================================================================================
T1557.504: Service Based Interface
Architecture Segment:  Control-plane
----------------------------------------
Procedure Examples
----------------------------------------
Triple Handshake: (2014): if a TLS client connects to a malicious server and presents a client credential, the server can then impersonate the client at any other server that accepts the same credential. Concretely, the malicious server performs an adversary-in-the-middle attack on three successive handshakes between the honest client and server, and succeeds in impersonating the client on the third handshake. See [5], clause 4.2.2.2 of [2].
SCP as AITM: An adversary in control of SCP can eavesdrop or alter user plane data and signaling data between two NFs e.g. AMF and UDM.
----------------------------------------
Mitigations
----------------------------------------
FGM5095: TLS certificate thorough checking. Ensure that all certificates received over a connection are valid for the current server endpoint, and abort the handshake if they are not. In some usages, it may be simplest to refuse any change of certificates during renegotiation.
FGM1557: Use TLS 1.3 or TLS 1.2 with only strong ciphersuites.
M1041: Use TLS 1.3 or TLS 1.2 with only strong ciphersuites.
M1047: Audit NF configuration for interfaces, e.g. if TLS is disabled or what version of TLS is being used.
----------------------------------------
Pre-Conditions
----------------------------------------
----------------------------------------
Critical Assets
----------------------------------------
5G Core network services, control plane (provisioning) data, service discovery.: There are many procedures that can be impacted if an adversary gets in the middle of a TLS connection between two network functions on the SBI.
----------------------------------------
Detection
----------------------------------------
----------------------------------------
Post-Conditions
----------------------------------------
----------------------------------------
References
----------------------------------------
European Union Agency for Cybersecurity (ENISA): “ENISA Threat Landscape for 5G Networks” Report, December 2020.: https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks
3rd Generation Partnership Project (3GPP) TS 33.117, “Catalogue of general security assurance requirements (Release 17)”, v17.0.0, June 2021.: https://www.3gpp.org/DynaReport/33117.htm  
3GPP TS 33.310 “Network Domain Security (NDS); Authentication Framework (AF)”: https://www.3gpp.org/DynaReport/33310.htm 
G. Koien, "On Threats to the 5G Service Based Architecture", 2021.: https://www.researchgate.net/journal/Wireless-Personal-Communications-1572-834X/publication/349455036_On_Threats_to_the_5G_Service_Based_Architecture/links/6030a03a4585158939b7bcae/On-Threats-to-the-5G-Service-Based-Architecture.pdf
3SHAKE: “Triple Handshakes Considered Harmful: Breaking and Fixing Authentication over TLS”: https://mitls.org/pages/attacks/3SHAKE
