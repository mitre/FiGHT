campaigns:
- description: The SolarWinds Compromise was a sophisticated supply chain cyber operation
    conducted by APT29 that was discovered in mid-December 2020.
  first_seen: ''
  groups: []
  id: C0024
  last_seen: ''
  name: Solarwind Compromise
  object-type: campaign
  software: []
  techniques:
  - id: FGT1195
    name: Supply Chain Compromise
    use: Solarwind compromise
  version: ''
- description: Operation Soft Cell is a sophisticated, long-term cyber espionage campaign
    targeting telecommunications providers worldwide.
  first_seen: ''
  groups: []
  id: FGC5001
  last_seen: ''
  name: Operation Soft Cell
  object-type: campaign
  software: []
  techniques:
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: Operation Soft Cell is a worldwide campaign against telecom. [1]
  version: ''
case-studies: []
data sources:
- component-of: []
  description: Computer software that provides low-level control for the hardware
    and device(s) of a host, such as BIOS or UEFI/EFI
  id: FGDS0001
  name: Firmware
  object-type: data source
  techniques: []
- component-of: FGDS0001
  description: Changes made to firmware, including its settings and/or data, such
    as MBR (Master Boot Record) and VBR (Volume Boot Record)
  id: FGDS0001.001
  name: Firmware Modification
  object-type: data source
  techniques:
  - FGT1014
  - FGT1542.501
- component-of: FGDS0001
  description: Baseband firmware on the UE does not match authorized version by the
    OEM or carrier
  id: FGDS0001.002
  name: Firmware Mismatch
  object-type: data source
  techniques:
  - FGT1203.502
- component-of: []
  description: A profile representing a user, device, service, or application used
    to authenticate and access resources
  id: FGDS0002
  name: User Account
  object-type: data source
  techniques: []
- component-of: FGDS0002
  description: 'An attempt by a user to gain access to a network or computing resource,
    often by providing credentials (ex: Windows EID 4776 or /var/log/auth.log)'
  id: FGDS0002.001
  name: User Account Authentication
  object-type: data source
  techniques:
  - FGT1078.001
  - FGT1195.502
  - FGT1078.003
  - FGT5004
  - FGT1110.001
  - FGT1078.004
- component-of: FGDS0002
  description: 'Initial construction of a new account (ex: Windows EID 4720 or /etc/passwd
    logs)'
  id: FGDS0002.002
  name: User Account Creation
  object-type: data source
  techniques: []
- component-of: FGDS0002
  description: 'Removal of an account (ex: Windows EID 4726 or /var/log access/authentication
    logs)'
  id: FGDS0002.003
  name: User Account Deletion
  object-type: data source
  techniques: []
- component-of: FGDS0002
  description: Contextual data about an account, which may include a username, user
    ID, environmental data, etc.
  id: FGDS0002.004
  name: User Account Metadata
  object-type: data source
  techniques: []
- component-of: FGDS0002
  description: 'Changes made to an account, such as permissions and/or membership
    in specific groups (ex: Windows EID 4738 or /var/log access/authentication logs)'
  id: FGDS0002.005
  name: User Account Modification
  object-type: data source
  techniques:
  - FGT1498.504
- component-of: []
  description: Information obtained (via shared or submitted samples) regarding malicious
    software (droppers, backdoors, etc.) used by adversaries
  id: FGDS0004
  name: Malware Repository
  object-type: data source
  techniques: []
- component-of: FGDS0004
  description: Code, strings, signatures, and other identifying characteristics of
    a malicious payload stored within a malware repository. It includes both static
    (file-based) and dynamic (behavioral or execution-based) components that can be
    analyzed for threat intelligence, detection, and prevention purposes.
  id: FGDS0004.001
  name: Malware Content
  object-type: data source
  techniques:
  - FGT1195.501
- component-of: FGDS0004
  description: Contextual data about a malicious payload, such as compilation times,
    file hashes, as well as watermarks or other identifiable configuration information
  id: FGDS0004.002
  name: Malware Metadata
  object-type: data source
  techniques:
  - FGT1195.501
  - FGT1588.002
- component-of: []
  description: Credential material, such as session cookies or tokens, used to authenticate
    to web applications and services
  id: FGDS0006
  name: Web Credential
  object-type: data source
  techniques: []
- component-of: FGDS0006
  description: Credential material, such as session cookies or tokens, used to authenticate
    to web applications and services
  id: FGDS0006.001
  name: Web Credential Creation
  object-type: data source
  techniques: []
- component-of: FGDS0006
  description: 'An attempt by a user to gain access to a network or computing resource
    by providing web credentials (ex: Windows EID 1202)'
  id: FGDS0006.002
  name: Web Credential Usage
  object-type: data source
  techniques:
  - FGT5034
- component-of: []
  description: A single file used to deploy a virtual machine/bootable disk into an
    on-premise or third-party cloud environment
  id: FGDS0007
  name: Image
  object-type: data source
  techniques: []
- component-of: FGDS0007
  description: 'Initial construction of a virtual machine image (ex: Azure Compute
    Service Images PUT)'
  id: FGDS0007.001
  name: Image Creation
  object-type: data source
  techniques:
  - FGT1525
- component-of: FGDS0007
  description: 'Removal of a virtual machine image (ex: Azure Compute Service Images
    DELETE)'
  id: FGDS0007.002
  name: Image Deletion
  object-type: data source
  techniques:
  - FGT1525
- component-of: FGDS0007
  description: Contextual data about a virtual machine image such as name, resource
    group, state, or type
  id: FGDS0007.003
  name: Image Metadata
  object-type: data source
  techniques:
  - FGT1525
  - FGT1498.503
- component-of: FGDS0007
  description: 'Changes made to a virtual machine image, including setting and/or
    control data (ex: Azure Compute Service Images PATCH)'
  id: FGDS0007.004
  name: Image Modification
  object-type: data source
  techniques:
  - FGT1525
  - FGT5039
  - FGT1195
- component-of: FGDS0007
  description: "Verify the image hash of core NF or O-RAN applications (xApp/rApp)\
    \ against known reference values for these hashes. Ensure the applications have\
    \ the correct software patches installed. \nThe hash could also be a 5G platform\
    \ software image hash."
  id: FGDS0007.005
  name: Image hash
  object-type: data source
  techniques:
  - FGT1525
  - FGT5032.002
  - FGT1210
  - FGT5032.003
  - FGT5034
- component-of: []
  description: A computer program, at the core of a computer OS, that resides in memory
    and facilitates interactions between hardware and software components
  id: FGDS0008
  name: Kernel
  object-type: data source
  techniques: []
- component-of: FGDS0008
  description: An object file that contains code to extend the running kernel of an
    OS, typically used to add support for new hardware (as device drivers) and/or
    filesystems, or for adding system calls
  id: FGDS0008.001
  name: Kernel Module Load
  object-type: data source
  techniques:
  - FGT1609.501
  - FGT1014
  - FGT1542.501
  - FGT5005
- component-of: []
  description: Instances of computer programs that are being executed by at least
    one thread.
  id: FGDS0009
  name: Process
  object-type: data source
  techniques: []
- component-of: FGDS0009
  description: Operating system function/method calls executed by a process
  id: FGDS0009.001
  name: OS API Execution
  object-type: data source
  techniques:
  - FGT1609.501
  - FGT1195.502
  - FGT1059
  - FGT1014
  - FGT1542.501
  - FGT5046
  - FGT5005
- component-of: FGDS0009
  description: 'Opening of a process by another process, typically to read memory
    of the target process (ex: Sysmon EID 10)'
  id: FGDS0009.002
  name: Process Access
  object-type: data source
  techniques:
  - FGT1562.004
  - FGT1036.005
  - FGT1040.502
  - FGT5045
- component-of: FGDS0009
  description: The initial construction of an executable managed by the OS, that may
    involve one or more tasks or threads. (e.g. Win EID 4688, Sysmon EID 1, cmd.exe
    > net use, etc.)
  id: FGDS0009.003
  name: Process Creation
  object-type: data source
  techniques:
  - FGT1040
  - FGT1205
  - FGT1611
  - FGT1071.501
  - FGT1572.502
  - FGT1036.502
- component-of: FGDS0009
  description: Contextual data about a running process, which may include information
    such as environment variables, image name, user/owner, etc.
  id: FGDS0009.004
  name: Process Metadata
  object-type: data source
  techniques:
  - FGT1040
  - FGT1072
  - FGT1611.501
- component-of: FGDS0009
  description: 'Changes made to a process, or its contents, typically to write and/or
    execute code in the memory of the target process (ex: Sysmon EID 8)'
  id: FGDS0009.005
  name: Process Modification
  object-type: data source
  techniques:
  - FGT5039
- component-of: FGDS0009
  description: 'Exit of a running process (ex: Sysmon EID 5 or Windows EID 4689)'
  id: FGDS0009.006
  name: Process Termination
  object-type: data source
  techniques: []
- component-of: []
  description: Data object storage infrastructure hosted on-premise or by third-party
    providers, made available to users through network connections and/or APIs
  id: FGDS0010
  name: Cloud Storage
  object-type: data source
  techniques: []
- component-of: FGDS0010
  description: 'Opening of a cloud storage infrastructure, typically to collect/read
    its value (ex: AWS S3 GetObject)'
  id: FGDS0010.001
  name: Cloud Storage Access
  object-type: data source
  techniques:
  - FGT5034
- component-of: FGDS0010
  description: 'Initial construction of new cloud storage infrastructure (ex: AWS
    S3 CreateBucket)'
  id: FGDS0010.002
  name: Cloud Storage Creation
  object-type: data source
  techniques: []
- component-of: FGDS0010
  description: 'Removal of cloud storage infrastructure (ex: AWS S3 DeleteBucket)'
  id: FGDS0010.003
  name: Cloud Storage Deletion
  object-type: data source
  techniques: []
- component-of: FGDS0010
  description: 'An extracted list of cloud storage infrastructure (ex: AWS S3 ListBuckets
    or ListObjects)'
  id: FGDS0010.004
  name: Cloud Storage Enumeration
  object-type: data source
  techniques: []
- component-of: FGDS0010
  description: Contextual data about cloud storage infrastructure and activity around
    it such as name, size, or owner
  id: FGDS0010.005
  name: Cloud Storage Metadata
  object-type: data source
  techniques: []
- component-of: FGDS0010
  description: 'Changes made to cloud storage infrastructure, including its settings
    and/or data (ex: AWS S3 PutObject or PutObjectAcl)'
  id: FGDS0010.006
  name: Cloud Storage Modification
  object-type: data source
  techniques: []
- component-of: []
  description: A file or stream containing a list of commands, allowing them to be
    launched in sequence
  id: FGDS0012
  name: Script
  object-type: data source
  techniques: []
- component-of: FGDS0012
  description: The execution of a text file that contains code via the interpreter
    (e.g. Powershell, WMI, Windows EID 4104, etc.)
  id: FGDS0012.001
  name: Execution
  object-type: data source
  techniques:
  - FGT1525
  - FGT5034.001
  - FGT1195.502
  - FGT1059
- component-of: []
  description: Information from host telemetry providing insights about system status,
    errors, or other notable functional activity
  id: FGDS0013
  name: Sensor Health
  object-type: data source
  techniques: []
- component-of: FGDS0013
  description: 'Logging, messaging, and other artifacts highlighting the health of
    host sensors (ex: metrics, errors, and/or exceptions from logging applications)'
  id: FGDS0013.001
  name: Host Status
  object-type: data source
  techniques:
  - FGT1498.502
  - FGT1499.505
  - FGT1609.501
  - FGT5034.001
  - FGT1195.003
  - FGT5038
  - FGT5035
  - FGT1642.502
  - FGT1599.501
  - FGT5010
  - FGT1599.502
  - FGT1195
- component-of: []
  description: A single unit of shared resources within a cluster, comprised of one
    or more containers
  id: FGDS0014
  name: Pod
  object-type: data source
  techniques: []
- component-of: FGDS0014
  description: 'Initial construction of a new pod (ex: kubectl apply|run)'
  id: FGDS0014.001
  name: Pod Creation
  object-type: data source
  techniques:
  - FGT5014
  - FGT5013
- component-of: FGDS0014
  description: 'An extracted list of pods within a cluster (ex: kubectl get pods)'
  id: FGDS0014.002
  name: Pod Enumeration
  object-type: data source
  techniques:
  - FGT5013
- component-of: FGDS0014
  description: 'Changes made to a pod, including its settings and/or control data
    (ex: kubectl set|patch|edit)'
  id: FGDS0014.003
  name: Pod Modification
  object-type: data source
  techniques:
  - FGT5013
- component-of: []
  description: Events collected by third-party services such as mail servers, web
    applications, or other appliances (not by the native OS or platform) Data sources
    with information about the set of devices found within the network, along with
    their current software and configurations
  id: FGDS0015
  name: Application Log
  object-type: data source
  techniques: []
- component-of: FGDS0015
  description: 'Logging, messaging, and other artifacts provided by third-party services
    (ex: metrics, errors, and/or alerts)'
  id: FGDS0015.001
  name: Application Log Content
  object-type: data source
  techniques:
  - FGT1498.504
  - FGT1525
  - FGT5020
  - FGT1499.503
  - FGT1040
  - FGT5004.001
  - FGT1557.502
  - FGT5016
  - FGT1642.503
  - FGT1072
  - FGT1600.501
  - FGT5014
  - FGT5039
  - FGT5034.001
  - FGT5004.002
  - FGT5012.004
  - FGT5037
  - FGT1557.503
  - FGT5022
  - FGT1557.504
  - FGT1555.501
  - FGT5009.002
  - FGT5012.005
  - FGT5008
  - FGT5029
  - FGT1199.501
  - FGT5013
  - FGT5038
  - FGT5004
  - FGT5007
  - FGT5009.001
  - FGT1599.501
  - FGT5032.002
  - FGT5036
  - FGT5032.003
  - FGT1499.504
  - FGT5041
  - FGT5011
  - FGT5019.003
  - FGT1611.501
  - FGT1600.502
  - FGT1599.502
  - FGT5005
  - FGT1190
  - FGT5002
  - FGT5028
  - FGT5027
- component-of: []
  description: A non-volatile data storage device (hard drive, floppy disk, USB flash
    drive) with at least one formatted partition, typically mounted to the file system
    and/or assigned a drive letter
  id: FGDS0016
  name: Drive
  object-type: data source
  techniques: []
- component-of: FGDS0016
  description: Refers to the act of accessing a data storage device, such as a hard
    drive, SSD, USB, or network-mounted drive. This data component logs the opening
    or mounting of drives, capturing activities such as reading, writing, or executing
    files within an assigned drive letter (e.g., C:\, /mnt/drive) or mount point.
  id: FGDS0016.001
  name: Drive Access
  object-type: data source
  techniques:
  - FGT1195.502
- component-of: FGDS0016
  description: The activity of assigning a new drive letter or creating a mount point
    for a data storage device, such as a USB, network share, or external hard drive,
    enabling access to its content on a host system.
  id: FGDS0016.002
  name: Drive Creation
  object-type: data source
  techniques: []
- component-of: FGDS0016
  description: The alteration of a drive letter, mount point, or other attributes
    of a data storage device, which could involve reassignment, renaming, permissions
    changes, or other modifications.
  id: FGDS0016.003
  name: Drive Modification
  object-type: data source
  techniques: []
- component-of: []
  description: A directive given to a computer program, acting as an interpreter of
    some kind, in order to perform a specific task
  id: FGDS0017
  name: Command
  object-type: data source
  techniques: []
- component-of: FGDS0017
  description: The execution of a line of text, potentially with arguments, created
    from program code (e.g. a cmdlet executed via powershell.exe, interactive commands
    like >dir, shell executions, etc. )
  id: FGDS0017.001
  name: Command Execution
  object-type: data source
  techniques:
  - FGT1020.001
  - FGT1040
  - FGT1048.003
  - FGT1046
  - FGT5014
  - FGT5034.001
  - FGT1195.502
  - FGT1048.501
  - FGT1059
  - FGT1071.502
  - FGT1542.501
  - FGT1021
- component-of: []
  description: 'A network security system, running locally on an endpoint or remotely
    as a service (ex: cloud environment), that monitors and controls incoming/outgoing
    network traffic based on predefined rules'
  id: FGDS0018
  name: Firewall
  object-type: data source
  techniques: []
- component-of: FGDS0018
  description: 'Deactivation or stoppage of a cloud service (ex: Write/Delete entries
    within Azure Firewall Activity Logs)'
  id: FGDS0018.001
  name: Firewall disable
  object-type: data source
  techniques: []
- component-of: FGDS0018
  description: An extracted list of available firewalls and/or their associated settings/rules
  id: FGDS0018.002
  name: Firewall enumeration
  object-type: data source
  techniques:
  - FGT5045
- component-of: FGDS0018
  description: Contextual data about a firewall and activity around it such as name,
    policy, or status
  id: FGDS0018.003
  name: Firewall metadata
  object-type: data source
  techniques:
  - FGT5042
  - FGT5044
  - FGT1498.501
  - FGT1572.502
  - FGT1583.508
- component-of: FGDS0018
  description: Changes made to a firewall rule, typically to allow/block specific
    network traffic
  id: FGDS0018.004
  name: Firewall rule modification
  object-type: data source
  techniques: []
- component-of: []
  description: A computer process that is configured to execute continuously in the
    background and perform system tasks, in some cases before any user has logged
    in
  id: FGDS0019
  name: Service
  object-type: data source
  techniques: []
- component-of: FGDS0019
  description: 'Initial construction of a new service/daemon (ex: Windows EID 4697
    or /var/log daemon logs)'
  id: FGDS0019.001
  name: Service Creation
  object-type: data source
  techniques:
  - FGT1609.501
- component-of: FGDS0019
  description: Contextual data about a service/daemon, which may include information
    such as name, service executable, start type, etc.
  id: FGDS0019.002
  name: Service Metdata
  object-type: data source
  techniques: []
- component-of: FGDS0019
  description: 'Changes made to a service/daemon, such as changes to name, description,
    and/or start type (ex: Windows EID 7040 or /var/log daemon logs)'
  id: FGDS0019.003
  name: Service Modification
  object-type: data source
  techniques: []
- component-of: []
  description: A computer resource object, managed by the I/O system, for storing
    data (such as images, text, videos, computer programs, or any wide variety of
    other media).
  id: FGDS0022
  name: File
  object-type: data source
  techniques: []
- component-of: FGDS0022
  description: 'Opening a file, which makes the file contents available to the requestor
    (ex: Windows EID 4663)'
  id: FGDS0022.001
  name: File Access
  object-type: data source
  techniques:
  - FGT1195.502
  - FGT1059
  - FGT5046
  - FGT1195
- component-of: FGDS0022
  description: 'Initial construction of a new file (ex: Sysmon EID 11)'
  id: FGDS0022.002
  name: File Creation
  object-type: data source
  techniques:
  - FGT1195.502
  - FGT1059
  - FGT5046
  - FGT1195
- component-of: FGDS0022
  description: 'Removal of a file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK,
    or Linux commands auditd unlink, rename, rmdir, unlinked, or renameat rules)'
  id: FGDS0022.003
  name: File Deletion
  object-type: data source
  techniques:
  - FGT1195.502
  - FGT1059
  - FGT5046
- component-of: FGDS0022
  description: 'Contextual data about a file, which may include information such as
    name, the content (ex: signature, headers, or data/media), user/owner, permissions,
    etc.'
  id: FGDS0022.004
  name: File Metadata
  object-type: data source
  techniques:
  - FGT1195.502
  - FGT1059
  - FGT1195.003
  - FGT5046
- component-of: FGDS0022
  description: File contents are changed by adversary.
  id: FGDS0022.005
  name: File Modification
  object-type: data source
  techniques:
  - FGT1498.504
  - FGT1609.501
  - FGT1195.002
  - FGT1562.004
  - FGT1195.502
  - FGT1059
  - FGT1195.003
  - FGT1036.005
  - FGT5032.002
  - FGT5045
  - FGT5032.003
  - FGT5046
  - FGT1195
- component-of: []
  description: Infrastructure, platforms, or software that are hosted on-premise or
    by third-party providers, made available to users through network connections
    and/or APIs
  id: FGDS0025
  name: Cloud Service
  object-type: data source
  techniques: []
- component-of: FGDS0025
  description: 'Deactivation or stoppage of a cloud service (ex: AWS Cloudtrail StopLogging)'
  id: FGDS0025.001
  name: Cloud Service Disable
  object-type: data source
  techniques: []
- component-of: FGDS0025
  description: 'An extracted list of cloud services (ex: AWS ECS ListServices)'
  id: FGDS0025.002
  name: Cloud Service Enumeration
  object-type: data source
  techniques:
  - FGT1046
- component-of: FGDS0025
  description: Contextual data about a cloud service and activity around it such as
    name, type, or purpose/function
  id: FGDS0025.003
  name: Cloud Service Metadata
  object-type: data source
  techniques:
  - FGT1210
- component-of: FGDS0025
  description: 'Changes made to a cloud service, including its settings and/or data
    (ex: AWS CloudTrail DeleteTrail or DeleteConfigRule)'
  id: FGDS0025.004
  name: Cloud Service Modification
  object-type: data source
  techniques:
  - FGT5032.002
  - FGT5032.003
  - FGT5034
- component-of: []
  description: A database and set of services that allows administrators to manage
    permissions, access to network resources, and stored data objects (user, group,
    application, or devices)
  id: FGDS0026
  name: Active Directory
  object-type: data source
  techniques: []
- component-of: FGDS0026
  description: Requests for authentication credentials via Kerberos or other methods
    like NTLM and LDAP queries.
  id: FGDS0026.001
  name: Active Directory Credential Request
  object-type: data source
  techniques: []
- component-of: FGDS0026
  description: Object access refers to activities where AD objects (e.g., user accounts,
    groups, policies) are accessed or queried.
  id: FGDS0026.002
  name: Active Directory Object Access
  object-type: data source
  techniques: []
- component-of: FGDS0026
  description: Creating new objects in AD, such as user accounts, groups, organizational
    units (OUs), or trust relationships. Logged as Event ID 5137
  id: FGDS0026.003
  name: Active Directory Object Creation
  object-type: data source
  techniques:
  - FGT5041
- component-of: FGDS0026
  description: Object deletion in AD (e.g., user accounts, groups, OUs) is logged
    as Event ID 5141
  id: FGDS0026.004
  name: Active Directory Object Deletion
  object-type: data source
  techniques: []
- component-of: FGDS0026
  description: Changes to AD objects (e.g., users, groups, OUs) are logged as Event
    ID 5136 (Object Modification) or 5163 (Attribute Changes).
  id: FGDS0026.005
  name: Active Directory Object Modification
  object-type: data source
  techniques: []
- component-of: []
  description: Logon occurring on a system or resource (local, domain, or cloud) to
    which a user/device is gaining access after successful authentication and authorizaton
  id: FGDS0028
  name: Logon Session
  object-type: data source
  techniques: []
- component-of: FGDS0028
  description: Initial construction of a successful new user logon following an authentication
    attempt. (e.g. Windows EID 4624, /var/log/utmp, or /var/log/wmtp)
  id: FGDS0028.001
  name: Logon Session Creation
  object-type: data source
  techniques:
  - FGT5039
  - FGT5037
  - FGT5029
  - FGT1021
  - FGT5036
  - FGT1078.004
- component-of: FGDS0028
  description: Contextual data about a logon session, such as username, logon type,
    access tokens (security context, user SIDs, logon identifiers, and logon SID),
    and any activity associated within it
  id: FGDS0028.002
  name: Logon Session Metadata
  object-type: data source
  techniques:
  - FGT5039
  - FGT5037
  - FGT1555.501
  - FGT1078.003
  - FGT5038
  - FGT5036
  - FGT1599.502
- component-of: []
  description: 'Data transmitted across a network (ex: Web, DNS, Mail, File, etc.),
    that is either summarized (ex: Netflow) and/or captured as raw data in an analyzable
    format (ex: PCAP)'
  id: FGDS0029
  name: Network Traffic
  object-type: data source
  techniques: []
- component-of: FGDS0029
  description: 'Initial construction of a network connection, such as capturing socket
    information with a source/destination IP and port(s) (ex: Windows EID 5156, Sysmon
    EID 3, or Zeek conn.log)'
  id: FGDS0029.001
  name: Network Connection Creation
  object-type: data source
  techniques:
  - FGT1018
  - FGT1048.003
  - FGT1090.002
  - FGT5016
  - FGT1046
  - FGT1048
  - FGT1542.501
  - FGT1498.501
  - FGT1090.003
  - FGT5021
  - FGT1090.001
  - FGT1499.504
  - FGT1200
  - FGT5005
  - FGT1046.501
- component-of: FGDS0029
  description: 'Logged network traffic data showing both protocol header and body
    values (ex: PCAP)'
  id: FGDS0029.002
  name: Network Traffic Content
  object-type: data source
  techniques:
  - FGT1599
  - FGT1499
  - FGT1499.505
  - FGT1018
  - FGT1205
  - FGT1499.501
  - FGT5031
  - FGT1048.003
  - FGT1090.002
  - FGT1600.501
  - FGT5039
  - FGT5019.005
  - FGT5012.004
  - FGT1567.002
  - FGT1557.503
  - FGT1041
  - FGT1048
  - FGT1564.501
  - FGT1557.504
  - FGT5009.002
  - FGT1048.501
  - FGT1498.503
  - FGT1071.502
  - FGT1572
  - FGT1542.501
  - FGT5029
  - FGT1071.501
  - FGT1599.505
  - FGT1021
  - FGT5038
  - FGT5009.001
  - FGT5009
  - FGT1572.502
  - FGT1557.002
  - FGT1090.003
  - FGT1090.001
  - FGT1200
  - FGT1036.502
  - FGT1600.502
  - FGT1190
  - FGT5012.008
  - FGT1572.501
  - FGT1046.501
- component-of: FGDS0029
  description: 'Summarized network packet data, with metrics, such as protocol headers
    and volume (ex: Netflow or Zeek http.log)'
  id: FGDS0029.003
  name: Network Traffic Flow
  object-type: data source
  techniques:
  - FGT1599
  - FGT1020.001
  - FGT1018
  - FGT5004.001
  - FGT1048.003
  - FGT1557.502
  - FGT1090.002
  - FGT1046
  - FGT5004.002
  - FGT1195.502
  - FGT1555.501
  - FGT1014
  - FGT1071.502
  - FGT1542.501
  - FGT1199.501
  - FGT5004
  - FGT1599.501
  - FGT1557.002
  - FGT1090.003
  - FGT1036.501
  - FGT1090.001
  - FGT1200
  - FGT1599.502
  - FGT5005
  - FGT1046.501
- component-of: []
  description: A standard unit of virtualized software that packages up code and all
    its dependencies so the application runs quickly and reliably from one computing
    environment to another
  id: FGDS0032
  name: Container
  object-type: data source
  techniques: []
- component-of: FGDS0032
  description: 'Initial construction of a new container (ex: docker create )'
  id: FGDS0032.001
  name: Container Creation
  object-type: data source
  techniques:
  - FGT5014
  - FGT1611
  - FGT5013
  - FGT5007
  - FGT1611.501
- component-of: FGDS0032
  description: 'An extracted list of containers (ex: docker ps)'
  id: FGDS0032.002
  name: Container Enumeration
  object-type: data source
  techniques:
  - FGT5014
  - FGT5013
- component-of: FGDS0032
  description: 'Activation or invocation of a container (ex: docker start or docker
    restart)'
  id: FGDS0032.003
  name: Container Start
  object-type: data source
  techniques:
  - FGT1609.501
  - FGT5014
  - FGT5013
- component-of: []
  description: Block object storage hosted on-premise or by third-party providers,
    typically made available to resources as virtualized hard drives
  id: FGDS0034
  name: Volume
  object-type: data source
  techniques: []
- component-of: FGDS0034
  description: 'Initial construction of a cloud volume (ex: AWS create-volume)'
  id: FGDS0034.001
  name: Volume Creation
  object-type: data source
  techniques:
  - FGT1611
- component-of: FGDS0034
  description: 'Removal of a a cloud volume (ex: AWS delete-volume)'
  id: FGDS0034.002
  name: Volume Deletion
  object-type: data source
  techniques:
  - FGT1611
- component-of: FGDS0034
  description: 'An extracted list of available volumes within a cloud environment
    (ex: AWS describe-volumes)'
  id: FGDS0034.003
  name: Volume Enumeration
  object-type: data source
  techniques:
  - FGT1611
- component-of: FGDS0034
  description: Contextual data about a cloud volume and activity around it, such as
    id, type, state, and size
  id: FGDS0034.004
  name: Volume Metdata
  object-type: data source
  techniques:
  - FGT1611
- component-of: FGDS0034
  description: 'Changes made to a cloud volume, including its settings and control
    data (ex: AWS modify-volume)'
  id: FGDS0034.005
  name: Volume Modification
  object-type: data source
  techniques:
  - FGT1611
  - FGT1611.501
- component-of: []
  description: Information obtained (commonly via active network traffic probes or
    web crawling) regarding various types of resources and servers connected to the
    public Internet
  id: FGDS0035
  name: Internet Scan
  object-type: data source
  techniques: []
- component-of: FGDS0035
  description: Logged network traffic in response to a scan showing both protocol
    header and body values
  id: FGDS0035.001
  name: Response Content
  object-type: data source
  techniques: []
- component-of: FGDS0035
  description: Contextual data about an Internet-facing resource gathered from a scan,
    such as running services or ports
  id: FGDS0035.002
  name: Response Metadata
  object-type: data source
  techniques:
  - FGT1583.508
  - FGT1046.501
- component-of: []
  description: A digital document, which highlights information such as the owner's
    identity, used to instill trust in public keys used while encrypting network communications
  id: FGDS0037
  name: Certificate
  object-type: data source
  techniques: []
- component-of: FGDS0037
  description: Verify and refresh frequently digital signatures used for authenticating
    xApps by near-RT RIC and E2 nodes.
  id: FGDS0037.001
  name: Certificate Registration
  object-type: data source
  techniques:
  - FGT1210
  - FGT5034
- component-of: []
  description: Data sources with information about the set of devices found within
    the network, along with their current software and configurations
  id: FGDS0039
  name: Asset
  object-type: data source
  techniques: []
- component-of: FGDS0039
  description: This includes sources of current and expected devices on the network,
    including the manufacturer, model, and necessary identifiers (e.g., IP and hardware
    addresses)
  id: FGDS0039.001
  name: Asset inventory
  object-type: data source
  techniques:
  - FGT1040.502
  - FGT1200
  - FGT5018
- component-of: FGDS0039
  description: This includes sources of current and expected software or application
    programs deployed to a device, along with information on the version and patch
    level for vendor products, full source code for any application programs, and
    unique identifiers (e.g., hashes, signatures).
  id: FGDS0039.002
  name: Software
  object-type: data source
  techniques: []
- component-of: []
  description: Operational databases contain information about the status of the operational
    process and associated devices, including any measurements, events, history, or
    alarms that have occurred
  id: FGDS0040
  name: Operational Databases
  object-type: data source
  techniques: []
- component-of: FGDS0040
  description: This includes alarms associated with unexpected device functions, such
    as shutdowns, restarts, failures, or configuration changes
  id: FGDS0040.001
  name: Device Alarm
  object-type: data source
  techniques:
  - FGT5018
- component-of: FGDS0040
  description: This includes any data stores that maintain historical or real-time
    events and telemetry recorded from various sensors or devices
  id: FGDS0040.002
  name: Process History/Live Data
  object-type: data source
  techniques:
  - FGT5018.002
- component-of: FGDS0040
  description: This includes a list of any process alarms or alerts produced to indicate
    unusual or concerning activity within the operational process (e.g., increased
    temperature/pressure)
  id: FGDS0040.003
  name: Process/Event Alarm
  object-type: data source
  techniques: []
- component-of: []
  description: Visual activity on the device that could alert the user to potentially
    malicious behavior.
  id: FGDS0042
  name: User Interface
  object-type: data source
  techniques: []
- component-of: FGDS0042
  description: System prompts triggered when an application requests new or additional
    permissions
  id: FGDS0042.001
  name: Permission Request
  object-type: data source
  techniques:
  - FGT5043.001
  - FGT5043
- component-of: FGDS0042
  description: Notifications generated by the OS
  id: FGDS0042.002
  name: System Notifications
  object-type: data source
  techniques:
  - FGT5044
  - FGT5035
- component-of: FGDS0042
  description: Settings visible to the user on the device
  id: FGDS0042.003
  name: System Settings
  object-type: data source
  techniques:
  - FGT5004.002
- component-of: []
  description: RF spectrum contains information that can be used for signal direction
    finding and geolocation, as well as to detect jamming
  id: FGDS5001
  name: RF Spectrum
  object-type: data source
  techniques: []
- component-of: FGDS5001
  description: Signal measurements to identify the presence of jamming source.
  id: FGDS5001.001
  name: RF Spectrum signals
  object-type: data source
  techniques: []
- component-of: []
  description: Radio layer messages between UE and the serving gNB (phy/MAC layer)
  id: FGDS5002
  name: Radio interface
  object-type: data source
  techniques: []
- component-of: FGDS5002
  description: 'UE signals sent to gNB such as: measurements of received power levels
    from all base stations nearby, other signals such as Sounding Reference Signal
    (SRS).'
  id: FGDS5002.001
  name: Signals sent by UEs
  object-type: data source
  techniques:
  - FGT1498.504
  - FGT1608.501
  - FGT5012.006
  - FGT1583.501
  - FGT1642.501
  - FGT1036.501
  - FGT5012.007
  - FGT1562.501
  - FGT1557.501
- component-of: FGDS5002
  description: gNB signals & messages broadcast for all UEs to hear- e.g. MIBs and
    SIBs, also PRS (Positioning Ref Signal)
  id: FGDS5002.002
  name: gNB broadcast messages
  object-type: data source
  techniques:
  - FGT1498.002
  - FGT1642.502
- component-of: FGDS5002
  description: Paging channel content
  id: FGDS5002.003
  name: Paging channel
  object-type: data source
  techniques:
  - FGT5012.003
- component-of: FGDS5002
  description: NAS messages from UE to gNB or gNB to UE (e.g., NAS attach messages  for
    encryption/integrity algorithm downgrading to NULL, or NAS registration rejects
    for downgrade by network to steer UE to 4G/3G.)
  id: FGDS5002.004
  name: NAS messages between UE and AMF
  object-type: data source
  techniques:
  - FGT5012.006
- component-of: []
  description: Charging system records for anomaly detection
  id: FGDS5003
  name: Charging data records
  object-type: data source
  techniques: []
- component-of: FGDS5003
  description: Content of Subscriber CDRs (Charging Data Records) (e.g., in Charging
    Funciton (CHF) logs)
  id: FGDS5003.001
  name: Charging data records content
  object-type: data source
  techniques:
  - FGT5025
  - FGT5021
  - FGT5023
- component-of: []
  description: SIM card usage logs in the network to identify any fraudulent use of
    SIM cards.
  id: FGDS5005
  name: Core network logs for SIM
  object-type: data source
  techniques: []
- component-of: FGDS5005
  description: SIM card usage logs in the network to identify if more than one UE
    is using the same IMSI/SUPI simultaneously or the same IMSI/SUPI is being used
    in two impossible geographical locations within a short period of time. E.g. if
    the IMSI/SUPI is used in two locations which are far apart within a short period
    of time (not simultaneously).
  id: FGDS5005.001
  name: Core logs for SIM usage pattern
  object-type: data source
  techniques:
  - FGT5026
- component-of: []
  description: Logs of battery, CPU, storage consumption and use
  id: FGDS5006
  name: UE logs for resource usage
  object-type: data source
  techniques: []
- component-of: FGDS5006
  description: Unexpected power consumption or unexplained battery drain
  id: FGDS5006.001
  name: UE battery performance
  object-type: data source
  techniques:
  - FGT1203.502
- component-of: []
  description: Logs of access to operator O&M resources like IR.21, EIR databases.
  id: FGDS5009
  name: MNO database access logs
  object-type: data source
  techniques: []
- component-of: FGDS5009
  description: Logs of all types of operator database access requests.
  id: FGDS5009.001
  name: MNO database access logs  content in core
  object-type: data source
  techniques:
  - FGT5015
  - FGT1592.501
- component-of: []
  description: UE logs about RAT transition events, and user actions such as turn
    on or off airplane mode, SIM card operations.
  id: FGDS5010
  name: UE  logs
  object-type: data source
  techniques: []
- component-of: FGDS5010
  description: UE modem logs  RAT transition events e.g. 5G to 4G or 3G.
  id: FGDS5010.001
  name: UE logs for radio network transition events
  object-type: data source
  techniques:
  - FGT5019.002
  - FGT1562.501
- component-of: FGDS5010
  description: UE service related logs from the Android or iOS applications in the
    application processor. These logs capture user actions such as turning on or off
    airplane mode.
  id: FGDS5010.002
  name: UE Operating system logs
  object-type: data source
  techniques: []
- component-of: FGDS5010
  description: Messages between modem processor and SIM/eSIM.
  id: FGDS5010.003
  name: UE logs for SIM card accesses
  object-type: data source
  techniques: []
- component-of: []
  description: Subscriber complaints to the operator about issues they experience
    with connectivity, network performance or billing.
  id: FGDS5011
  name: MNO logs in core for subscriber service complaints
  object-type: data source
  techniques: []
- component-of: FGDS5011
  description: Subscriber complaint logs about degraded or denied service.
  id: FGDS5011.001
  name: MNO logs for service issues in core
  object-type: data source
  techniques:
  - FGT5025
  - FGT1499.503
  - FGT5022
  - FGT1203.502
  - FGT1499.502
- component-of: []
  description: Security Incident and event monitoring.
  id: FGDS5012
  name: Security logs in network
  object-type: data source
  techniques: []
- component-of: FGDS5012
  description: Logs for security, authentication and authorization, host access (physical
    and virtual) etc.
  id: FGDS5012.001
  name: Security logs in core
  object-type: data source
  techniques:
  - FGT1498.502
  - FGT5018.004
  - FGT5018.001
  - FGT5001
  - FGT1040.502
  - FGT5018.003
  - FGT5027
- component-of: []
  description: SDN logs to detect unauthorized activity
  id: FGDS5014
  name: SDN Access Logs in SDN elements
  object-type: data source
  techniques: []
- component-of: FGDS5014
  description: Logs accessing SDN elements (routers, switches, SDN controllers)
  id: FGDS5014.001
  name: SDN Access Logs in SDN elements
  object-type: data source
  techniques:
  - FGT5004.001
  - FGT5004.002
  - FGT5004
- component-of: []
  description: Packets received at the User Plane Function (UPF)
  id: FGDS5016
  name: Packet capture for user plane packets
  object-type: data source
  techniques: []
- component-of: FGDS5016
  description: Message payload of all user plane packets received from the internet
    at UPF or PGW for detecting encapsulated GTP-U packet.
  id: FGDS5016.001
  name: Core network packet captures (pcaps)
  object-type: data source
  techniques:
  - FGT5031
  - FGT1567.002
  - FGT1041
  - FGT1564.501
  - FGT1572.502
  - FGT1572.501
- component-of: []
  description: Logs collected at the gNB or a 5G core network function.
  id: FGDS5017
  name: gNB or 5G core logs
  object-type: data source
  techniques: []
- component-of: FGDS5017
  description: gNB logs for NULL scheme usage in registration messages from UEs.
  id: FGDS5017.001
  name: gNB log content for NULL encryption use
  object-type: data source
  techniques:
  - FGT1600.501
- component-of: FGDS5017
  description: Core network logs for NULL scheme usage in registration messages from
    UEs.
  id: FGDS5017.002
  name: Core network log content for NULL encryption use
  object-type: data source
  techniques:
  - FGT1600.501
- component-of: FGDS5017
  description: Access request messages received from UEs (or a single UE) at the gNB
    within a short period of time.
  id: FGDS5017.003
  name: gNB log content for flooding of messages from UE
  object-type: data source
  techniques:
  - FGT1498.501
  - FGT1499.002
- component-of: FGDS5017
  description: Registration request messages received from UEs (or a single UE) at
    the core network within a short period of time.
  id: FGDS5017.004
  name: Core network log content for flooding of messages from UE
  object-type: data source
  techniques: []
- component-of: FGDS5017
  description: gNB logs of UE experiencing frequent dropped connections, difficulty
    connecting and throttled data.
  id: FGDS5017.005
  name: Erratic connectivity
  object-type: data source
  techniques: []
- component-of: FGDS5017
  description: gNB logs for unplanned service outage.
  id: FGDS5017.006
  name: gNB log for service outage
  object-type: data source
  techniques:
  - FGT5024
- component-of: FGDS5017
  description: Provisioning logs for UE related security configuration changes in
    core allowing NULL encryption of the SUPI.
  id: FGDS5017.007
  name: Provisioning logs in core
  object-type: data source
  techniques:
  - FGT1600.501
- component-of: FGDS5017
  description: gNB logs for replayed messages sent to gNB
  id: FGDS5017.008
  name: gNB log for replayed messages
  object-type: data source
  techniques:
  - FGT5035
- component-of: []
  description: UE operational logs in core NFs.
  id: FGDS5019
  name: UE operations logs in core
  object-type: data source
  techniques: []
- component-of: FGDS5019
  description: Core logs related to UE operations for events such as - UE makes an
    emergency call or in NSA mode, when a UE is ordered to connect to network via
    eNB.
  id: FGDS5019.001
  name: UE operations logs in core
  object-type: data source
  techniques:
  - FGT1600.501
- component-of: []
  description: Security related configuration logs in gNB and core.
  id: FGDS5022
  name: Security configuration
  object-type: data source
  techniques: []
- component-of: FGDS5022
  description: Security related configuration logs in O-CU, O-DU and O-RU.
  id: FGDS5022.001
  name: O-RAN security configuration logs
  object-type: data source
  techniques:
  - FGT1040.502
- component-of: FGDS5022
  description: Security related configuration logs in core NFs.
  id: FGDS5022.002
  name: Core security configuration logs
  object-type: data source
  techniques:
  - FGT1565.002
- component-of: []
  description: Automated policy compliance checks
  id: FGDS5023
  name: User and resource policy configuration
  object-type: data source
  techniques: []
- component-of: FGDS5023
  description: User and resource policy configuration logs in core network for compliance
    violations.
  id: FGDS5023.001
  name: User and resource policy configuration logs in core network
  object-type: data source
  techniques:
  - FGT1498.502
  - FGT1599.501
- component-of: []
  description: UE application for detection of silent SMS messages.
  id: FGDS5024
  name: Silent SMS detector
  object-type: data source
  techniques: []
- component-of: FGDS5024
  description: Logs in UE for detecting silent SMS messages.
  id: FGDS5024.001
  name: Silent SMS detector at UE side
  object-type: data source
  techniques:
  - FGT5019.006
  - FGT5012.007
- component-of: []
  description: Contents of the UE registration message in UDM/SIDF for SUCI parameter
  id: FGDS5025
  name: SUCI parameters in UDM
  object-type: data source
  techniques: []
- component-of: FGDS5025
  description: Registration message contents in UDM/SIDF for Ellitpic curve of public
    key sent by the UE.
  id: FGDS5025.001
  name: SUCI parameter for elliptic curve in UDM
  object-type: data source
  techniques: []
- component-of: []
  description: Core performance counters for default and dedicated slices (bearers)
  id: FGDS5026
  name: Slice performance counters, KPIs
  object-type: data source
  techniques: []
- component-of: FGDS5026
  description: Network slice related performance management counters and KPIs of core
    NFs in MANO.
  id: FGDS5026.001
  name: Slice performance counters and KPIs of core NFs in MANO
  object-type: data source
  techniques:
  - FGT5040
- component-of: []
  description: Inspection of hardware components
  id: FGDS5027
  name: Physical Inspection
  object-type: data source
  techniques: []
- component-of: FGDS5027
  description: Manually inspect all hardware components for tampering.
  id: FGDS5027.001
  name: Manual inspection
  object-type: data source
  techniques:
  - FGT1195.003
- component-of: []
  description: Sensors on physical components
  id: FGDS5028
  name: Physical Sensors
  object-type: data source
  techniques: []
- component-of: FGDS5028
  description: Facility intrusion detection and alert
  id: FGDS5028.001
  name: Facility sensors
  object-type: data source
  techniques:
  - FGT5018.004
  - FGT5018.001
  - FGT5018.003
- component-of: FGDS5028
  description: Cabinet and cage instrusion detection and alert
  id: FGDS5028.002
  name: Cabinet and cage sensors
  object-type: data source
  techniques:
  - FGT5018.004
  - FGT5018.001
  - FGT5018.003
- component-of: FGDS5028
  description: Device instrusion detection and alert
  id: FGDS5028.003
  name: Device sensors
  object-type: data source
  techniques:
  - FGT5018.004
  - FGT5018.001
  - FGT5018.003
- component-of: []
  description: Host system information on malicious software and configurations.
  id: FGDS5029
  name: Host system software and configurations
  object-type: data source
  techniques: []
- component-of: FGDS5029
  description: Reports of host system scans for malicious software and configurations.
  id: FGDS5029.001
  name: 5G network host software and configurations
  object-type: data source
  techniques:
  - FGT5034.001
  - FGT5017
  - FGT1210
  - FGT5034
groups:
- associated:
    campaigns: []
    software: []
  description: LIMINAL PANDA is a China-linked, state-sponsored cyber threat group
    primarily targeting telecommunications providers, with operations dating back
    to at least 2020.
  id: FGG5001
  name: Liminal Panda
  object-type: group
  techniques:
  - id: FGT5042
    name: Bypass Telecom Signaling Firewall
    use: LightBasin used GTPDOOR for C2 data transfer outside of an operator network,
      bypassing signaling firewalls ([1],[2],[3],[4],[5])
  - id: FGT1040
    name: Network Sniffing
    use: LIMINAL PANDA is a China-linked, state-sponsored cyber threat group primarily
      targeting telecommunications providers, with operations dating back to at least
      2020.
  - id: FGT1205
    name: Traffic Signaling
    use: Liminal Panda established a command and control channel between eDNS server
      of a partner network and another server controlled by them using TCP port 53
      for transport. [1,2]
  - id: FGT1090.002
    name: External Proxy
    use: Fast Reverse Prox was used by LIMINAL PANDA as a reverse proxy that allowed
      C2 access from external systems. [1]
  - id: FGT1562.004
    name: Disable or Modify System Firewall
    use: Liminal Panda modified the eDNS host-based firewall to allow communication
      from a compromised telecom network ([1].[2]).
  - id: FGT1078.001
    name: Default Accounts
    use: During LightBasin's campaign, the threat actor was observed to gain access
      into eDNS server by abusing default credentials of Huawei devices. [2]
  - id: FGT1041
    name: Exfiltration Over C2 Channel
    use: Liminal Panda (formerly LightBasin) exfiltrated data (collected data in a
      MNO's roaming partner host machine) over a C2 channel using SIGTRAN protocol
      data format, as well as GTP-U and DNS ([1], [2]).
  - id: FGT1195.502
    name: Compromise Service Supply Chain
    use: Liminal Panda (CrowdStrike, 2024) and Salt Typhoon (Tenable, 2024) compromise
      Managed Service Provider (MSP) environments to gain long-term access to telecom
      systems. [5],[6],[7].
  - id: FGT1564.501
    name: Command Output Filtering
    use: Liminal Panda used SIGTRANslator to establish a C2 channel from the compromised
      host of a partner network to a remote server controlled by them. [1]
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: LIMINAL PANDA uses a novel technique to support C2 communication, leveraging
      SGSN emulation software in concert with TinyShell. [2]
  - id: FGT1071.502
    name: Telecom Protocols
    use: Liminal Panda used a Linux ELF binary called SIGTRANslator in a compromised
      host of MNO roaming partner network to establish a command and control (C2)
      channel to a remote server ([3], [4]. [5]).
  - id: FGT1071.501
    name: SSH
    use: Liminal Panda established C2 channel between eDNS server of a partner network
      and another server controlled by them using SSH on TCP port 53. [1,2]
  - id: FGT1021
    name: Remote Services
    use: Liminal Panda initially accessed an eDNS server via SSH from a compromised
      mobile network operator; they installed CobaltStrike on compromised hosts [2].
  - id: FGT1036.005
    name: Match Legitimate Name or Location
    use: According to [1], Liminal Panda replaced the legitimate iptables binary for
      eDNS host-based firewall to allow communication from a compromised telecom network,
      keeping the same name, "iptables".
  - id: FGT1110.001
    name: Password Guessing
    use: "CrowdStrike uncovered evidence showing LIMINAL PANDA initially accessed\
      \ the first eDNS server via SSH from another compromised telecommunications\
      \ company by password spraying extremely weak and third-party-focused passwords\
      \ (e.g.,\_huawei). [1]"
  - id: FGT1588.002
    name: Tool
    use: Liminal Panda obtained and used SIGTRANslator tool to establish a C2 channel
      from the compromised host of a partner network to a remote server controlled
      by them. [3]
  - id: FGT5045
    name: Telecom Protocol Payload
    use: Liminal Panda placed C2 data, encrypted (with a fixed string) into SIGTRAN
      protocols - which even though rare in 4G/5G core and data network, but the firewalls
      allow this type of traffic [1],[2].
  - id: FGT1090.003
    name: Multi-hop Proxy
    use: ProxyChains was used by Liminal Panda to force network traffic through a
      chain of proxies belonging to different telecommunication organizations around
      the world. [1]
  - id: FGT1090.001
    name: Internal Proxy
    use: Microsocks Proxy was used by LIMINAL PANDA to pivot to systems internally.
      [1]
  - id: FGT5046
    name: Program Wrapper
    use: 'Liminal Panda replaced the standard iptables binary with a modified version
      (SHA256: 97d4c9b5750d614face73d11ba8532e53594332af53f4c07c1543195225b76eb) that
      selectively filters output, hiding unauthorized rules while maintaining SSH
      connections.'
  - id: FGT1036.502
    name: Port Number
    use: Liminal Panda established C2 channel between eDNS server of a partner network
      and another server controlled by them using TCP port 53 for transport. [1,2]
  - id: FGT1046.501
    name: Protocol Fingerprinting
    use: Liminal Panda has been observed to leverage CORDSCAN to capture packets,
      thus enabling them to extract sensitive subscriber data (e.g., traffic patterns
      and subscriber location information). [1], [2]
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: Stone Panda, a part of the larger APT41 group, is a state-sponsored
    actor believed to be operating out of China.
  id: FGG5002
  name: Stone Panda
  object-type: group
  techniques:
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: StonePanda used China Chopper to open a command terminal and execute certain
      actions. [1]
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: HiddenArt is the name  assigned to a Signalling threat actor (platform)
    that Enea believes with a high degree of confidence to originate from Russian
    network sources
  id: FGG5003
  name: HIddenArt
  object-type: group
  techniques:
  - id: FGT5019.005
    name: SS7 Or Diameter Signaling
    use: HiddenArt retrieved of UE location via using the SS7 -sending SS7 messages
      from the GRX/IPX or a compromised operator to the home PLMN of a user being
      targeted ([4]).
  - id: FGT1036.501
    name: PLMN ID
    use: HiddenArt spoofed the Global Title of a victim operator as source in roaming
      signaling -- SS7 messages sent from the GRX/IPX to the home PLMN of a user being
      targeted ([2]).
  - id: FGT5012.008
    name: SS7 Or Diameter Signaling
    use: HiddenArt retrieved of UE location via using the SS7 -sending SS7 messages
      from the GRX/IPX or a compromised operator to the home PLMN of a user being
      targeted ([5]).
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: UNC3944, which overlaps with public reporting on Scattered Spider,
    is a financially-motivated threat actor characterized by its persistent use of
    social engineering and brazen communications with victims.
  id: FGG5004
  name: Scattered Spider
  object-type: group
  techniques:
  - id: FGT1078.003
    name: Local Accounts
    use: UNC3944 threat actor leveraged the serial console on Azure virtual machines
      in order to gain full administrative access to VMs.
  - id: FGT1078.004
    name: Cloud Accounts
    use: UNC3944 uses social engineering, phishing, smishing to gain access to cloud
      accounts and used that to establish foot hold in cloud infrastructure, add VMs
      and applications for persistence and lateral movements.
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: "Salt Typhoon\_is a People's Republic of China (PRC) state-backed actor\
    \ that has been active since at least 2019 and responsible for numerous compromises\
    \ of network infrastructure at major U.S."
  id: G1045
  name: Salt Typhoon
  object-type: group
  techniques:
  - id: FGT1567.002
    name: Exfiltration to Cloud Storage
    use: "Salt Typhoon exfiltrated collected data to external servers using cURL to\
      \ public repository (e.g., AnonFiles,\_File.io, etc.) ([1],[2],[3])"
  - id: FGT1078.003
    name: Local Accounts
    use: Salt Typhoon used tools like Trill Client to harvest administrative credentials
      from browser caches [9], to impersonate privileged users, for persistence and
      further escalation of privileges.
  - id: FGT1021
    name: Remote Services
    use: Using harvested valid account credentials, Salt Typhoon accessed remote systems
      to spread malware, and used commercially available penetration testing tool
      and remote management tools to create beacons for lateral movement, remote control
      ([3], [4]). WMI/WMIC and SMB/Windows admin share  were used for scripts execution
      on remote systems ([1],[3],[5],[6]).
  - id: FGT1190
    name: Exploit Public-Facing Application
    use: Salt Typhoon has gained initial access through exploitation of vulnerabilities
      in internet-facing software and appliances, such as Sophos Firewall, Ivanti
      VPN, Fortinet FortiClient EMS, and Microsoft Exchange Server ([6],[7]).
  - id: FGT1078.004
    name: Cloud Accounts
    use: Salt Typhoon compromised cloud credentials for data breach and lateral movements.
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: GALLIUM is a cyberespionage group that has been active since at least
    2012, primarily targeting telecommunications companies, financial institutions,
    and government entities in Afghanistan, Australia, Belgium, Cambodia, Malaysia,
    Mozambique, the Philippines, Russia, and Vietnam.
  id: G0093
  name: GALLIUM
  object-type: group
  techniques:
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: During Operation Soft Cell, Gallium was observed to launch a series of PowerShell
      commands to enumerate the Exchange server, network architecture, users, and
      active directory enumeration. [3]
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: TeamTNT is a threat group that has primarily targeted cloud and containerized
    environments.
  id: G0139
  name: TeamTNT
  object-type: group
  techniques:
  - id: FGT5014
    name: Shared Resource Discovery
    use: TeamTNT has deployed different types of containers into victim environments
      to facilitate execution.
  - id: FGT1611
    name: Escape to Host
    use: TeamTNT has deployed privileged containers that mount the filesystem of victim
      machine
  - id: FGT5013
    name: Malicious VNF Instantiation
    use: TeamTNT has deployed different types of containers into victim environments
      to facilitate execution. [2]
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: Silence is a financially motivated threat actor targeting financial
    institutions in different countries.
  id: G0091
  name: Silence
  object-type: group
  techniques:
  - id: FGT1072
    name: Software Deployment Tools
    use: "Silence\_has used RAdmin, a remote software tool used to remotely control\
      \ workstations and ATMs. [4]"
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: HAFNIUM is a likely state-sponsored cyber espionage group operating
    out of China that has been active since at least January 2021.
  id: G0125
  name: HAFNIUM
  object-type: group
  techniques:
  - id: FGT1195.502
    name: Compromise Service Supply Chain
    use: Silk Typhoon (formerly Hafnium), a Chinese threat actor who compromised Beyond
      Trust, their managed service provider. [8]
  version: ''
  x_mitre_contributors: []
- associated:
    campaigns: []
    software: []
  description: APT29 is threat group that has been attributed to Russia's Foreign
    Intelligence Service (SVR).
  id: G0016
  name: APT29
  object-type: group
  techniques:
  - id: FGT1195
    name: Supply Chain Compromise
    use: APT29 is threat group added compromised dynamic link library (dll) file during
      build phase which was part of a patch update, delivered to more than 18000 thousands
      of nodes allowing a C2 backdoor.
  version: ''
  x_mitre_contributors: []
id: FiGHT
mitigations:
- description: 5G Operators should evaluate suppliers of services for their technical
    and administrative controls to ensure that it meets minimum standards for assured
    services; These evaluations may include SW, HD supply  chain, personnel and process
    used for service creation
  id: FGM0817
  name: Supply Chain Management
  object-type: mitigation
  techniques:
  - FGT1195.002
  - FGT1195.502
- description: Perform audits or scans of systems, permissions, insecure software,
    insecure configurations, etc, to identify potential weaknesses; Perform periodic
    integrity checks of the device to validate the correctness of the firmware, software,
    programs, and configurations; Integrity checks, which typically include cryptographic
    hashes or digital signatures, should be compared to those obtained at known valid
    states, especially after events like device reboots, program downloads, or program
    restarts
  id: FGM0947
  name: Audit
  object-type: mitigation
  techniques:
  - FGT1608.501
  - FGT5017
  - FGT5023
- description: Install security updates in response to discovered vulnerabilities
  id: FGM1001
  name: Security Updates
  object-type: mitigation
  techniques:
  - FGT1587.004
- description: APIs in the system should use secure access and data transport using
    TLS v13 or latest
  id: FGM1009
  name: Encrypt Network Traffic
  object-type: mitigation
  techniques:
  - FGT5016
  - FGT5036
  - FGT5037
- description: A variety of methods exist that can be used to enable enterprises to
    identify compromised (for example, rooted/jailbroken) devices, whether using security
    mechanisms built directly into the device, third-party mobile security applications,
    enterprise mobility management (EMM)/mobile device management (MDM) capabilities,
    or other methods; Some methods may be trivial to evade while others may be more
    sophisticated
  id: FGM1010
  name: Deploy Compromised Device Detection Method
  object-type: mitigation
  techniques:
  - FGT1203.502
- description: In order to mitigate Signaling System 7 (SS7) exploitation, the Communications,
    Security, Reliability, and Interoperability Council (CSRIC) describes filtering
    interconnections between network operators to block inappropriate requests
  id: FGM1014
  name: Interconnection Filtering
  object-type: mitigation
  techniques:
  - FGT1036.501
  - FGT1583.508
  - FGT5012.008
  - FGT5019.005
- description: Vulnerability scanning is used to find potentially exploitable software
    vulnerabilities to remediate them
  id: FGM1016
  name: Vulnerability Scanning
  object-type: mitigation
  techniques:
  - FGT1190
  - FGT1195
  - FGT1195.002
  - FGT1195.003
- description: Train users to be aware of access or manipulation attempts by an adversary
    to reduce the risk of successful spearphishing, social engineering, and other
    techniques that involve user interaction
  id: FGM1017
  name: User Training
  object-type: mitigation
  techniques:
  - FGT1078.004
  - FGT1195.501
  - FGT1555.501
  - FGT5026
  - FGT5046
- description: Manage the creation, modification, use, and permissions associated
    to user accounts
  id: FGM1018
  name: User Account Management
  object-type: mitigation
  techniques:
  - FGT1014
  - FGT1021
  - FGT1036.005
  - FGT1072
  - FGT1078.004
  - FGT1195.502
  - FGT1199.501
  - FGT1542.501
  - FGT1555.501
  - FGT1562.004
  - FGT1600.501
  - FGT1600.502
  - FGT1609.501
  - FGT1611.501
  - FGT5007
  - FGT5009.001
  - FGT5009.002
  - FGT5013
  - FGT5014
  - FGT5036
  - FGT5037
  - FGT5041
  - FGT5045
- description: Break and inspect SSL/TLS sessions to look at encrypted web traffic
    for adversary activity
  id: FGM1020
  name: SSL/TLS Inspection
  object-type: mitigation
  techniques:
  - FGT1040
  - FGT1071.502
  - FGT5003
  - FGT5027
- description: Restricting web-based content involves enforcing policies and technologies
    that limit access to potentially malicious websites, unsafe downloads, and unauthorized
    browser behaviors This can include URL filtering, download restrictions, script
    blocking, and extension control to protect against exploitation, phishing, and
    malware delivery
  id: FGM1021
  name: Restrict Web-Based Content
  object-type: mitigation
  techniques:
  - FGT5041
- description: Restrict access by setting directory and file permissions that are
    not specific to users or privileged accounts
  id: FGM1022
  name: Restrict File And Directory Permissions
  object-type: mitigation
  techniques:
  - FGT1036.005
  - FGT1195.501
  - FGT1562.004
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5026
  - FGT5045
- description: Protect processes with high privileges that can be used to interact
    with critical system components through use of protected process light, anti-process
    injection defenses, or other process integrity enforcement measures
  id: FGM1025
  name: Privileged Process Integrity
  object-type: mitigation
  techniques:
  - FGT1557.002
  - FGT5032.002
  - FGT5032.003
- description: Manage the creation, modification, use, and permissions associated
    to privileged accounts, including SYSTEM and root
  id: FGM1026
  name: Privileged Account Management
  object-type: mitigation
  techniques:
  - FGT1020.001
  - FGT1059
  - FGT1072
  - FGT1078.003
  - FGT1078.004
  - FGT1200
  - FGT1525
  - FGT1555.501
  - FGT1599
  - FGT1599.501
  - FGT1599.502
  - FGT1609.501
  - FGT1611
  - FGT5036
  - FGT5037
  - FGT5038
- description: Set and enforce secure password policies for accounts
  id: FGM1027
  name: Password Policies
  object-type: mitigation
  techniques:
  - FGT1021
  - FGT1072
  - FGT1078.001
  - FGT1078.003
  - FGT1078.004
  - FGT1110.001
  - FGT1599
- description: Operating System Configuration involves adjusting system settings and
    hardening the default configurations of an operating system (OS) to mitigate adversary
    exploitation and prevent abuse of system functionality Proper OS configurations
    address security vulnerabilities, limit attack surfaces, and ensure robust defense
    against a wide range of techniques
  id: FGM1028
  name: Operating System Configuration
  object-type: mitigation
  techniques:
  - FGT5046
- description: Use remote security log and sensitive file storage where access can
    be controlled better to prevent exposure of intrusion detection log data or sensitive
    information
  id: FGM1029
  name: Remote Data Storage
  object-type: mitigation
  techniques:
  - FGT1072
- description: Architect sections of the network to isolate critical systems, functions,
    or resources; Use physical and logical segmentation to prevent access to potentially
    sensitive systems and information; Use a DMZ to contain any internet-facing services
    that should not be exposed from the internal network; Configure separate virtual
    private cloud (VPC) instances to isolate critical cloud systems
  id: FGM1030
  name: Network Segmentation
  object-type: mitigation
  techniques:
  - FGT1018
  - FGT1021
  - FGT1040.502
  - FGT1046
  - FGT1046.501
  - FGT1072
  - FGT1190
  - FGT1195.501
  - FGT1199.501
  - FGT1200
  - FGT1498.502
  - FGT1499.503
  - FGT1499.504
  - FGT1557.502
  - FGT1567.002
  - FGT1583
  - FGT1599.501
  - FGT1599.502
  - FGT1611.501
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5007
  - FGT5013
  - FGT5014
  - FGT5034
  - FGT5038
- description: Use intrusion detection signatures to block traffic at network boundaries
  id: FGM1031
  name: Network Intrusion Prevention
  object-type: mitigation
  techniques:
  - FGT1018
  - FGT1041
  - FGT1046
  - FGT1046.501
  - FGT1048.003
  - FGT1048.501
  - FGT1090.001
  - FGT1090.002
  - FGT1090.003
  - FGT1567.002
  - FGT1572
  - FGT1572.501
  - FGT1572.502
  - FGT1600.501
  - FGT1600.502
  - FGT5009.001
  - FGT5009.002
  - FGT5031
- description: Use two or more pieces of evidence to authenticate to a system; such
    as username and password in addition to a token from a physical smart card or
    token generator
  id: FGM1032
  name: Multi-factor Authentication
  object-type: mitigation
  techniques:
  - FGT1021
  - FGT1040
  - FGT1059
  - FGT1072
  - FGT1078.001
  - FGT1078.004
  - FGT1110.001
  - FGT1599
  - FGT1600.501
- description: Block users or groups from installing unapproved software
  id: FGM1033
  name: Limit Software Installation
  object-type: mitigation
  techniques:
  - FGT1059
  - FGT1210
  - FGT1557.002
  - FGT5005
  - FGT5032.002
  - FGT5032.003
  - FGT5034
  - FGT5034.001
  - FGT5039
- description: Block users or groups from installing or using unapproved hardware
    on systems, including USB devices
  id: FGM1034
  name: Limit Hardware Installation
  object-type: mitigation
  techniques:
  - FGT1200
- description: Prevent access to file shares, remote access to systems, unnecessary
    services Mechanisms to limit access may include use of network concentrators,
    RDP gateways, etc
  id: FGM1035
  name: Limit Access To Resource Over Network
  object-type: mitigation
  techniques:
  - FGT1557.002
  - FGT1557.502
  - FGT1599.501
  - FGT1599.502
  - FGT1609.501
  - FGT1611.501
  - FGT5013
  - FGT5014
  - FGT5021
  - FGT5032.002
  - FGT5032.003
  - FGT5038
- description: Use network appliances to filter ingress or egress traffic and perform
    protocol-based filtering Configure software on endpoints to filter network traffic
  id: FGM1037
  name: Filter Network Traffic
  object-type: mitigation
  techniques:
  - FGT1036.502
  - FGT1041
  - FGT1048
  - FGT1048.003
  - FGT1071.501
  - FGT1071.502
  - FGT1199.501
  - FGT1205
  - FGT1557.002
  - FGT1557.502
  - FGT1567.002
  - FGT1572
  - FGT1583.508
  - FGT1599
  - FGT1642.502
  - FGT5012.004
  - FGT5031
- description: Block execution of code on a system through application control, and/or
    script blocking
  id: FGM1038
  name: Execution Prevention
  object-type: mitigation
  techniques:
  - FGT1609.501
  - FGT1611
- description: Use capabilities to prevent suspicious behavior patterns from occurring
    on endpoint systems; This could include suspicious process, file, API call, etc
    behavior
  id: FGM1040
  name: Behavior Prevention On Endpoint
  object-type: mitigation
  techniques:
  - FGT1040
  - FGT1071.502
  - FGT1203.502
  - FGT1567.002
  - FGT5008
  - FGT5011
  - FGT5042
  - FGT5043
  - FGT5043.001
- description: Protect sensitive information with strong encryption
  id: FGM1041
  name: Encrypt Sensitive Information
  object-type: mitigation
  techniques:
  - FGT1020.001
  - FGT1040
  - FGT1040.501
  - FGT1040.502
  - FGT1195.501
  - FGT1557.503
  - FGT1557.504
  - FGT1572.501
  - FGT1583
  - FGT1599.501
  - FGT1599.502
  - FGT1600.501
  - FGT1600.502
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5012.002
  - FGT5012.006
  - FGT5016
  - FGT5019.004
  - FGT5026
  - FGT5031
  - FGT5036
  - FGT5037
  - FGT5038
- description: Remove or deny access to unnecessary and potentially vulnerable software
    to prevent abuse by adversaries
  id: FGM1042
  name: Disable Or Remove Feature Or Program
  object-type: mitigation
  techniques:
  - FGT1018
  - FGT1046
  - FGT1046.501
  - FGT1059
- description: Use capabilities to prevent successful credential access by adversaries;
    including blocking forms of credential dumping
  id: FGM1043
  name: Credential Access Protection
  object-type: mitigation
  techniques:
  - FGT1210
  - FGT1599
  - FGT1600.501
  - FGT1600.502
  - FGT5009.001
  - FGT5009.002
  - FGT5032.002
  - FGT5032.003
  - FGT5034
- description: Enforce binary and application integrity with digital signature verification
    to prevent untrusted code from executing
  id: FGM1045
  name: Code Signing
  object-type: mitigation
  techniques:
  - FGT1014
  - FGT1195.002
  - FGT1210
  - FGT1525
  - FGT1542.501
  - FGT5032.002
  - FGT5032.003
  - FGT5034
  - FGT5046
- description: Use secure methods to boot a system and verify the integrity of the
    operating system and loading mechanisms
  id: FGM1046
  name: Boot Integrity
  object-type: mitigation
  techniques:
  - FGT1014
  - FGT1542.501
  - FGT1600.501
  - FGT1600.502
  - FGT5009.002
- description: Perform audits or scans of systems, permissions, insecure software,
    insecure configurations, etc to identify potential weaknesses
  id: FGM1047
  name: Audit
  object-type: mitigation
  techniques:
  - FGT1014
  - FGT1200
  - FGT1525
  - FGT1542.501
  - FGT1557.002
  - FGT1557.504
  - FGT1611.501
  - FGT5005
  - FGT5008
  - FGT5009
  - FGT5013
  - FGT5014
  - FGT5021
  - FGT5034
  - FGT5034.001
  - FGT5036
  - FGT5037
  - FGT5039
  - FGT5043
  - FGT5043.001
- description: Restrict execution of code to a virtual environment on or in transit
    to an endpoint system
  id: FGM1048
  name: Application Isolation And Sandboxing
  object-type: mitigation
  techniques:
  - FGT1611
- description: Use signatures or heuristics to detect malicious software
  id: FGM1049
  name: Anti-virus & Anti-malware
  object-type: mitigation
  techniques:
  - FGT1071.502
  - FGT1195.501
  - FGT5001
  - FGT5042
- description: Use capabilities to detect and block conditions that may lead to or
    be indicative of a software exploit occurring
  id: FGM1050
  name: Exploit Protection
  object-type: mitigation
  techniques:
  - FGT1190
  - FGT1203.501
  - FGT5029
- description: Perform regular software updates to mitigate exploitation risk
  id: FGM1051
  name: Update Software
  object-type: mitigation
  techniques:
  - FGT1014
  - FGT1072
  - FGT1195
  - FGT1195.002
  - FGT1195.003
  - FGT1498.503
  - FGT1542.501
  - FGT1600.501
  - FGT1600.502
  - FGT5009.002
  - FGT5029
- description: Take and store data backups from end user systems and critical servers
    Ensure backup and storage systems are hardened and kept separate from the corporate
    network to prevent compromise
  id: FGM1053
  name: Data Backup
  object-type: mitigation
  techniques:
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5039
- description: Implement configuration changes to software (other than the operating
    system) to mitigate security risks associated to how the software operates
  id: FGM1054
  name: Software Configuration
  object-type: mitigation
  techniques:
  - FGT1040
  - FGT1199.501
  - FGT5004
  - FGT5004.001
  - FGT5004.002
- description: This category is used for any applicable mitigation activities that
    apply to techniques occurring before an adversary gains Initial Access, such as
    Reconnaissance and Resource Development techniques
  id: FGM1056
  name: Pre-compromise
  object-type: mitigation
  techniques:
  - FGT1557.501
  - FGT1564.501
  - FGT1583.501
  - FGT1583.502
  - FGT1587
  - FGT1587.501
  - FGT1588.002
  - FGT1588.501
- description: Data Loss Prevention (DLP) involves implementing strategies and technologies
    to identify, categorize, monitor, and control the movement of sensitive data within
    an organization; This includes protecting data formats indicative of Personally
    Identifiable Information (PII), intellectual property, or financial data from
    unauthorized access, transmission, or exfiltration; DLP solutions integrate with
    network, endpoint, and cloud platforms to enforce security policies and prevent
    accidental or malicious data leaks
  id: FGM1057
  name: Data Loss Prevention
  object-type: mitigation
  techniques:
  - FGT1567.002
- description: Mobile security products, such as Mobile Threat Defense (MTD), offer
    various device-based mitigations against certain behaviors
  id: FGM1058
  name: Antivirus/Antimalware
  object-type: mitigation
  techniques:
  - FGT1203.502
- description: Disable or remove an RF transmitter
  id: FGM5001
  name: Disable Malicious Transmitter
  object-type: mitigation
  techniques:
  - FGT5035
- description: User Equipment (UE) can reject for example RRC signaling such as RRC
    Release with Redirect info, if not integrity protected
  id: FGM5002
  name: Discard RAN Signaling Received Without Integrity Protection
  object-type: mitigation
  techniques:
  - FGT1562.501
  - FGT1608.501
- description: NFs such as NRF should cross check with TLS layer before issuing token
    to an NF
  id: FGM5003
  name: Cross Check Between Application Layer And Transport Layer
  object-type: mitigation
  techniques:
  - FGT5003
  - FGT5011
  - FGT5027
- description: Employ a SMS Router that intercepts incoming location queries (from
    other operators), configured so that it can't be subverted
  id: FGM5004
  name: Correctly Configure SMS Firewall
  object-type: mitigation
  techniques:
  - FGT5002
  - FGT5012.007
  - FGT5012.008
  - FGT5019.005
  - FGT5019.006
- description: 'Physical protection of: communications centers, Telecommunications
    equipment room, Physically isolated operation areas, Equipment sited in other
    carrier''s or partner''s premises, cable/fibers, junction boxes, etc'
  id: FGM5005
  name: Physical And Environmental Protection
  object-type: mitigation
  techniques:
  - FGT1498.502
  - FGT5018
  - FGT5018.001
  - FGT5018.002
  - FGT5018.003
  - FGT5018.004
- description: Prevent insecure user profile configuration in network or UE
  id: FGM5006
  name: Restrictive User Profile
  object-type: mitigation
  techniques:
  - FGT1040.501
  - FGT1562.501
  - FGT5009.001
  - FGT5012.002
  - FGT5019.002
- description: Subscription that includes unlimited data can prevent DoS due to exhausion
    of data plan limits
  id: FGM5007
  name: Unlimited Data Plan
  object-type: mitigation
  techniques:
  - FGT1499.501
- description: On the UE, monitor installed applications for data usage and perform
    throttling if necessary
  id: FGM5008
  name: Monitor Installed Applications For Data Usage
  object-type: mitigation
  techniques:
  - FGT1499.501
- description: Services are refreshed periodically and/or terminated after completion
    of a request
  id: FGM5010
  name: Non-Persistent Services
  object-type: mitigation
  techniques:
  - FGT5029
- description: Check if IMSI is served by the slice ID (NSSAI)
  id: FGM5012
  name: Slice ID Check
  object-type: mitigation
  techniques:
  - FGT5012.005
- description: UDM/UDR should correctly implement UE authentication/registration status
    updates
  id: FGM5013
  name: Timely Updates To UE Status
  object-type: mitigation
  techniques:
  - FGT5010
- description: UDM can check whether a requesting AMF is likely to be the one serving
    that UE
  id: FGM5014
  name: UE Location Plausibility
  object-type: mitigation
  techniques:
  - FGT1499.502
  - FGT5010
- description: 5G NFs should authorize API calls especially from external AFs for
    service accesses
  id: FGM5019
  name: Authorize External API Calls
  object-type: mitigation
  techniques:
  - FGT1567.002
  - FGT5008
  - FGT5011
  - FGT5012.004
  - FGT5019.003
- description: Secure all subscriber databases in 5G network, for example,  Equipment
    Identity Register (EIR)
  id: FGM5020
  name: Secure Subscriber Repositories
  object-type: mitigation
  techniques:
  - FGT5015
  - FGT5022
- description: Increase RACH resources on the gNB (bandwith, time slots)
  id: FGM5021
  name: Increase RACH (Random Access Channel) Resources
  object-type: mitigation
  techniques:
  - FGT1499.002
- description: When the subscriber affiliation is reflected in the home network identifier
    (part of subscriber identifier), and would benefit from not being sent in the
    clear, the subscriber's provider (home network) should be a proxy mobile network
    operator - whose identifier does not reveal the true affiliation of the subscriber
  id: FGM5022
  name: Proxy Home Network
  object-type: mitigation
  techniques:
  - FGT5019.001
- description: Perform periodic authentication and authorization of consumer NFs by
    NRF
  id: FGM5023
  name: Periodic Authentication & Authorization Of NFs
  object-type: mitigation
  techniques:
  - FGT1499.503
  - FGT1499.504
  - FGT5007
  - FGT5010
  - FGT5012.004
  - FGT5023
- description: Use strong data integrity protection algorithms
  id: FGM5024
  name: Integrity Protection Of Data Communication
  object-type: mitigation
  techniques:
  - FGT1040.502
  - FGT1048.501
  - FGT1195.501
  - FGT1498.002
  - FGT1557.503
  - FGT1557.504
  - FGT1565.002
  - FGT1572
  - FGT1642.501
  - FGT1642.502
  - FGT1642.503
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5009.001
  - FGT5009.002
  - FGT5012.006
  - FGT5012.007
  - FGT5016
  - FGT5023
  - FGT5026
- description: Use zero trust principles for application/NF protection
  id: FGM5033
  name: Zero Trust
  object-type: mitigation
  techniques:
  - FGT1040
  - FGT5020
- description: Separate repositositories must be maintained for development and production
    software to avoid access and image slipovers
  id: FGM5088
  name: Separate Repositories For Development And Production
  object-type: mitigation
  techniques: []
- description: Enforce strong mutual authentication methods between service providers
    and service consumers in the transport, core and O-RAN systems
  id: FGM5091
  name: Mutual Authentication
  object-type: mitigation
  techniques:
  - FGT1210
  - FGT5004
  - FGT5004.001
  - FGT5004.002
  - FGT5034
  - FGT5034.001
- description: UE warns user of lower security network
  id: FGM5092
  name: Warn User
  object-type: mitigation
  techniques:
  - FGT1562.501
- description: 'UDM/SIDF checks SUCI for freshness, whether it has been seen before,
    and for crypto parameters (example: if SUCI freshness parameter from the same
    UE (with same SUPI) is identical during SUCI deconcealment within a short period
    of time)'
  id: FGM5093
  name: SUCI Parameter Checks
  object-type: mitigation
  techniques:
  - FGT1499.502
  - FGT5040
- description: Network (AMF) should allocate new 5G-GUTI whenever possible; UPF and
    gNB should allocate unique Tunnel IDs; SMF should check newly allocated charging
    IDs
  id: FGM5094
  name: Allocate New 5G Identifiers Judiciously
  object-type: mitigation
  techniques:
  - FGT5012.003
  - FGT5021
  - FGT5027
- description: Verify if the TLS certificate is valid for the endpoint
  id: FGM5095
  name: TLS Certificate Check
  object-type: mitigation
  techniques:
  - FGT1557.504
- description: Disable usage of location on UE device
  id: FGM5096
  name: Disable UE Location Use
  object-type: mitigation
  techniques:
  - FGT5012.002
- description: Restrict UE to bid down (from 5G) or use of less secure system
  id: FGM5097
  name: Disable Acceptance Of A Less Secure System
  object-type: mitigation
  techniques: []
- description: Use UE only when needed Turn power off when not in use
  id: FGM5098
  name: Reduce UE Usage
  object-type: mitigation
  techniques:
  - FGT5012.001
- description: Move UE close to gNB or indoors to make geo-location harder
  id: FGM5099
  name: Move UE Close To gNB
  object-type: mitigation
  techniques:
  - FGT5012.001
  - FGT5035
- description: Raising the height of the UE may move it outside another RF source,
    for example, jammer
  id: FGM5100
  name: Raise Height Of UE
  object-type: mitigation
  techniques:
  - FGT5035
- description: Isolate CDR databases from the rest of the IT systems/NOC resources
  id: FGM5101
  name: Isolate CDR Database
  object-type: mitigation
  techniques:
  - FGT5017
- description: Run at the UE side an application/tool to detect and not respond to
    silent SMS messages
  id: FGM5102
  name: Silent SMS Blocker
  object-type: mitigation
  techniques:
  - FGT5019.006
- description: For example, restrict access to IR 21 database
  id: FGM5500
  name: Restrict Access To Operator OA&M Resources
  object-type: mitigation
  techniques:
  - FGT1210
  - FGT1592.501
- description: Operator should deploy TLS proxies or firewalls on the SBA that can
    inspect packets to detect anomalies
  id: FGM5501
  name: TLS Proxy/Firewalls With DPI On The SBA
  object-type: mitigation
  techniques:
  - FGT1046.501
- description: 'Examples: employ home routing vs local bypass'
  id: FGM5503
  name: Increase Control Of Home Network For User Plane
  object-type: mitigation
  techniques:
  - FGT5025
- description: Cloud compute, cloud storage and any serverless activity should be
    isolated from other tenants
  id: FGM5504
  name: Resource Isolation In Virtualization Environment
  object-type: mitigation
  techniques:
  - FGT1583
- description: Hardware mediated  execution environment
  id: FGM5505
  name: Hardware Mediated Execution Environment
  object-type: mitigation
  techniques:
  - FGT1583
  - FGT1599.501
  - FGT1599.502
  - FGT5038
- description: Use of Network Slice Templates -Use of templates for network slicing
    can enforce baseline security and isolation requirements  These templates can
    be created for networks, compute and 5G slice functions deployments
  id: FGM5506
  name: Network Slice Templates
  object-type: mitigation
  techniques:
  - FGT1498.502
  - FGT1599.501
  - FGT1599.502
  - FGT5038
- description: Randomize TEID allocations
  id: FGM5507
  name: TEID Allocation
  object-type: mitigation
  techniques:
  - FGT5031
- description: Filter control plane and user plane messages to rate limit or block
    the ones with malicious contents
  id: FGM5509
  name: Screen Signaling And User Plane Messages
  object-type: mitigation
  techniques:
  - FGT1059
  - FGT1498.501
  - FGT1498.503
  - FGT1499
  - FGT1499.505
  - FGT1572.501
  - FGT1572.502
  - FGT1599.505
  - FGT5020
  - FGT5028
- description: Use high availability feature for all core network functions
  id: FGM5512
  name: Use High Availability
  object-type: mitigation
  techniques:
  - FGT1498.502
  - FGT1498.503
  - FGT1499.505
- description: Use Diameter End-to-end Signaling Security (DESS)
  id: FGM5513
  name: Use DESS Security
  object-type: mitigation
  techniques:
  - FGT5012.008
  - FGT5019.005
- description: Minimize number of connections to eNB in NSA mode
  id: FGM5514
  name: Minmize eNB Connections
  object-type: mitigation
  techniques:
  - FGT5019.004
- description: Move mIAB node to another location to avoid RF jamming
  id: FGM5515
  name: Move mIAB Node
  object-type: mitigation
  techniques:
  - FGT5024
- description: Allow OAuth20 tokens with short lifetime to prevent AiTM attacks by
    replaying stolen tokens
  id: FGM5516
  name: Session Lifetime
  object-type: mitigation
  techniques:
  - FGT1210
  - FGT5034
- description: Use application layer data obfuscation technique for example use of
    Orbot as Tor proxy to send all traffic through Tor circuit
  id: FGM5517
  name: Use Obfuscation At Application Layer
  object-type: mitigation
  techniques:
  - FGT1040.501
- description: Create and enforce resource policy; policy can include SLA, quotas,
    QOS etc
  id: FGM5518
  name: Resource Policy Enforcement
  object-type: mitigation
  techniques:
  - FGT1498.502
- description: 5G operators should integrate performance and change management from
    their suppliers into their own OA&M tools to have complete visibility into service
  id: FGM5519
  name: Integrate Performance And Change Management
  object-type: mitigation
  techniques:
  - FGT1195.502
- description: Enforce policy to use signed Software Bill of Materials (SBOMs) and
    software
  id: FGM5520
  name: Use SBOM
  object-type: mitigation
  techniques:
  - FGT1195.002
- description: Continuity of power supplies to equipment deployed in the field
  id: FGM5540
  name: Power Supplies
  object-type: mitigation
  techniques:
  - FGT5018.001
- description: Implement risk modeling of internal and external interfaces as part
    of architecture design and implement mitigations
  id: FGM5541
  name: Risk Modeling
  object-type: mitigation
  techniques:
  - FGT1499
- description: Filter packets with unusual payloads
  id: FGM5542
  name: Application Layer Firewall
  object-type: mitigation
  techniques:
  - FGT1036.502
  - FGT1071.501
  - FGT1205
  - FGT5044
name: FiGHT Threat Matrix
software:
- associated:
    campaigns: []
    groups: []
  description: PingPong listens for inbound magic ICMP echo requests and establishes
    a TCP reverse shell connection to an IP address and port specified at certain
    offsets within the packet.
  id: FGS5001
  name: PingPong
  object-type: software
  techniques:
  - id: FGT1205
    name: Traffic Signaling
    use: Pingpong malware was used by Liminal Panda to listen to ICMP echo requests
      from remote hosts. This helped determine the IP address and port number to connect
      to the remote host via TCP reverse shell.
  - id: FGT1071.501
    name: SSH
    use: Pingpong malware was used by Liminal Panda to listen to ICMP echo requests
      from remote hosts. This helped determine the IP address and port number to connect
      to the remote host via TCP reverse shell. [1, 2]
  - id: FGT1036.005
    name: Match Legitimate Name or Location
    use: Liminal Panda used the PingPong process masquerading under httpd (software
      that runs as a background process (daemon) and acting as a web server, using
      HTTP and/or HTTPS) in the eDNS server. ([2])
  - id: FGT5046
    name: Program Wrapper
    use: PingPong - Custom ICMP-triggered backdoor used alongside binary wrapper for
      persistence.
  - id: FGT1036.502
    name: Port Number
    use: Pingpong malware was used by Liminal Panda to listen to ICMP echo requests
      from remote hosts. This helped determine the IP address and port number to connect
      to the remote host via TCP reverse shell.
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: This utility is capable of chaining proxies together and forcing network
    traffic through said chain of proxies, even if the program generating the traffic
    does not have proxy support.
  id: FGS5002
  name: ProxyChains
  object-type: software
  techniques:
  - id: FGT1090.003
    name: Multi-hop Proxy
    use: Liminal Panda used proxyChains, proxy is a utility capable of forcing network
      traffic through a chain of proxies, even if the program generating the traffic
      does not have proxy support. It utilizes a configuration file to specify proxies
      in use. [1]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: This utility is a reverse proxy used that permits C2 access to an actor-controlled
    servers (e.g., DNS).
  id: FGS5003
  name: Fast Reverse Proxy
  object-type: software
  techniques:
  - id: FGT1090.002
    name: External Proxy
    use: Fast Reverse Proxy utility is a reverse proxy used that permits C2 access
      to an actor-controlled servers (e.g., DNS) used by Liminal Panda. [1]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: This utility is a lightweight SOCKS5 proxy server used to pivot to
    systems internally.
  id: FGS5004
  name: Microsocks Proxy
  object-type: software
  techniques:
  - id: FGT1090.001
    name: Internal Proxy
    use: Microsocks Proxy is a lightweight SOCKS5 proxy server used to pivot to systems
      internally used by Liminal Panda. [1]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: SIGTRANslator is a Linux ELF binary capable of sending and receiving
    data via various SS7 over IP protocols, which are used to carry public switched
    telephone network (PSTN) signaling over IP networks.
  id: FGS5005
  name: SIGTRANslator
  object-type: software
  techniques:
  - id: FGT1041
    name: Exfiltration Over C2 Channel
    use: SIGTRANslator can be used to send and receive data over the SS7 (SIGTRAN)
      protocol. This tool encrypts using a pre-defined XOR key further hiding adversary
      activities.
  - id: FGT1564.501
    name: Command Output Filtering
    use: SIGTRANslator software tool was used by Liminal Panda to connect to remote
      server.
  - id: FGT1071.502
    name: Telecom Protocols
    use: SIGTRANslator is a Linux ELF binary capable of sending and receiving data
      via various SS7 - telecom protocols
  - id: FGT1588.002
    name: Tool
    use: SIGTRANslator software tool was used by Liminal Panda to connect to remote
      server. [3]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: TINYSHELL is a lightweight client/server clone of the standard remote
    shell tools (rlogin, DNS, telnet, ssh, etc.) that can act as a backdoor to provide
    remote shell execution as well as file transfers.
  id: FGS5006
  name: TINYSHELL
  object-type: software
  techniques:
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: TinyShell provides a command prompt that can be used by threat actors to
      do activities like unauthorized access, fetch system, and network-related information.
      [2]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: STEELCORGI is a packer for Linux ELF programs that uses key material
    from the executing environment to decrypt the payload..
  id: FGS5007
  name: STEELCORGI
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: GHOSTSPIDER is a sophisticated multi-modular backdoor designed with
    several layers to load different modules based on specific purposes.
  id: FGS5008
  name: Ghost Spider
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: NinjaCopy is a PowerShell script capable of reading SYSTEM files that
    were normally locked, such as NTDS.dit or sensitive registry locations.
  id: FGS5009
  name: NinjaCopy
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: TrillClient is a custom stealers for harvesting credentials and browser
    data.
  id: FGS5010
  name: TrillClient
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Deploys stealers for harvesting credentials and browser data.
  id: FGS5011
  name: SnappyBee
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: The malware can hide C2 traffic over GPRS Tunnelling Protocol, Control
    Plane or GTP-C signaling messages.
  id: FGS5012
  name: GTPDOOR
  object-type: software
  techniques:
  - id: FGT5042
    name: Bypass Telecom Signaling Firewall
    use: GTPDOOR is used to bypass telecom signaling firewall [1], [3], [4]
  - id: FGT1572.502
    name: C2 Over GTP-U
    use: GTPDOOR embeds adversary commands into the GTP-U heartbeat message protocol
      to evade detection ([1], [2], [3], [4]).
  - id: FGT5045
    name: Telecom Protocol Payload
    use: GTPDOOR is used to bypass telecom signaling firewall [3].
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: SLAPSTICK is a Solaris PAM backdoor that bypasses authentication with
    a hard-coded password, captures credentials during login attempts, and stores
    them in an obfuscated text file to maintain access and evade detection.
  id: FGS5013
  name: SLAPSTICK
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: CordScan is a network-scanning and packet-capture utility containing
    logic to fingerprint and retrieve data relating to common telecommunication systems
    from infrastructure such as SGSNs.
  id: FGS5014
  name: CordScan
  object-type: software
  techniques:
  - id: FGT1040
    name: Network Sniffing
    use: CordScan was used to capture user data packets in the user plane in the core
      network. [10]
  - id: FGT1046.501
    name: Protocol Fingerprinting
    use: Liminal Panda leveraged CordScan to map networks and collect packet data
      related to common telecommunication systems, such as SGSN. This included analyzing
      mobile station transmissions and identifying location information of registered
      GPRS users. [1], [2]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: China Chopper is a Web Shell hosted on Web servers to provide access
    back into an enterprise network that does not rely on an infected system calling
    back to a remote command and control server.
  id: S0020
  name: China Chopper
  object-type: software
  techniques:
  - id: FGT1059
    name: Command and Scripting Interpreter
    use: ChinaChopper is a web shell hosted on servers to provide access back into
      an enterprise network. [4]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Cobalt Strike is a commercial, full-featured, remote access tool designed
    to execute various targeted attacks and emulate the post-exploitation actions
    of advanced threat actors.
  id: S0154
  name: Cobalt Strike
  object-type: software
  techniques:
  - id: FGT1021
    name: Remote Services
    use: Liminal Panda used CobaltStrike for lateral movement in a telecom network.
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: BPFDoor is a Linux based passive long-term backdoor used by China-based
    threat actors.
  id: S1161
  name: BPFDOOR
  object-type: software
  techniques: []
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Doki is a backdoor that uses a unique Dogecoin-based Domain Generation
    Algorithm and was first observed in July 2020.
  id: S0600
  name: Doki
  object-type: software
  techniques:
  - id: FGT5014
    name: Shared Resource Discovery
    use: Doki was run through a deployed container
  - id: FGT1611
    name: Escape to Host
    use: Container was configured to bind to the host root directory
  - id: FGT5013
    name: Malicious VNF Instantiation
    use: Doki was run through a deployed container. [4]
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Peirates is a post-exploitation Kubernetes exploitation framework with
    a focus on gathering service account tokens for lateral movement and privilege
    escalation.
  id: S0683
  name: Peirates
  object-type: software
  techniques:
  - id: FGT5014
    name: Shared Resource Discovery
    use: Peirates can deploy a pod that mounts its node's root file system, then execute
      a command to create a reverse shell on the node
  - id: FGT1611
    name: Escape to Host
    use: "Peirates\_can gain a reverse shell on a host node by mounting the Kubernetes\
      \ hostPath."
  - id: FGT5013
    name: Malicious VNF Instantiation
    use: Peirates can deploy a pod that mounts its node's root file system, then execute
      a command to create a reverse shell on the node. [3]
  - id: FGT1078.004
    name: Cloud Accounts
    use: Peirates is a post-exploitation Kubernetes exploitation framework with a
      focus on gathering service account tokens for lateral movement and privilege
      escalation.
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Hildegard is malware that targets misconfigured kubelets for initial
    access and runs cryptocurrency miner operations.
  id: S0601
  name: Hildegard
  object-type: software
  techniques:
  - id: FGT1611
    name: Escape to Host
    use: Hildegard used the BOtB tool that can break out of Container
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Siloscape is malware that targets Kubernetes clusters through Windows
    containers.
  id: S0623
  name: Siloscape
  object-type: software
  techniques:
  - id: FGT1611
    name: Escape to Host
    use: Siliscape maps the hosts's C drive to the contianer by creating a global
      symbolic link of NtSetInformationSymbolicLink
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: Wiper is a family of destructive malware used in March 2013 during
    breaches of South Korean banks and media companies.
  id: S0041
  name: Wiper
  object-type: software
  techniques:
  - id: FGT1072
    name: Software Deployment Tools
    use: "A patch management system for an anti-virus product commonly installed among\
      \ targeted companies may have been used to distribute the\_Wiper\_malware. [5]"
  version: ''
  x_mitre_platforms: []
- associated:
    campaigns: []
    groups: []
  description: AADInternals is a PowerShell-based framework for administering, enumerating,
    and exploiting Azure Active Directory.
  id: S0677
  name: AADInternals
  object-type: software
  techniques:
  - id: FGT5041
    name: DOS An NF Via Deregistration
    use: "AADInternals\_can steal users' access tokens via phishing emails containing\
      \ malicious links. [3]"
  version: ''
  x_mitre_platforms: []
tactics:
- description: The adversary is trying to gather information they can use to plan
    future operations.
  id: TA0043
  name: Reconnaissance
  object-type: tactic
- description: The adversary is trying to establish resources they can use to support
    operations.
  id: TA0042
  name: Resource Development
  object-type: tactic
- description: The adversary is trying to get into your network.
  id: TA0001
  name: Initial Access
  object-type: tactic
- description: The adversary is trying to run malicious code.
  id: TA0002
  name: Execution
  object-type: tactic
- description: The adversary is trying to maintain their foothold.
  id: TA0003
  name: Persistence
  object-type: tactic
- description: The adversary is trying to gain higher-level permissions.
  id: TA0004
  name: Privilege Escalation
  object-type: tactic
- description: The adversary is trying to avoid being detected.
  id: TA0005
  name: Defense Evasion
  object-type: tactic
- description: The adversary is trying to steal account names and passwords.
  id: TA0006
  name: Credential Access
  object-type: tactic
- description: The adversary is trying to figure out your environment.
  id: TA0007
  name: Discovery
  object-type: tactic
- description: The adversary is trying to move through your environment.
  id: TA0008
  name: Lateral Movement
  object-type: tactic
- description: The adversary is trying to gather data of interest to their goal.
  id: TA0009
  name: Collection
  object-type: tactic
- description: The adversary is trying to communicate with compromised systems to
    control them.
  id: TA0011
  name: Command And Control
  object-type: tactic
- description: The adversary is trying to steal data.
  id: TA0010
  name: Exfiltration
  object-type: tactic
- description: The adversary is trying to manipulate, interrupt, or destroy your systems
    and data.
  id: TA0040
  name: Impact
  object-type: tactic
- description: Obtain service without contracturally paying for it.
  id: TA5001
  name: Fraud
  object-type: tactic
techniques:
- addendums:
  - access-required: Administrative Access
    campaigns: []
    criticalassets:
    - description: NFVI components that support virtualization and network connecting
        the virtual functions.
      name: Operator NFV MANO, NFVO
    - description: Any compute entity that supports data processing functions, including
        Linux/Windows hosts, VMs, and or specialty equipment that has address and
        interacts with other NFVI elements.
      name: Host server
    - description: Any components that support integration and deployment
      name: CI/CD Tools
    - description: Container orchestrators such as Kubernetes, Mesos, Openshift
      name: Container Management Controller system
    detections:
    - component: Kernel Module Load
      detects: Kernel executing unknown processes or unauthorized processes not typical
        of the host.
      fgdsid: FGDS0008.001
      name: Kernel
    - component: Network Traffic Flow
      detects: Network traffic pattern may reveal remote C2 communication from rootkit
      fgdsid: FGDS0029.003
      name: Network Traffic
    - component: OS API Execution
      detects: Active processes or process log may reveal unauthorized activity due
        to rootkits
      fgdsid: FGDS0009.001
      name: Process
    - component: Firmware Modification
      detects: Monitor for changes made to firmware for unexpected modifications to
        settings and/or data that may be used by rootkits to hide the presence of
        programs, files, network connections, services, drivers, and other system
        components. There are dedicated rootkit detection tools that look for specific
        types of rootkit behavior.
      fgdsid: FGDS0001.001
      name: Firmware
    groups: []
    mitigations:
    - fgmid: FGM1046
      mitigates: Use boot integrity measures
      name: Boot Integrity
    - fgmid: FGM1045
      mitigates: Employ code signing and verification
      name: Code Signing
    - fgmid: FGM1051
      mitigates: Update software to latest secure version
      name: Update Software
    - fgmid: FGM1018
      mitigates: Employ user account management for all admin users
      name: User Account Management
    - fgmid: FGM1047
      mitigates: System audits can reveal anomalous behavior that may be caused by
        rootkits.
      name: Audit
    name: "## Addendum Name: Unauthorized Software In NFVI\r\n### Architecture Segments:\
      \ Virtualization, OA&M\r\n An adversary may implant rootkits in the Network\
      \ Function Virtualization Infrastructure (NFVI) that will hide the presence\
      \ of programs, files, network connections, services, drivers, and other system\
      \ components.\r\n\r\nRootkits are a special type of malware designed to remain\
      \ hidden on a target computer. These Rootkits can be created for hardware and\
      \ firmware for CMOS and other chips, Kernel, Memory, and Applications. \r\n\r\
      \nAdversaries may implant rootkits during device manufacturing process, use\
      \ compromised CI/CD pipeline, direct access to device to implant rootkits in\
      \ the Cloud, MEC, RAN, UE components.\r\n\r\nAdversaries may use rootkit compromise\
      \ for other actions such as credential dumping, configuration changes, or attack\
      \ other components in the network. Rootkits are hard to detect and may not be\
      \ easily identified by end point protection software. Host suspected of rootkit\
      \ infection may need to be quarantined and rebuilt from scratch with known good\
      \ software."
    platforms:
    - OS Platforms
    - Virtual infrastructure orchestrator
    - CI/CD
    - OA&M
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [ETSI NFV SEC025, Secure E2E VNF & NS management spec
      (WIP) v006, retrieved April 26, 2021](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC025_Secure_E2E_VNF_%26_NS_management)
    software: []
  architecture-segment: Virtualization, OA&M
  bluf: Adversaries may use rootkits to hide the presence of programs, files, network
    connections, services, drivers, and other system components.
  campaigns: []
  criticalassets:
  - description: NFVI components that support virtualization and network connecting
      the virtual functions.
    name: Operator NFV MANO, NFVO
  - description: Any compute entity that supports data processing functions, including
      Linux/Windows hosts, VMs, and or specialty equipment that has address and interacts
      with other NFVI elements.
    name: Host server
  - description: Any components that support integration and deployment
    name: CI/CD Tools
  - description: Container orchestrators such as Kubernetes, Mesos, Openshift
    name: Container Management Controller system
  description: 'Adversaries may use rootkits to hide the presence of programs, files,
    network connections, services, drivers, and other system components. Rootkits
    are programs that hide the existence of malware by intercepting/hooking and modifying
    operating system API calls that supply system information. (Citation: Symantec
    Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the
    user or kernel level in the operating system or lower, to include a hypervisor,
    Master Boot Record, or [System Firmware](https://attack.mitre.org/techniques/T1542/001).
    (Citation: Wikipedia Rootkit) Rootkits have been seen for Windows, Linux, and
    Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac
    OSX Rootkit)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1014)'
  detections:
  - component: Kernel Module Load
    detects: Kernel executing unknown processes or unauthorized processes not typical
      of the host.
    fgdsid: FGDS0008.001
    name: Kernel
  - component: Network Traffic Flow
    detects: Network traffic pattern may reveal remote C2 communication from rootkit
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: OS API Execution
    detects: Active processes or process log may reveal unauthorized activity due
      to rootkits
    fgdsid: FGDS0009.001
    name: Process
  - component: Firmware Modification
    detects: Monitor for changes made to firmware for unexpected modifications to
      settings and/or data that may be used by rootkits to hide the presence of programs,
      files, network connections, services, drivers, and other system components.
      There are dedicated rootkit detection tools that look for specific types of
      rootkit behavior.
    fgdsid: FGDS0001.001
    name: Firmware
  groups: []
  id: FGT1014
  mitigations:
  - fgmid: FGM1046
    mitigates: Use boot integrity measures
    name: Boot Integrity
  - fgmid: FGM1045
    mitigates: Employ code signing and verification
    name: Code Signing
  - fgmid: FGM1051
    mitigates: Update software to latest secure version
    name: Update Software
  - fgmid: FGM1018
    mitigates: Employ user account management for all admin users
    name: User Account Management
  - fgmid: FGM1047
    mitigates: System audits can reveal anomalous behavior that may be caused by rootkits.
    name: Audit
  name: Rootkit
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC025, Secure E2E VNF & NS management spec
    (WIP) v006, retrieved April 26, 2021](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC025_Secure_E2E_VNF_%26_NS_management)
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_addendum
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Data (IP address or FQDN, ports) relating to network nodes.
      name: MNO core network component data.
    detections:
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log)'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: 'Logged network traffic data showing both protocol header and body
        values (ex: PCAP)'
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log)'
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1042
      mitigates: Ensure that unnecessary ports and services are closed to prevent
        risk of discovery and potential exploitation.
      name: Disable Or Remove Feature Or Program
    - fgmid: FGM1031
      mitigates: Use network intrusion detection/prevention systems to detect and
        prevent remote service scans.
      name: Network Intrusion Prevention
    - fgmid: FGM1030
      mitigates: Ensure proper network segmentation is followed to protect critical
        servers and devices.
      name: Network Segmentation
    name: "## Addendum Name: Core-network Scanning\r\n### Architecture Segments: OA&M\r\
      \n An adversary may use scanning tools to discover 5G core network related information\
      \ (identifiers).\r\n\r\nAdversary may use an SCTP scan to identify the AMF interface\
      \ i.e. the IP address of the AMF. Additionally, N2 interface of AMF and N3 interface\
      \ of UPF could be found by User Equipment (UE) using NMAP SCTP scan and UDP\
      \ scan. Adversaries may attempt to get a listing of earlier generation systems\
      \ (e.g. 3G) that do not use IP address, hostname, but instead, other identifiers,\
      \ such as point codes (like IP addresses for SS7 protocols, point to point)\
      \ and Global Titles. Examples are GTScan, SigPloit, and GTPScan.\r\n\r\nNote:\
      \ This is scanning for 3G, 4G and 5G core components address info. This is scanning\
      \ for open ports to determine protocol use without compromising the host/NF."
    platforms:
    - 5G Core
    preconditions:
    - description: Adversaries need access to such tools.
      name: Access to scanning tool
    procedureexamples:
    - description: Adversaries may employ pen testing tools such as GTScan, SigPloit,
        SCTPScan and GTPScan. N2 interface of AMF and N3 interface of UPF could be
        found by User Equipment (UE) using NMAP SCTP scan and UDP scan.
      name: Use of pen testing tools.
    references:
    - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling
      framework for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
    - '<a name="2"> \[2\] </a> [Vulnerabilities in Cellular Packet Cores Part IV:
      Authentication, TrendMicro](https://www.trendmicro.com/en_us/research/24/i/vulnerabilities-in-cellular-packet-cores-part-iv-authentication.html)'
    software: []
  architecture-segment: OA&M
  bluf: Adversaries may attempt to get a listing of other systems by IP address, hostname,
    or other logical identifier on a network that may be used for Lateral Movement
    from the current system.
  campaigns: []
  criticalassets:
  - description: Data (IP address or FQDN, ports) relating to network nodes.
    name: MNO core network component data.
  description: 'Adversaries may attempt to get a listing of other systems by IP address,
    hostname, or other logical identifier on a network that may be used for Lateral
    Movement from the current system. Functionality could exist within remote access
    tools to enable this, but utilities available on the operating system could also
    be used such as [Ping](https://attack.mitre.org/software/S0097) or <code>net view</code>
    using [Net](https://attack.mitre.org/software/S0039). Adversaries may also analyze
    data from local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code>
    or <code>/etc/hosts</code>) or other passive means (such as local [Arp](https://attack.mitre.org/software/S0099)
    cache entries) in order to discover the presence of remote systems in an environment.
    Adversaries may also target discovery of network infrastructure as well as leverage
    [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands on
    network devices to gather detailed information about systems within a network
    (e.g. <code>show cdp neighbors</code>, <code>show arp</code>).(Citation: US-CERT-TA18-106A)(Citation:
    CISA AR21-126A FIVEHANDS May 2021)[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1018)'
  detections:
  - component: Network Connection Creation
    detects: 'Initial construction of a network connection, such as capturing socket
      information with a source/destination IP and port(s) (ex: Windows EID 5156,
      Sysmon EID 3, or Zeek conn.log)'
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Logged network traffic data showing both protocol header and body values
      (ex: PCAP)'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarized network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log)'
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1018
  mitigations:
  - fgmid: FGM1042
    mitigates: Ensure that unnecessary ports and services are closed to prevent risk
      of discovery and potential exploitation.
    name: Disable Or Remove Feature Or Program
  - fgmid: FGM1031
    mitigates: Use network intrusion detection/prevention systems to detect and prevent
      remote service scans.
    name: Network Intrusion Prevention
  - fgmid: FGM1030
    mitigates: Ensure proper network segmentation is followed to protect critical
      servers and devices.
    name: Network Segmentation
  name: Remote System Discovery
  object-type: technique
  postconditions:
  - description: Adversary now knows identifiers of some network nodes, and so these
      nodes can now be spoofed or targeted for Denial of Service.
    name: Identifier of some network nodes is known
  preconditions:
  - description: Adversaries need access to such tools.
    name: Access to scanning tool
  procedureexamples:
  - description: Adversaries may employ pen testing tools such as GTScan, SigPloit,
      SCTPScan and GTPScan. N2 interface of AMF and N3 interface of UPF could be found
      by User Equipment (UE) using NMAP SCTP scan and UDP scan.
    name: Use of pen testing tools.
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  - '<a name="2"> \[2\] </a> [Vulnerabilities in Cellular Packet Cores Part IV: Authentication,
    TrendMicro](https://www.trendmicro.com/en_us/research/24/i/vulnerabilities-in-cellular-packet-cores-part-iv-authentication.html)'
  software: []
  status: Observed
  tactics:
  - TA0007
  typecode: attack_technique_addendum
- bluf: Adversaries may exfiltrate data, such as sensitive documents, through the
    use of automated processing after being gathered during Collection.
  campaigns: []
  criticalassets: []
  description: Adversaries may exfiltrate data, such as sensitive documents, through
    the use of automated processing after being gathered during Collection. When automated
    exfiltration is used, other exfiltration techniques likely apply as well to transfer
    the information out of the network, such as [Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041)
    and [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1020)
  detections: []
  groups: []
  id: FGT1020
  mitigations: []
  name: Automated Exfiltration
  object-type: technique
  platforms: Linux, macOS, Windows, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0007
  - TA0010
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns: []
    criticalassets:
    - description: Virtual switch, Virtual Router, Virtual Firewalls, Virtual Load
        Balancers, SDN Controllers
      name: Virtual elements
    detections:
    - component: Network Traffic Flow
      detects: Network traffic for new traffic flows, analyze socket connections and
        protocol used to determine abnormal behavior.  Monitor for creation of unauthorized
        traffic mirroring sessions, unexpected outbound network connections from routers
        or cloud instances, configuration changes in network devices related to traffic
        forwarding or unusual new network flows, particularly on ports associated
        with traffic analysis tools.
      fgdsid: FGDS0029.003
      name: Network Traffic
    - component: Command Execution
      detects: Monitors Command executions on the devices. Command Execution involves
        monitoring and capturing the execution of textual commands (including shell
        commands, cmdlets, and scripts) within an operating system or application.
      fgdsid: FGDS0017.001
      name: Command
    groups: []
    mitigations:
    - fgmid: FGM1041
      mitigates: Encrypt sensitive data flows for Control plane and User plane traffic
      name: Encrypt Sensitive Information
    - fgmid: FGM1026
      mitigates: Manage accounts with privilege to make changes either in the device
        or its controller.
      name: Privileged Account Management
    name: "## Addendum Name: Network Traffic Duplication\r\n### Architecture Segments:\
      \ OA&M, Virtualization\r\n An adversary may use compromised virtualized network\
      \ elements to (vSwitch, vRouter, Virtual Firewalls) to span traffic to sniffing\
      \ port for access to user plane and control plane data.\r\n\r\nIn a virtualized\
      \ environment, access can be gained much more easily as the servers making up\
      \ a function are more likely to be virtually distributed and the SDN vSwitch\
      \ would allow an adversary to fork IP packets flowing much more easily between\
      \ hosts remotely. Most network devices/software have capabilities for traffic\
      \ duplication for troubleshooting or legal purposes (Lawful Interception). Such\
      \ forking is very difficult to detect or prevent from within a 3GPP NF or VM.\
      \ An adversary could read data in transit without being detected by application\
      \ monitoring software."
    platforms:
    - SDN network element
    - Transport
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [3GPP TR 33.848 Security Impacts of Virtualization,Section
      5.15.2](https://www.3gpp.org/DynaReport/33848.htm)
    software: []
  architecture-segment: OA&M, Virtualization
  bluf: Adversaries may leverage traffic mirroring in order to automate data exfiltration
    over compromised infrastructure.
  campaigns: []
  criticalassets:
  - description: Virtual switch, Virtual Router, Virtual Firewalls, Virtual Load Balancers,
      SDN Controllers
    name: Virtual elements
  description: 'Adversaries may leverage traffic mirroring in order to automate data
    exfiltration over compromised infrastructure. Traffic mirroring is a native feature
    for some devices, often used for network analysis. For example, devices may be
    configured to forward network traffic to one or more destinations for analysis
    by a network analyzer or other monitoring device. (Citation: Cisco Traffic Mirroring)(Citation:
    Juniper Traffic Mirroring) Adversaries may abuse traffic mirroring to mirror or
    redirect network traffic through other infrastructure they control. Malicious
    modifications to network devices to enable traffic redirection may be possible
    through [ROMMONkit](https://attack.mitre.org/techniques/T1542/004) or [Patch System
    Image](https://attack.mitre.org/techniques/T1601/001).(Citation: US-CERT-TA18-106A)(Citation:
    Cisco Blog Legacy Device Attacks) Many cloud-based environments also support traffic
    mirroring. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure
    vTap allow users to define specified instances to collect traffic from and specified
    targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation:
    GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Adversaries may use
    traffic duplication in conjunction with [Network Sniffing](https://attack.mitre.org/techniques/T1040),
    [Input Capture](https://attack.mitre.org/techniques/T1056), or [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)
    depending on the goals and objectives of the adversary.[To read more, please see
    the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1020/001)'
  detections:
  - component: Network Traffic Flow
    detects: Network traffic for new traffic flows, analyze socket connections and
      protocol used to determine abnormal behavior.  Monitor for creation of unauthorized
      traffic mirroring sessions, unexpected outbound network connections from routers
      or cloud instances, configuration changes in network devices related to traffic
      forwarding or unusual new network flows, particularly on ports associated with
      traffic analysis tools.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: Command Execution
    detects: Monitors Command executions on the devices. Command Execution involves
      monitoring and capturing the execution of textual commands (including shell
      commands, cmdlets, and scripts) within an operating system or application.
    fgdsid: FGDS0017.001
    name: Command
  groups: []
  id: FGT1020.001
  mitigations:
  - fgmid: FGM1041
    mitigates: Encrypt sensitive data flows for Control plane and User plane traffic
    name: Encrypt Sensitive Information
  - fgmid: FGM1026
    mitigates: Manage accounts with privilege to make changes either in the device
      or its controller.
    name: Privileged Account Management
  name: Traffic Duplication
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [3GPP TR 33.848 Security Impacts of Virtualization,Section
    5.15.2](https://www.3gpp.org/DynaReport/33848.htm)
  software: []
  status: Theoretical
  subtechnique-of: FGT1020
  tactics:
  - TA0007
  - TA0010
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: Admin
    campaigns: []
    criticalassets:
    - description: 5G or RAN Network functions including VNF and PNFs.
      name: Network functions
    - description: Virtualized 5G environment relies on underlying compute and SDN
        network elements which may be of interest to adversary.
      name: Hosts, VMs, or Infrastructure elements
    detections:
    - component: Command Execution
      detects: Audit command logs service specifically designed to accept remote connections,
        such as telnet, SSH, VNC, etc.
      fgdsid: FGDS0017.001
      name: Command
    - component: Logon Session Creation
      detects: Monitor logon sessions, blocked/denied activity, and, any other session
        establishment activity that may be unauthorized.
      fgdsid: FGDS0028.001
      name: Logon Session
    - component: Network Traffic Content
      detects: Monitor network traffic for attempted and established connections to
        log into a service specifically designed to accept remote connections, such
        as RDP, telnet, SSH, and VNC.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups:
    - description: Liminal Panda initially accessed an eDNS server via SSH from a
        compromised mobile network operator; they installed CobaltStrike on compromised
        hosts [2].
      fggid: FGG5001
      name: Liminal Panda
    - description: Using harvested valid account credentials, Salt Typhoon accessed
        remote systems to spread malware, and used commercially available penetration
        testing tool and remote management tools to create beacons for lateral movement,
        remote control ([3], [4]). WMI/WMIC and SMB/Windows admin share  were used
        for scripts execution on remote systems ([1],[3],[5],[6]).
      fggid: G1045
      name: Salt Typhoon
    mitigations:
    - fgmid: FGM1030
      mitigates: Place services like DNS, web servers, external routers in a DMZ to
        separate them from the internal network.
      name: Network Segmentation
    - fgmid: FGM1032
      mitigates: Use multi-factor authentication on remote service logons where possible.
      name: Multi-factor Authentication
    - fgmid: FGM1018
      mitigates: Limit the accounts that may use remote services. Limit the permissions
        for accounts that are at higher risk of compromise; for example, configure
        SSH so users can only run specific programs. Block access (from external nodes)
        to internal OA&M via SSH.
      name: User Account Management
    - fgmid: FGM1027
      mitigates: Employ a good password policy for SSH accounts, or else use key based
        authentication.
      name: Password Policies
    name: "## Addendum Name: Server Or Router Access\r\n### Architecture Segments:\
      \ OA&M\r\n An adversary may compromise a remote management interface of routers\
      \ or servers in telecommunications infrastructure to achieve follow-on behaviors.\r\
      \n\r\nAn adversary may achieve control over nodes in a telecom network, by leveraging\
      \ valid account credentials that they harvested during initial access for remote\
      \ management services.\r\n\r\nThere are many remote management tools, depending\
      \ on the platform of the managed node. Remote management tools that could be\
      \ used for adversarial purposes are: WMIC/Powershell, ConnectWise Screen Connect,\
      \ AnyDesk, TeamViewer, Atera Agent.\r\n\r\nA remote management protocol is SSH,\
      \ and it too can be used as is by adversaries to achieve control over telecom\
      \ network components/servers. SSH is a protocol that allows authorized users\
      \ to open remote shells on other nodes. Telecom routers and network functions\
      \ often run Linux thus supporting the SSH protocol. The SSH servers in question\
      \ likely used regular password authentication, which the adversaries may discover\
      \ (for example via password spraying techniques ATT&CK T1110/003). "
    platforms:
    - Transport
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
      Look at China''s Cyber Threats to the Telecom Sector", updated November 19,
      2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
    - '<a name="3"> \[3\] </a> [TrendMicro blog: "Earth Estries Targets Government,
      Tech for Cyberespionage," Trend Micro, Aug. 30, 2023.](https://www.trendmicro.com/en_in/research/23/h/earth-estries-targets-government-tech-for-cyberespionage.html)'
    - '<a name="4"> \[4\] </a> [Picus security: "Salt Typhoon: A Persistent Threat
      to Global Telecommunications Infrastructure", Dec. 20, 2024.](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
    - '<a name="5"> \[5\] </a> [Vectra: "Is your organization safe from Salt Typhoon
      attacks?".](https://www.vectra.ai/threat-actors/salt-typhoon)'
    - '<a name="6"> \[6\] </a> [Tenable: "Salt Typhoon: An Analysis of Vulnerabilities
      Exploited by this State-Sponsored Actor".](https://www.tenable.com/blog/salt-typhoon-an-analysis-of-vulnerabilities-exploited-by-this-state-sponsored-actor)'
    software:
    - description: Liminal Panda used CobaltStrike for lateral movement in a telecom
        network.
      fgsid: S0154
      name: Cobalt Strike
  - access-required: User, Administrative Access
    campaigns: []
    criticalassets:
    - description: 5G or RAN Network functions including VNF.
      name: VNF
    - description: Virtualized 5G environment relies on underlying compute and SDN
        network elements which may be of interest to adversary.
      name: Hosts servers
    detections:
    - component: Command Execution
      detects: Audit command logs.
      fgdsid: FGDS0017.001
      name: Command
    - component: Logon Session Creation
      detects: Detects communication sessions. 5G NFs have defined interfaces, any
        other session establishment activity may be unauthorized.  Monitor traffic
        patterns and session sources along with blocked/denied activity.
      fgdsid: FGDS0028.001
      name: Logon Session
    - component: Logon Session Metadata
      detects: Contextual data about a logon session, such as username, logon type,
        access tokens (security context, user SIDs, logon identifiers, and logon SID),
        and any activity associated within it.
      fgdsid: FGDS0028.002
      name: Logon Session
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log).'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: Logged network traffic data showing both protocol header.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log).'
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1032
      mitigates: Use multi-factor authentication on remote service logons where possible.
      name: Multi-factor Authentication
    - fgmid: FGM1018
      mitigates: Limit the accounts that may use remote services. Limit the permissions
        for accounts that are at higher risk of compromise; for example, configure
        SSH so users can only run specific programs.
      name: User Account Management
    name: "## Addendum Name: VNF Access Services\r\n### Architecture Segments: OA&M\r\
      \n Adversary may use non-5G functional remote communication interfaces (SNMP/RPC,\
      \ SSH) to change host configuration to enable host compromise.\r\n\r\nCloud\
      \ tenants may deploy additional network services in their containers along with\
      \ the main functionality of the 5G Virtual Network Function (VNF).  These services\
      \ can be deployed as part of the VNF itself, since they allow for VNF monitoring\
      \ or remote configuration. If these network services are directly accessible\
      \ over the Internet (or from another tenant of the CaaS), then they are vulnerable\
      \ to intrusion attacks. For example, adversaries may attempt to guess access\
      \ credentials or to exploit known vulnerabilities in the management services\
      \ APIs. If successful, the adversary now can use the access to this container\
      \ through these services for additional follow-on techniques."
    platforms:
    - VNF
    preconditions: []
    procedureexamples: []
    references: []
    software: []
  architecture-segment: OA&M
  bluf: Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078)
    to log into a service that accepts remote connections, such as telnet, SSH, and
    VNC.
  campaigns: []
  criticalassets:
  - description: 5G or RAN Network functions including VNF and PNFs.
    name: Network functions
  - description: Virtualized 5G environment relies on underlying compute and SDN network
      elements which may be of interest to adversary.
    name: Hosts, VMs, or Infrastructure elements
  description: 'Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078)
    to log into a service that accepts remote connections, such as telnet, SSH, and
    VNC. The adversary may then perform actions as the logged-on user. In an enterprise
    environment, servers and workstations can be organized into domains. Domains provide
    centralized identity management, allowing users to login using one set of credentials
    across the entire network. If an adversary is able to obtain a set of valid domain
    credentials, they could login to many different machines using remote access protocols
    such as secure shell (SSH) or remote desktop protocol (RDP).(Citation: SSH Secure
    Shell)(Citation: TechNet Remote Desktop Services) They could also login to accessible
    SaaS or IaaS services, such as those that federate their identities to the domain.
    Legitimate applications (such as [Software Deployment Tools](https://attack.mitre.org/techniques/T1072)
    and other administrative programs) may utilize [Remote Services](https://attack.mitre.org/techniques/T1021)
    to access remote hosts. For example, Apple Remote Desktop (ARD) on macOS is native
    software used for remote management. ARD leverages a blend of protocols, including
    [VNC](https://attack.mitre.org/techniques/T1021/005) to send the screen and control
    buffers and [SSH](https://attack.mitre.org/techniques/T1021/004) for secure file
    transfer.(Citation: Remote Management MDM macOS)(Citation: Kickstart Apple Remote
    Desktop commands)(Citation: Apple Remote Desktop Admin Guide 3.3) Adversaries
    can abuse applications such as ARD to gain remote code execution and perform lateral
    movement. In versions of macOS prior to 10.14, an adversary can escalate an SSH
    session to an ARD session which enables an adversary to accept TCC (Transparency,
    Consent, and Control) prompts without user interaction and gain access to data.(Citation:
    FireEye 2019 Apple Remote Desktop)(Citation: Lockboxx ARD 2019)(Citation: Kickstart
    Apple Remote Desktop commands)[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1021)'
  detections:
  - component: Command Execution
    detects: Audit command logs service specifically designed to accept remote connections,
      such as telnet, SSH, VNC, etc.
    fgdsid: FGDS0017.001
    name: Command
  - component: Logon Session Creation
    detects: Monitor logon sessions, blocked/denied activity, and, any other session
      establishment activity that may be unauthorized.
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: Network Traffic Content
    detects: Monitor network traffic for attempted and established connections to
      log into a service specifically designed to accept remote connections, such
      as RDP, telnet, SSH, and VNC.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: Liminal Panda initially accessed an eDNS server via SSH from a compromised
      mobile network operator; they installed CobaltStrike on compromised hosts [2].
    fggid: FGG5001
    name: Liminal Panda
  - description: Using harvested valid account credentials, Salt Typhoon accessed
      remote systems to spread malware, and used commercially available penetration
      testing tool and remote management tools to create beacons for lateral movement,
      remote control ([3], [4]). WMI/WMIC and SMB/Windows admin share  were used for
      scripts execution on remote systems ([1],[3],[5],[6]).
    fggid: G1045
    name: Salt Typhoon
  id: FGT1021
  mitigations:
  - fgmid: FGM1030
    mitigates: Place services like DNS, web servers, external routers in a DMZ to
      separate them from the internal network.
    name: Network Segmentation
  - fgmid: FGM1032
    mitigates: Use multi-factor authentication on remote service logons where possible.
    name: Multi-factor Authentication
  - fgmid: FGM1018
    mitigates: Limit the accounts that may use remote services. Limit the permissions
      for accounts that are at higher risk of compromise; for example, configure SSH
      so users can only run specific programs. Block access (from external nodes)
      to internal OA&M via SSH.
    name: User Account Management
  - fgmid: FGM1027
    mitigates: Employ a good password policy for SSH accounts, or else use key based
      authentication.
    name: Password Policies
  name: Remote Services
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  - '<a name="3"> \[3\] </a> [TrendMicro blog: "Earth Estries Targets Government,
    Tech for Cyberespionage," Trend Micro, Aug. 30, 2023.](https://www.trendmicro.com/en_in/research/23/h/earth-estries-targets-government-tech-for-cyberespionage.html)'
  - '<a name="4"> \[4\] </a> [Picus security: "Salt Typhoon: A Persistent Threat to
    Global Telecommunications Infrastructure", Dec. 20, 2024.](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
  - '<a name="5"> \[5\] </a> [Vectra: "Is your organization safe from Salt Typhoon
    attacks?".](https://www.vectra.ai/threat-actors/salt-typhoon)'
  - '<a name="6"> \[6\] </a> [Tenable: "Salt Typhoon: An Analysis of Vulnerabilities
    Exploited by this State-Sponsored Actor".](https://www.tenable.com/blog/salt-typhoon-an-analysis-of-vulnerabilities-exploited-by-this-state-sponsored-actor)'
  software:
  - description: Liminal Panda used CobaltStrike for lateral movement in a telecom
      network.
    fgsid: S0154
    name: Cobalt Strike
  status: Observed
  tactics:
  - TA0008
  - TA0007
  typecode: attack_technique_addendum
- bluf: Adversaries may attempt to manipulate features of their artifacts to make
    them appear legitimate or benign to users and/or security tools.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may attempt to manipulate features of their artifacts
    to make them appear legitimate or benign to users and/or security tools. Masquerading
    occurs when the name or location of an object, legitimate or malicious, is manipulated
    or abused for the sake of evading defenses and observation. This may include manipulating
    file metadata, tricking users into misidentifying the file type, and giving legitimate
    task or service names. Renaming abusable system utilities to evade security monitoring
    is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation:
    LOLBAS Main Site) Masquerading may also include the use of [Proxy](https://attack.mitre.org/techniques/T1090)
    or VPNs to disguise IP addresses, which can allow adversaries to blend in with
    normal network traffic and bypass conditional access policies or anti-abuse protections.[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1036)'
  detections: []
  groups: []
  id: FGT1036
  mitigations: []
  name: Masquerading
  object-type: technique
  platforms: Linux, macOS, Windows, Containers
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: Admin
    campaigns: []
    criticalassets:
    - description: The external DNS server that MNOs employ to support roaming services.
      name: DNS server
    - description: Host based firewalls
      name: Firewalls
    detections:
    - component: Process Access
      detects: Employ EDR (Extended Detection and Response) for process creation and
        execution
      fgdsid: FGDS0009.002
      name: Process
    - component: File Modification
      detects: Employ File integrity monitoring (FIM) for recording file changes of
        key configuration files
      fgdsid: FGDS0022.005
      name: File
    groups:
    - description: According to [1], Liminal Panda replaced the legitimate iptables
        binary for eDNS host-based firewall to allow communication from a compromised
        telecom network, keeping the same name, "iptables".
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1018
      mitigates: Ensure proper user permissions are in place to prevent adversaries
        from disabling or modifying firewall settings on the eDNS servers.
      name: User Account Management
    - fgmid: FGM1022
      mitigates: Ensure proper process and file permissions are in place to prevent
        adversaries from disabling or modifying firewall settings
      name: Restrict File And Directory Permissions
    name: "## Addendum Name: Utility Software\r\n### Architecture Segments: OA&M,\
      \ Roaming\r\n Adversaries may deploy their own software with a name to match\
      \ the name of legitimate firewall utility tool.\r\n\r\nIn order to evade defenses\
      \ and observation, an adversary may introduce their own iptables wrapper function\
      \ and give it the same name, replacing the legitimate iptables. This is in order\
      \ to allow communication from a compromised telecom network, which would otherwise\
      \ be blocked by the firewall.\r\n\r\nReplacing the legitimate iptables binary\
      \ for the eDNS host-based firewall allows modifying the output from iptables\
      \ queries to conceal the firewall rules the adversary added. Thus, an administrator\
      \ of the MNO would not notice anything amiss with the firewall rules by simply\
      \ reviewing the iptables output. An adversary uses such a utility software to\
      \ allow incoming traffic from disallowed IP addresses, in order to maintain\
      \ a connection to IP hosts they control outside of the MNO's network - hosts\
      \ whose IP address ranges may be blocked by the MNO's host-based firewall on\
      \ the external DNS server. \r\n\r\nPingPong process masquerades under httpd\
      \ (software that runs as a background process (daemon) and acts as a web server,\
      \ using HTTP and/or HTTPS) in the eDNS server. "
    platforms:
    - Interconnect
    - Transport
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
      Look at China''s Cyber Threats to the Telecom Sector", updated November 19,
      2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
    software:
    - description: Liminal Panda used the PingPong process masquerading under httpd
        (software that runs as a background process (daemon) and acting as a web server,
        using HTTP and/or HTTPS) in the eDNS server. ([2])
      fgsid: FGS5001
      name: PingPong
  architecture-segment: OA&M, Roaming
  bluf: Adversaries may match or approximate the name or location of legitimate files
    or resources when naming/placing them.
  campaigns: []
  criticalassets:
  - description: The external DNS server that MNOs employ to support roaming services.
    name: DNS server
  - description: Host based firewalls
    name: Firewalls
  description: 'Adversaries may match or approximate the name or location of legitimate
    files or resources when naming/placing them. This is done for the sake of evading
    defenses and observation. This may be done by placing an executable in a commonly
    trusted directory (ex: under System32) or giving it the name of a legitimate,
    trusted program (ex: svchost.exe). In containerized environments, this may also
    be done by creating a resource in a namespace that matches the naming convention
    of a container pod or cluster. Alternatively, a file or container image name given
    may be a close approximation to legitimate programs/images or something innocuous.
    Adversaries may also use the same icon of the file they are trying to mimic.[To
    read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1036/005)'
  detections:
  - component: Process Access
    detects: Employ EDR (Extended Detection and Response) for process creation and
      execution
    fgdsid: FGDS0009.002
    name: Process
  - component: File Modification
    detects: Employ File integrity monitoring (FIM) for recording file changes of
      key configuration files
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: According to [1], Liminal Panda replaced the legitimate iptables
      binary for eDNS host-based firewall to allow communication from a compromised
      telecom network, keeping the same name, "iptables".
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1036.005
  mitigations:
  - fgmid: FGM1018
    mitigates: Ensure proper user permissions are in place to prevent adversaries
      from disabling or modifying firewall settings on the eDNS servers.
    name: User Account Management
  - fgmid: FGM1022
    mitigates: Ensure proper process and file permissions are in place to prevent
      adversaries from disabling or modifying firewall settings
    name: Restrict File And Directory Permissions
  name: Match Legitimate Name or Location
  object-type: technique
  postconditions:
  - description: SSH connection (or similar) from victim MNO network to an already
      compromised telecom network is maintained
    name: Maintain connection to external adversary controlled host
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software:
  - description: Liminal Panda used the PingPong process masquerading under httpd
      (software that runs as a background process (daemon) and acting as a web server,
      using HTTP and/or HTTPS) in the eDNS server. ([2])
    fgsid: FGS5001
    name: PingPong
  status: Observed
  subtechnique-of: FGT1036
  tactics:
  - TA0005
  typecode: attack_subtechnique_addendum
- access-required: Expanded Privilege
  architecture-segment: RAN, Roaming
  bluf: An adversary may use the identifier of a legitimate operator (e.g., PLMN ID)
    in order evade roaming firewall/filtering or trick a UE into connecting.
  campaigns: []
  criticalassets: []
  description: "An adversary may use the identifier of a legitimate operator (e.g.,\
    \ PLMN ID) in order evade roaming firewall/filtering or trick a UE into connecting.\r\
    \n\r\nAn adversary may spoof a cellular operator identifier (PLMN ID, Global Title)\
    \ in several settings in order to evade defenses or pave the way to follow-on\
    \ behaviors.\r\n\r\nMasquerading can occur in roaming exchange signaling: an adversary\
    \ sets the origin of a roaming signaling message to the PLMN ID (or Global Title\
    \ for earlier generations) of another, legitimate operator - for 2G/3G, this is\
    \ an SS7 message, for 4G, this is a Diameter protocol message, while for 5G it\
    \ is an HTTP/2 message. This type of signaling carries requests for identifiers,\
    \ location, or authentication information. This is done in order to bypass the\
    \ filtering by an SS7 or Diameter Edge Agent.\r\n\r\nMasquerading can also be\
    \ done at the radio access, where a false base station is deployed to advertise\
    \ a spoofed PLMN ID, in order to trick the UE to connect to it and perform a new\
    \ registration procedure."
  detections:
  - component: Network Traffic Flow
    detects: Use firewalls, Intrusion Detection Systems (IDS), or Intrusion Prevention
      Systems (IPS) to detect and/or block suspicious SS7, Diameter  messages.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: Signals sent by UEs
    detects: UE sends to gNB signal measurements helps detect false base stations
      in the network, and their spoofed PLMN IDs
    fgdsid: FGDS5002.001
    name: Radio interface
  groups:
  - description: HiddenArt spoofed the Global Title of a victim operator as source
      in roaming signaling -- SS7 messages sent from the GRX/IPX to the home PLMN
      of a user being targeted ([2]).
    fggid: FGG5003
    name: HIddenArt
  id: FGT1036.501
  mitigations:
  - fgmid: FGM1014
    mitigates: Filter messages from the roaming interconnect network (GRX/IPX ) for
      suspicious messages
    name: Interconnection Filtering
  name: PLMN ID
  object-type: technique
  platforms: 5G RAN, 5G Core, Interconnect
  postconditions:
  - description: Adversary masquerading as a trusted roaming partner, engages in roaming
      signaling with the PLMN of the victim UE, which can lead to fraudulently obtaining
      UE credentials or other information.
    name: Home PLMN is tricked into engaging in roaming signaling
  - description: UE is tricked into connecting to the false base station
    name: Lure UE to connect to the false base station
  preconditions:
  - description: Adversary obtains a false base station and places it in the vicinity
      of the victim UE, setting it to broadcast a spoofed PLMN ID and cell ID.
    name: Obtain and deploy false base station
  - description: The adversary buys access or fraudulently obtains access to the IPX
      network in order to send Diameter or HTTP/2 messages with spoofed origin PLMN
      ID
    name: Obtain access to roaming network (IPX)
  procedureexamples:
  - description: Roaming partner requests an authentication vector for the PLMN ID
      of the home network ([1]).
    name: Spoofed PLMN ID on roaming signaling
  - description: Adversary controlled false base station broadcasts the cell ID and
      PLMN ID of an existing legitimate cellular base station ([3]).
    name: Spoofed PLMN ID broadcast
  references:
  - <a name="1"> \[1\] </a> [P1 security (2021). All authentication vectors are not
    made equal.](https://labs.p1sec.com/2021/09/30/all-authentication-vectors-are-not-made-equal/)
  - <a name="2"> \[2\] </a> [Enea (2022). HiddenArt - A Russian-linked SS7 Threat
    Actor](https://www.enea.com/insights/the-hunt-for-hiddenart/)
  - '<a name="3"> \[3\] </a> [T. Heijligenberg, D. Rupprecht, K. Kohls , "The attacks
    aren''t alright: Large-Scale Simulation of Fake Base Station Attacks and Detections",
    in Workshop on Cyber Security Experimentation and Test, Philadelphia, PA, USA,
    August 2024](https://dl.acm.org/doi/fullHtml/10.1145/3675741.3675742)'
  software: []
  status: Observed
  subtechnique-of: FGT1036
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: User Plane
  bluf: Adversaries may use an unconventional port to obscure illicit communications.
  campaigns: []
  criticalassets:
  - description: All core network functions of victim MNO may be impacted by this
      behavior.
    name: MNO core network functions
  - description: Victim MNO's network data may be exposed to adversaries due to this
      behavior.
    name: MNO network data
  description: "Adversaries may use an unconventional port to obscure illicit communications.\r\
    \n\r\nAdversaries may establish a command and control channel by hiding communication\
    \ using an unconventional port. They may compromise the external DNS (eDNS) server\
    \ of a partner network using SSH for initial access with password spraying. Then\
    \ they launch the pingpong malware which listens for ICMP echo requests from compromised\
    \ hosts of other partner networks. It establishes a TCP reverse shell connection\
    \ to the partner network when it finds the remote IP address and port number.\
    \ The remote IP address and port number are embedded at a fixed offset of the\
    \ ICMP echo request. Then the adversaries exchange C2 messages with the remote\
    \ server using TCP port 53 for transport. This particular port is chosen for C2\
    \ because it is allowed by most firewalls for DNS queries to pass through."
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic contents especially all payloads of traffic received
      on TCP port 53.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Process Creation
    detects: Monitor all process creations in host systems for any unusual activity
      e.g. TCP reverse shell process to connect to remote server.
    fgdsid: FGDS0009.003
    name: Process
  groups:
  - description: Liminal Panda established C2 channel between eDNS server of a partner
      network and another server controlled by them using TCP port 53 for transport.
      [1,2]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1036.502
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter all network traffic received on TCP port 53 with unusually long
      payloads.
    name: Filter Network Traffic
  - fgmid: FGM5542
    mitigates: Use application layer firewall for unusual payloads sent and received
      on TCP port 53.
    name: Application Layer Firewall
  name: Port Number
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions:
  - description: eDNS server of an MNO partner network must be compromised before
      launching this behavior. Then the adversaries may install the pingpong backdoor
      in the compromised eDNS server.
    name: MNOs eDNS server is compromised
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software:
  - description: Pingpong malware was used by Liminal Panda to listen to ICMP echo
      requests from remote hosts. This helped determine the IP address and port number
      to connect to the remote host via TCP reverse shell.
    fgsid: FGS5001
    name: PingPong
  status: Observed
  subtechnique-of: FGT1036
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns: []
    criticalassets:
    - description: User signaling such as authentication data, user location on the
        N32 interface.
      name: Control plane
    - description: User plane data on the N9 interface.
      name: User plane
    - description: Signaling data, provisioning data, service discovery
      name: Control plane
    detections:
    - component: Application Log Content
      detects: Monitor for allowed modifications relative to the agreed upon modifications
        per roaming agreements and agreements with IPX.
      fgdsid: FGDS0015.001
      name: Application Log
    - component: Process Creation
      detects: Monitor creation of processes which may sniff data.
      fgdsid: FGDS0009.003
      name: Process
    - component: Process Metadata
      detects: Monitor activity of processes which may sniff data.
      fgdsid: FGDS0009.004
      name: Process
    - component: Command Execution
      detects: Monitor commands given to NFs which may help data sniffing.
      fgdsid: FGDS0017.001
      name: Command
    groups:
    - description: LIMINAL PANDA is a China-linked, state-sponsored cyber threat group
        primarily targeting telecommunications providers, with operations dating back
        to at least 2020.
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1041
      mitigates: 'Non-SBI: Use encryption (IPSec) on these interfaces. Sections 9.2,
        9.3, 9.4, 9.8, 9.9 of [2], and for N26 interfaces, see 4.3.1. of [3].SBI:
        Encrypt using TLS all links between NFs and between NF and SCP if one is deployed.
        TLS must use certificates for both client and server, and the certificate
        must include the SBA node type and must be checked against what the expectation
        is for that other party. The TLS profile should adhere to those in TS 33.210
        [9]. IPSec can be optionally used to protect TLS traffic further at a lower
        layer. Section 13.1.0 of [2] and also [8], [9].Roaming: For SEPP, see sections
        4.2.3.3, 4.3., 4.4. of [4], and sections 13.1 and 13.2 of [2].'
      name: Encrypt Sensitive Information
    - fgmid: FGM1054
      mitigates: Ensure for MNO services that serve roaming partners that the minimum
        acceptable configuration is adequate and complies with [2] TS 33.501 clause
        13.2.4.9.
      name: Software Configuration
    - fgmid: FGM1040
      mitigates: Monitor to ensure configurations do not change from acceptable options
      name: Behavior Prevention On Endpoint
    - fgmid: FGM5033
      mitigates: Use zero trust for NF protection
      name: Zero Trust
    - fgmid: FGM1020
      mitigates: Encrypt using TLS all links between NFs and between NF and SCP
      name: SSL/TLS Inspection
    - fgmid: FGM1032
      mitigates: Without Multi-Factor Authentication (MFA), there is a higher risk
        of unauthorized access since passwords alone are insufficient for securing
        system. Malicious actors could then change the configuration of network elements
        to allow for no encryption.
      name: Multi-factor Authentication
    name: "## Addendum Name: Network Elements\r\n### Architecture Segments: Control\
      \ Plane, User Plane, Roaming, Virtualization\r\n Adversaries may sniff network\
      \ traffic to capture information about 5G environment, control and user plane\
      \ data including authentication material, equipment identifiers.\r\n\r\nA compromise\
      \ of network function (NF) supporting Service based (SBI), Non-Service Based\
      \ (non-SBI), Roaming interfaces, and virtual network elements may allow an adversary\
      \ to capture network traffic. \r\n\r\n The following Network interfaces are\
      \ in the scope of this technique addendum:\r\n\r\n1.\t\"Non-SBI\" (non-Service\
      \ Based Interface) network interfaces are within 5G core and RAN, and between\
      \ the RAN and the 5G Core (e.g. N2, N3, N4, Xn). \r\n\r\n2.\tSBI network interfaces\
      \ are between core NFs within an operator network; they use REST APIs.\r\n\r\
      \n3.\tRoaming and interconnect interfaces, including IPX, are between network\
      \ operators (between SEPPs, or other interworking functions like AMF/MME (N26)\
      \ and between UPFs (N9)).\r\n\r\nAn adversary with access to the non-SBI interfaces\
      \ not using encryption can monitor traffic exchange and obtain UE information\
      \ such as user identifiers, serving network identifiers, and location info.\
      \ \r\n\r\nThe adversary with access to the SBI links, may eavesdrop signaling\
      \ messages if TLS encryption is not enabled. This leads to disclosure of UE\
      \ authentication and authorization information, and NF IP addresses and other\
      \ topology information.\r\n\r\nThe adversary positioned on an IPX node may collect\
      \ data over the N32 interface while a UE is roaming, if a SEPP has used encryption\
      \ on some parts of the messages sent, or used a weak cipher for JWE encryption.\
      \ Similarly, an adversary positioned on a SEPP can observe or easily decrypt\
      \ signaling messages sent on the N32 interface.\r\n\r\nSimilarly, if the EPC\
      \ interworking interface N26 for non-roaming is not encrypted, all subscriber\
      \ signaling data may be exposed to adversary.\r\n\r\nAdversary may also use\
      \ compromised virtualized network elements to (vSwitch/vRouter, Virtual Firewalls)\
      \ to span traffic to a sniffing port for access to traffic flows and user/system\
      \ data. In a virtualized environment access can be gained much more easily as\
      \ the servers making up a function are more likely to be physically and virtually\
      \ distributed and the SDN vSwitch would allow an adversary to fork IP packets\
      \ flowing between hosts remotely much more easily. Such forking is very difficult\
      \ to detect or prevent from within a 3GPP NF or VM, and adversaries may be able\
      \ to read data in transit. \r\n\r\nAn adversary may utilize these observations\
      \ for several follow-on techniques."
    platforms:
    - RAN
    - Core
    - Interconnect
    preconditions: []
    procedureexamples:
    - description: Adversary with access to the non-SBI interfaces (Xn, N2, N3, N4,
        N9) not using encryption can monitor traffic exchange and obtain UE information
        such as user identifiers, serving network identifiers, and location info.
        Non-SBI interfaces may not be encrypted for at least user plane or for control
        plane packets. See sections D.2.2., L.2.2., L.2.3 of [1]
      name: Non-SBI compromise
    - description: The adversary with access to the SBI links, for example, with control
        over the 5G Service Communication Proxy (SCP) or a network infrastructure
        node (proxy, router, switch), may eavesdrop signaling messages if TLS encryption
        is not enabled. This leads to disclosure of UE authentication and authorization
        information, and NF IP addresses and other topology information. See [6],
        [7].
      name: SBI node compromise
    - description: 'Adversary positioned on an IPX node can observe UE data if in
        the clear or easily decrypted: If a SEPP has not properly removed clear text
        information elements (IE) when replacing them with encrypted versions consistent
        with the previously negotiated protection policy or if the SEPP used a weak
        cipher for JWE encryption. See section G.2.4 of [1].'
      name: IPX node compromise
    - description: The adversary positioned on a SEPP, can observe information elements
        on the N32c interface including cipher suites used, keys, protection policies
        exchanged, and error messages received from the peer SEPP.  Observations on
        the N32f interface include cell ID and Physical Cell ID, SUPI, NF to NF signaling
        for a given victim UE. An adversary may utilize these observations for a number
        of follow-on techniques.
      name: SEPP compromise
    references:
    - <a name="1"> \[1\] </a> [3GPP TR 33.926 "Security Assurance Specification (SCAS)
      threats and critical assets in 3GPP network product classes", March 2022](https://www.3gpp.org/DynaReport/33926.htm)
    - <a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP), "Security
      Architecture and Procedures for 5G System", TS 33.501 v16.10.0 Release 16, March
      2022](https://www.3gpp.org/DynaReport/33501.htm)
    - <a name="3"> \[3\] </a> [3GPP TS 23.501 "System architecture for the 5G System
      (5GS)", March 2022](https://www.3gpp.org/DynaReport/23501.htm)
    - <a name="4"> \[4\] </a> [3rd Generation Partnership Project (3GPP), "5G Security
      Assurance Specification (SCAS) for the Security Edge Protection Proxy (SEPP)
      network product class", TS 33.517, ver. 17.0.0, Jun. 2021](https://www.3gpp.org/DynaReport/33517.htm)
    - <a name="5"> \[5\] </a> [G. Green, "5G Security when Roaming - Part 2," Mpirical,
      Lancaster, UK, May 21,2021](https://www.mpirical.com/blog/5g-security-when-roaming-part-2)
    - <a name="6"> \[6\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
      October 2021](https://arxiv.org/abs/2108.11206)
    - <a name="7"> \[7\] </a> [G. Koien, "On Threats to the 5G Service Based Architecture",
      2021.](https://www.researchgate.net/publication/349455036_On_Threats_to_the_5G_Service_Based_Architecture)
    - <a name="8"> \[8\] </a> ["The Transport Layer Security (TLS) Protocol", Version
      1.2. RFC 5246](https://www.ietf.org/rfc/rfc5246.txt)
    - <a name="9"> \[9\] </a> [3GPP TS 33.210 "Network Domain Security (NDS); IP network
      layer security"](https://www.3gpp.org/DynaReport/33210.htm)
    - <a name="10"> \[10\] </a> [CrowdStrike, "An analysis of LightBasin telecommunications
      attacks".](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks)
    software:
    - description: CordScan was used to capture user data packets in the user plane
        in the core network. [10]
      fgsid: FGS5014
      name: CordScan
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Sensitive subscriber and/or network data may be available to the
        adversary.
      name: Sensitive subscriber data and network data
    detections:
    - component: Network Traffic Content
      detects: Monitor traffic on all transport interfaces that are used for log transport
        to detect if data is sent with weak or no encryption.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Command Execution
      detects: Monitor all command executions to check whether a SPAN port was started
        on the log transport network element.
      fgdsid: FGDS0017.001
      name: Command
    - component: Process/Event Alarm
      detects: Monitor all operational alerts/events for detecting if an unknown element
        is created on the log transport network.
      fgdsid: FGDS0040.003
      name: Operational Databases
    groups: []
    mitigations:
    - fgmid: FGM1041
      mitigates: Ensure all data sent by the log producer/collector/forwarder on external
        interfaces are protected with strong encryption algorithm.For example, SMO
        forwarding logs to the external server should protect the log data with strong
        encryption algorithm.
      name: Encrypt Sensitive Information
    - fgmid: FGM1047
      mitigates: When a new SPAN port or an unknown network element is detected on
        the log transport network, raise an alarm to SOC to identify and block the
        SPAN port or the element.
      name: Audit
    name: "## Addendum Name: Interception Of Local Logs Transport\r\n### Architecture\
      \ Segments: O-RAN, RAN\r\n Adversaries may intercept exports of local logs on\
      \ unsecured external interface to extract sensitive information.\r\n\r\nAdversaries\
      \ may gain access to the transport interface to intercept data in transit as\
      \ logs are transferred. For example, logs from the SMO or other O-RAN components\
      \ to a remote server/external entity are transported via external interfaces.\
      \ If the logs are transported unencrypted, adversaries may eavesdrop on logs\
      \ sent to the external server.\r\n\r\nNote: The same interface may be used for\
      \ transporting other types of data such as AI/ML enrichment information and\
      \ analytics data. Log data can be filtered from the mix of various types of\
      \ data."
    platforms:
    - RAN
    - O-CLOUD
    - O-RAN nodes
    - O-RAN transport
    - core
    preconditions:
    - description: Adversary must have physical access to the devices on transport
        interfaces.
      name: Adversary has access to SMO external interfaces
    procedureexamples:
    - description: If logs collected by SMO are sent on the external interface with
        weak or no encryption, an adversary positioned as AiTM may intercept the log
        data in transit. The log data may contain sensitive information about subscribers
        and/or about network. Refer T-SMO-16 of [2].A follow-on activity may be done
        similar to the ATT&CK technique T1020 "Automated Exfiltration" by exfiltrating
        the collected data to a malicious server which is controlled by adversary.
      name: Eavesdrop on SMO logs
    references:
    - '<a name="1"> \[1\] </a> [NTIA: "Open RAN Security Report", May 2023.](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)'
    - '<a name="2"> \[2\] </a> [O-RAN Alliance WG11 O-R004-v05.00: "O-RAN Security
      Threat Modeling and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
    software: []
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Sensitive subscriber user plane data will be available to the adversary.
      name: Sensitive subscriber data
    detections:
    - component: O-RAN security configuration logs
      detects: Monitor if security configurations in O-RU and O-DU are downgraded
        to weak or no security levels.
      fgdsid: FGDS5022.001
      name: Security configuration
    - component: Asset inventory
      detects: Monitoring ability to detect new ports, devices on the network
      fgdsid: FGDS0039.001
      name: Asset
    groups: []
    mitigations:
    - fgmid: FGM1041
      mitigates: Ensure fronthaul user plane data is protected with strong encryption
        algorithm. This will have performance impact on devices implementing it.
      name: Encrypt Sensitive Information
    - fgmid: FGM1026
      mitigates: Implement strong access control for all types of interfaces on originating
        switch and any intermediary devices on the fronthaul.
      name: Privileged Account Management
    - fgmid: FGM1030
      mitigates: Implement network segmentation.
      name: Network Segmentation
    - fgmid: FGM1047
      mitigates: Perform hardware and software installation audits of all O-RAN open
        fronthaul components.
      name: Audit
    - fgmid: FGM1034
      mitigates: Limit new hardware installation.
      name: Limit Hardware Installation
    name: "## Addendum Name: Fronthaul\r\n### Architecture Segments: O-RAN\r\n Adversaries\
      \ may sniff network traffic to capture information about fronthaul user plane.\r\
      \n\r\nORAN Alliance has defined the open fronthaul interface which connects\
      \ one O-DU to one or more O-RUs inside the gNB. The fronthaul interface makes\
      \ it possible to distribute the physical layer functionalities between RU and\
      \ DU, and to control RU operations from DU. ORAN Alliance has selected a specific\
      \ configuration (split 7.2x) for splitting of the physical layer among those\
      \ proposed by 3GPP. The lower part of the physical layer (low PHY) resides in\
      \ RU and performs Orthogonal Frequency Division Multiplexing (OFDM) phase compensation,\
      \ inverse FFT and Cyclic Prefix (CP) insertion for frequency-to-time conversion\
      \ in downlink, and FFT and CP removal in uplink. The physical layer in DU (high\
      \ PHY) performs scrambling, modulation, layer mapping, and resource element\
      \ mapping. Fronthaul consists of four types of interfaces: Control or C plane\
      \ is used to carry control plane messages, User or U plane is used to carry\
      \ user plane data, Synchronization or S plane is used to carry timing information\
      \ and Management or M plane is used to carry management data.\r\n\r\nO-RAN fronthaul\
      \ interface needs to implement strict performance requirements which includes\
      \ very high throughput and very low latency. See clause 4.4 of [2]. Some security\
      \ features may not be implemented by MNOs to meet those requirements and to\
      \ reduce processing delay. Hence, Adversary on the Side (AoTS) attack on open\
      \ fronthaul interface is possible which results in passive eavesdropping of\
      \ U plane data. The adversary may use a simple sniffer device to monitor all\
      \ U plane communications which is normally not encrypted at lower 3 layers (RLC,\
      \ MAC and PHY). Confidentiality and integrity protection requirements are not\
      \ specified by ORAN alliance for control, user and synchronization (CUS) planes,\
      \ and those are mandatory for M plane. See clause 6.1 of [2] and clause 5.4\
      \ of [3].\r\n\r\nNote: The user plane data in PDCP and above layers remains\
      \ encrypted on Fronthaul U plane and this eavesdrop attack will not impact any\
      \ of those data unless PDCP security is also broken by the adversary."
    platforms:
    - RAN
    preconditions:
    - description: Adversary must have physical access to open fronthaul network to
        collect data.
      name: Adversary has access to open fronthaul network.
    procedureexamples:
    - description: Adversary launches AoTS attack on open fronthaul U plane data traffic
        by using a simple sniffer device. The fronthaul U plane data usually does
        not have encryption due to stringent performance requirements. Hence an eavesdrop
        attack is possible by a simple device.This attack can only eavesdrop on user
        plane data below PDCP layer. Any user plane data in PDCP and above layers
        are not impacted by this attack. See clause 5.4.1.2, T-UPLANE-01 of [1], clause
        6.1 of [2] and clause 5.4 of [3].
      name: Eavesdrop on U plane data on open fronthaul interface.
    references:
    - <a name="1"> \[1\] </a> [O-RAN Threat Model 6.00 version](https://orandownloadsweb.azurewebsites.net/specifications)
    - <a name="2"> \[2\] </a> [O-RAN WG4 Control, User, and Synchronization Plane
      Specification 12.00 version](https://orandownloadsweb.azurewebsites.net/specifications)
    - <a name="3"> \[3\] </a> [O-RAN WG4 Management Plane Specification 12.00 version](https://orandownloadsweb.azurewebsites.net/specifications)
    software: []
  architecture-segment: User Plane, Control Plane, Roaming, Virtualization, O-RAN,
    RAN
  bluf: Adversaries may sniff network traffic to capture information about an environment,
    including authentication material passed over the network.
  campaigns: []
  criticalassets:
  - description: User signaling such as authentication data, user location on the
      N32 interface.
    name: Control plane
  - description: User plane data on the N9 interface.
    name: User plane
  - description: Signaling data, provisioning data, service discovery
    name: Control plane
  description: 'Adversaries may sniff network traffic to capture information about
    an environment, including authentication material passed over the network. Network
    sniffing refers to using the network interface on a system to monitor or capture
    information sent over a wired or wireless connection. An adversary may place a
    network interface into promiscuous mode to passively access data in transit over
    the network, or use span ports to capture a larger amount of data. Data captured
    via this technique may include user credentials, especially those sent over an
    insecure, unencrypted protocol. Techniques for name service resolution poisoning,
    such as [LLMNR/NBT-NS Poisoning and SMB Relay](https://attack.mitre.org/techniques/T1557/001),
    can also be used to capture credentials to websites, proxies, and internal systems
    by redirecting traffic to an adversary. Network sniffing may also reveal configuration
    details, such as running services, version numbers, and other network characteristics
    (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement
    and/or Defense Evasion activities. In cloud-based environments, adversaries may
    still be able to use traffic mirroring services to sniff network traffic from
    virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and
    Azure vTap allow users to define specified instances to collect traffic from and
    specified targets to send collected traffic to.(Citation: AWS Traffic Mirroring)(Citation:
    GCP Packet Mirroring)(Citation: Azure Virtual Network TAP) Often, much of this
    traffic will be in cleartext due to the use of TLS termination at the load balancer
    level to reduce the strain of encrypting and decrypting traffic.(Citation: Rhino
    Security Labs AWS VPC Traffic Mirroring)(Citation: SpecterOps AWS Traffic Mirroring)
    The adversary can then use exfiltration techniques such as Transfer Data to Cloud
    Account in order to access the sniffed traffic.(Citation: Rhino Security Labs
    AWS VPC Traffic Mirroring) On network devices, adversaries may perform network
    captures using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008)
    commands such as `monitor capture`.(Citation: US-CERT-TA18-106A)(Citation: capture_embedded_packet_on_software)[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1040)'
  detections:
  - component: Application Log Content
    detects: Monitor for allowed modifications relative to the agreed upon modifications
      per roaming agreements and agreements with IPX.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Process Creation
    detects: Monitor creation of processes which may sniff data.
    fgdsid: FGDS0009.003
    name: Process
  - component: Process Metadata
    detects: Monitor activity of processes which may sniff data.
    fgdsid: FGDS0009.004
    name: Process
  - component: Command Execution
    detects: Monitor commands given to NFs which may help data sniffing.
    fgdsid: FGDS0017.001
    name: Command
  groups:
  - description: LIMINAL PANDA is a China-linked, state-sponsored cyber threat group
      primarily targeting telecommunications providers, with operations dating back
      to at least 2020.
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1040
  mitigations:
  - fgmid: FGM1041
    mitigates: 'Non-SBI: Use encryption (IPSec) on these interfaces. Sections 9.2,
      9.3, 9.4, 9.8, 9.9 of [2], and for N26 interfaces, see 4.3.1. of [3].SBI: Encrypt
      using TLS all links between NFs and between NF and SCP if one is deployed. TLS
      must use certificates for both client and server, and the certificate must include
      the SBA node type and must be checked against what the expectation is for that
      other party. The TLS profile should adhere to those in TS 33.210 [9]. IPSec
      can be optionally used to protect TLS traffic further at a lower layer. Section
      13.1.0 of [2] and also [8], [9].Roaming: For SEPP, see sections 4.2.3.3, 4.3.,
      4.4. of [4], and sections 13.1 and 13.2 of [2].'
    name: Encrypt Sensitive Information
  - fgmid: FGM1054
    mitigates: Ensure for MNO services that serve roaming partners that the minimum
      acceptable configuration is adequate and complies with [2] TS 33.501 clause
      13.2.4.9.
    name: Software Configuration
  - fgmid: FGM1040
    mitigates: Monitor to ensure configurations do not change from acceptable options
    name: Behavior Prevention On Endpoint
  - fgmid: FGM5033
    mitigates: Use zero trust for NF protection
    name: Zero Trust
  - fgmid: FGM1020
    mitigates: Encrypt using TLS all links between NFs and between NF and SCP
    name: SSL/TLS Inspection
  - fgmid: FGM1032
    mitigates: Without Multi-Factor Authentication (MFA), there is a higher risk of
      unauthorized access since passwords alone are insufficient for securing system.
      Malicious actors could then change the configuration of network elements to
      allow for no encryption.
    name: Multi-factor Authentication
  name: Network Sniffing
  object-type: technique
  postconditions:
  - description: Adversary can read sensitive data.
    name: User and control plane data exposed
  preconditions: []
  procedureexamples:
  - description: Adversary with access to the non-SBI interfaces (Xn, N2, N3, N4,
      N9) not using encryption can monitor traffic exchange and obtain UE information
      such as user identifiers, serving network identifiers, and location info. Non-SBI
      interfaces may not be encrypted for at least user plane or for control plane
      packets. See sections D.2.2., L.2.2., L.2.3 of [1]
    name: Non-SBI compromise
  - description: The adversary with access to the SBI links, for example, with control
      over the 5G Service Communication Proxy (SCP) or a network infrastructure node
      (proxy, router, switch), may eavesdrop signaling messages if TLS encryption
      is not enabled. This leads to disclosure of UE authentication and authorization
      information, and NF IP addresses and other topology information. See [6], [7].
    name: SBI node compromise
  - description: 'Adversary positioned on an IPX node can observe UE data if in the
      clear or easily decrypted: If a SEPP has not properly removed clear text information
      elements (IE) when replacing them with encrypted versions consistent with the
      previously negotiated protection policy or if the SEPP used a weak cipher for
      JWE encryption. See section G.2.4 of [1].'
    name: IPX node compromise
  - description: The adversary positioned on a SEPP, can observe information elements
      on the N32c interface including cipher suites used, keys, protection policies
      exchanged, and error messages received from the peer SEPP.  Observations on
      the N32f interface include cell ID and Physical Cell ID, SUPI, NF to NF signaling
      for a given victim UE. An adversary may utilize these observations for a number
      of follow-on techniques.
    name: SEPP compromise
  references:
  - <a name="1"> \[1\] </a> [3GPP TR 33.926 "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes", March 2022](https://www.3gpp.org/DynaReport/33926.htm)
  - <a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP), "Security
    Architecture and Procedures for 5G System", TS 33.501 v16.10.0 Release 16, March
    2022](https://www.3gpp.org/DynaReport/33501.htm)
  - <a name="3"> \[3\] </a> [3GPP TS 23.501 "System architecture for the 5G System
    (5GS)", March 2022](https://www.3gpp.org/DynaReport/23501.htm)
  - <a name="4"> \[4\] </a> [3rd Generation Partnership Project (3GPP), "5G Security
    Assurance Specification (SCAS) for the Security Edge Protection Proxy (SEPP) network
    product class", TS 33.517, ver. 17.0.0, Jun. 2021](https://www.3gpp.org/DynaReport/33517.htm)
  - <a name="5"> \[5\] </a> [G. Green, "5G Security when Roaming - Part 2," Mpirical,
    Lancaster, UK, May 21,2021](https://www.mpirical.com/blog/5g-security-when-roaming-part-2)
  - <a name="6"> \[6\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021](https://arxiv.org/abs/2108.11206)
  - <a name="7"> \[7\] </a> [G. Koien, "On Threats to the 5G Service Based Architecture",
    2021.](https://www.researchgate.net/publication/349455036_On_Threats_to_the_5G_Service_Based_Architecture)
  - <a name="8"> \[8\] </a> ["The Transport Layer Security (TLS) Protocol", Version
    1.2. RFC 5246](https://www.ietf.org/rfc/rfc5246.txt)
  - <a name="9"> \[9\] </a> [3GPP TS 33.210 "Network Domain Security (NDS); IP network
    layer security"](https://www.3gpp.org/DynaReport/33210.htm)
  - <a name="10"> \[10\] </a> [CrowdStrike, "An analysis of LightBasin telecommunications
    attacks".](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks)
  software:
  - description: CordScan was used to capture user data packets in the user plane
      in the core network. [10]
    fgsid: FGS5014
    name: CordScan
  status: Observed
  tactics:
  - TA0007
  - TA0009
  - TA0006
  typecode: attack_technique_addendum
- access-required: None
  architecture-segment: RAN, O-RAN
  bluf: An adversary may eavesdrop on unencrypted subscriber data on the air interface.
  campaigns: []
  criticalassets:
  - description: All user plane data sent by UE over the air can be intercepted in
      the clear.
    name: User plane traffic confidentiality
  - description: All signaling data (not NAS) including measurement reports sent by
      UE over the air can be intercepted in the clear.
    name: Signaling traffic confidentiality
  - description: UE's private information is leaked to the adversary such as which
      websites they are using and the time and day the websites are visited.
    name: UE's application metadata
  description: "An adversary may eavesdrop on unencrypted subscriber data on the air\
    \ interface.\r\n\r\nIf UE security profile in the gNB or SMF is inadvertently\
    \ set to use NULL encryption for both signaling and user plane traffic on the\
    \ radio interface, all such data will be sent in the clear. An adversary may eavesdrop\
    \ on unencrypted signaling and user plane data to discover various information\
    \ about subscriber such as the cell ID of UE's serving cell, received signal strength\
    \ of messages received from the serving gNB, requested network slice ID, internet\
    \ data e.g. email or web browsing data etc.\r\n\r\nLTE layer 2 RLC/MAC metadata\
    \ (e.g. PDCP packet length) may be eavesdropped by adversary on the air interface\
    \ as all layer 2 data below PDCP layer which are always sent without encryption\
    \ in LTE. Once the metadata is collected, an Artificial Intelligence/Machine learning\
    \ (AI/ML) tool can be used to track which websites the UE applications are using\
    \ even though PDCP and higher layer data are encrypted. The adversary must be\
    \ in the same area where the victim UE is located to sniff the downlink air link\
    \ messages sent to UE from gNB. The same attack is possible in 5G as layer 2 protocols\
    \ have not changed in the 5G 3GPP specification."
  detections: []
  groups: []
  id: FGT1040.501
  mitigations:
  - fgmid: FGM5006
    mitigates: Prohibit security profile in the UE or in network to use less secure
      service.
    name: Restrictive User Profile
  - fgmid: FGM1041
    mitigates: Avoid systems that employ null encryption. De-register when only NULL
      encryption is offered.
    name: Encrypt Sensitive Information
  - fgmid: FGM5517
    mitigates: Obfuscation can be done at the application layer to avoid fingerprint
      detection of UE's internet usage. An example of application layer obfuscation
      is to use Orbot as Tor proxy that sends and receives all traffic through a Tor
      circuit. This is not highly effective as some metadata can still be used to
      fingerprint applications.Encryption of metadata such as PDCP length can be done
      to prevent this attack. It introduces large overhead on UE and hence it is not
      proposed in the 3GPP [6].
    name: Use Obfuscation At Application Layer
  name: Radio Interface
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Subscriber data confidentiality is compromised.
    name: Loss of subscriber data confidentiality
  - description: Further attacks are possible on the victim UE based on the data collected,
      e.g. bank fraud or attacks from social media sites.
    name: Further attacks based on UE's internet usage
  preconditions:
  - description: Adversary must be positioned in the same area as the victim UE with
      an airlink message sniffer device to collect the downlink data sent by gNB to
      the UE.
    name: Adversary in the same vicinity as victim UE
  procedureexamples:
  - description: If the 5G network (gNB and/or SMF) employs null encryption for Access
      Stratum (AS) traffic, all subscriber data traffic on air interface (CP & UP)
      can be collected in the clear. Clause 4.4 of [1].
    name: Eavesdrop on air interface for a particular UE or all UEs - NULL encryption
      case
  - description: Adversary collects layer 2 metadata of downlink data sent to the
      victim UE from gNB using an airlink sniffer device. Then it processes the metadata
      using an ML classifier such as k-NN. The classifier can reveal with high accuracy
      which websites are visited by the UE application [5]. It is a passive attack
      and it is possible even when strong encryption and integrity protection are
      used in the Access Stratum (AS).
    name: Passive collection of airlink messages leads to UE application fingerprinting
      - encryption case
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [Hu, X. et al: "A Systematic Analysis Method for 5G Non-Access
    Stratum Signalling Security", August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)'
  - <a name="3"> \[3\] </a> [3GPP TS33.501 "Security architecture and procedures for
    5G System".](https://www.3gpp.org/DynaReport/33501.htm)
  - '<a name="4"> \[4\] </a> [ACM article, Chuan Yu et al: "Improving 4G/5G air interface
    security: A survey of existing attacks on different LTE layers".](https://dl.acm.org/doi/abs/10.1016/j.comnet.2021.108532)'
  - '<a name="5"> \[5\] </a> [ACM article, Katharina Kohls et al: "Lost traffic encryption:
    fingerprinting LTE/4G traffic on layer two".](https://dl.acm.org/doi/10.1145/3317549.3323416)'
  - '<a name="6"> \[6\] </a> [L. Zhai et al: "Identify What You are Doing: Smartphone
    Apps Fingerprinting on Cellular Network Traffic".](https://ieeexplore.ieee.org/document/9631415)'
  software: []
  status: Observed In 4G And Expected To Be Observed In 5G
  subtechnique-of: FGT1040
  tactics:
  - TA0009
  - TA0007
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: RAN, O-RAN
  bluf: Adversary intercepts communications on O-RAN Open Fronthaul interface to sniff
    U Plane data.
  campaigns: []
  criticalassets:
  - description: Subscriber sensitive data will be compromised since the user plane
      is not secured.
    name: UEs and UPF
  description: "Adversary intercepts communications on O-RAN Open Fronthaul interface\
    \ to sniff U Plane data.\r\n\r\nAn adversary may eavesdrop on the O-RAN open FH\
    \ U-plane by intercepting unencrypted or weakly protected traffic between the\
    \ O-RU and O-DU. Since this interface may transmit subscriber data (e.g., voice,\
    \ video, messages) over standard Ethernet without strong encryption, a malicious\
    \ actor with access to the transport network could use packet-sniffing tools to\
    \ capture and reconstruct sensitive payloads-especially if IPsec or other link-layer\
    \ protections are misconfigured or absent.\r\n\r\nO-RAN fronthaul interface needs\
    \ to implement strict performance requirements which includes very high throughput\
    \ and very low latency. See clause 4.4 of [2]. Hence some security features may\
    \ not be implemented to meet those requirements. AiTM attack on open fronthaul\
    \ interface is possible which results in eavesdrop of U plane (user plane) data.\
    \ Confidentiality, integrity, authentication/authorization requirements are optional\
    \ for control, user and synchronization (CUS) planes, and mandatory for management\
    \ (M) plane. See clause 6.1 of [2] and clause 5.4 of [3]."
  detections:
  - component: Process Access
    detects: Monitor for instances where one process opens another process, particularly
      with the intent to read the memory of the target process.
    fgdsid: FGDS0009.002
    name: Process
  - component: Security logs in core
    detects: Logs for security, authentication and authorization, host access (physical
      and virtual) etc.
    fgdsid: FGDS5012.001
    name: Security logs in network
  - component: Asset inventory
    detects: Track and analyze the presence and behavior of devices on the network
      by maintaining an inventory of current and expected devices. This inventory
      should include key attributes such as manufacturer, model, IP addresses, hardware
      (MAC) addresses, and other unique identifiers.
    fgdsid: FGDS0039.001
    name: Asset
  - component: O-RAN security configuration logs
    detects: 'Security configuration log: Monitor whether security configurations
      in O-RU and O-DU are downgraded to weak or no security levels.'
    fgdsid: FGDS5022.001
    name: Security configuration
  groups: []
  id: FGT1040.502
  mitigations:
  - fgmid: FGM5024
    mitigates: Ensure fronthaul user plane data is protected with integrity protection.
      This will have performance impact on devices which implement integrity protection.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1030
    mitigates: Architect the FH to isolate critical systems, functions, or resources.
      Use physical and logical segmentation to prevent access to potentially sensitive
      information.
    name: Network Segmentation
  - fgmid: FGM1041
    mitigates: Use encryption with only strong cipher suites.
    name: Encrypt Sensitive Information
  name: Eavesdrop On O-RAN U Plane Data
  object-type: technique
  platforms: O-RAN Open Fronthaul
  postconditions:
  - description: An AiTM is able to listen/monitor in on the subscriber user plane
      traffic.
    name: Eavesdropping
  preconditions:
  - description: Unauthorized access to devices on open FH interface.
    name: Subscriber sensitive data
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [A. S. Abdalla, A. S., & V. Marojevic: "End-to-end O-RAN
    security architecture, threat surface, coverage, and the case of the open fronthaul",
    2020](https://arxiv.org/pdf/2304.05513)'
  - <a name="2"> \[2\] </a> [O-RAN Alliance, "O-RAN.WG11.TS.SecReqSpecs.0-R004.v11.00",
    2025.](https://specifications.o-ran.org/download?id=843)
  - <a name="3"> \[3\] </a> [O-RAN Alliance, "O-RAN.WG11.TR.Threat-Modeling.O-R004.v05.00",
    2025.](https://specifications.o-ran.org/download?id=846)
  - <a name="4"> \[4\] </a> [O-RAN Alliance, "O-RAN.WG4.TS.CUS.0-R004-v17.01", 2025.](https://specifications.o-ran.org/download?id=856)
  - <a name="5"> \[5\] </a> [O-RAN Alliance, "O-RAN.WG4.TS.MP.0-R004-v17.01", 2025.](https://specifications.o-ran.org/download?id=857)
  software: []
  status: Theoretical
  subtechnique-of: FGT1040
  tactics:
  - TA0007
  - TA0009
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: None
    campaigns: []
    criticalassets: []
    detections:
    - component: Core network packet captures (pcaps)
      detects: Inspect all incoming signaling packet payloads for any abnormal encrypted
        communications.
      fgdsid: FGDS5016.001
      name: Packet capture for user plane packets
    - component: Network Traffic Content
      detects: Monitor all incoming and outgoing network traffic over roaming interfaces
        for any unauthorized activities.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups:
    - description: Liminal Panda (formerly LightBasin) exfiltrated data (collected
        data in a MNO's roaming partner host machine) over a C2 channel using SIGTRAN
        protocol data format, as well as GTP-U and DNS ([1], [2]).
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1037
      mitigates: Use a firewall and/or rate limiter for all incoming signaling traffic
        to 5G network especially over the roaming interfaces such as N32 and N9.
      name: Filter Network Traffic
    - fgmid: FGM1031
      mitigates: Use Network Intrusion Prevention methods.
      name: Network Intrusion Prevention
    name: "## Addendum Name: Telecom Protocol\r\n### Architecture Segments: Control\
      \ Plane, Roaming\r\n Adversaries may exfiltrate subscriber data by embedding\
      \ it in a telecommunications protocol also used for C2 (for example GTP, SIGTRAN\
      \ or external DNS protocol).\r\n\r\nAn adversary may hide the subscriber data\
      \ they collected within protocols that they are already using for C2. These\
      \ are: GTP, SIGTRAN, and eDNS requests/responses. The adversary exploits these\
      \ telecommunications signaling protocols by establishing a communication channel\
      \ from the compromised host to a server they control and using them to exfiltrate\
      \ the collected data.\r\n\r\nBackground information: SIGTRAN is a signaling\
      \ protocol which is used to carry Public Switched Telephone Network (PSTN) (i.e.\
      \ early generation communications such as SS7) signaling data over IP networks."
    platforms:
    - 5G core platform
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
      Look at China''s Cyber Threats to the Telecom Sector", updated November 19,
      2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
    software:
    - description: SIGTRANslator can be used to send and receive data over the SS7
        (SIGTRAN) protocol. This tool encrypts using a pre-defined XOR key further
        hiding adversary activities.
      fgsid: FGS5005
      name: SIGTRANslator
  architecture-segment: Control Plane, Roaming
  bluf: Adversaries may steal data by exfiltrating it over an existing command and
    control channel.
  campaigns: []
  criticalassets: []
  description: Adversaries may steal data by exfiltrating it over an existing command
    and control channel. Stolen data is encoded into the normal communications channel
    using the same protocol as command and control communications.[To read more, please
    see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1041)
  detections:
  - component: Core network packet captures (pcaps)
    detects: Inspect all incoming signaling packet payloads for any abnormal encrypted
      communications.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  - component: Network Traffic Content
    detects: Monitor all incoming and outgoing network traffic over roaming interfaces
      for any unauthorized activities.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: Liminal Panda (formerly LightBasin) exfiltrated data (collected data
      in a MNO's roaming partner host machine) over a C2 channel using SIGTRAN protocol
      data format, as well as GTP-U and DNS ([1], [2]).
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1041
  mitigations:
  - fgmid: FGM1037
    mitigates: Use a firewall and/or rate limiter for all incoming signaling traffic
      to 5G network especially over the roaming interfaces such as N32 and N9.
    name: Filter Network Traffic
  - fgmid: FGM1031
    mitigates: Use Network Intrusion Prevention methods.
    name: Network Intrusion Prevention
  name: Exfiltration Over C2 Channel
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software:
  - description: SIGTRANslator can be used to send and receive data over the SS7 (SIGTRAN)
      protocol. This tool encrypts using a pre-defined XOR key further hiding adversary
      activities.
    fgsid: FGS5005
    name: SIGTRANslator
  status: Observed
  tactics:
  - TA0010
  typecode: attack_technique_addendum
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: 5G services offered by MNO.
      name: MNO core network services
    - description: Network management, monitoring and OA&M services.
      name: MNO IT services
    detections:
    - component: Network Connection Creation
      detects: Monitor for newly constructed network connections associated with pings/scans
        that may attempt to get a listing of other systems by IP address, hostname,
        or other logical identifier on a network.
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Flow
      detects: Monitor network traffic flows at network firewalls to detect abnormal
        patterns such as unusual port scanning activities from a single host.
      fgdsid: FGDS0029.003
      name: Network Traffic
    - component: Cloud Service Enumeration
      detects: Monitor cloud service usage patterns for abnormal activities. For example,
        a process may scan all cloud services running in a host.
      fgdsid: FGDS0025.002
      name: Cloud Service
    - component: Command Execution
      detects: Monitor the commands and arguments executed in MNO hosts which try
        to get a listing of services running in the system.
      fgdsid: FGDS0017.001
      name: Command
    groups: []
    mitigations:
    - fgmid: FGM1042
      mitigates: Ensure that only required ports and services are open to prevent
        risk of discovery and potential exploitation.
      name: Disable Or Remove Feature Or Program
    - fgmid: FGM1031
      mitigates: Use network intrusion detection/prevention systems to detect and
        prevent remote service scans.
      name: Network Intrusion Prevention
    - fgmid: FGM1030
      mitigates: Ensure proper network segmentation is followed to protect critical
        servers and devices.
      name: Network Segmentation
    name: "## Addendum Name: Core-network Scanning\r\n### Architecture Segments: User\
      \ Plane, Control Plane\r\n Adversaries may scan operator network to discover\
      \ network services.\r\n\r\nAdversaries may attempt to get a listing of MNO network\
      \ services by using open-source and other commercial scanning tools. The tools\
      \ can scan open ports of hosts that do not use IP address and hostname, but\
      \ instead, other identifiers, such as point codes (like IP addresses for SS7,\
      \ point to point) and Global Titles. Some examples of scanning tools: GTScan,\
      \ SigPloit, SCTPScan can be used on 2G and 3G networks which use SS7 protocols\
      \ for roaming. GTPScan can be used on 2G/3G/4G/5G networks which use GTP based\
      \ GRX interconnect. MNO's network services include enhanced mobile broadband\
      \ (eMBB), Ultra reliable low latency communication (URLLC), Internet of Things\
      \ (IoT), Vehicle to everything (V2X) etc."
    platforms:
    - 5G core
    - interconnect
    preconditions:
    - description: Adversaries need access to open-source or commercial tools.
      name: Access to scanning tools
    procedureexamples:
    - description: Adversaries may employ pen testing tools such as GTScan, SigPloit
        and SCTPScan in 2G and 3G networks to scan for network services in remote
        hosts. [1,2,4]
      name: Use of pen testing tools in legacy networks.
    - description: Adversaries may employ pen testing tools such as GTPScan in 2G/3G/4G/5G
        networks to scan for network services in remote hosts. [1,3]
      name: Use of pen testing tools in legacy and 5G networks.
    references:
    - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling
      framework for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
    - '<a name="2"> \[2\] </a> [P1 Security whitepaper: "Worldwide attacks on SS7/SIGTRAN
      networks".](https://www.p1sec.com/white-paper/worldwide-attacks-on-ss7-sigtran-network)'
    - '<a name="3"> \[3\] </a> [P1 Security whitepaper: "Attacking GRX - GPRS Roaming
      eXchange".](https://www.p1sec.com/white-paper/attacking-grx-gprs-roaming-exchange)'
    - '<a name="4"> \[4\] </a> [Loay Abdelrazek, Marianne Azer, 2018 Tenth International
      Conference on Ubiquitous and Future Networks (ICUFN). IEEE, 481-486: "Sigploit:
      A New Signaling Exploitation Framework".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8436820)'
    software: []
  architecture-segment: User Plane, Control Plane
  bluf: Adversaries may attempt to get a listing of services running on remote hosts
    and local network infrastructure devices, including those that may be vulnerable
    to remote software exploitation.
  campaigns: []
  criticalassets:
  - description: 5G services offered by MNO.
    name: MNO core network services
  - description: Network management, monitoring and OA&M services.
    name: MNO IT services
  description: 'Adversaries may attempt to get a listing of services running on remote
    hosts and local network infrastructure devices, including those that may be vulnerable
    to remote software exploitation. Common methods to acquire this information include
    port and/or vulnerability scans using tools that are brought onto a system.(Citation:
    CISA AR21-126A FIVEHANDS May 2021) Within cloud environments, adversaries may
    attempt to discover services running on other cloud hosts. Additionally, if the
    cloud environment is connected to a on-premises environment, adversaries may be
    able to identify services running on non-cloud systems as well. Within macOS environments,
    adversaries may use the native Bonjour application to discover services running
    on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically
    registers and advertises a host''s registered services on the network. For example,
    adversaries can use a mDNS query (such as <code>dns-sd -B _ssh._tcp .</code>)
    to find other systems broadcasting the ssh service.(Citation: apple doco bonjour
    description)(Citation: macOS APT Activity Bradley)[To read more, please see the
    MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1046)'
  detections:
  - component: Network Connection Creation
    detects: Monitor for newly constructed network connections associated with pings/scans
      that may attempt to get a listing of other systems by IP address, hostname,
      or other logical identifier on a network.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Monitor network traffic flows at network firewalls to detect abnormal
      patterns such as unusual port scanning activities from a single host.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: Cloud Service Enumeration
    detects: Monitor cloud service usage patterns for abnormal activities. For example,
      a process may scan all cloud services running in a host.
    fgdsid: FGDS0025.002
    name: Cloud Service
  - component: Command Execution
    detects: Monitor the commands and arguments executed in MNO hosts which try to
      get a listing of services running in the system.
    fgdsid: FGDS0017.001
    name: Command
  groups: []
  id: FGT1046
  mitigations:
  - fgmid: FGM1042
    mitigates: Ensure that only required ports and services are open to prevent risk
      of discovery and potential exploitation.
    name: Disable Or Remove Feature Or Program
  - fgmid: FGM1031
    mitigates: Use network intrusion detection/prevention systems to detect and prevent
      remote service scans.
    name: Network Intrusion Prevention
  - fgmid: FGM1030
    mitigates: Ensure proper network segmentation is followed to protect critical
      servers and devices.
    name: Network Segmentation
  name: Network Service Discovery
  object-type: technique
  postconditions:
  - description: Adversary now knows services offered by MNO in some network nodes,
      and so these nodes can now be spoofed or targeted for Denial of Service.
    name: Services of some network nodes revealed to the adversary.
  preconditions:
  - description: Adversaries need access to open-source or commercial tools.
    name: Access to scanning tools
  procedureexamples:
  - description: Adversaries may employ pen testing tools such as GTScan, SigPloit
      and SCTPScan in 2G and 3G networks to scan for network services in remote hosts.
      [1,2,4]
    name: Use of pen testing tools in legacy networks.
  - description: Adversaries may employ pen testing tools such as GTPScan in 2G/3G/4G/5G
      networks to scan for network services in remote hosts. [1,3]
    name: Use of pen testing tools in legacy and 5G networks.
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
  - '<a name="2"> \[2\] </a> [P1 Security whitepaper: "Worldwide attacks on SS7/SIGTRAN
    networks".](https://www.p1sec.com/white-paper/worldwide-attacks-on-ss7-sigtran-network)'
  - '<a name="3"> \[3\] </a> [P1 Security whitepaper: "Attacking GRX - GPRS Roaming
    eXchange".](https://www.p1sec.com/white-paper/attacking-grx-gprs-roaming-exchange)'
  - '<a name="4"> \[4\] </a> [Loay Abdelrazek, Marianne Azer, 2018 Tenth International
    Conference on Ubiquitous and Future Networks (ICUFN). IEEE, 481-486: "Sigploit:
    A New Signaling Exploitation Framework".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8436820)'
  software: []
  status: Observed
  tactics:
  - TA0007
  - TA0043
  typecode: attack_technique_addendum
- architecture-segment: User Plane
  bluf: An adversary may perform network scanning to fingerprint network protocol
    by using CordScan.
  campaigns: []
  criticalassets:
  - description: Fingerprinting and retrieving protocol data.
    name: Protocol Data
  - description: Targeting network infrastructure such as core network functions and
      MNO services.
    name: Core network
  description: "An adversary may perform network scanning to fingerprint network protocol\
    \ by using CordScan.\r\n\r\nAdversary utilizes CordScan which is a network-scanning\
    \ and packet-capture utility containing logic to fingerprint and retrieve data\
    \ relating to common telecommunication protocols. This process helps identify\
    \ active devices, open ports, and fingerprint network protocol and services."
  detections:
  - component: Network Connection Creation
    detects: Detect port scanners. Initial establishment of a network connection,
      typically involving the capture of socket information, including source and
      destination IP addresses, port numbers, and protocol details.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Log network traffic data showing both protocol header and body values
      (ex: PCAP) to detect unusual traffic payload.'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarize network flows, with metrics, such as protocol headers and
      volume (ex: Netflow or Zeek http.log) to detect unusual traffic flows.'
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: Response Metadata
    detects: Information gathered through active network traffic analysis or DNS query
      probing to identify and map various types of resources, servers, and DNS configurations
      connected to the public Internet within the telecom network infrastructure.
    fgdsid: FGDS0035.002
    name: Internet Scan
  groups:
  - description: Liminal Panda has been observed to leverage CORDSCAN to capture packets,
      thus enabling them to extract sensitive subscriber data (e.g., traffic patterns
      and subscriber location information). [1], [2]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1046.501
  mitigations:
  - fgmid: FGM1030
    mitigates: Ensure proper network segmentation is followed to protect critical
      servers and devices.
    name: Network Segmentation
  - fgmid: FGM1031
    mitigates: Use network intrusion detection/prevention systems to detect and prevent
      remote service scans.
    name: Network Intrusion Prevention
  - fgmid: FGM1042
    mitigates: Ensure that unnecessary ports and services are closed to prevent risk
      of discovery and potential exploitation.
    name: Disable Or Remove Feature Or Program
  - fgmid: FGM5501
    mitigates: Operator should deploy TLS proxies or firewalls on the SBA that can
      inspect packets to detect anomalies.
    name: TLS Proxy/Firewalls With DPI On The SBA
  name: Protocol Fingerprinting
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: Adversary has access to network services exposed by network protocol
      data.
    name: Exposed Protocol Data
  - description: Adversary successfully compromised core network elements such as
      SGSN.
    name: Compromised network functions
  preconditions:
  - description: Adversaries need access to such tools.
    name: Access to scanning tool
  - description: In the case of LightBasin, adversaries gained access by exploiting
      vulnerabilities in external-facing systems and using custom tools to connect
      to telecommunications infrastructure.
    name: Initial Access to the Target Network
  - description: In LightBasin, adversaries demonstrated knowledge of telecommunications
      protocols like GPRS Tunneling Protocol (GTP) and Signaling System No. 7 (SS7),
      which are critical for scanning and lateral movement within telecom networks.
    name: Understanding of the Target Environment
  - description: LightBasin used custom scanning tools tailored to telecom environments,
      allowing them to map network assets and identify weaknesses.
    name: Deployment of custom Malware
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike: "LIMINAL PANDA: A Roaming Threat to Telecommunications
    Companies", November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks.)'
  - '<a name="2"> \[2\] </a> [CrowdStrike: "Unveiling LIMINAL PANDA: A Closer Look
    at China''s Cyber Threats to the Telecom Sector", November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software:
  - description: Liminal Panda leveraged CordScan to map networks and collect packet
      data related to common telecommunication systems, such as SGSN. This included
      analyzing mobile station transmissions and identifying location information
      of registered GPRS users. [1], [2]
    fgsid: FGS5014
    name: CordScan
  status: Observed
  subtechnique-of: FGT1046
  tactics:
  - TA0007
  - TA0043
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: NF Service Account
    campaigns: []
    criticalassets:
    - description: Sensitive information in subscriber signaling data
      name: User authentication /authorization data
    - description: 'Operator resource identifiers: Core NF identifiers (e.g. IP address,
        FQDN) such as AMF, SMF, UDM etc.'
      name: MNO system data
    detections:
    - component: Network Connection Creation
      detects: Monitor and analyze new connections over the SBI, especially to/from
        external functions.
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: Monitor and analyze traffic patterns and perform packet inspection
        over the SBI, especially to/from external functions.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1037
      mitigates: Filter and inspect network traffic coming out of SEPP and NEF
      name: Filter Network Traffic
    name: "## Addendum Name: Control Plane Signaling Exfiltration\r\n### Architecture\
      \ Segments: Control Plane, Roaming\r\n An adversary may use Control Plane signaling\
      \ between operator-internal Network Functions and externally-facing NFs or proxies\
      \ to exfiltrate data to external endpoints.\r\n\r\nThe operator network uses\
      \ edge functions that communicate to external parties: The Network Exposure\
      \ Function (NEF) communicates with external Application Functions (AF), and\
      \ the Security Edge Protection Proxy (SEPP) communicates with nodes on the IP\
      \ Interchange (roaming/interconnect fabric). This type of channel can be used\
      \ by an adversary to exfiltrate data originating at a compromised NF inside\
      \ the operator network and ending up at the external node (AF, IPX node). For\
      \ example, HTTP/2 optional parameters may be used to communicate between a core\
      \ NF and an external server via NEF or SEPP."
    platforms:
    - 5G Core
    preconditions:
    - description: Adversary has obtained access to a core NF.
      name: Core NF take over
    procedureexamples:
    - description: HTTP/2 optional parameters may be used to communicate between a
        core NF and an external server (AF, IPX node) via NEF or SEPP.
      name: HTTP/2 optional parameters
    references: []
    software: []
  architecture-segment: Control Plane, Roaming
  bluf: Adversaries may steal data by exfiltrating it over a different protocol than
    that of the existing command and control channel.
  campaigns: []
  criticalassets:
  - description: Sensitive information in subscriber signaling data
    name: User authentication /authorization data
  - description: 'Operator resource identifiers: Core NF identifiers (e.g. IP address,
      FQDN) such as AMF, SMF, UDM etc.'
    name: MNO system data
  description: 'Adversaries may steal data by exfiltrating it over a different protocol
    than that of the existing command and control channel. The data may also be sent
    to an alternate network location from the main command and control server. Alternate
    protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not
    being used as the main command and control channel. Adversaries may also opt to
    encrypt and/or obfuscate these alternate channels. [Exfiltration Over Alternative
    Protocol](https://attack.mitre.org/techniques/T1048) can be done using various
    common operating system utilities such as [Net](https://attack.mitre.org/software/S0039)/SMB
    or FTP.(Citation: Palo Alto OilRig Oct 2016) On macOS and Linux <code>curl</code>
    may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from
    a system.(Citation: 20 macOS Common Tools and Techniques) Many IaaS and SaaS platforms
    (such as Microsoft Exchange, Microsoft SharePoint, GitHub, and AWS S3) support
    the direct download of files, emails, source code, and other sensitive information
    via the web console or [Cloud API](https://attack.mitre.org/techniques/T1059/009).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1048)'
  detections:
  - component: Network Connection Creation
    detects: Monitor and analyze new connections over the SBI, especially to/from
      external functions.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: Monitor and analyze traffic patterns and perform packet inspection over
      the SBI, especially to/from external functions.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1048
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter and inspect network traffic coming out of SEPP and NEF
    name: Filter Network Traffic
  name: Exfiltration Over Alternative Protocol
  object-type: technique
  postconditions: []
  preconditions:
  - description: Adversary has obtained access to a core NF.
    name: Core NF take over
  procedureexamples:
  - description: HTTP/2 optional parameters may be used to communicate between a core
      NF and an external server (AF, IPX node) via NEF or SEPP.
    name: HTTP/2 optional parameters
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0010
  - TA0011
  typecode: attack_technique_addendum
- addendums:
  - access-required: NF
    campaigns: []
    criticalassets:
    - description: DNS service is compromised.
      name: DNS server
    - description: User plane data may be exfiltrated this way.
      name: User plane
    - description: Control plane data may be exfiltrated this way
      name: Control plane
    - description: The service for providing data pipes to the users may have their
        confidentiality compromised
      name: Data services
    detections:
    - component: Command Execution
      detects: Monitor executed commands and arguments that may steal data by exfiltrating
        it over DNS request
      fgdsid: FGDS0017.001
      name: Command
    - component: Network Connection Creation
      detects: Analyze network destinations for DNS traffic for unusual destinations.
        The configuration of DNS Resolvers is important to ensure the ability to monitor
        DNS queries for adversary behavior.
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: Monitor and analyze traffic patterns and apply DNS packet inspection
        to look for data that does not follow the expected protocol standards and
        traffic flow.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: Analyze network destinations for DNS traffic for unusual volumes.
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1037
      mitigates: Filter public network lookups to limit exfiltration destinations.
        Potential use of protective DNS services.
      name: Filter Network Traffic
    - fgmid: FGM1031
      mitigates: "Network intrusion detection and prevention systems that use network\
        \ signatures to identify traffic for specific adversary malware can be used\
        \ to mitigate activity at the network level. Signatures are often for unique\
        \ indicators within protocols and may be based on the specific obfuscation\
        \ technique used by a particular adversary or tool and will likely be different\
        \ across various malware families and versions. Adversaries will likely change\
        \ tool command and control signatures over time or construct protocols in\
        \ such a way to avoid detection by common defensive tools.\_Scan all external\
        \ traffic header fields to detect any suspicious protocol or port number use."
      name: Network Intrusion Prevention
    name: "## Addendum Name: DNS Queries\r\n### Architecture Segments: Control Plane,\
      \ Roaming\r\n Adversaries may steal data from an MNO by sending it over allowed\
      \ DNS requests to DNS servers outside the MNO domain.\r\n\r\nAn adversary may\
      \ be able to move data by simply encoding data as a hostname query. Adversaries\
      \ may opt to obfuscate this exfiltrated data within the constraints of DNS record\
      \ types. The adversary may also use custom or publicly available encoding/compression\
      \ algorithms (such as base64). The data may be embedded within protocol headers\
      \ and fields, e.g. in the names section of a DNS lookup. \r\n\r\nThe receiving\
      \ DNS server, controlled by the adversary, logs the query and decodes the data,\
      \ reassembles in the planned sequence from the named field. The reply to the\
      \ query may or may not be sent. If the query is sent, it may be ignored by the\
      \ compromised host.\r\n\r\nThe data may be sent to an alternate network location\
      \ from that used for command and control. The exfiltrated data is not C2 data\
      \ but user/system data such as identifiers, files, credentials, etc."
    platforms:
    - 5G Core
    - 5G transport
    preconditions:
    - description: Operator environment must permit DNS queries either directly or
        recursively for domains the operator doesn't directly control.
      name: External DNS Resolution
    - description: There must not be an endpoint detection and response capability
        to validate whether host/network function/UE is communicating with a malicious
        DNS server or a valid one.
      name: Unauthenticated DNS Services
    procedureexamples:
    - description: Operators do not strictly enforce flow monitoring for free DNS
        service via the standard five-tuple flow ID (source IP, destination IP, source
        port, destination port, protocol). Instead, they use only the destination
        port (or plus protocol ID), thus exposing a vulnerability.Adversary may setup
        fake DNS server to receive exfiltrated data.Adversarial activity could be
        from a person who has remote access or a worm collecting and transmitting
        protected information. [2]
      name: Free DNS loophole
    references:
    - '<a name="1"> \[1\] </a> ["Bhadhra Framework": S.P. Rao, S. Holtmanns, T. Aura,
      "Threat modeling framework for mobile communication systems"](https://arxiv.org/pdf/2005.05110.pdf)'
    - '<a name="2"> \[2\] </a> [Peng, C., Li, C., Tu, G., Lu, S., & Zhang, L. (2012).
      "Mobile data charging: new attacks and countermeasures". Proceedings of the
      2012 ACM conference on Computer and communications security.](https://dl.acm.org/doi/pdf/10.1145/2382196.2382220)'
    - '<a name="3"> \[3\] </a> [Merve Sahin, Aurelien Francillon, Payas Gupta, and
      Mustaque Ahamad.. "Sok: Fraud in telephony networks". In 2017 IEEE European
      Symposium on Security and Privacy (EuroS&P). IEEE, p235-250](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7961983&tag=1)'
    - <a name="4"> \[4\] </a> [Kui Xu, Patrick Butler, Sudip Saha, Danfeng (Daphni)
      Yao in DNS CC Journal, "DNS for Massive-Scale Command and Control"](https://people.cs.vt.edu/~danfeng/papers/DNS-CC-JOURNAL.pdf)
    - <a name="5"> \[5\] </a> [Infoblox website, "DNS Data exfiltration leverages
      DNS tunneling"](https://www.infoblox.com/dns-security-resource-center/dns-security-issues-threats/dns-security-threats-data-exfiltration/)
    software: []
  architecture-segment: Control Plane, Roaming
  bluf: Adversaries may steal data by exfiltrating it over an un-encrypted network
    protocol other than that of the existing command and control channel.
  campaigns: []
  criticalassets:
  - description: DNS service is compromised.
    name: DNS server
  - description: User plane data may be exfiltrated this way.
    name: User plane
  - description: Control plane data may be exfiltrated this way
    name: Control plane
  - description: The service for providing data pipes to the users may have their
      confidentiality compromised
    name: Data services
  description: 'Adversaries may steal data by exfiltrating it over an un-encrypted
    network protocol other than that of the existing command and control channel.
    The data may also be sent to an alternate network location from the main command
    and control server.(Citation: copy_cmd_cisco) Adversaries may opt to obfuscate
    this data, without the use of encryption, within network protocols that are natively
    unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available
    encoding/compression algorithms (such as base64) as well as embedding data within
    protocol headers and fields.[To read more, please see the MITRE ATT&CK page for
    this subtechnique](https://attack.mitre.org/techniques/T1048/003)'
  detections:
  - component: Command Execution
    detects: Monitor executed commands and arguments that may steal data by exfiltrating
      it over DNS request
    fgdsid: FGDS0017.001
    name: Command
  - component: Network Connection Creation
    detects: Analyze network destinations for DNS traffic for unusual destinations.
      The configuration of DNS Resolvers is important to ensure the ability to monitor
      DNS queries for adversary behavior.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: Monitor and analyze traffic patterns and apply DNS packet inspection
      to look for data that does not follow the expected protocol standards and traffic
      flow.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Analyze network destinations for DNS traffic for unusual volumes.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1048.003
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter public network lookups to limit exfiltration destinations. Potential
      use of protective DNS services.
    name: Filter Network Traffic
  - fgmid: FGM1031
    mitigates: "Network intrusion detection and prevention systems that use network\
      \ signatures to identify traffic for specific adversary malware can be used\
      \ to mitigate activity at the network level. Signatures are often for unique\
      \ indicators within protocols and may be based on the specific obfuscation technique\
      \ used by a particular adversary or tool and will likely be different across\
      \ various malware families and versions. Adversaries will likely change tool\
      \ command and control signatures over time or construct protocols in such a\
      \ way to avoid detection by common defensive tools.\_Scan all external traffic\
      \ header fields to detect any suspicious protocol or port number use."
    name: Network Intrusion Prevention
  name: Exfiltration Over Unencrypted Non-C2 Protocol
  object-type: technique
  postconditions:
  - description: Adversary has a route to exfiltrate stolen data disguised as DNS
      packets.
    name: Exfiltration Route
  - description: Adversary has access to user data such as identifiers, files, user
      credentials, other types of data.
    name: User/System data
  preconditions:
  - description: Operator environment must permit DNS queries either directly or recursively
      for domains the operator doesn't directly control.
    name: External DNS Resolution
  - description: There must not be an endpoint detection and response capability to
      validate whether host/network function/UE is communicating with a malicious
      DNS server or a valid one.
    name: Unauthenticated DNS Services
  procedureexamples:
  - description: Operators do not strictly enforce flow monitoring for free DNS service
      via the standard five-tuple flow ID (source IP, destination IP, source port,
      destination port, protocol). Instead, they use only the destination port (or
      plus protocol ID), thus exposing a vulnerability.Adversary may setup fake DNS
      server to receive exfiltrated data.Adversarial activity could be from a person
      who has remote access or a worm collecting and transmitting protected information.
      [2]
    name: Free DNS loophole
  references:
  - '<a name="1"> \[1\] </a> ["Bhadhra Framework": S.P. Rao, S. Holtmanns, T. Aura,
    "Threat modeling framework for mobile communication systems"](https://arxiv.org/pdf/2005.05110.pdf)'
  - '<a name="2"> \[2\] </a> [Peng, C., Li, C., Tu, G., Lu, S., & Zhang, L. (2012).
    "Mobile data charging: new attacks and countermeasures". Proceedings of the 2012
    ACM conference on Computer and communications security.](https://dl.acm.org/doi/pdf/10.1145/2382196.2382220)'
  - '<a name="3"> \[3\] </a> [Merve Sahin, Aurelien Francillon, Payas Gupta, and Mustaque
    Ahamad.. "Sok: Fraud in telephony networks". In 2017 IEEE European Symposium on
    Security and Privacy (EuroS&P). IEEE, p235-250](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7961983&tag=1)'
  - <a name="4"> \[4\] </a> [Kui Xu, Patrick Butler, Sudip Saha, Danfeng (Daphni)
    Yao in DNS CC Journal, "DNS for Massive-Scale Command and Control"](https://people.cs.vt.edu/~danfeng/papers/DNS-CC-JOURNAL.pdf)
  - <a name="5"> \[5\] </a> [Infoblox website, "DNS Data exfiltration leverages DNS
    tunneling"](https://www.infoblox.com/dns-security-resource-center/dns-security-issues-threats/dns-security-threats-data-exfiltration/)
  software: []
  status: Theoretical
  subtechnique-of: FGT1048
  tactics:
  - TA0010
  - TA0011
  typecode: attack_subtechnique_addendum
- access-required: User
  architecture-segment: User Plane, Control Plane
  bluf: An adversary may move targeted data and remain undetected during the exfiltration
    process by using DNS requests.
  campaigns: []
  criticalassets:
  - description: Whoever controls the DNS servers controls how and what end users
      connect to over the network, making DNS servers a type of critical infrastructure.
    name: DNS Server
  description: "An adversary may move targeted data and remain undetected during the\
    \ exfiltration process by using DNS requests.\r\n\r\nAn adversary may be able\
    \ to move data by simply encoding data as a hostname query and by placing the\
    \ data in the names section of a DNS lookup. The receiving DNS server, controlled\
    \ by the adversary, logs the query and decodes the data, reassembles in the planned\
    \ sequence from the named field. The reply to the query may or may not sent. If\
    \ the query is sent, it may be ignored by the compromised host.\r\n\r\nThe data\
    \ is not C2 data but user/system data such as identifiers, files, credentials,\
    \ etc."
  detections:
  - component: Network Traffic Content
    detects: 'Monitor DNS data transmitted across the network, that is either summarized
      and/or captured as raw data in an analyzable format (ex: PCAP).'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Command Execution
    detects: Monitor executed commands and arguments that may steal data by exfiltrating
      it over DNS request
    fgdsid: FGDS0017.001
    name: Command
  groups: []
  id: FGT1048.501
  mitigations:
  - fgmid: FGM5024
    mitigates: Use strong data integrity protection algorithms within 5G network such
      as airlink, backhaul and core network.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1031
    mitigates: "Network intrusion detection and prevention systems that use network\
      \ signatures to identify traffic for specific adversary malware can be used\
      \ to mitigate activity at the network level. Signatures are often for unique\
      \ indicators within protocols and may be based on the specific obfuscation technique\
      \ used by a particular adversary or tool and will likely be different across\
      \ various malware families and versions. Adversaries will likely change tool\
      \ command and control signatures over time or construct protocols in such a\
      \ way to avoid detection by common defensive tools.\_Scan all external traffic\
      \ header fields to detect any suspicious protocol or port number use."
    name: Network Intrusion Prevention
  name: Covert Exfiltration Of Data Via DNS Request
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Attacker can route command and control traffic through DNS to control
      botnets or other entities.
    name: Command and Control Network
  - description: Attacker has a route to exfiltrate stolen data disguised as DNS packets.
    name: Exfiltration Route
  - description: This involves information such as identifiers, files, user credentials,
      etc.
    name: User/System data
  preconditions:
  - description: There must not be an endpoint detection and response capability to
      validate whether host/network function/UE is communicating with a malicious
      DNS server or a valid one.
    name: Unauthenticated DNS Services
  procedureexamples:
  - description: Operators do not strictly enforce flow monitoring for free DNS service
      via the standard five-tuple flow ID (source IP, destination IP, source port,
      destination port, protocol). Instead, they use only the destination port (or
      plus protocol ID), thus exposing a vulnerability.Adversary may setup fake DNS
      server to receive exfiltrated data.Adversarial activity could be a person who
      has remote access or a worm collecting and transmitting protected information.
      [2]
    name: Free DNS loophole
  references:
  - '<a name="1"> \[1\] </a> ["Bhadhra Framework": S.P. Rao, S. Holtmanns, T. Aura,
    "Threat modeling framework for mobile communication systems"](https://arxiv.org/pdf/2005.05110.pdf)'
  - '<a name="2"> \[2\] </a> [Peng, C., Li, C., Tu, G., Lu, S., & Zhang, L. (2012).
    Mobile data charging: new attacks and countermeasures. Proceedings of the 2012
    ACM conference on Computer and communications security.](https://dl.acm.org/doi/pdf/10.1145/2382196.2382220)'
  - '<a name="3"> \[3\] </a> [Merve Sahin, Aurelien Francillon, Payas Gupta, and Mustaque
    Ahamad. 2017. "Sok: Fraud in telephony networks". In 2017 IEEE European Symposium
    on Securityand Privacy (EuroS&P). IEEE, p235-250](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7961983&tag=1)'
  - <a name="4"> \[4\] </a> [Kui Xu, Patrick Butler, Sudip Saha, Danfeng (Daphni)
    Yao in DNS CC Journal, "DNS for Massive-Scale Command and Control"](https://people.cs.vt.edu/~danfeng/papers/DNS-CC-JOURNAL.pdf)
  - <a name="5"> \[5\] </a> [Infoblox website, "DNS Data exfiltration"](https://www.infoblox.com/dns-security-resource-center/dns-security-issues-threats/dns-security-threats-data-exfiltration/)
  software: []
  status: Theoretical
  subtechnique-of: FGT1048
  tactics:
  - TA0011
  - TA0010
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: ''
    campaigns:
    - description: Operation Soft Cell is a worldwide campaign against telecom. [1]
      fgcid: FGC5001
      name: Operation Soft Cell
    criticalassets: []
    detections:
    - component: Command Execution
      detects: Monitor command-line arguments for script execution and subsequent
        behavior.
      fgdsid: FGDS0017.001
      name: Command
    - component: OS API Execution
      detects: Monitor log files for process creation and execution through command-line
        and scripting activities
      fgdsid: FGDS0009.001
      name: Process
    - component: Execution
      detects: Monitor for any attempts to enable scripts running on a system that
        install software or make changes that would be considered suspicious.
      fgdsid: FGDS0012.001
      name: Script
    - component: File Access
      detects: 'Opening a file, which makes the file contents available to the requestor
        (ex: Windows EID 4663)'
      fgdsid: FGDS0022.001
      name: File
    - component: File Creation
      detects: 'Initial construction of a new file (ex: Sysmon EID 11)'
      fgdsid: FGDS0022.002
      name: File
    - component: File Deletion
      detects: 'Removal of a file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK,
        or Linux commands auditd unlink, rename, rmdir, unlinked, or renameat rules)'
      fgdsid: FGDS0022.003
      name: File
    - component: File Metadata
      detects: 'Contextual data about a file, which may include information such as
        name, the content (ex: signature, headers, or data/media), user/owner, permissions,
        etc.'
      fgdsid: FGDS0022.004
      name: File
    - component: File Modification
      detects: File contents are changed by adversary.
      fgdsid: FGDS0022.005
      name: File
    groups:
    - description: LIMINAL PANDA uses a novel technique to support C2 communication,
        leveraging SGSN emulation software in concert with TinyShell. [2]
      fggid: FGG5001
      name: Liminal Panda
    - description: StonePanda used China Chopper to open a command terminal and execute
        certain actions. [1]
      fggid: FGG5002
      name: Stone Panda
    - description: During Operation Soft Cell, Gallium was observed to launch a series
        of PowerShell commands to enumerate the Exchange server, network architecture,
        users, and active directory enumeration. [3]
      fggid: G0093
      name: GALLIUM
    mitigations:
    - fgmid: FGM1032
      mitigates: Implement strong authentication (OAuth 2.0, API keys, JWT) and enforce
        role-based access control (RBAC).Limit permissions and expose only necessary
        API endpoints.Continuously verify API calls before granting access.
      name: Multi-factor Authentication
    - fgmid: FGM5509
      mitigates: Implement filtering and screening capabilities such as WAF, API gateways
        or Service proxies with granular message level policy controls.
      name: Screen Signaling And User Plane Messages
    - fgmid: FGM1026
      mitigates: Manage the creation, modification, use, and permissions associated
        to privileged accounts, including SYSTEM and root.
      name: Privileged Account Management
    - fgmid: FGM1033
      mitigates: Prevent user installation of unrequired command and scripting interpreters
        and limit included utilities when assessing base OS or images.
      name: Limit Software Installation
    - fgmid: FGM1042
      mitigates: Disable or remove any unnecessary or unused shells or interpreters.
      name: Disable Or Remove Feature Or Program
    name: "## Addendum Name: Telecom Systems CLI\r\n### Architecture Segments: Virtualization,\
      \ OA&M\r\n Adversaries may exploit command and scripting interpreters to abuse\
      \ API to escalate privileges, navigate the control plane, discover network information,\
      \ or impact availability.\r\n\r\n\nData centers, Cloud, and MEC in 5G deployments\
      \ may host CORE Network functions that allow administrators to remotely manage\
      \ devices via command and scripting interpreters (e.g., Azure PowerShell, Unix\
      \ Shell, Cloud APIs, etc.) For example, an exposed API may be remotely abused\
      \ by nefarious threat actors to execute commands to escalate privileges, navigate\
      \ the control plane, discover network information, or impact availability. \r\
      \n\r\nThese remote management APIs allow the provision and management of software\
      \ defined network functions including subscriber database, policy control, control\
      \ plane, and user plane. If onboarding system (order fulfillment, SIM inventory,\
      \ UDM, USDF, etc.) are hosted on the cloud, this API may pose a risk to modify\
      \ the SIM database or SIM assignments.[1] \r\n\r\nThis technique could provide\
      \ the adversary an opportunity to further affect the environment by registering\
      \ malicious NF or installing tools such as remote management and monitoring\
      \ in the environment. See FGT1570\"Lateral Tool Transfer: Malicious tool transfer\
      \ to a 5G NF and FGT5007 \"Registration of malicious network functions\". \r\
      \n\r\nDuring Operation Soft Cell, cyber-espionage threat actor Gallium was observed\
      \ to leverage an exposed command and scripting interpreter on a remote device\
      \ when interacting with a device belonging to Telecom providers. In this incident,\
      \ adversaries leveraged these exposed APIs to escalate privileges, run scripts,\
      \ and exfiltrate customer's call detail record system (CDR). [2] "
    platforms:
    - OA&M
    - 5G Core
    - Data Center
    - MEC
    - Virtual infrastructure orchestrator
    - infrastructure
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [Operation Soft Cell: A Worldwide Campaign Against
      Telecom](https://www.cybereason.com/blog/research/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers)'
    - '<a name="2"> \[2\] </a> [CrowdStrike Blog - LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="3"> \[3\] </a> [Microsoft Security Intelligence: "GALLIUM: Targeting
      global telecom".](https://www.microsoft.com/en-us/security/blog/2019/12/12/gallium-targeting-global-telecom/)'
    - '<a name="4"> \[4\] </a> [Lee, T., Hanzlik, D., Ahl, I. (2013, August 7): "Breaking
      Down the China Chopper Web Shell - Part I." Retrieved March 27, 2015.](https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html)'
    software:
    - description: TinyShell provides a command prompt that can be used by threat
        actors to do activities like unauthorized access, fetch system, and network-related
        information. [2]
      fgsid: FGS5006
      name: TINYSHELL
    - description: ChinaChopper is a web shell hosted on servers to provide access
        back into an enterprise network. [4]
      fgsid: S0020
      name: China Chopper
  architecture-segment: Virtualization, OA&M
  bluf: Adversaries may abuse command and script interpreters to execute commands,
    scripts, or binaries.
  campaigns:
  - description: Operation Soft Cell is a worldwide campaign against telecom. [1]
    fgcid: FGC5001
    name: Operation Soft Cell
  criticalassets: []
  description: 'Adversaries may abuse command and script interpreters to execute commands,
    scripts, or binaries. These interfaces and languages provide ways of interacting
    with computer systems and are a common feature across many different platforms.
    Most systems come with some built-in command-line interface and scripting capabilities,
    for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004)
    while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003)
    and [PowerShell](https://attack.mitre.org/techniques/T1059/001). There are also
    cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006),
    as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007)
    and [Visual Basic](https://attack.mitre.org/techniques/T1059/005). Adversaries
    may abuse these technologies in various ways as a means of executing arbitrary
    commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001)
    payloads delivered to victims as lure documents or as secondary payloads downloaded
    from an existing C2. Adversaries may also execute commands through interactive
    terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021)
    in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation:
    Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell
    Execution in Python)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1059)'
  detections:
  - component: Command Execution
    detects: Monitor command-line arguments for script execution and subsequent behavior.
    fgdsid: FGDS0017.001
    name: Command
  - component: OS API Execution
    detects: Monitor log files for process creation and execution through command-line
      and scripting activities
    fgdsid: FGDS0009.001
    name: Process
  - component: Execution
    detects: Monitor for any attempts to enable scripts running on a system that install
      software or make changes that would be considered suspicious.
    fgdsid: FGDS0012.001
    name: Script
  - component: File Access
    detects: 'Opening a file, which makes the file contents available to the requestor
      (ex: Windows EID 4663)'
    fgdsid: FGDS0022.001
    name: File
  - component: File Creation
    detects: 'Initial construction of a new file (ex: Sysmon EID 11)'
    fgdsid: FGDS0022.002
    name: File
  - component: File Deletion
    detects: 'Removal of a file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK,
      or Linux commands auditd unlink, rename, rmdir, unlinked, or renameat rules)'
    fgdsid: FGDS0022.003
    name: File
  - component: File Metadata
    detects: 'Contextual data about a file, which may include information such as
      name, the content (ex: signature, headers, or data/media), user/owner, permissions,
      etc.'
    fgdsid: FGDS0022.004
    name: File
  - component: File Modification
    detects: File contents are changed by adversary.
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: LIMINAL PANDA uses a novel technique to support C2 communication,
      leveraging SGSN emulation software in concert with TinyShell. [2]
    fggid: FGG5001
    name: Liminal Panda
  - description: StonePanda used China Chopper to open a command terminal and execute
      certain actions. [1]
    fggid: FGG5002
    name: Stone Panda
  - description: During Operation Soft Cell, Gallium was observed to launch a series
      of PowerShell commands to enumerate the Exchange server, network architecture,
      users, and active directory enumeration. [3]
    fggid: G0093
    name: GALLIUM
  id: FGT1059
  mitigations:
  - fgmid: FGM1032
    mitigates: Implement strong authentication (OAuth 2.0, API keys, JWT) and enforce
      role-based access control (RBAC).Limit permissions and expose only necessary
      API endpoints.Continuously verify API calls before granting access.
    name: Multi-factor Authentication
  - fgmid: FGM5509
    mitigates: Implement filtering and screening capabilities such as WAF, API gateways
      or Service proxies with granular message level policy controls.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM1026
    mitigates: Manage the creation, modification, use, and permissions associated
      to privileged accounts, including SYSTEM and root.
    name: Privileged Account Management
  - fgmid: FGM1033
    mitigates: Prevent user installation of unrequired command and scripting interpreters
      and limit included utilities when assessing base OS or images.
    name: Limit Software Installation
  - fgmid: FGM1042
    mitigates: Disable or remove any unnecessary or unused shells or interpreters.
    name: Disable Or Remove Feature Or Program
  name: Command and Scripting Interpreter
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [Operation Soft Cell: A Worldwide Campaign Against Telecom](https://www.cybereason.com/blog/research/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers)'
  - '<a name="2"> \[2\] </a> [CrowdStrike Blog - LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="3"> \[3\] </a> [Microsoft Security Intelligence: "GALLIUM: Targeting
    global telecom".](https://www.microsoft.com/en-us/security/blog/2019/12/12/gallium-targeting-global-telecom/)'
  - '<a name="4"> \[4\] </a> [Lee, T., Hanzlik, D., Ahl, I. (2013, August 7): "Breaking
    Down the China Chopper Web Shell - Part I." Retrieved March 27, 2015.](https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html)'
  software:
  - description: TinyShell provides a command prompt that can be used by threat actors
      to do activities like unauthorized access, fetch system, and network-related
      information. [2]
    fgsid: FGS5006
    name: TINYSHELL
  - description: ChinaChopper is a web shell hosted on servers to provide access back
      into an enterprise network. [4]
    fgsid: S0020
    name: China Chopper
  status: Observed
  tactics:
  - TA0002
  typecode: attack_technique_addendum
- bluf: Adversaries may communicate using OSI application layer protocols to avoid
    detection/network filtering by blending in with existing traffic.
  campaigns: []
  criticalassets: []
  description: Adversaries may communicate using OSI application layer protocols to
    avoid detection/network filtering by blending in with existing traffic. Commands
    to the remote system, and often the results of those commands, will be embedded
    within the protocol traffic between the client and server. Adversaries may utilize
    many different protocols, including those used for web browsing, transferring
    files, electronic mail, or DNS. For connections that occur internally within an
    enclave (such as those between a proxy or pivot node and other nodes), commonly
    used protocols are SMB, SSH, or RDP.[To read more, please see the MITRE ATT&CK
    page for this technique](https://attack.mitre.org/techniques/T1071)
  detections: []
  groups: []
  id: FGT1071
  mitigations: []
  name: Application Layer Protocol
  object-type: technique
  platforms: Linux, macOS, Windows
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0011
  typecode: attack_technique_with_fight_subs
- architecture-segment: User Plane
  bluf: Adversaries may use application layer protocol on an unconventional port to
    avoid detection or network filtering.
  campaigns: []
  criticalassets:
  - description: All core network functions of victim MNO may be impacted by this
      behavior.
    name: MNO core network functions
  - description: Victim MNO's network data may be exposed to adversaries due to this
      behavior.
    name: MNO network data
  description: "Adversaries may use application layer protocol on an unconventional\
    \ port to avoid detection or network filtering.\r\n\r\nAdversaries may compromise\
    \ the external DNS (eDNS) server of a partner network using SSH for initial access\
    \ with password spraying. Then they launch the pingpong malware which listens\
    \ for ICMP echo requests from compromised hosts of other partner networks and\
    \ it establishes a TCP reverse shell connection to the partner network when it\
    \ finds the remote IP address and port number. The remote IP address and port\
    \ number are embedded at a fixed offset of the ICMP echo request. Then they communicate\
    \ to a remote C2 server which is also controlled by them using encapsulated SSH\
    \ messages on TCP port 53. This particular port is chosen for C2 because it is\
    \ allowed by most firewalls for DNS queries to pass through."
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic contents especially all payloads of traffic on
      TCP port 53.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Process Creation
    detects: Monitor all process creations in host systems for any unusual activity
      e.g. TCP reverse shell process to connect to remote server.
    fgdsid: FGDS0009.003
    name: Process
  groups:
  - description: Liminal Panda established C2 channel between eDNS server of a partner
      network and another server controlled by them using SSH on TCP port 53. [1,2]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1071.501
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter all network traffic received on TCP port 53 with unusually long
      payloads.
    name: Filter Network Traffic
  - fgmid: FGM5542
    mitigates: Use application layer firewall for unusual payloads on TCP port 53.
    name: Application Layer Firewall
  name: SSH
  object-type: technique
  platforms: 5G core
  postconditions: []
  preconditions:
  - description: eDNS server of an MNO partner network must be compromised before
      launching this behavior. Then they may install the pingpong backdoor in the
      compromised eDNS server.
    name: MNOs eDNS server is compromised
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software:
  - description: Pingpong malware was used by Liminal Panda to listen to ICMP echo
      requests from remote hosts. This helped determine the IP address and port number
      to connect to the remote host via TCP reverse shell. [1, 2]
    fgsid: FGS5001
    name: PingPong
  status: Observed
  subtechnique-of: FGT1071
  tactics:
  - TA0011
  typecode: fight_subtechnique_to_attack_technique
- access-required: NF Service Account Credentials
  architecture-segment: Control Plane, Roaming
  bluf: An adversary may use various telecom protocols for Command and Control (C2)
    to/from a compromised MNO roaming partner network.
  campaigns: []
  criticalassets:
  - description: All core network functions of victim MNO may be impacted by this
      behavior.
    name: Core network functions
  - description: Victim MNO's user data may be exposed to adversaries due to this
      behavior.
    name: User data (calls/data/SMS)
  - description: IP addresses. FQDNs and TLS connections of core NFs are used for
      nefarious purposes
    name: MNO system data
  description: "An adversary may use various telecom protocols for Command and Control\
    \ (C2) to/from a compromised MNO roaming partner network.\r\n\r\nAdversaries may\
    \ exploit telecom protocols to establish covert Command and Control (C2) channels.\
    \ SIGTRAN, used for SS7 signaling over IP, can be abused within compromised MNO\
    \ roaming networks to facilitate C2 communication. Similarly, HTTP-based protocols\
    \ (e.g., HTTP/2 in 5G Service-Based Architectures) can enable adversaries to embed\
    \ C2 traffic within encrypted control plane signaling between Network Functions\
    \ (NFs), evading detection. Further, HTTP/2 optional parameters may be used to\
    \ communicate between a core NF and an external application function via NEF or\
    \ between an NF in visited PLMN and an NF in home PLMN via SEPP. These approaches\
    \ leverage trusted telecom infrastructure, making C2 communications resilient\
    \ to monitoring and filtering.\r\n\r\nAdversaries may use malware in a compromised\
    \ host of MNO roaming partner network to establish a command and control (C2)\
    \ channel to a remote server. The remote server is also controlled by the adversaries.\
    \ The payload data may be encrypted to avoid detection.\r\n\r\nThe adversaries\
    \ may also achieve a follow-on procedure by exfiltrating data from the compromised\
    \ host to another server which is controlled by them. The exfiltrated data can\
    \ be transported over the same C2 channel by encrypting the payload.\r\n\r\nBackground\
    \ info: SIGTRAN is a signaling protocol which uses IP network to transport various\
    \ metadata of public switched telephone network (PSTN) such as telephone numbers\
    \ called by a mobile device. "
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic contents especially signaling traffic with SIGTRAN
      protocol.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Command Execution
    detects: Monitor all command executions in host systems for any unusual activity
      e.g. SIGTRANslator ELF binary execution for connecting to remote server.
    fgdsid: FGDS0017.001
    name: Command
  - component: Network Traffic Flow
    detects: 'Summarize network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log).'
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups:
  - description: Liminal Panda used a Linux ELF binary called SIGTRANslator in a compromised
      host of MNO roaming partner network to establish a command and control (C2)
      channel to a remote server ([3], [4]. [5]).
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1071.502
  mitigations:
  - fgmid: FGM1020
    mitigates: Employ TLS proxies with DPI firewalls. These decrypt the packets and
      send them off to their destination, but only after logging what the packet contains.
      Service communication proxy (SCP) can be also used for this purpose.The firewalls/proxies
      connect to a SIEM whose data is being kept up to date with current threats.
    name: SSL/TLS Inspection
  - fgmid: FGM1049
    mitigates: Anti-virus can be used to automatically detect and quarantine suspicious
      files running on the gNB or UPF or other IMS function
    name: Anti-virus & Anti-malware
  - fgmid: FGM1040
    mitigates: Prevent the running (on this NF "endpoint") of obfuscated or masquerading
      software; this malware can disguise itself as syslog.
    name: Behavior Prevention On Endpoint
  - fgmid: FGM1037
    mitigates: Filter all network traffic received from roaming partner networks with
      SIGTRAN protocol as transport.
    name: Filter Network Traffic
  name: Telecom Protocols
  object-type: technique
  platforms: 5G Core Network
  postconditions:
  - description: Adversary has access to user data traffic communication metadata
    name: User data privacy compromised
  preconditions:
  - description: Adversary must be capable of establishing encrypted communication
      channels (e.g., using TLS) to ensure that the C2 traffic is not easily detectable.
    name: Ability to Encrypt Communication
  - description: Adversary must have access to one or more Network Functions within
      the 5G network. This could be achieved through various means such as exploiting
      vulnerabilities, insider threats, or compromising legitimate NFs.
    name: Access to Network Functions
  - description: Adversary must have prepared SIGTRANslator ELF binary beforehand
      for this behavior.
    name: SIGTRANslator binary needs to be obtained
  procedureexamples:
  - description: 'The signaling AF to NEF to UDM and back from UDM to NEF to AF is
      used in several procedures [1]. Example: NIDD (non-IP data delivery) (see clause
      4.25 of [2]), or VN (Virtual Network) group management. See clause 4.15.6 of
      [2].'
    name: Third party app (AF) to Network Exposure Function (NEF) to Core NF
  - description: AMF in vPLMN communicates to AUSF in hPLMN during UE authentication.
      This channel can be used to disguise C2 communication.
    name: An NF in vPLMN to an NF in hPLMN via SEPP
  references:
  - <a name="1"> \[1\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021](https://arxiv.org/abs/2108.11206)
  - <a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TS 23.502,
    "Procedures for the 5G System (5GS); Stage 2 (Release 17)", Technical Specification,
    v17.4.0, March 2022.](https://www.3gpp.org/DynaReport/23502.htm)
  - <a name="3"> \[3\] </a> [China-Backed Hackers Leverage SIGTRAN, GSM Protocols
    to Infiltrate Telecom Networks](https://thehackernews.com/2024/11/china-backed-hackers-leverage-sigtran.html)
  - '<a name="4"> \[4\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  - '<a name="5"> \[5\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  software:
  - description: SIGTRANslator is a Linux ELF binary capable of sending and receiving
      data via various SS7 - telecom protocols
    fgsid: FGS5005
    name: SIGTRANslator
  status: Observed
  subtechnique-of: FGT1071
  tactics:
  - TA0011
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns: []
    criticalassets:
    - description: Software development and deployment tools in MNO (and supplier)
        environments.
      name: CI/CD Tools
    - description: Scanning, monitoring, and end point protection tools.
      name: Security Tools
    - description: Operation and system support tools.
      name: OSS Tools
    detections:
    - component: Application Log Content
      detects: Often these third-party applications will have logs of their own that
        can be collected and correlated with other data from the environment. Ensure
        that third-party application logs are on-boarded to the enterprise logging
        system and the logs are regularly reviewed. Audit software deployment logs
        and look for suspicious or unauthorized activity. A system not typically used
        to push software to clients that suddenly is used for such a task outside
        of a known admin function may be suspicious. Monitor account login activity
        on these applications to detect suspicious/abnormal usage. Perform application
        deployment at regular times so that irregular deployment activity stands out.
      fgdsid: FGDS0015.001
      name: Application Log
    - component: Process Metadata
      detects: Monitor for newly executed processes that do not correlate to known
        good software. Analyze the process execution trees, historical activities
        from the third-party application (such as what types of files are usually
        pushed), and the resulting activities or events from the file/binary/script
        pushed to systems.
      fgdsid: FGDS0009.004
      name: Process
    groups:
    - description: "Silence\_has used RAdmin, a remote software tool used to remotely\
        \ control workstations and ATMs. [4]"
      fggid: G0091
      name: Silence
    mitigations:
    - fgmid: FGM1018
      mitigates: User Account Management, limited and least privileged user accounts.
      name: User Account Management
    - fgmid: FGM1051
      mitigates: Update Software regularly to eliminate persistence.
      name: Update Software
    - fgmid: FGM1029
      mitigates: Remote Data Storage, restrict access and monitor repository activity.
      name: Remote Data Storage
    - fgmid: FGM1026
      mitigates: Privileged Account Management, unique, least privileged accounts
        and regularly audit access attempts audits.
      name: Privileged Account Management
    - fgmid: FGM1027
      mitigates: Password Policies, no credential sharing, create traceability.
      name: Password Policies
    - fgmid: FGM1030
      mitigates: Network Segmentation allows limit movements, insert application aware
        firewalls between segments.
      name: Network Segmentation
    - fgmid: FGM1032
      mitigates: Multi-factor Authentication adds additional layer of security for
        compromised credentials as well as increased accountability.
      name: Multi-factor Authentication
    name: "## Addendum Name: 5G Orchestration And Deployment Tools\r\n### Architecture\
      \ Segments: OA&M, Virtualization, Supply Chain, RAN, UE\r\n An adversary may\
      \ use CI/CD tools to gain access to production hosts/VNFs for discovery, data\
      \ exfiltration and for deployment of lateral movements tools.\r\n\r\nIn 5G deployments,\
      \ MNO's development and deployment tools offer a conduit to 5G production RAN\
      \ and Core network functions. CI/CD tools have a greater access to Software\
      \ during development lifecycle, an adversary may be able to find a back door\
      \ to software in production environment- a very similar scenario to SolarWinds\
      \ hack, where compromised software was deployed on thousands of hosts via a\
      \ software upgrade carrying compromised image. \r\n\r\nManagement and Orchestration\
      \ is a framework for managing and orchestrating network functions virtualization\
      \ (NFV) infrastructure, resources, and services. It provides a standard approach\
      \ for the management and orchestration of network services in NFV environments,\
      \ including the automation of tasks such as network service deployment, scaling,\
      \ and network function lifecycle management. MANO toolset if misconfigured or\
      \ APIs not properly secured can provide an attack vector to adversary with grave\
      \ consequences to network and its services."
    platforms:
    - Infrastructure
    - PNF
    - VNF Hosts
    - ''
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization
      (NFV); NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
    - "<a name=\"2\"> \\[2\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:\
      \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
      ,\_October 2021.](https://arxiv.org/abs/2108.11206)"
    - '<a name="3"> \[3\] </a> [Dell SecureWorks. (2013, March 21): "Wiper Malware
      Analysis Attacking Korean Financial Sector." Retrieved May 13, 2015.](http://www.secureworks.com/cyber-threat-intelligence/threats/wiper-malware-analysis-attacking-korean-financial-sector/)'
    - <a name="4"> \[4\] </a> [Silence - a new Trojan attacking financial organizations
      (accessed 06/20/2023).](https://securelist.com/the-silence/83009/)
    - '<a name="5"> \[5\] </a> [Dell SecureWorks. (2013, March 21): "Wiper Malware
      Analysis Attacking Korean Financial Sector." Retrieved May 13, 2015.](http://www.secureworks.com/cyber-threat-intelligence/threats/wiper-malware-analysis-attacking-korean-financial-sector/)'
    software:
    - description: "A patch management system for an anti-virus product commonly installed\
        \ among targeted companies may have been used to distribute the\_Wiper\_malware.\
        \ [5]"
      fgsid: S0041
      name: Wiper
  architecture-segment: OA&M, Virtualization, Supply Chain, RAN, UE
  bluf: Adversaries may gain access to and use third-party software suites installed
    within an enterprise network, such as administration, monitoring, and deployment
    systems, to move laterally through the network.
  campaigns: []
  criticalassets:
  - description: Software development and deployment tools in MNO (and supplier) environments.
    name: CI/CD Tools
  - description: Scanning, monitoring, and end point protection tools.
    name: Security Tools
  - description: Operation and system support tools.
    name: OSS Tools
  description: 'Adversaries may gain access to and use third-party software suites
    installed within an enterprise network, such as administration, monitoring, and
    deployment systems, to move laterally through the network. Third-party applications
    and software deployment systems may be in use in the network environment for administration
    purposes (e.g., SCCM, HBSS, Altiris, etc.). Access to a third-party network-wide
    or enterprise-wide software system may enable an adversary to have remote code
    execution on all systems that are connected to such a system. The access may be
    used to laterally move to other systems, gather information, or cause a specific
    effect, such as wiping the hard drives on all endpoints. Network infrastructure
    may also have administration tools that can be similarly abused by adversaries.
    (Citation: Fortinet Zero-Day and Custom Malware Used by Suspected Chinese Actor
    in Espionage Operation) The permissions required for this action vary by system
    configuration; local credentials may be sufficient with direct access to the third-party
    system, or specific domain credentials may be required. However, the system may
    require an administrative account to log in or to perform it''s intended purpose.[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1072)'
  detections:
  - component: Application Log Content
    detects: Often these third-party applications will have logs of their own that
      can be collected and correlated with other data from the environment. Ensure
      that third-party application logs are on-boarded to the enterprise logging system
      and the logs are regularly reviewed. Audit software deployment logs and look
      for suspicious or unauthorized activity. A system not typically used to push
      software to clients that suddenly is used for such a task outside of a known
      admin function may be suspicious. Monitor account login activity on these applications
      to detect suspicious/abnormal usage. Perform application deployment at regular
      times so that irregular deployment activity stands out.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Process Metadata
    detects: Monitor for newly executed processes that do not correlate to known good
      software. Analyze the process execution trees, historical activities from the
      third-party application (such as what types of files are usually pushed), and
      the resulting activities or events from the file/binary/script pushed to systems.
    fgdsid: FGDS0009.004
    name: Process
  groups:
  - description: "Silence\_has used RAdmin, a remote software tool used to remotely\
      \ control workstations and ATMs. [4]"
    fggid: G0091
    name: Silence
  id: FGT1072
  mitigations:
  - fgmid: FGM1018
    mitigates: User Account Management, limited and least privileged user accounts.
    name: User Account Management
  - fgmid: FGM1051
    mitigates: Update Software regularly to eliminate persistence.
    name: Update Software
  - fgmid: FGM1029
    mitigates: Remote Data Storage, restrict access and monitor repository activity.
    name: Remote Data Storage
  - fgmid: FGM1026
    mitigates: Privileged Account Management, unique, least privileged accounts and
      regularly audit access attempts audits.
    name: Privileged Account Management
  - fgmid: FGM1027
    mitigates: Password Policies, no credential sharing, create traceability.
    name: Password Policies
  - fgmid: FGM1030
    mitigates: Network Segmentation allows limit movements, insert application aware
      firewalls between segments.
    name: Network Segmentation
  - fgmid: FGM1032
    mitigates: Multi-factor Authentication adds additional layer of security for compromised
      credentials as well as increased accountability.
    name: Multi-factor Authentication
  name: Software Deployment Tools
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization (NFV);
    NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
  - "<a name=\"2\"> \\[2\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:\
    \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
    ,\_October 2021.](https://arxiv.org/abs/2108.11206)"
  - '<a name="3"> \[3\] </a> [Dell SecureWorks. (2013, March 21): "Wiper Malware Analysis
    Attacking Korean Financial Sector." Retrieved May 13, 2015.](http://www.secureworks.com/cyber-threat-intelligence/threats/wiper-malware-analysis-attacking-korean-financial-sector/)'
  - <a name="4"> \[4\] </a> [Silence - a new Trojan attacking financial organizations
    (accessed 06/20/2023).](https://securelist.com/the-silence/83009/)
  - '<a name="5"> \[5\] </a> [Dell SecureWorks. (2013, March 21): "Wiper Malware Analysis
    Attacking Korean Financial Sector." Retrieved May 13, 2015.](http://www.secureworks.com/cyber-threat-intelligence/threats/wiper-malware-analysis-attacking-korean-financial-sector/)'
  software:
  - description: "A patch management system for an anti-virus product commonly installed\
      \ among targeted companies may have been used to distribute the\_Wiper\_malware.\
      \ [5]"
    fgsid: S0041
    name: Wiper
  status: Theoretical
  tactics:
  - TA0002
  - TA0008
  typecode: attack_technique_addendum
- bluf: Adversaries may obtain and abuse credentials of existing accounts as a means
    of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may obtain and abuse credentials of existing accounts
    as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense
    Evasion. Compromised credentials may be used to bypass access controls placed
    on various resources on systems within the network and may even be used for persistent
    access to remote systems and externally available services, such as VPNs, Outlook
    Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW)
    Compromised credentials may also grant an adversary increased privilege to specific
    systems or access to restricted areas of the network. Adversaries may choose not
    to use malware or tools in conjunction with the legitimate access those credentials
    provide to make it harder to detect their presence. In some cases, adversaries
    may abuse inactive accounts: for example, those belonging to individuals who are
    no longer part of an organization. Using these accounts may allow the adversary
    to evade detection, as the original account user will not be present to identify
    any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)
    The overlap of permissions for local, domain, and cloud accounts across a network
    of systems is of concern because the adversary may be able to pivot across accounts
    and systems to reach a high level of access (i.e., domain or enterprise administrator)
    to bypass access controls set within the enterprise.(Citation: TechNet Credential
    Theft)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1078)'
  detections: []
  groups: []
  id: FGT1078
  mitigations: []
  name: Valid Accounts
  object-type: technique
  platforms: Windows, Azure AD, Office 365, SaaS, IaaS, Linux, macOS, Google Workspace,
    Containers, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0005
  - TA0003
  - TA0004
  - TA0001
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections:
    - component: User Account Authentication
      detects: Monitors activity (attempts, successes, failures) from profile representing
        a user, device, service, or application used to authenticate and access resources.
      fgdsid: FGDS0002.001
      name: User Account
    groups:
    - description: During LightBasin's campaign, the threat actor was observed to
        gain access into eDNS server by abusing default credentials of Huawei devices.
        [2]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1032
      mitigates: Use two or more pieces of evidence to authenticate to a system; such
        as username and password in addition to a token from a physical smart card
        or token generator.
      name: Multi-factor Authentication
    - fgmid: FGM1027
      mitigates: Set and enforce secure password policies for accounts.
      name: Password Policies
    name: "## Addendum Name: Network Element\r\n### Architecture Segments: Cloud Service\
      \ Provider\r\n Adversaries may abuse credentials of default accounts set by\
      \ the factory on networking devices, system assets, or user accounts to gain\
      \ access or control of the host or NF.\r\n\r\nThese default accounts pose serious\
      \ threat to organizations as they often help adversaries gain Initial Access,\
      \ Persistence, Privilege Escalation, or Defense Evasion. This technique may\
      \ affect various technology platforms, such as: network devices, computing systems,\
      \ 3rd party software, and cloud services.\r\n\r\nIn 5G deployments, DNS servers\
      \ help facilitate the translation from domain names to IP addresses. Huawei\
      \ provides Area Routers (AR) are multi-service network appliances designed for\
      \ small-, medium-, and large-sized enterprises. Huawei AR device's The factory\
      \ settings for username admin and password Admin@huawei. [1] When a poorly secured\
      \ DNS server is deployed into operations, this may serve as easy targets to\
      \ nefarious threat actors.\r\n\r\nDuring Operation LightBasin estimated between\
      \ 2016 and 2022, telecommunication threat actor was able to compromise an eDNS\
      \ server of a General Packet Radio Service (GPRS) roaming exchange network (GRX)\
      \ by abusing default accounts, then allowed them to further proliferate in the\
      \ environment. [2]\r\n\r\nThis technique could provide the adversary with an\
      \ opportunity to further affect the environment by attempting to brute force\
      \ into other poorly secure assets or transfer tools into the compromised environment.\
      \ See FGT1110.001 Brute Force: Password Guessing and FGT1570 Lateral Tool Transfer.\n"
    platforms:
    - OA&M
    - Core
    - Virtualization
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [Huawei Area Router Guide.](https://support.huawei.com/enterprise/en/doc/EDOC1000079719/1b8f7bdb/logging-in-to-an-ar-router-through-a-web-system)
    - '<a name="2"> \[2\] </a> [Crowdstrike blog: "LightBasin: A Roaming Threat to
      Telecommunications Companies".](https://www.crowdstrike.com/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="3"> \[3\] </a> [Crowdstrike blog: LIMINAL PANDA: A Closer Look at
      China''s Cyber Threats to the Telecom Sector".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
    software: []
  architecture-segment: Cloud Service Provider
  bluf: Adversaries may obtain and abuse credentials of a default account as a means
    of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may obtain and abuse credentials of a default account
    as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense
    Evasion. Default accounts are those that are built-into an OS, such as the Guest
    or Administrator accounts on Windows systems. Default accounts also include default
    factory/provider set accounts on other types of systems, software, or devices,
    including the root user account in AWS and the default service account in Kubernetes.(Citation:
    Microsoft Local Accounts Feb 2019)(Citation: AWS Root User)(Citation: Threat Matrix
    for Kubernetes) Default accounts are not limited to client machines, rather also
    include accounts that are preset for equipment such as network devices and computer
    applications whether they are internal, open source, or commercial. Appliances
    that come preset with a username and password combination pose a serious threat
    to organizations that do not change it post installation, as they are easy targets
    for an adversary. Similarly, adversaries may also utilize publicly disclosed or
    stolen [Private Keys](https://attack.mitre.org/techniques/T1552/004) or credential
    materials to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021).(Citation:
    Metasploit SSH Module)[To read more, please see the MITRE ATT&CK page for this
    subtechnique](https://attack.mitre.org/techniques/T1078/001)'
  detections:
  - component: User Account Authentication
    detects: Monitors activity (attempts, successes, failures) from profile representing
      a user, device, service, or application used to authenticate and access resources.
    fgdsid: FGDS0002.001
    name: User Account
  groups:
  - description: During LightBasin's campaign, the threat actor was observed to gain
      access into eDNS server by abusing default credentials of Huawei devices. [2]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1078.001
  mitigations:
  - fgmid: FGM1032
    mitigates: Use two or more pieces of evidence to authenticate to a system; such
      as username and password in addition to a token from a physical smart card or
      token generator.
    name: Multi-factor Authentication
  - fgmid: FGM1027
    mitigates: Set and enforce secure password policies for accounts.
    name: Password Policies
  name: Default Accounts
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Huawei Area Router Guide.](https://support.huawei.com/enterprise/en/doc/EDOC1000079719/1b8f7bdb/logging-in-to-an-ar-router-through-a-web-system)
  - '<a name="2"> \[2\] </a> [Crowdstrike blog: "LightBasin: A Roaming Threat to Telecommunications
    Companies".](https://www.crowdstrike.com/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="3"> \[3\] </a> [Crowdstrike blog: LIMINAL PANDA: A Closer Look at China''s
    Cyber Threats to the Telecom Sector".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software: []
  status: Observed
  subtechnique-of: FGT1078
  tactics:
  - TA0005
  - TA0003
  - TA0004
  - TA0001
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: Administrative Access
    campaigns: []
    criticalassets:
    - description: Any 5G, Network, OSS and Security capability deployed as PNF supporting
        local accounts
      name: VNF
    - description: Any Virtualization and Network host supporting local account
      name: Host Server
    detections:
    - component: Logon Session Metadata
      detects: Contextual data about a logon session, such as username, logon type,
        access tokens (security context, user SIDs, logon identifiers, and logon SID),
        and any activity associated within it.
      fgdsid: FGDS0028.002
      name: Logon Session
    - component: User Account Authentication
      detects: 'An attempt by a user to gain access to a network or computing resource,
        often by providing credentials (ex: Windows EID 4776 or /var/log/auth.log).'
      fgdsid: FGDS0002.001
      name: User Account
    groups:
    - description: UNC3944 threat actor leveraged the serial console on Azure virtual
        machines in order to gain full administrative access to VMs.
      fggid: FGG5004
      name: Scattered Spider
    - description: Salt Typhoon used tools like Trill Client to harvest administrative
        credentials from browser caches [9], to impersonate privileged users, for
        persistence and further escalation of privileges.
      fggid: G1045
      name: Salt Typhoon
    mitigations:
    - fgmid: FGM1027
      mitigates: Passwords Policies to ensure secure local accounts across all devices
        that necessitate local accounts
      name: Password Policies
    - fgmid: FGM1026
      mitigates: Privileged account management
      name: Privileged Account Management
    name: "## Addendum Name: Infrastructure Local Accounts\r\n### Architecture Segments:\
      \ OA&M\r\n An adversary may use local administrative privileges to bypass network\
      \ controls responsible for access controls and software to achieve persistence.\r\
      \n\r\nIn a 5G deployment, unstaffed locations or low security sites, adversaries\
      \ can use local communication, auxiliary or serial interfaces to gain access\
      \ to device using device local account. \r\n\r\nAn adversary with a legitimate\
      \ or compromised local network operator administrative account may perform unauthorized\
      \ administration of devices and systems. Some devices always maintain local\
      \ accounts in addition to networked Identity, (Credentials) and Access Management\
      \ (IDAM/ICAM). Unauthorized administration of devices and systems can be done\
      \ using these compromised local administrative accounts. "
    platforms:
    - Infrastructure
    - PNF
    preconditions: []
    procedureexamples:
    - description: Adversaries seeking unauthorized access to network devices often
        begin by exploiting default or weak credentials.
      name: Exploit of local account
    - description: Adversaries can exploit AUX and console (COM) ports on servers,
        routers, and switches to gain unauthorized access and manipulate network devices.
      name: Abuse of local accounts using local ports
    references:
    - <a name="1"> \[1\] </a> [ENISA "Threat Landscape and Good Practice Guide for
      Software Defined Networks/5G", Jan. 2016, Table 1, and 2](https://www.enisa.europa.eu/publications/sdn-threat-landscape)
    - "<a name=\"2\"> \\[2\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,\
      \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
      ,\_ October 2021](https://arxiv.org/abs/2108.11206)"
    - <a name="3"> \[3\] </a> [Juniper ScreenOS SSH / Telnet Authentication Backdoor](https://www.tenable.com/plugins/nessus/87601)
    - <a name="4"> \[4\] </a> [US Senators inquiy into Juinper backdoor](https://www.wyden.senate.gov/imo/media/doc/061020%20Wyden%20Led%20Bicameral%20Juniper%20Letter.pdf)
    - <a name="5"> \[5\] </a> [Cisco CVE-2018-15439](https://nvd.nist.gov/vuln/detail/cve-2018-15439)
    - <a name="6"> \[6\] </a> [Azure Serial Ports Exploit](https://www.bleepingcomputer.com/news/security/hackers-use-azure-serial-console-for-stealthy-access-to-vms)
    - <a name="7"> \[7\] </a> [Cisco Small Business Switches Privileged Access Vulnerability](https://www.cisco.com/c/en/us/support/docs/csa/cisco-sa-20181107-sbsw-privacc.html)
    - '<a name="8"> \[8\] </a> [SIM Swapping and Abuse of the Microsoft Azure Serial
      Console: Serial Is Part of a Well Balanced Attack](https://cloud.google.com/blog/topics/threat-intelligence/sim-swapping-abuse-azure-serial/)'
    - '<a name="9"> \[9\] </a> [Picus Security:"Salt Typhoon: A Persistent Threat
      to Global Telecommunications Infrastructure" (retrieved Jan 31, 2025)](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
    - <a name="10"> \[10\] </a> [MICROSOFT AZURE SERIAL CONSOLE ABUSED IN UNC3944
      ATTACKS](https://duo.com/decipher/microsoft-azure-serial-console-abused-in-unc3944-attacks)
    software: []
  architecture-segment: OA&M
  bluf: Adversaries may obtain and abuse credentials of a local account as a means
    of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.
  campaigns: []
  criticalassets:
  - description: Any 5G, Network, OSS and Security capability deployed as PNF supporting
      local accounts
    name: VNF
  - description: Any Virtualization and Network host supporting local account
    name: Host Server
  description: Adversaries may obtain and abuse credentials of a local account as
    a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense
    Evasion. Local accounts are those configured by an organization for use by users,
    remote support, services, or for administration on a single system or service.
    Local Accounts may also be abused to elevate privileges and harvest credentials
    through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). Password
    reuse may allow the abuse of local accounts across a set of machines on a network
    for the purposes of Privilege Escalation and Lateral Movement.[To read more, please
    see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1078/003)
  detections:
  - component: Logon Session Metadata
    detects: Contextual data about a logon session, such as username, logon type,
      access tokens (security context, user SIDs, logon identifiers, and logon SID),
      and any activity associated within it.
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: User Account Authentication
    detects: 'An attempt by a user to gain access to a network or computing resource,
      often by providing credentials (ex: Windows EID 4776 or /var/log/auth.log).'
    fgdsid: FGDS0002.001
    name: User Account
  groups:
  - description: UNC3944 threat actor leveraged the serial console on Azure virtual
      machines in order to gain full administrative access to VMs.
    fggid: FGG5004
    name: Scattered Spider
  - description: Salt Typhoon used tools like Trill Client to harvest administrative
      credentials from browser caches [9], to impersonate privileged users, for persistence
      and further escalation of privileges.
    fggid: G1045
    name: Salt Typhoon
  id: FGT1078.003
  mitigations:
  - fgmid: FGM1027
    mitigates: Passwords Policies to ensure secure local accounts across all devices
      that necessitate local accounts
    name: Password Policies
  - fgmid: FGM1026
    mitigates: Privileged account management
    name: Privileged Account Management
  name: Local Accounts
  object-type: technique
  postconditions:
  - description: Successful exploit can lead to disabling remote authentication, or
      gaining physical access to a device, adversary can override security controls
      and retain control over the compromised network element.
    name: Compromised host or network element
  preconditions: []
  procedureexamples:
  - description: Adversaries seeking unauthorized access to network devices often
      begin by exploiting default or weak credentials.
    name: Exploit of local account
  - description: Adversaries can exploit AUX and console (COM) ports on servers, routers,
      and switches to gain unauthorized access and manipulate network devices.
    name: Abuse of local accounts using local ports
  references:
  - <a name="1"> \[1\] </a> [ENISA "Threat Landscape and Good Practice Guide for Software
    Defined Networks/5G", Jan. 2016, Table 1, and 2](https://www.enisa.europa.eu/publications/sdn-threat-landscape)
  - "<a name=\"2\"> \\[2\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,\
    \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
    ,\_ October 2021](https://arxiv.org/abs/2108.11206)"
  - <a name="3"> \[3\] </a> [Juniper ScreenOS SSH / Telnet Authentication Backdoor](https://www.tenable.com/plugins/nessus/87601)
  - <a name="4"> \[4\] </a> [US Senators inquiy into Juinper backdoor](https://www.wyden.senate.gov/imo/media/doc/061020%20Wyden%20Led%20Bicameral%20Juniper%20Letter.pdf)
  - <a name="5"> \[5\] </a> [Cisco CVE-2018-15439](https://nvd.nist.gov/vuln/detail/cve-2018-15439)
  - <a name="6"> \[6\] </a> [Azure Serial Ports Exploit](https://www.bleepingcomputer.com/news/security/hackers-use-azure-serial-console-for-stealthy-access-to-vms)
  - <a name="7"> \[7\] </a> [Cisco Small Business Switches Privileged Access Vulnerability](https://www.cisco.com/c/en/us/support/docs/csa/cisco-sa-20181107-sbsw-privacc.html)
  - '<a name="8"> \[8\] </a> [SIM Swapping and Abuse of the Microsoft Azure Serial
    Console: Serial Is Part of a Well Balanced Attack](https://cloud.google.com/blog/topics/threat-intelligence/sim-swapping-abuse-azure-serial/)'
  - '<a name="9"> \[9\] </a> [Picus Security:"Salt Typhoon: A Persistent Threat to
    Global Telecommunications Infrastructure" (retrieved Jan 31, 2025)](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
  - <a name="10"> \[10\] </a> [MICROSOFT AZURE SERIAL CONSOLE ABUSED IN UNC3944 ATTACKS](https://duo.com/decipher/microsoft-azure-serial-console-abused-in-unc3944-attacks)
  software: []
  status: Theoretical
  subtechnique-of: FGT1078
  tactics:
  - TA0003
  - TA0005
  - TA0004
  - TA0001
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns: []
    criticalassets:
    - description: RAN and Core CNFs
      name: Containerized network functions
    - description: Cloud, Kubernetes, or Openstack administrative controllers
      name: Cloud/virtualized container Management controllers
    detections:
    - component: Logon Session Creation
      detects: Monitors suspicious account behavior across cloud services that share
        account.  Logon session logs and meta data helps determine if the session
        was an authorized activity.
      fgdsid: FGDS0028.001
      name: Logon Session
    - component: User Account Authentication
      detects: Monitors user account authentication activity.  Monitors the activity
        of cloud accounts to detect abnormal or malicious behavior, such as accessing
        information outside of the normal function of the account or account usage
        at atypical hours.  Repeated attempts may be indictive of password guessing
        or brute force password cracking.
      fgdsid: FGDS0002.001
      name: User Account
    groups:
    - description: UNC3944 uses social engineering, phishing, smishing to gain access
        to cloud accounts and used that to establish foot hold in cloud infrastructure,
        add VMs and applications for persistence and lateral movements.
      fggid: FGG5004
      name: Scattered Spider
    - description: Salt Typhoon compromised cloud credentials for data breach and
        lateral movements.
      fggid: G1045
      name: Salt Typhoon
    mitigations:
    - fgmid: FGM1032
      mitigates: Use multi-factor authentication for cloud and virtualization OSS
        accounts used for VNF deployments, especially privileged accounts.
      name: Multi-factor Authentication
    - fgmid: FGM1027
      mitigates: Ensure that cloud accounts, particularly privileged accounts, have
        complex, unique passwords across all systems on the network. Passwords and
        access keys should be rotated regularly. This limits the amount of time credentials
        can be used to access resources if a credential is compromised without your
        knowledge. Rotate access keys regularly.
      name: Password Policies
    - fgmid: FGM1026
      mitigates: Review privileged cloud account permission levels routinely to look
        for those that could allow an adversary to gain wide access.
      name: Privileged Account Management
    - fgmid: FGM1018
      mitigates: Periodically review user accounts and remove those that are inactive
        or unnecessary. Limit the ability for user accounts to create additional accounts.
      name: User Account Management
    - fgmid: FGM1017
      mitigates: Applications may send push notifications to verify a login as a form
        of multi-factor authentication (MFA). Train users to only accept valid push
        notifications and to report suspicious push notifications.
      name: User Training
    name: "## Addendum Name: Container Management- Unauthorized Access\r\n### Architecture\
      \ Segments: OA&M, RAN, O-RAN, Virtualization\r\n An adversary may use privileged\
      \ accounts of valid, role-based accounts for management services to gain access\
      \ to network elements.\r\n\r\nAn adversary may also use a valid account with\
      \ excessive privileges (i.e., does not follow least privilege policy) to gain\
      \ access to container execution environment. If access rights are not tailored\
      \ to specific needs of users, the risk to attack container execution increases.\r\
      \n\r\nInternal or external adversary may gain access to management account credentials\
      \ (e.g. due to weak account management practices) allowing access to VNF containers\
      \ for persistence, and defense evasion."
    platforms:
    - Infrastructure
    - CI/CD
    - OA&M
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [ETSI NFV SEC023, Container Security Spec, section 5.4.4,
      Accessed 6/27/2022](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC023_Container_Security_Spec/NFV-SEC023v005.zip)
    - <a name="2"> \[2\] </a> [Peirates](https://github.com/inguardians/peirates)
    - <a name="3"> \[3\] </a> [Kubernetes Used in Brute-Force Attacks Tied to Russia's
      APT28](https://vulners.com/threatpost/THREATPOST:B25070E6CF075EEA6B20C4D8D25ADBE8)
    - <a name="4"> \[4\] </a> [UNC3944 aka Scattered Panda Proactive Hardening](https://cloud.google.com/blog/topics/threat-intelligence/unc3944-proactive-hardening-recommendations)
    - <a name="5"> \[5\] </a> [Azure Serial Ports Exploit](https://www.bleepingcomputer.com/news/security/hackers-use-azure-serial-console-for-stealthy-access-to-vms)
    - <a name="6"> \[6\] </a> [Microsoft Azure serial console abused in UNC3944 attacks](https://duo.com/decipher/microsoft-azure-serial-console-abused-in-unc3944-attacks)
    - <a name="7"> \[7\] </a> [Salt Typhoon Believed to Be Behind Commvault Data Breach](https://www.bankinfosecurity.com/salt-typhoon-believed-to-be-behind-commvault-data-breach-a-28496)
    software:
    - description: Peirates is a post-exploitation Kubernetes exploitation framework
        with a focus on gathering service account tokens for lateral movement and
        privilege escalation.
      fgsid: S0683
      name: Peirates
  architecture-segment: Virtualization, OA&M, RAN, O-RAN
  bluf: Valid accounts in cloud environments may allow adversaries to perform actions
    to achieve Initial Access, Persistence, Privilege Escalation, or Defense Evasion.
  campaigns: []
  criticalassets:
  - description: RAN and Core CNFs
    name: Containerized network functions
  - description: Cloud, Kubernetes, or Openstack administrative controllers
    name: Cloud/virtualized container Management controllers
  description: 'Valid accounts in cloud environments may allow adversaries to perform
    actions to achieve Initial Access, Persistence, Privilege Escalation, or Defense
    Evasion. Cloud accounts are those created and configured by an organization for
    use by users, remote support, services, or for administration of resources within
    a cloud service provider or SaaS application. Cloud Accounts can exist solely
    in the cloud or be hybrid joined between on-premises systems and the cloud through
    federation with other identity sources such as Windows Active Directory. (Citation:
    AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying
    AD Federation) Service or user accounts may be targeted by adversaries through
    [Brute Force](https://attack.mitre.org/techniques/T1110), [Phishing](https://attack.mitre.org/techniques/T1566),
    or various other means to gain access to the environment. Federated accounts may
    be a pathway for the adversary to affect both on-premises systems and cloud environments.
    An adversary may create long lasting [Additional Cloud Credentials](https://attack.mitre.org/techniques/T1098/001)
    on a compromised cloud account to maintain persistence in the environment. Such
    credentials may also be used to bypass security controls such as multi-factor
    authentication. Cloud accounts may also be able to assume [Temporary Elevated
    Cloud Access](https://attack.mitre.org/techniques/T1548/005) or other privileges
    through various means within the environment. Misconfigurations in role assignments
    or role assumption policies may allow an adversary to use these mechanisms to
    leverage permissions outside the intended scope of the account. Such over privileged
    accounts may be used to harvest sensitive data from online storage accounts and
    databases through [Cloud API](https://attack.mitre.org/techniques/T1059/009) or
    other methods.[To read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1078/004)'
  detections:
  - component: Logon Session Creation
    detects: Monitors suspicious account behavior across cloud services that share
      account.  Logon session logs and meta data helps determine if the session was
      an authorized activity.
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: User Account Authentication
    detects: Monitors user account authentication activity.  Monitors the activity
      of cloud accounts to detect abnormal or malicious behavior, such as accessing
      information outside of the normal function of the account or account usage at
      atypical hours.  Repeated attempts may be indictive of password guessing or
      brute force password cracking.
    fgdsid: FGDS0002.001
    name: User Account
  groups:
  - description: UNC3944 uses social engineering, phishing, smishing to gain access
      to cloud accounts and used that to establish foot hold in cloud infrastructure,
      add VMs and applications for persistence and lateral movements.
    fggid: FGG5004
    name: Scattered Spider
  - description: Salt Typhoon compromised cloud credentials for data breach and lateral
      movements.
    fggid: G1045
    name: Salt Typhoon
  id: FGT1078.004
  mitigations:
  - fgmid: FGM1032
    mitigates: Use multi-factor authentication for cloud and virtualization OSS accounts
      used for VNF deployments, especially privileged accounts.
    name: Multi-factor Authentication
  - fgmid: FGM1027
    mitigates: Ensure that cloud accounts, particularly privileged accounts, have
      complex, unique passwords across all systems on the network. Passwords and access
      keys should be rotated regularly. This limits the amount of time credentials
      can be used to access resources if a credential is compromised without your
      knowledge. Rotate access keys regularly.
    name: Password Policies
  - fgmid: FGM1026
    mitigates: Review privileged cloud account permission levels routinely to look
      for those that could allow an adversary to gain wide access.
    name: Privileged Account Management
  - fgmid: FGM1018
    mitigates: Periodically review user accounts and remove those that are inactive
      or unnecessary. Limit the ability for user accounts to create additional accounts.
    name: User Account Management
  - fgmid: FGM1017
    mitigates: Applications may send push notifications to verify a login as a form
      of multi-factor authentication (MFA). Train users to only accept valid push
      notifications and to report suspicious push notifications.
    name: User Training
  name: Cloud Accounts
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC023, Container Security Spec, section 5.4.4,
    Accessed 6/27/2022](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC023_Container_Security_Spec/NFV-SEC023v005.zip)
  - <a name="2"> \[2\] </a> [Peirates](https://github.com/inguardians/peirates)
  - <a name="3"> \[3\] </a> [Kubernetes Used in Brute-Force Attacks Tied to Russia's
    APT28](https://vulners.com/threatpost/THREATPOST:B25070E6CF075EEA6B20C4D8D25ADBE8)
  - <a name="4"> \[4\] </a> [UNC3944 aka Scattered Panda Proactive Hardening](https://cloud.google.com/blog/topics/threat-intelligence/unc3944-proactive-hardening-recommendations)
  - <a name="5"> \[5\] </a> [Azure Serial Ports Exploit](https://www.bleepingcomputer.com/news/security/hackers-use-azure-serial-console-for-stealthy-access-to-vms)
  - <a name="6"> \[6\] </a> [Microsoft Azure serial console abused in UNC3944 attacks](https://duo.com/decipher/microsoft-azure-serial-console-abused-in-unc3944-attacks)
  - <a name="7"> \[7\] </a> [Salt Typhoon Believed to Be Behind Commvault Data Breach](https://www.bankinfosecurity.com/salt-typhoon-believed-to-be-behind-commvault-data-breach-a-28496)
  software:
  - description: Peirates is a post-exploitation Kubernetes exploitation framework
      with a focus on gathering service account tokens for lateral movement and privilege
      escalation.
    fgsid: S0683
    name: Peirates
  status: Observed
  subtechnique-of: FGT1078
  tactics:
  - TA0005
  - TA0003
  - TA0004
  - TA0001
  typecode: attack_subtechnique_addendum
- bluf: Adversaries may use a connection proxy to direct network traffic between systems
    or act as an intermediary for network communications to a command and control
    server to avoid direct connections to their infrastructure.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may use a connection proxy to direct network traffic between
    systems or act as an intermediary for network communications to a command and
    control server to avoid direct connections to their infrastructure. Many tools
    exist that enable traffic redirection through proxies or port redirection, including
    [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation:
    Trend Micro APT Attack Tools) Adversaries use these types of proxies to manage
    command and control communications, reduce the number of simultaneous outbound
    network connections, provide resiliency in the face of connection loss, or to
    ride over existing trusted communications paths between victims to avoid suspicion.
    Adversaries may chain together multiple proxies to further disguise the source
    of malicious traffic. Adversaries can also take advantage of routing schemes in
    Content Delivery Networks (CDNs) to proxy command and control traffic.[To read
    more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1090)'
  detections: []
  groups: []
  id: FGT1090
  mitigations: []
  name: Proxy
  object-type: technique
  platforms: Linux, macOS, Windows, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0011
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: User/subscriber, Admin, Expanded Privilege.
    campaigns: []
    criticalassets: []
    detections:
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log).'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: 'Logged network traffic data showing both protocol header and body
        values (ex: PCAP).'
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log).'
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups:
    - description: Microsocks Proxy was used by LIMINAL PANDA to pivot to systems
        internally. [1]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1031
      mitigates: Network intrusion detection and prevention systems that use network
        signatures to identify traffic patterns to new or unapproved infrastructure.
      name: Network Intrusion Prevention
    name: "## Addendum Name: Internal Proxy\r\n### Architecture Segments: User Plane,\
      \ Control Plane\r\n Adversaries may use an internal proxy to direct command\
      \ and control traffic between two or more systems in a compromised environment.\r\
      \n\r\nMany tools exist that enable traffic redirection through proxies or port\
      \ redirection, including Microsocks Proxy.\r\n\r\nAdversaries use internal proxies\
      \ to manage command and control communications inside a compromised environment,\
      \ to reduce the number of simultaneous outbound network connections, to provide\
      \ resiliency in the face of connection loss, or to ride over existing trusted\
      \ communications paths between infected systems to avoid suspicion."
    platforms:
    - 5G RAN
    - 5G core
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
    software:
    - description: Microsocks Proxy is a lightweight SOCKS5 proxy server used to pivot
        to systems internally used by Liminal Panda. [1]
      fgsid: FGS5004
      name: Microsocks Proxy
  architecture-segment: Control Plane, User Plane
  bluf: Adversaries may use an internal proxy to direct command and control traffic
    between two or more systems in a compromised environment.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may use an internal proxy to direct command and control
    traffic between two or more systems in a compromised environment. Many tools exist
    that enable traffic redirection through proxies or port redirection, including
    [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation:
    Trend Micro APT Attack Tools) Adversaries use internal proxies to manage command
    and control communications inside a compromised environment, to reduce the number
    of simultaneous outbound network connections, to provide resiliency in the face
    of connection loss, or to ride over existing trusted communications paths between
    infected systems to avoid suspicion. Internal proxy connections may use common
    peer-to-peer (p2p) networking protocols, such as SMB, to better blend in with
    the environment. By using a compromised internal system as a proxy, adversaries
    may conceal the true destination of C2 traffic while reducing the need for numerous
    connections to external systems.[To read more, please see the MITRE ATT&CK page
    for this subtechnique](https://attack.mitre.org/techniques/T1090/001)'
  detections:
  - component: Network Connection Creation
    detects: 'Initial construction of a network connection, such as capturing socket
      information with a source/destination IP and port(s) (ex: Windows EID 5156,
      Sysmon EID 3, or Zeek conn.log).'
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Logged network traffic data showing both protocol header and body values
      (ex: PCAP).'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarized network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log).'
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups:
  - description: Microsocks Proxy was used by LIMINAL PANDA to pivot to systems internally.
      [1]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1090.001
  mitigations:
  - fgmid: FGM1031
    mitigates: Network intrusion detection and prevention systems that use network
      signatures to identify traffic patterns to new or unapproved infrastructure.
    name: Network Intrusion Prevention
  name: Internal Proxy
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software:
  - description: Microsocks Proxy is a lightweight SOCKS5 proxy server used to pivot
      to systems internally used by Liminal Panda. [1]
    fgsid: FGS5004
    name: Microsocks Proxy
  status: Observed
  subtechnique-of: FGT1090
  tactics:
  - TA0011
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: User/subscriber, Admin, Expanded Privilege.
    campaigns: []
    criticalassets: []
    detections:
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log).'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: 'Logged network traffic data showing both protocol header and body
        values (ex: PCAP).'
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log).'
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups:
    - description: Fast Reverse Prox was used by LIMINAL PANDA as a reverse proxy
        that allowed C2 access from external systems. [1]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1031
      mitigates: Network intrusion detection and prevention systems that use network
        signatures to identify traffic patterns to new or unapproved external infrastructure
        or untrusted hosts.
      name: Network Intrusion Prevention
    name: "## Addendum Name: External Proxy\r\n### Architecture Segments: User Plane,\
      \ Control Plane\r\n Adversaries may use an external proxy to act as an intermediary\
      \ for network communications to a C2 server to avoid direct connections to their\
      \ infrastructure.\r\n\r\nMany tools exist that enable traffic redirection through\
      \ proxies or port redirection, including Fast Reverse Proxy.\r\n\r\nAdversaries\
      \ use these types of proxies to manage command and control communications, to\
      \ provide resiliency in the face of connection loss, or to ride over existing\
      \ trusted communications paths to avoid suspicion."
    platforms:
    - 5G Core
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
    software:
    - description: Fast Reverse Proxy utility is a reverse proxy used that permits
        C2 access to an actor-controlled servers (e.g., DNS) used by Liminal Panda.
        [1]
      fgsid: FGS5003
      name: Fast Reverse Proxy
  architecture-segment: Control Plane, User Plane
  bluf: Adversaries may use an external proxy to act as an intermediary for network
    communications to a command and control server to avoid direct connections to
    their infrastructure.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may use an external proxy to act as an intermediary for
    network communications to a command and control server to avoid direct connections
    to their infrastructure. Many tools exist that enable traffic redirection through
    proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040),
    ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools) Adversaries use
    these types of proxies to manage command and control communications, to provide
    resiliency in the face of connection loss, or to ride over existing trusted communications
    paths to avoid suspicion. External connection proxies are used to mask the destination
    of C2 traffic and are typically implemented with port redirectors. Compromised
    systems outside of the victim environment may be used for these purposes, as well
    as purchased infrastructure such as cloud-based resources or virtual private servers.
    Proxies may be chosen based on the low likelihood that a connection to them from
    a compromised system would be investigated. Victim systems would communicate directly
    with the external proxy on the Internet and then the proxy would forward communications
    to the C2 server.[To read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1090/002)'
  detections:
  - component: Network Connection Creation
    detects: 'Initial construction of a network connection, such as capturing socket
      information with a source/destination IP and port(s) (ex: Windows EID 5156,
      Sysmon EID 3, or Zeek conn.log).'
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Logged network traffic data showing both protocol header and body values
      (ex: PCAP).'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarized network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log).'
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups:
  - description: Fast Reverse Prox was used by LIMINAL PANDA as a reverse proxy that
      allowed C2 access from external systems. [1]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1090.002
  mitigations:
  - fgmid: FGM1031
    mitigates: Network intrusion detection and prevention systems that use network
      signatures to identify traffic patterns to new or unapproved external infrastructure
      or untrusted hosts.
    name: Network Intrusion Prevention
  name: External Proxy
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software:
  - description: Fast Reverse Proxy utility is a reverse proxy used that permits C2
      access to an actor-controlled servers (e.g., DNS) used by Liminal Panda. [1]
    fgsid: FGS5003
    name: Fast Reverse Proxy
  status: Observed
  subtechnique-of: FGT1090
  tactics:
  - TA0011
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: User/subscriber, Admin, Expanded Privilege.
    campaigns: []
    criticalassets: []
    detections:
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log).'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: 'Logged network traffic data showing both protocol header and body
        values (ex: PCAP).'
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log).'
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups:
    - description: ProxyChains was used by Liminal Panda to force network traffic
        through a chain of proxies belonging to different telecommunication organizations
        around the world. [1]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1031
      mitigates: Network intrusion detection and prevention systems that use network
        signatures to identify patterns and block traffic sent or received by unknown
        external infrastructure or untrusted hosts.
      name: Network Intrusion Prevention
    name: "## Addendum Name: Multi-hop Proxy\r\n### Architecture Segments: User Plane,\
      \ Control Plane\r\n Adversaries may chain together multiple proxies to disguise\
      \ the source of malicious traffic.\r\n\r\nTypically, a defender will be able\
      \ to identify the last proxy traffic traversed before it enters their network;\
      \ the defender may or may not be able to identify any previous proxies before\
      \ the last-hop proxy. This technique makes identifying the original source of\
      \ the malicious traffic even more difficult by requiring the defender to trace\
      \ malicious traffic through several proxies to identify its source."
    platforms:
    - 5G network
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
    software:
    - description: Liminal Panda used proxyChains, proxy is a utility capable of forcing
        network traffic through a chain of proxies, even if the program generating
        the traffic does not have proxy support. It utilizes a configuration file
        to specify proxies in use. [1]
      fgsid: FGS5002
      name: ProxyChains
  architecture-segment: Control Plane, User Plane
  bluf: To disguise the source of malicious traffic, adversaries may chain together
    multiple proxies.
  campaigns: []
  criticalassets: []
  description: 'To disguise the source of malicious traffic, adversaries may chain
    together multiple proxies. Typically, a defender will be able to identify the
    last proxy traffic traversed before it enters their network; the defender may
    or may not be able to identify any previous proxies before the last-hop proxy.
    This technique makes identifying the original source of the malicious traffic
    even more difficult by requiring the defender to trace malicious traffic through
    several proxies to identify its source. A particular variant of this behavior
    is to use onion routing networks, such as the publicly available TOR network.
    (Citation: Onion Routing) In the case of network infrastructure, particularly
    routers, it is possible for an adversary to leverage multiple compromised devices
    to create a multi-hop proxy chain within the Wide-Area Network (WAN) of the enterprise.
    By leveraging [Patch System Image](https://attack.mitre.org/techniques/T1601/001),
    adversaries can add custom code to the affected network devices that will implement
    onion routing between those nodes. This custom onion routing network will transport
    the encrypted C2 traffic through the compromised population, allowing adversaries
    to communicate with any device within the onion routing network. This method is
    dependent upon the [Network Boundary Bridging](https://attack.mitre.org/techniques/T1599)
    method in order to allow the adversaries to cross the protected network boundary
    of the Internet perimeter and into the organization''s WAN. Protocols such as
    ICMP may be used as a transport.[To read more, please see the MITRE ATT&CK page
    for this subtechnique](https://attack.mitre.org/techniques/T1090/003)'
  detections:
  - component: Network Connection Creation
    detects: 'Initial construction of a network connection, such as capturing socket
      information with a source/destination IP and port(s) (ex: Windows EID 5156,
      Sysmon EID 3, or Zeek conn.log).'
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Logged network traffic data showing both protocol header and body values
      (ex: PCAP).'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarized network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log).'
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups:
  - description: ProxyChains was used by Liminal Panda to force network traffic through
      a chain of proxies belonging to different telecommunication organizations around
      the world. [1]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1090.003
  mitigations:
  - fgmid: FGM1031
    mitigates: Network intrusion detection and prevention systems that use network
      signatures to identify patterns and block traffic sent or received by unknown
      external infrastructure or untrusted hosts.
    name: Network Intrusion Prevention
  name: Multi-hop Proxy
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike Blog: "Unveiling LIMINAL PANDA".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software:
  - description: Liminal Panda used proxyChains, proxy is a utility capable of forcing
      network traffic through a chain of proxies, even if the program generating the
      traffic does not have proxy support. It utilizes a configuration file to specify
      proxies in use. [1]
    fgsid: FGS5002
    name: ProxyChains
  status: Observed
  subtechnique-of: FGT1090
  tactics:
  - TA0011
  typecode: attack_subtechnique_addendum
- bluf: Adversaries may use brute force techniques to gain access to accounts when
    passwords are unknown or when password hashes are obtained.
  campaigns: []
  criticalassets: []
  description: Adversaries may use brute force techniques to gain access to accounts
    when passwords are unknown or when password hashes are obtained. Without knowledge
    of the password for an account or set of accounts, an adversary may systematically
    guess the password using a repetitive or iterative mechanism. Brute forcing passwords
    can take place via interaction with a service that will check the validity of
    those credentials or offline against previously acquired credential data, such
    as password hashes. Brute forcing credentials may take place at various points
    during a breach. For example, adversaries may attempt to brute force access to
    [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment
    leveraging knowledge gathered from other post-compromise behaviors such as [OS
    Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087),
    or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries
    may also combine brute forcing activity with behaviors such as [External Remote
    Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1110)
  detections: []
  groups: []
  id: FGT1110
  mitigations: []
  name: Brute Force
  object-type: technique
  platforms: Windows, Azure AD, Office 365, SaaS, IaaS, Linux, macOS, Google Workspace,
    Containers, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0006
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections:
    - component: User Account Authentication
      detects: Monitors activity (attempts, successes, failures) from profile representing
        a user, device, service, or application used to authenticate and access resources.
      fgdsid: FGDS0002.001
      name: User Account
    groups:
    - description: "CrowdStrike uncovered evidence showing LIMINAL PANDA initially\
        \ accessed the first eDNS server via SSH from another compromised telecommunications\
        \ company by password spraying extremely weak and third-party-focused passwords\
        \ (e.g.,\_huawei). [1]"
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1032
      mitigates: Use two or more pieces of evidence to authenticate to a system; such
        as username and password in addition to a token from a physical smart card
        or token generator.
      name: Multi-factor Authentication
    - fgmid: FGM1027
      mitigates: Set and enforce secure password policies for accounts.
      name: Password Policies
    name: "## Addendum Name: Password Guessing eDNS Server\r\n### Architecture Segments:\
      \ Cloud Service Provider\r\n Adversaries with no prior knowledge of legitimate\
      \ credentials within the system or environment may guess passwords to attempt\
      \ access to accounts.\r\n\r\nAdversaries may use a list of commonly used passwords\
      \ or default device passwords, against many different accounts to attempt to\
      \ acquire valid account credentials to gain access to Telecommunication infrastructure,\
      \ such as GRX and IPX DNS servers. For example, LIMINAL PANDA compromised several\
      \ telecommunications companies via their external DNS (eDNS) servers, which\
      \ are part of the General Packet Radio Service (GPRS) networ, and play a role\
      \ in roaming between different mobile operators [1]\r\n\r\nCrowdStrike determined\
      \ that Liminal Panda compromised multiple telecom providers by targeting their\
      \ GRX and IPX DNS servers.\_Liminal Panda gained access by performing password\
      \ spraying attacks on weak credentials. LIMINAL PANDA has likely compromised\
      \ at least 13 telecommunication companies."
    platforms:
    - OA&M
    - Core
    - Virtualization
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [LIMINAL PANDA: A Closer Look at China''s Cyber Threats
      to the Telecom Sector](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
    software: []
  architecture-segment: Cloud Service Provider
  bluf: Adversaries with no prior knowledge of legitimate credentials within the system
    or environment may guess passwords to attempt access to accounts.
  campaigns: []
  criticalassets: []
  description: 'Adversaries with no prior knowledge of legitimate credentials within
    the system or environment may guess passwords to attempt access to accounts. Without
    knowledge of the password for an account, an adversary may opt to systematically
    guess the password using a repetitive or iterative mechanism. An adversary may
    guess login credentials without prior knowledge of system or environment passwords
    during an operation by using a list of common passwords. Password guessing may
    or may not take into account the target''s policies on password complexity or
    use policies that may lock accounts out after a number of failed attempts. Guessing
    passwords can be a risky option because it could cause numerous authentication
    failures and account lockouts, depending on the organization''s login failure
    policies. (Citation: Cylance Cleaver) Typically, management services over commonly
    used ports are used when guessing passwords. Commonly targeted services include
    the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB
    / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal
    Services (3389/TCP) * HTTP/HTTP Management Services (80/TCP & 443/TCP) * MSSQL
    (1433/TCP) * Oracle (1521/TCP) * MySQL (3306/TCP) * VNC (5900/TCP) * SNMP (161/UDP
    and 162/TCP/UDP) In addition to management services, adversaries may "target single
    sign-on (SSO) and cloud-based applications utilizing federated authentication
    protocols," as well as externally facing email applications, such as Office 365.(Citation:
    US-CERT TA18-068A 2018). Further, adversaries may abuse network device interfaces
    (such as `wlanAPI`) to brute force accessible wifi-router(s) via wireless authentication
    protocols.(Citation: Trend Micro Emotet 2020) In default environments, LDAP and
    Kerberos connection attempts are less likely to trigger events over SMB, which
    creates Windows "logon failure" event ID 4625.[To read more, please see the MITRE
    ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1110/001)'
  detections:
  - component: User Account Authentication
    detects: Monitors activity (attempts, successes, failures) from profile representing
      a user, device, service, or application used to authenticate and access resources.
    fgdsid: FGDS0002.001
    name: User Account
  groups:
  - description: "CrowdStrike uncovered evidence showing LIMINAL PANDA initially accessed\
      \ the first eDNS server via SSH from another compromised telecommunications\
      \ company by password spraying extremely weak and third-party-focused passwords\
      \ (e.g.,\_huawei). [1]"
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1110.001
  mitigations:
  - fgmid: FGM1032
    mitigates: Use two or more pieces of evidence to authenticate to a system; such
      as username and password in addition to a token from a physical smart card or
      token generator.
    name: Multi-factor Authentication
  - fgmid: FGM1027
    mitigates: Set and enforce secure password policies for accounts.
    name: Password Policies
  name: Password Guessing
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [LIMINAL PANDA: A Closer Look at China''s Cyber Threats
    to the Telecom Sector](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  software: []
  status: Observed
  subtechnique-of: FGT1110
  tactics:
  - TA0006
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: The Network Exposure Function has the N33 interface exposed to
        an Application Function (AF) on the Internet (3rd party).
      name: NEF
    detections:
    - component: Application Log Content
      detects: Collect and inspect access logs , application logs. Web Application
        Firewalls may detect improper inputs attempting exploitation.
      fgdsid: FGDS0015.001
      name: Application Log
    - component: Network Traffic Content
      detects: Examine network traffic content. The NEF supports TCP, HTTP2 and JSON
        . Look for compromise in the same way as for an RESTful API interface, but
        tailored to each function.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups:
    - description: Salt Typhoon has gained initial access through exploitation of
        vulnerabilities in internet-facing software and appliances, such as Sophos
        Firewall, Ivanti VPN, Fortinet FortiClient EMS, and Microsoft Exchange Server
        ([6],[7]).
      fggid: G1045
      name: Salt Typhoon
    mitigations:
    - fgmid: FGM1016
      mitigates: Vulnerability scanning of public APIs.
      name: Vulnerability Scanning
    - fgmid: FGM1050
      mitigates: Use Web Application Firewall (WAF) to minimize potential exploit
        of vulnerabilities.
      name: Exploit Protection
    - fgmid: FGM1030
      mitigates: Network segmentation - place NEF within a DMZ or separate hosting
        infrastructure.
      name: Network Segmentation
    name: "## Addendum Name: Exploit Public-Facing Network Function\r\n### Architecture\
      \ Segments: Control Plane, User Plane\r\n An adversary may exploit weaknesses\
      \ in Application Programming Interfaces (API) on Network Functions (NF) that\
      \ are exposed to the public Internet, in order to compromise the NF, or disclose\
      \ information.\r\n\r\nSome 5G functions such as the Network Exposure Function\
      \ (NEF) have APIs that are public facing and are subject to potential exploit\
      \ by adversaries similarly to public facing websites and services. The adversary\
      \ could exploit a previously identified weakness in the API to gain initial\
      \ access to the operator's environment. The adversary may also obtain credentials\
      \ through other techniques that allow the adversary to obtain unauthorized information\
      \ from the exposed network function. See Exploit Semi-public Facing Application\
      \ [FGT5029](/techniques/FGT5029) for API exposure to interworking networks.\r\
      \n\r\nAn example of this is represented through access control of application\
      \ functions (AF) by NEF, which is done at the API level and so is not protected\
      \ at a granular enough level, i.e., it is not done at Information Element (IE)\
      \ level. An adversary may use a 3rd party AF to make requests for a service,\
      \ e.g. location of a UE, beyond their authorization level since IE's are not\
      \ explicitly required to be checked. "
    platforms:
    - 5G Core
    preconditions:
    - description: Adversary may need to identify vulnerabilities in the API to obtain
        initial-access, unauthorized information, or perform a denial of service.
      name: API vulnerability
    - description: Adversary may need to obtain credentials to collect unauthorized
        information.
      name: API credentials
    procedureexamples:
    - description: Adversary uses an insecure API to take over the edge NF, then can
        use legitimate signaling to obtain sensitive UE or network data ([1], [2],
        [3]).
      name: Sensitive data exposure
    - description: Adversary may bypass standard AF API access control mechanism by
        using crafted IEs to access sensitive data such as location of a UE through
        NEF ([4].)
      name: Exploit vulnerable API
    references:
    - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
      Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
    - '<a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
      October 2021.](https://arxiv.org/abs/2108.11206)'
    - <a name="3"> \[3\] </a> ["TOP 7 REST API Security Threats", blog January 2019.](https://blog.restcase.com/top-7-rest-api-security-threats/)
    - '<a name="4"> \[4\] </a> [3GPP TS 29.522: "Network Exposure Function Northbound
      APIs; Stage 3".](https://www.3gpp.org/DynaReport/29522.htm)'
    - '<a name="5"> \[5\] </a> [3GPP TS 23.501: "System architecture for the 5G System
      (5GS)".](https://www.3gpp.org/DynaReport/23501.htm)'
    - '<a name="6"> \[6\] </a> [Vectra: "Is your organization safe from Salt Typhoon
      attacks?".](https://www.vectra.ai/threat-actors/salt-typhoon)'
    - "<a name=\"7\"> \\[7\\] </a> [S. \xD6ZEREN: \"Salt Typhoon: A Persistent Threat\
      \ to Global Telecommunications Infrastructure\".](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)"
    software: []
  architecture-segment: Control Plane, User Plane
  bluf: Adversaries may attempt to exploit a weakness in an Internet-facing host or
    system to initially access a network.
  campaigns: []
  criticalassets:
  - description: The Network Exposure Function has the N33 interface exposed to an
      Application Function (AF) on the Internet (3rd party).
    name: NEF
  description: 'Adversaries may attempt to exploit a weakness in an Internet-facing
    host or system to initially access a network. The weakness in the system can be
    a software bug, a temporary glitch, or a misconfiguration. Exploited applications
    are often websites/web servers, but can also include databases (like SQL), standard
    services (like SMB or SSH), network device administration and management protocols
    (like SNMP and Smart Install), and any other system with Internet accessible open
    sockets.(Citation: NVD CVE-2016-6662)(Citation: CIS Multiple SMB Vulnerabilities)(Citation:
    US-CERT TA18-106A Network Infrastructure Devices 2018)(Citation: Cisco Blog Legacy
    Device Attacks)(Citation: NVD CVE-2014-7169) Depending on the flaw being exploited
    this may also involve [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211).
    If an application is hosted on cloud-based infrastructure and/or is containerized,
    then exploiting it may lead to compromise of the underlying instance or container.
    This can allow an adversary a path to access the cloud or container APIs, exploit
    container host access via [Escape to Host](https://attack.mitre.org/techniques/T1611),
    or take advantage of weak identity and access management policies. Adversaries
    may also exploit edge network infrastructure and related appliances, specifically
    targeting devices that do not support robust host-based defenses.(Citation: Mandiant
    Fortinet Zero Day)(Citation: Wired Russia Cyberwar) For websites and databases,
    the OWASP top 10 and CWE top 25 highlight the most common web-based vulnerabilities.(Citation:
    OWASP Top 10)(Citation: CWE top 25)[To read more, please see the MITRE ATT&CK
    page for this technique](https://attack.mitre.org/techniques/T1190)'
  detections:
  - component: Application Log Content
    detects: Collect and inspect access logs , application logs. Web Application Firewalls
      may detect improper inputs attempting exploitation.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Content
    detects: Examine network traffic content. The NEF supports TCP, HTTP2 and JSON
      . Look for compromise in the same way as for an RESTful API interface, but tailored
      to each function.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: Salt Typhoon has gained initial access through exploitation of vulnerabilities
      in internet-facing software and appliances, such as Sophos Firewall, Ivanti
      VPN, Fortinet FortiClient EMS, and Microsoft Exchange Server ([6],[7]).
    fggid: G1045
    name: Salt Typhoon
  id: FGT1190
  mitigations:
  - fgmid: FGM1016
    mitigates: Vulnerability scanning of public APIs.
    name: Vulnerability Scanning
  - fgmid: FGM1050
    mitigates: Use Web Application Firewall (WAF) to minimize potential exploit of
      vulnerabilities.
    name: Exploit Protection
  - fgmid: FGM1030
    mitigates: Network segmentation - place NEF within a DMZ or separate hosting infrastructure.
    name: Network Segmentation
  name: Exploit Public-Facing Application
  object-type: technique
  postconditions: []
  preconditions:
  - description: Adversary may need to identify vulnerabilities in the API to obtain
      initial-access, unauthorized information, or perform a denial of service.
    name: API vulnerability
  - description: Adversary may need to obtain credentials to collect unauthorized
      information.
    name: API credentials
  procedureexamples:
  - description: Adversary uses an insecure API to take over the edge NF, then can
      use legitimate signaling to obtain sensitive UE or network data ([1], [2], [3]).
    name: Sensitive data exposure
  - description: Adversary may bypass standard AF API access control mechanism by
      using crafted IEs to access sensitive data such as location of a UE through
      NEF ([4].)
    name: Exploit vulnerable API
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021.](https://arxiv.org/abs/2108.11206)'
  - <a name="3"> \[3\] </a> ["TOP 7 REST API Security Threats", blog January 2019.](https://blog.restcase.com/top-7-rest-api-security-threats/)
  - '<a name="4"> \[4\] </a> [3GPP TS 29.522: "Network Exposure Function Northbound
    APIs; Stage 3".](https://www.3gpp.org/DynaReport/29522.htm)'
  - '<a name="5"> \[5\] </a> [3GPP TS 23.501: "System architecture for the 5G System
    (5GS)".](https://www.3gpp.org/DynaReport/23501.htm)'
  - '<a name="6"> \[6\] </a> [Vectra: "Is your organization safe from Salt Typhoon
    attacks?".](https://www.vectra.ai/threat-actors/salt-typhoon)'
  - "<a name=\"7\"> \\[7\\] </a> [S. \xD6ZEREN: \"Salt Typhoon: A Persistent Threat\
    \ to Global Telecommunications Infrastructure\".](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)"
  software: []
  status: Observed
  tactics:
  - TA0040
  - TA0001
  - TA0009
  typecode: attack_technique_addendum
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns:
    - description: Solarwind compromise
      fgcid: C0024
      name: Solarwind Compromise
    criticalassets:
    - description: Network functions are prime target to impact 5G communication services
      name: CORE, RAN VNFs
    - description: OSS tools have privileged access and broad reachability and may
        be used to change configuration of the network by adversary.
      name: OSS Tools
    - description: Security tools have privileged access and broad reachability may
        be used to evade defenses and allow for lateral movements by the adversary
      name: Security tools
    - description: CI/CD tools may be used for inserting malware or poisoned images
        as well as change the network elements deployed and their behavior.
      name: CI/CD Tools
    detections:
    - component: Image Modification
      detects: Monitor software images and applications packages
      fgdsid: FGDS0007.004
      name: Image
    - component: Host Status
      detects: Perform physical inspection of hardware to look for potential tampering.
        Perform integrity checking on pre-OS boot mechanisms that can be manipulated
        for malicious purposes and compare against known good baseline behavior.
      fgdsid: FGDS0013.001
      name: Sensor Health
    - component: File Access
      detects: 'Opening a file, which makes the file contents available to the requestor
        (ex: Windows EID 4663)'
      fgdsid: FGDS0022.001
      name: File
    - component: File Creation
      detects: 'Initial construction of a new file (ex: Sysmon EID 11)'
      fgdsid: FGDS0022.002
      name: File
    - component: File Modification
      detects: File contents are changed by adversary.
      fgdsid: FGDS0022.005
      name: File
    groups:
    - description: APT29 is threat group added compromised dynamic link library (dll)
        file during build phase which was part of a patch update, delivered to more
        than 18000 thousands of nodes allowing a C2 backdoor.
      fggid: G0016
      name: APT29
    mitigations:
    - fgmid: FGM1051
      mitigates: Update Software regularly
      name: Update Software
    - fgmid: FGM1016
      mitigates: Vulnerability Scanning of software before it is brought into MNO
        environment as well as regular scans to detect abnormal behavior
      name: Vulnerability Scanning
    name: "## Addendum Name: 5G Supply Chain Compromise\r\n### Architecture Segments:\
      \ Virtualization, OA&M, Virtualization, RAN, O-RAN\r\n Adversaries may manipulate\
      \ products or product delivery mechanisms prior to deployment in an MNO's production\
      \ environment for the purpose of data or system compromise.\r\n\r\n5G deployments\
      \ are expected to have various deployment models comprise of vendor supplied\
      \ VNF/CNFs, open-source software, and dedicated physical appliances from suppliers\
      \ as well as white label hardware. It is also expected that 5G services to end-consumer\
      \ may include third party services to support resources required by 5G Core\
      \ and RAN elements such as third party back haul, MEC or commercial Cloud data\
      \ centers resources. The resources also include O-RAN elements such as O-DU,\
      \ O-RU and O-CU. Adversary may use a software, hardware, or service supply chain\
      \ to insert compromised components (binaries, Firmware, compromised processing\
      \ chips) in the supply chain of a targeted MNO or taint entire supply chain\
      \ first to have option to select a target from victims receiving compromised\
      \ products. Opensource communities may be vulnerable to accidental or intentional\
      \ compromise. These days a lot of reputable vendors also use open-source components\
      \ in their license products, Opensource community may become a conduit to a\
      \ target victim."
    platforms:
    - Infrastructure
    - CI/CD
    - OA&M Tools
    - VNFs
    preconditions: []
    procedureexamples:
    - description: In 2020, Solarwind software update was changed by adversary to
        provide back door access prior to patch update to field deployed systems
      name: Solarwind ORION
    references:
    - <a name="1"> \[1\] </a> [ETSI NFV SEC001, "Network Functions Virtualization
      (NFV); NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)
    - <a name="2"> \[2\] </a> [The Untold Story of the Boldest Supply-Chain Hack Ever.](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)
    - <a name="3"> \[3\] </a> [Analyzing Solorigate, the compromised DLL file that
      started a sophisticated cyberattack](https://www.microsoft.com/en-us/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)
    software: []
  architecture-segment: OA&M, Virtualization, RAN, O-RAN
  bluf: Adversaries may manipulate products or product delivery mechanisms prior to
    receipt by a final consumer for the purpose of data or system compromise.
  campaigns:
  - description: Solarwind compromise
    fgcid: C0024
    name: Solarwind Compromise
  criticalassets:
  - description: Network functions are prime target to impact 5G communication services
    name: CORE, RAN VNFs
  - description: OSS tools have privileged access and broad reachability and may be
      used to change configuration of the network by adversary.
    name: OSS Tools
  - description: Security tools have privileged access and broad reachability may
      be used to evade defenses and allow for lateral movements by the adversary
    name: Security tools
  - description: CI/CD tools may be used for inserting malware or poisoned images
      as well as change the network elements deployed and their behavior.
    name: CI/CD Tools
  description: 'Adversaries may manipulate products or product delivery mechanisms
    prior to receipt by a final consumer for the purpose of data or system compromise.
    Supply chain compromise can take place at any stage of the supply chain including:
    * Manipulation of development tools * Manipulation of a development environment
    * Manipulation of source code repositories (public or private) * Manipulation
    of source code in open-source dependencies * Manipulation of software update/distribution
    mechanisms * Compromised/infected system images (multiple cases of removable media
    infected at the factory)(Citation: IBM Storwize)(Citation: Schneider Electric
    USB Malware) * Replacement of legitimate software with modified versions * Sales
    of modified/counterfeit products to legitimate distributors * Shipment interdiction
    While supply chain compromise can impact any component of hardware or software,
    adversaries looking to gain execution have often focused on malicious additions
    to legitimate software in software distribution or update channels.(Citation:
    Avast CCleaner3 2018)(Citation: Microsoft Dofoil 2018)(Citation: Command Five
    SK 2011) Targeting may be specific to a desired victim set or malicious software
    may be distributed to a broad set of consumers but only move on to additional
    tactics on specific victims.(Citation: Symantec Elderwood Sept 2012)(Citation:
    Avast CCleaner3 2018)(Citation: Command Five SK 2011) Popular open source projects
    that are used as dependencies in many applications may also be targeted as a means
    to add malicious code to users of the dependency.(Citation: Trendmicro NPM Compromise)[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1195)'
  detections:
  - component: Image Modification
    detects: Monitor software images and applications packages
    fgdsid: FGDS0007.004
    name: Image
  - component: Host Status
    detects: Perform physical inspection of hardware to look for potential tampering.
      Perform integrity checking on pre-OS boot mechanisms that can be manipulated
      for malicious purposes and compare against known good baseline behavior.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: File Access
    detects: 'Opening a file, which makes the file contents available to the requestor
      (ex: Windows EID 4663)'
    fgdsid: FGDS0022.001
    name: File
  - component: File Creation
    detects: 'Initial construction of a new file (ex: Sysmon EID 11)'
    fgdsid: FGDS0022.002
    name: File
  - component: File Modification
    detects: File contents are changed by adversary.
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: APT29 is threat group added compromised dynamic link library (dll)
      file during build phase which was part of a patch update, delivered to more
      than 18000 thousands of nodes allowing a C2 backdoor.
    fggid: G0016
    name: APT29
  id: FGT1195
  mitigations:
  - fgmid: FGM1051
    mitigates: Update Software regularly
    name: Update Software
  - fgmid: FGM1016
    mitigates: Vulnerability Scanning of software before it is brought into MNO environment
      as well as regular scans to detect abnormal behavior
    name: Vulnerability Scanning
  name: Supply Chain Compromise
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: In 2020, Solarwind software update was changed by adversary to provide
      back door access prior to patch update to field deployed systems
    name: Solarwind ORION
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC001, "Network Functions Virtualization (NFV);
    NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)
  - <a name="2"> \[2\] </a> [The Untold Story of the Boldest Supply-Chain Hack Ever.](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)
  - <a name="3"> \[3\] </a> [Analyzing Solorigate, the compromised DLL file that started
    a sophisticated cyberattack](https://www.microsoft.com/en-us/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)
  software: []
  status: Theoretical
  tactics:
  - TA0001
  - TA0006
  typecode: attack_technique_addendum
- addendums:
  - access-required: ''
    campaigns: []
    criticalassets:
    - description: Core NFs can be targeted to impact 5G communication services.
      name: Core VNFs
    - description: RAN/O-RAN NFs can be targeted to impact 5G communication services.
      name: RAN VNFs
    - description: OSS tools have privileged access and broad reachability and may
        be used to change configuration of the network by adversary.
      name: OSS Tools
    - description: Security tools have privileged access and broad reachability and
        may be used to evade defenses and allow for lateral movements by the adversary.
      name: Security tools
    - description: CI/CD tools may be used for inserting malware or poisoned images
        as well as change the network elements deployed and their behavior.
      name: Vendor product lifecycle processes
    detections:
    - component: File Modification
      detects: File verification of distributed binaries through hash checking or
        other integrity checking mechanisms. Scan downloads for invalid signatures
        or signatures from untrusted sources and attempt to test software and updates
        prior to deployment while taking note of potential suspicious activity.
      fgdsid: FGDS0022.005
      name: File
    groups: []
    mitigations:
    - fgmid: FGM1051
      mitigates: Update Software regularly.
      name: Update Software
    - fgmid: FGM1016
      mitigates: Vulnerability Scanning of software before it is brought into MNO
        environment as well as regular scans to detect abnormal behavior.
      name: Vulnerability Scanning
    - fgmid: FGM1045
      mitigates: Enforce binary and application integrity with digital signature verification
        to prevent untrusted code from executing.
      name: Code Signing
    - fgmid: FGM5520
      mitigates: Enforce policy to use signed Software Bill of Materials (SBOMs) and
        software.
      name: Use SBOM
    - fgmid: FGM0817
      mitigates: Implement a supply chain management program, including policies and
        procedures to ensure all devices and components originate from a trusted supplier
        and are tested to verify their integrity. 5G operators should evaluate suppliers
        of services for their technical and administrative controls to ensure that
        they meet minimum standards for assured services. These evaluations may include
        SW and HW supply chain, personnel and process used for service creation.
      name: Supply Chain Management
    name: "## Addendum Name: Compromise Software Supply Chain\r\n### Architecture\
      \ Segments: Control Plane, RAN, Virtualization, OA&M, O-RAN\r\n Adversaries\
      \ may manipulate software products or product delivery mechanisms prior to deployment\
      \ in an MNO's production environment for the purpose of data or system compromise.\r\
      \n\r\nSoftware supply chain compromise can occur through various means, such\
      \ as tampering with the source code of the application, manipulating the software's\
      \ update and distribution process, or substituting legitimate compiled releases\
      \ with altered versions.\r\n\r\n5G deployments are expected to embrace diverse\
      \ deployment models, encompassing vendor-supplied VNF/CNFs, open-source software,\
      \ dedicated physical appliances from suppliers, and white-label hardware. This\
      \ diversity introduces multiple potential points of vulnerability before the\
      \ software is employed in 5G communication services. An adversary could exploit\
      \ the supply chain of management and monitoring tools, network functions, or\
      \ infrastructure software, including operating systems, orchestration systems,\
      \ and element managers. The same software deployment model is used in O-RAN\
      \ systems, hence all vulnerabilities described in this addendum applies to O-RAN\
      \ networks as well.\r\n\r\nxApps may be compromised during the delivery to the\
      \ service provider, either through the external supply chain from vendor to\
      \ service provider or through the internal CI/CD pipeline. Malicious code may\
      \ be inserted in the xApp application package that could compromise the application."
    platforms:
    - Core
    - RAN
    - Compute
    - Slice
    - OS
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization
      (NFV); NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
    - '<a name="2"> \[2\] </a> [Wired.com article: "The Untold Story of the Boldest
      Supply-Chain Hack Ever".](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)'
    software: []
  architecture-segment: Control Plane, RAN, Virtualization, OA&M, O-RAN
  bluf: Adversaries may manipulate application software prior to receipt by a final
    consumer for the purpose of data or system compromise.
  campaigns: []
  criticalassets:
  - description: Core NFs can be targeted to impact 5G communication services.
    name: Core VNFs
  - description: RAN/O-RAN NFs can be targeted to impact 5G communication services.
    name: RAN VNFs
  - description: OSS tools have privileged access and broad reachability and may be
      used to change configuration of the network by adversary.
    name: OSS Tools
  - description: Security tools have privileged access and broad reachability and
      may be used to evade defenses and allow for lateral movements by the adversary.
    name: Security tools
  - description: CI/CD tools may be used for inserting malware or poisoned images
      as well as change the network elements deployed and their behavior.
    name: Vendor product lifecycle processes
  description: 'Adversaries may manipulate application software prior to receipt by
    a final consumer for the purpose of data or system compromise. Supply chain compromise
    of software can take place in a number of ways, including manipulation of the
    application source code, manipulation of the update/distribution mechanism for
    that software, or replacing compiled releases with a modified version. Targeting
    may be specific to a desired victim set or may be distributed to a broad set of
    consumers but only move on to additional tactics on specific victims.(Citation:
    Avast CCleaner3 2018)(Citation: Command Five SK 2011)[To read more, please see
    the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1195/002)'
  detections:
  - component: File Modification
    detects: File verification of distributed binaries through hash checking or other
      integrity checking mechanisms. Scan downloads for invalid signatures or signatures
      from untrusted sources and attempt to test software and updates prior to deployment
      while taking note of potential suspicious activity.
    fgdsid: FGDS0022.005
    name: File
  groups: []
  id: FGT1195.002
  mitigations:
  - fgmid: FGM1051
    mitigates: Update Software regularly.
    name: Update Software
  - fgmid: FGM1016
    mitigates: Vulnerability Scanning of software before it is brought into MNO environment
      as well as regular scans to detect abnormal behavior.
    name: Vulnerability Scanning
  - fgmid: FGM1045
    mitigates: Enforce binary and application integrity with digital signature verification
      to prevent untrusted code from executing.
    name: Code Signing
  - fgmid: FGM5520
    mitigates: Enforce policy to use signed Software Bill of Materials (SBOMs) and
      software.
    name: Use SBOM
  - fgmid: FGM0817
    mitigates: Implement a supply chain management program, including policies and
      procedures to ensure all devices and components originate from a trusted supplier
      and are tested to verify their integrity. 5G operators should evaluate suppliers
      of services for their technical and administrative controls to ensure that they
      meet minimum standards for assured services. These evaluations may include SW
      and HW supply chain, personnel and process used for service creation.
    name: Supply Chain Management
  name: Compromise Software Supply Chain
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization (NFV);
    NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
  - '<a name="2"> \[2\] </a> [Wired.com article: "The Untold Story of the Boldest
    Supply-Chain Hack Ever".](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)'
  software: []
  status: Observed
  subtechnique-of: FGT1195
  tactics:
  - TA0001
  - TA0006
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: ''
    campaigns: []
    criticalassets:
    - description: Network functions are prime target to impact 5G communication services.
      name: Core Network Functions
    - description: Network functions are prime target to impact 5G communication services.
      name: RAN Network Function
    - description: OSS tools have privileged access and broad reachability and may
        be used to change configuration of the network by adversary.
      name: Operator OSS/BSS
    - description: Security tools have privileged access and broad reachability may
        be used to evade defenses and allow for lateral movements by the adversary.
      name: SDN Controller and Network Elements, operations, and security tools
    - description: CI/CD tools may be used for inserting malware or poisoned images
        as well as change the network elements deployed and their behavior.
      name: CI/CD Tools
    detections:
    - component: Manual inspection
      detects: Perform physical inspection of hardware to look for potential tampering.
        Some manufacturers are now adding seals to their component hardware packaging.
        This may provide some indication if hardware was tampered with after leaving
        the manufacturing facility.
      fgdsid: FGDS5027.001
      name: Physical Inspection
    - component: Host Status
      detects: Perform integrity checking on pre-OS boot mechanisms that can be manipulated
        for malicious purposes and compare against known good baseline behavior.
      fgdsid: FGDS0013.001
      name: Sensor Health
    - component: File Metadata
      detects: 'Monitor FW. Contextual data about a file, which may include information
        such as name, the content (ex: signature, headers, or data/media), user/owner,
        permissions, etc.'
      fgdsid: FGDS0022.004
      name: File
    - component: File Modification
      detects: Monitor FW. File contents are changed by adversary.
      fgdsid: FGDS0022.005
      name: File
    groups: []
    mitigations:
    - fgmid: FGM1051
      mitigates: Update Software regularly.
      name: Update Software
    - fgmid: FGM1016
      mitigates: Vulnerability Scanning of software before it is brought into MNO
        environment as well as regular scans to detect abnormal behavior.
      name: Vulnerability Scanning
    name: "## Addendum Name: Compromise Hardware Supply Chain\r\n### Architecture\
      \ Segments: RAN, Virtualization, OA&M\r\n Adversaries may manipulate hardware\
      \ components or products prior to deployment in an MNO's production environment\
      \ for the purpose of data or system compromise.\r\n\r\nThrough alterations to\
      \ hardware or firmware within the supply chain, malicious actors can implant\
      \ a concealed entry point into consumer networks. This clandestine access can\
      \ prove challenging to identify, affording the adversary substantial control\
      \ over the system. Hardware backdoors have the potential to be introduced into\
      \ a wide array of devices, including servers, workstations, network infrastructure\
      \ components, and peripherals.\r\n\r\n5G multiplicity of deployment options\
      \ introduces numerous potential points of vulnerability, all before the hardware\
      \ even integrates into 5G communication services. Within this complex landscape,\
      \ adversaries possess the opportunity to exploit various aspects of the supply\
      \ chain, such as compromising management and monitoring tools, tampering with\
      \ firmware within components, or clandestinely introducing additional chips\
      \ into server and network hardware. Furthermore, the prospect of counterfeit\
      \ hardware infiltrating the legitimate supply chain accentuates the vulnerability\
      \ landscape. Counterfeit hardware may lack rigorous security considerations\
      \ and thorough testing, making it a potential Achilles' heel within the supply\
      \ chain. The same hardware or firmware deployment model is used in O-RAN systems,\
      \ hence all vulnerabilities described in this addendum applies to O-RAN networks\
      \ as well."
    platforms:
    - Infrastructure
    - 5G CORE
    - 5G RAN
    - CI/CD
    - MEC
    - Compute Platform
    - OA&M
    preconditions: []
    procedureexamples:
    - description: "In virtual network functions, the provisioning, configuration,\
        \ testing, and debugging processes involve software interfaces, often remote,\
        \ with distinct security implications compared to traditional physical interfaces,\
        \ emphasizing the need for mitigations and protections in situations where\
        \ debug and test interfaces in NFV devices are enabled in the field.ETSI NFV\
        \ SEC001, \"Network Functions Virtualization (NFV); NFV Security; Problem\
        \ Statement\", Jan. 2014,\_section 6.9."
      name: Back-Doors via Virtualized Test & Monitoring Functions
    references:
    - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization
      (NFV); NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
    - <a name="2"> \[2\] </a> [The Untold Story of the Boldest Supply-Chain Hack Ever.](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)
    - <a name="3"> \[3\] </a> [Trusted Platform Module (TPM) Summary.](https://trustedcomputinggroup.org/wp-content/uploads/Trusted-Platform-Module-Summary_04292008.pdf)
    software: []
  architecture-segment: Control Plane, RAN, Virtualization, OA&M, O-RAN
  bluf: Adversaries may manipulate hardware components in products prior to receipt
    by a final consumer for the purpose of data or system compromise.
  campaigns: []
  criticalassets:
  - description: Network functions are prime target to impact 5G communication services.
    name: Core Network Functions
  - description: Network functions are prime target to impact 5G communication services.
    name: RAN Network Function
  - description: OSS tools have privileged access and broad reachability and may be
      used to change configuration of the network by adversary.
    name: Operator OSS/BSS
  - description: Security tools have privileged access and broad reachability may
      be used to evade defenses and allow for lateral movements by the adversary.
    name: SDN Controller and Network Elements, operations, and security tools
  - description: CI/CD tools may be used for inserting malware or poisoned images
      as well as change the network elements deployed and their behavior.
    name: CI/CD Tools
  description: Adversaries may manipulate hardware components in products prior to
    receipt by a final consumer for the purpose of data or system compromise. By modifying
    hardware or firmware in the supply chain, adversaries can insert a backdoor into
    consumer networks that may be difficult to detect and give the adversary a high
    degree of control over the system. Hardware backdoors may be inserted into various
    devices, such as servers, workstations, network infrastructure, or peripherals.[To
    read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1195/003)
  detections:
  - component: Manual inspection
    detects: Perform physical inspection of hardware to look for potential tampering.
      Some manufacturers are now adding seals to their component hardware packaging.
      This may provide some indication if hardware was tampered with after leaving
      the manufacturing facility.
    fgdsid: FGDS5027.001
    name: Physical Inspection
  - component: Host Status
    detects: Perform integrity checking on pre-OS boot mechanisms that can be manipulated
      for malicious purposes and compare against known good baseline behavior.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: File Metadata
    detects: 'Monitor FW. Contextual data about a file, which may include information
      such as name, the content (ex: signature, headers, or data/media), user/owner,
      permissions, etc.'
    fgdsid: FGDS0022.004
    name: File
  - component: File Modification
    detects: Monitor FW. File contents are changed by adversary.
    fgdsid: FGDS0022.005
    name: File
  groups: []
  id: FGT1195.003
  mitigations:
  - fgmid: FGM1051
    mitigates: Update Software regularly.
    name: Update Software
  - fgmid: FGM1016
    mitigates: Vulnerability Scanning of software before it is brought into MNO environment
      as well as regular scans to detect abnormal behavior.
    name: Vulnerability Scanning
  name: Compromise Hardware Supply Chain
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: "In virtual network functions, the provisioning, configuration, testing,\
      \ and debugging processes involve software interfaces, often remote, with distinct\
      \ security implications compared to traditional physical interfaces, emphasizing\
      \ the need for mitigations and protections in situations where debug and test\
      \ interfaces in NFV devices are enabled in the field.ETSI NFV SEC001, \"Network\
      \ Functions Virtualization (NFV); NFV Security; Problem Statement\", Jan. 2014,\_\
      section 6.9."
    name: Back-Doors via Virtualized Test & Monitoring Functions
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC001: "Network Functions Virtualization (NFV);
    NFV Security; Problem Statement", Jan. 2014, section 6.9.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/001/01.01.01_60/gs_nfv-sec001v010101p.pdf)'
  - <a name="2"> \[2\] </a> [The Untold Story of the Boldest Supply-Chain Hack Ever.](https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/)
  - <a name="3"> \[3\] </a> [Trusted Platform Module (TPM) Summary.](https://trustedcomputinggroup.org/wp-content/uploads/Trusted-Platform-Module-Summary_04292008.pdf)
  software: []
  status: Theoretical
  subtechnique-of: FGT1195
  tactics:
  - TA0001
  - TA0006
  typecode: attack_subtechnique_addendum
- access-required: Physical Or Malware Insertion
  architecture-segment: UE
  bluf: An adversary may get access to several SIM credentials either by physical
    access to SIM card inventory or by compromising SIM data repository.
  campaigns: []
  criticalassets:
  - description: Adversary is after getting the keys to decrypt cellular communications
      for those sets of SIMs whose credentials it captured.
    name: Privacy of subscriber data
  description: "An adversary may get access to several SIM credentials either by physical\
    \ access to SIM card inventory or by compromising SIM data repository.\r\n\r\n\
    Unauthorized actors use various means to intercept/steal SIM data in transit from\
    \ SIM card vendors towards the HSS or the UDR/UDM in the operator's network and\
    \ by gaining physical access to the SIM card inventory in order to obtain customer\
    \ credentials.\r\n\r\nThey may also gain access to several SIM encryption codes,\
    \ hack into the systems of a SIM card manufacturer, infiltrate a major SIM card\
    \ manufacturer, and infiltrate a telecommunications company's internal system.\
    \ Using phishing, social engineering, malware injection, cyber-stalking, and email\
    \ penetration techniques to steal encryption keys, access USIM-related information,\
    \ and enable mass surveillance by decrypting communications and data intercepted\
    \ from billions of mobile phones worldwide, resulting in a data leak. "
  detections:
  - component: Malware Content
    detects: Code, strings, and other signatures that compromise a malicious payload.
    fgdsid: FGDS0004.001
    name: Malware Repository
  - component: Malware Metadata
    detects: Contextual data about a malicious payload, such as compilation times,
      file hashes, as well as watermarks or other identifiable configuration information.
    fgdsid: FGDS0004.002
    name: Malware Repository
  - component: Malware Content
    detects: Store and analyze code, strings, signatures, and other identifying characteristics
      of malicious payloads within a centralized malware repository. Incorporate both
      static (file-based) and dynamic (behavioral or execution-based) analysis techniques
      to enhance threat intelligence, improve detection accuracy, and support proactive
      prevention efforts.
    fgdsid: FGDS0004.001
    name: Malware Repository
  - component: Malware Metadata
    detects: Leverage contextual data for detection, including compilation timestamps,
      file hashes, identifiable watermarks, and configuration metadata, while integrating
      machine learning algorithms to analyze patterns and anomalies for enhanced identification
      of malicious payloads.
    fgdsid: FGDS0004.002
    name: Malware Repository
  groups: []
  id: FGT1195.501
  mitigations:
  - fgmid: FGM1017
    mitigates: 'Personnel security: Train personnel in SIM card OEMs to be wary of
      social engineering and other attempts of unauthorized parties to gain access
      to any relevant resource, and to report suspicious activities.'
    name: User Training
  - fgmid: FGM1030
    mitigates: Physical and cyber security of IT systems, servers.
    name: Network Segmentation
  - fgmid: FGM1022
    mitigates: Restrict access to files exchanged between SIM vendor and MNO.
    name: Restrict File And Directory Permissions
  - fgmid: FGM1041
    mitigates: Protect the files where SIM data is stored by encryption.
    name: Encrypt Sensitive Information
  - fgmid: FGM1049
    mitigates: Utilize antivirus software with updated signatures and heuristic analysis
      to detect and prevent malicious software targeting sensitive systems. Regularly
      update the antivirus database to ensure protection against emerging threats.
    name: Anti-virus & Anti-malware
  - fgmid: FGM5024
    mitigates: Protect the files where SIM data is stored by integrity protection.
    name: Integrity Protection Of Data Communication
  name: SIM Credentials Theft
  object-type: technique
  platforms: 5G UE
  postconditions:
  - description: Subscriber's sensitive signaling and user plane data are exposed
      to the adversary.
    name: Subscriber data leak
  preconditions:
  - description: Adversary needs to either implant malware in SIM vendor's server
      or have physical access to the SIM card inventory.
    name: Implant malware or physical access
  procedureexamples:
  - description: An adversary may implant malware on a SIM vendor server and thus
      obtain SIM credentials.
    name: Infiltrate SIM vendor's network.
  - description: Unknown actor deploys malware to infiltrate SKT's internal system,
      using it to access USIM-related information, resulting in a data leak. [6]
    name: USIM Hack
  references:
  - '<a name="1"> \[1\] </a> [GSMA FS.28: "Security Guidelines for Exchange of UICC
    Credentials", Version 1.0, November 2020.](https://www.gsma.com/security/resources/fs-28-security-guidelines-for-exchange-of-uicc-credentials/)'
  - '<a name="2"> \[2\] </a> [Thales: "Gemalto Presents the Findings of Its Investigations
    into the Alleged Hacking of SIM Card Encryption Keys by Britain''s Government
    Communications Headquarters (GCHQ) and the U.S. National Security Agency (NSA)",
    February 25, 2015.](https://www.thalesgroup.com/en/markets/digital-identity-and-security/press-release/gemalto-presents-the-findings-of-its-investigations-into-the-alleged-hacking-of-sim-card-encryption-keys)'
  - '<a name="3"> \[3\] </a> [BBC article: "US and UK accused of hacking Sim card
    firm to steal codes", February 20, 2015.](https://www.bbc.com/news/technology-31545050)'
  - '<a name="4"> \[4\] </a> [G. Hill: "U.S. and Britain Work Together to Pull off
    SIM Card Heist", February 20, 2015.](https://securitytoday.com/articles/2015/02/20/us-and-britain-work-together-to-pull-off-sim-card-heist.aspx?admgarea=ht.government)'
  - '<a name="5"> \[5\] </a> [G. Onag: "SK Telecom Takes Full Responsibility Amid
    USIM Hacking Fallout", April 27, 2025.](https://www.lightreading.com/security/skt-takes-full-responsibility-amid-usim-hacking-fallout)'
  - '<a name="6"> \[6\] </a> [J. Waring: "SKT Hit by Leak of SIM Data", April 22,
    2025.](https://www.mobileworldlive.com/operators/skt-hit-by-leak-of-sim-data/?ID=a6g69000000m0xbAAA&JobID=2277374&utm_source=sfmc&utm_medium=email&utm_campaign=MWL_20250422&utm_content=https%3a%2f%2fwww.mobileworldlive.com%2foperators%2fskt-hit-by-leak-of-sim-data%2f)'
  software: []
  status: Observed
  subtechnique-of: FGT1195
  tactics:
  - TA0006
  - TA0001
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: MEC, OA&M, RAN, Virtualization
  bluf: Adversaries may manipulate service or service delivery mechanisms prior to
    or while used by a mobile network operator (MNO), especially those outsourced
    to third-party managed service providers (MSPs) or managed security service providers
    (MSSPs), to gain unauthorized access or persistence within the telecom network.
  campaigns: []
  criticalassets:
  - description: Network Exposure Function is a likely target for adversaries in a
      MEC environment.
    name: NEF
  - description: Distributed deployment models may require third party transport service.
    name: Transport network
  - description: Distributed deployment models may require third party MEC service.
    name: MEC
  - description: RAN as a Service or Shared RAN.
    name: RAN
  - description: Mobile Virtual Network Operators may completely rely on third party
      provided services for their subscriber.
    name: MVNO Core and RAN infrastructure
  - description: Monitoring and management tools used by outsourced services staff
      can provide greater access to specific assets.
    name: OAM Tools
  description: "Adversaries may manipulate service or service delivery mechanisms\
    \ prior to or while used by a mobile network operator (MNO), especially those\
    \ outsourced to third-party managed service providers (MSPs) or managed security\
    \ service providers (MSSPs), to gain unauthorized access or persistence within\
    \ the telecom network.\r\n\r\nThese services can include network operations, monitoring,\
    \ software development, cloud hosting, helpdesk support, and system integration.\
    \ When these functions are contracted externally, adversaries may compromise them\
    \ upstream, before the services are delivered to the MNO environment. This enables\
    \ stealthy, indirect access to the target telecom infrastructure.\r\n\r\nWhen\
    \ managed service providers (outsourced or contracted services) are used for providing\
    \ service to customers, the adversary may be in a position to compromise information\
    \ about the subscriber. These services may include outsourced IT operations, software\
    \ development, integration and deployments, IP transport, Cloud hosting, helpdesk\
    \ etc. This technique pertains specifically to external managed service providers\
    \ (e.g., contracted IT or cloud services) rather than internal enterprise support\
    \ functions where corporate security rules may be different or not verifiable.\
    \ \r\n\r\nFor example, threat actors such as Liminal Panda (CrowdStrike, 2024)\
    \ and Salt Typhoon (Tenable, 2024), state-sponsored actors targeted telecom providers\
    \ by compromising their service supply chain. Liminal Panda was observed compromising\
    \ upstream IT service vendors with long-term access into telecom operations. Salt\
    \ Typhoon focused on exploiting vulnerabilities in open-source software commonly\
    \ embedded in telecom service delivery. These attacks demonstrate the growing\
    \ threat posed by compromised third-party providers in telecom ecosystems.\r\n\
    \r\nThe adversary may use the compromised service to apply additional techniques\
    \ against interfaces exposed to the service provider such as the NEF. When the\
    \ service provider hosts or provides core network functions, the adversary may\
    \ attempt to compromise the 5G core components in the service provider environment,\
    \ e.g. MEC hosted NFs, or through the service provider environment, attempt compromise\
    \ of other core NFs not hosted in the MEC. "
  detections:
  - component: Command Execution
    detects: Command and Monitor scripting activity (e.g., PowerShell logs).
    fgdsid: FGDS0017.001
    name: Command
  - component: Network Traffic Flow
    detects: Unusual lateral movements from network traffic.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: User Account Authentication
    detects: User authentications, from user authentication logs detect odd hours/geolocation
      mismatch (GeoIP and time correlation).
    fgdsid: FGDS0002.001
    name: User Account
  - component: Drive Access
    detects: A non-volatile data storage device (hard drive, floppy disk, USB flash
      drive) with at least one formatted partition, typically mounted to the file
      system and/or assigned a drive letter.
    fgdsid: FGDS0016.001
    name: Drive
  - component: OS API Execution
    detects: Detects OS-level tampering and unusual process creation. Instances of
      computer programs that are being executed by at least one thread. Processes
      have memory space for process executables, loaded modules (DLLs or shared libraries),
      and allocated memory regions containing everything from user input to application-specific
      data structures.
    fgdsid: FGDS0009.001
    name: Process
  - component: Execution
    detects: A file or stream containing a list of commands, allowing them to be launched
      in sequence. Monitor for any attempts to enable scripts running on a system
      that install software or make changes that would be considered suspicious.
    fgdsid: FGDS0012.001
    name: Script
  - component: File Access
    detects: 'Openiinstallsle, which makes the file contents available to the requestor
      (ex: Windows EID 4663).'
    fgdsid: FGDS0022.001
    name: File
  - component: File Creation
    detects: 'Initial construction of a new file (ex: Sysmon EID 11).'
    fgdsid: FGDS0022.002
    name: File
  - component: File Deletion
    detects: 'Removal of a file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK,
      or Linux commands auditd unlink, rename, rmdir, unlinked, or renameat rules).'
    fgdsid: FGDS0022.003
    name: File
  - component: File Metadata
    detects: 'Contextual data about a file, which may include information such as
      name, the content (ex: signature, headers, or data/media), user/owner, permissions,
      etc.'
    fgdsid: FGDS0022.004
    name: File
  - component: File Modification
    detects: File contents are changed by adversary.
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: Liminal Panda (CrowdStrike, 2024) and Salt Typhoon (Tenable, 2024)
      compromise Managed Service Provider (MSP) environments to gain long-term access
      to telecom systems. [5],[6],[7].
    fggid: FGG5001
    name: Liminal Panda
  - description: Silk Typhoon (formerly Hafnium), a Chinese threat actor who compromised
      Beyond Trust, their managed service provider. [8]
    fggid: G0125
    name: HAFNIUM
  id: FGT1195.502
  mitigations:
  - fgmid: FGM0817
    mitigates: Operators should evaluate suppliers of services (MSPs/MSSPs) for their
      technical and administrative controls to ensure that it meets minimum standards
      for assured services. These evaluations may include SW, HD supply chain, personnel
      and process used for service creation.
    name: Supply Chain Management
  - fgmid: FGM5519
    mitigates: MNOs should integrate performance and change management from their
      suppliers into their own OA&M tools to have complete visibility into service.
    name: Integrate Performance And Change Management
  - fgmid: FGM1018
    mitigates: Ensure dedicated, time-boxed accounts for MSP staff. Disallow shared
      or persistent privileged credentials. Require MFA and hardware tokens for vendor
      access.
    name: User Account Management
  name: Compromise Service Supply Chain
  object-type: technique
  platforms: OA&M
  postconditions: []
  preconditions:
  - description: The existence of trust and interoperability between telecom entities
      and service providers, which can be exploited by adversaries to gain unauthorized
      access.
    name: Established Trust Relationships
  procedureexamples:
  - description: OA&M tools in service have greater access to network elements, compromise
      of such tools provide adversary access to network providing the service.
    name: OA&M tools
  - description: Service provider management may have nefarious intent for data collection
      or providing assistance to other nefarious actors.
    name: Malicious Service provider
  references:
  - '<a name="1"> \[1\] </a> [3GPP TS 23.501: "System architecture for the 5G System
    (5GS); Stage 2 (Release 17)".](https://www.3gpp.org/DynaReport/23501.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 23.558: "Architecture for enabling Edge Applications".](https://www.3gpp.org/DynaReport/23558.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TS 23.548: "5G System Enhancements for Edge Computing;
    Stage 2".](https://www.3gpp.org/DynaReport/23548.htm)'
  - '<a name="4"> \[4\] </a> [ETSI White Paper No. 28: "MEC in 5G networks".](https://www.etsi.org/images/files/ETSIWhitePapers/etsi_wp28_mec_in_5G_FINAL.pdf)'
  - '<a name="5"> \[5\] </a> [Crowdstrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector".](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/)'
  - '<a name="6"> \[6\] </a> [Trendmicro whitepaper: "Game of Emperor: Unveiling Long
    Term Earth Estries Cyber Intrusions".](https://www.trendmicro.com/en_us/research/24/k/earth-estries.html)'
  - '<a name="7"> \[7\] </a> [Tenable blog: "Salt Typhoon: An Analysis of Vulnerabilities
    Exploited by this State-Sponsored Actor".](https://www.tenable.com/blog/salt-typhoon-an-analysis-of-vulnerabilities-exploited-by-this-state-sponsored-actor)'
  - <a name="8"> \[8\] </a> [BeyondTrust Zero-Day Breach](https://thehackernews.com/2025/02/beyondtrust-zero-day-breach-exposes-17.html)
  software: []
  status: Observed
  subtechnique-of: FGT1195
  tactics:
  - TA0001
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may breach or otherwise leverage organizations who have access
    to intended victims.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may breach or otherwise leverage organizations who have
    access to intended victims. Access through trusted third party relationship abuses
    an existing connection that may not be protected or receives less scrutiny than
    standard mechanisms of gaining access to a network. Organizations often grant
    elevated access to second or third-party external providers in order to allow
    them to manage internal systems as well as cloud-based environments. Some examples
    of these relationships include IT services contractors, managed security providers,
    infrastructure contractors (e.g. HVAC, elevators, physical security). The third-party
    provider''s access may be intended to be limited to the infrastructure being maintained,
    but may exist on the same network as the rest of the enterprise. As such, [Valid
    Accounts](https://attack.mitre.org/techniques/T1078) used by the other party for
    access to internal network systems may be compromised and used.(Citation: CISA
    IT Service Providers) In Office 365 environments, organizations may grant Microsoft
    partners or resellers delegated administrator permissions. By compromising a partner
    or reseller account, an adversary may be able to leverage existing delegated administrator
    relationships or send new delegated administrator offers to clients in order to
    gain administrative control over the victim tenant.(Citation: Office 365 Delegated
    Administration)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1199)'
  detections: []
  groups: []
  id: FGT1199
  mitigations: []
  name: Trusted Relationship
  object-type: technique
  platforms: Windows, SaaS, IaaS, Linux, macOS, Office 365
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0001
  - TA0009
  typecode: attack_technique_with_fight_subs
- access-required: Service Account, Token, Expanded Privilege
  architecture-segment: Roaming, Application Layer, Supply Chain
  bluf: An adversary may breach or otherwise leverage a mobile network operator's
    (MNO's) roaming partners or their service partners to gain access to subscriber's
    services or obtain information about that subscriber from their home network.
  campaigns: []
  criticalassets:
  - description: An adversary would want to compromise the SEPP as it is the Visited
      network end-point for the N32c channel to the HPLMN.
    name: SEPP
  - description: An adversary would want to compromise the Visited network UPF as
      it is used as an endpoint on the roaming network for the N9 user plane interface
      between UPFs.
    name: UPF
  - description: An adversary would want to compromise a trusted VAS with access to
      the MNO's core functions.
    name: VAS
  description: "An adversary may breach or otherwise leverage a mobile network operator's\
    \ (MNO's) roaming partners or their service partners to gain access to subscriber's\
    \ services or obtain information about that subscriber from their home network.\r\
    \n\r\nAn adversary may use the trusted relationship with other mobile network\
    \ operators and their related service providers such as roaming hubs, roaming\
    \ partners, national partners, SMS service providers, lookup services to gain\
    \ access to subscriber information at the subscriber's home MNO. An adversary\
    \ may take advantage of potentially weaker security at a roaming partner of a\
    \ targeted MNO. The roaming MNO or their service partners could also be adversaries\
    \ themselves. \r\n\r\nThese trusted relationships expose more interfaces to the\
    \ roaming partner and their service providers than described in the related technique\
    \ Exploit Semi-public Facing Application [FGT5029](/techniques/FGT5029). The information\
    \ an adversary can obtain or modify about a subscriber and the subscriber's activity\
    \ depends on the specific location and assets compromised and additional techniques\
    \ used. Information such as location, call records, messages, etc. are potentially\
    \ obtained. Adversary use of additional techniques to compromise the Visited network\
    \ User Plane Function (UPF) (N9 endpoint) may result in direct compromise of user\
    \ plane data. The adversary may generate queries using specially crafted messages\
    \ as described in [FGT5029](/techniques/FGT5029) or obtain credentials and operate\
    \ as an apparently authorized partner would to collect information. Depending\
    \ on the roaming partner's configuration, core functions may be directly exposed\
    \ to service providers used by the roaming partner."
  detections:
  - component: Application Log Content
    detects: Analysis of application logs on the home network SEPP and Network Functions
      (NFs) may indicate unusual control channel activity.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Analysis of network traffic from VAS, and/or IPX may indicate unexpected
      or unusual traffic.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1199.501
  mitigations:
  - fgmid: FGM1030
    mitigates: Minimize exposure of functions to only those partner functions that
      need to access.
    name: Network Segmentation
  - fgmid: FGM1018
    mitigates: Management of credentials used by partners to be scoped to the least
      privilege can minimize potential abuse. Does not mitigate misuse within allowed
      privileges.
    name: User Account Management
  - fgmid: FGM1037
    mitigates: Ensure communication with functions such as a Secure Edge Protection
      Proxy (SEPP) is constrained to necessary addresses, ports, and protocols.
    name: Filter Network Traffic
  - fgmid: FGM1054
    mitigates: Validation of credentials properly can mitigate some AITM attacks and
      ensure revoked/expired credentials are not allowed.
    name: Software Configuration
  name: MNO Roaming Partners
  object-type: technique
  platforms: Interconnect
  postconditions:
  - description: The exposed or compromised interfaces allow subscribers' information
      to be stolen.
    name: Exposed Interfaces
  preconditions:
  - description: An adversary must already have compromised a trusted PLMN or one
      of their service providers, e.g. IPX, Value Added Service (VAS), etc.
    name: Compromised partner
  - description: An adversary may need compromised legitimate credentials that could
      be used to obtain information from the MNO.
    name: Compromised credentials
  - description: An adversary may need to identify a vulnerability in an MNO network
      function to send specially crafted requests to obtain initial access.
    name: Identified vulnerability
  procedureexamples:
  - description: The service partner of the targeted MNO may themselves be targeted
      as part of an attack chain using that roaming partner's supply chain [1].
    name: Partner supply chain compromise
  - description: A roaming partner, may have an adversary with a privileged position
      in the roaming or service partners organization and can use that position to
      attempt additional techniques against the targeted MNO [1].
    name: Partner insider
  references:
  - '<a name="1"> \[1\] </a> [GSMA: "5GS Roaming Guidelines Version 5.0", NG.113-v5.0,
    December 2021.](https://www.gsma.com/newsroom/wp-content/uploads//NG.113-v5.0.pdf)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G system", March 2022.](https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3169)'
  - '<a name="3"> \[3\] </a> [ETSI: White Paper No. 46: "MEC security: Status of standards
    support and future evolutions", May 2021.](https://www.etsi.org/images/files/ETSIWhitePapers/ETSI_WP_46-_MEC_security.pdf)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1199
  tactics:
  - TA0001
  - TA0009
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: User plane, M-Plane, and S-plane may be impacted from compromise.
      name: O-RAN open fronthaul (CUS & M plane)
    - description: O-RU, O-DU, CU may be exposed to front haul design vulnerability
        or compromise.
      name: O-DU, O-RU
    - description: Control plane and user plane data communication between DU and
        RRU as well as UE.
      name: Control plane, user plane
    detections:
    - component: Network Connection Creation
      detects: 'Initial construction of a network connection, such as capturing socket
        information with a source/destination IP and port(s) (ex: Windows EID 5156,
        Sysmon EID 3, or Zeek conn.log)'
      fgdsid: FGDS0029.001
      name: Network Traffic
    - component: Network Traffic Content
      detects: 'Logged network traffic data showing both protocol header and body
        values (ex: PCAP)'
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: 'Summarized network packet data, with metrics, such as protocol headers
        and volume (ex: Netflow or Zeek http.log)'
      fgdsid: FGDS0029.003
      name: Network Traffic
    - component: Asset inventory
      detects: New ports, devices on the network, this includes sources of current
        and expected devices on the network, including the manufacturer, model, and
        necessary identifiers (e.g., IP and hardware addresses)
      fgdsid: FGDS0039.001
      name: Asset
    groups: []
    mitigations:
    - fgmid: FGM1026
      mitigates: Implement strong access control for all types of interfaces on originating
        switch and any intermediary devices on the fronthaul.
      name: Privileged Account Management
    - fgmid: FGM1030
      mitigates: Implement network segmentation.
      name: Network Segmentation
    - fgmid: FGM1047
      mitigates: Perform hardware and software installation audits of all O-RAN open
        fronthaul components.
      name: Audit
    - fgmid: FGM1034
      mitigates: Limit new hardware installation.
      name: Limit Hardware Installation
    name: "## Addendum Name: Unauthorized Device On O-RAN Fronthaul Infrastructure\r\
      \n### Architecture Segments: RAN, O-RAN\r\n An adversary may attach a device\
      \ to an O-RAN fronthaul infrastructure in order to disrupt its traffic.\r\n\r\
      \nIn an O-RAN architecture, the baseband unit (BBU) is divided into two components:\
      \ the distributed unit (DU) and the centralized unit (CU). The front haul interface\
      \ plays a crucial role in connecting the DU and the Remote Radio Unit (RU or\
      \ RRU) within the network, ensuring efficient communication. \r\n\r\nTo transport\
      \ the CPRI (Common Public Radio Interface) traffic from the RU to the DU, an\
      \ Ethernet-based bridged network is employed. This involves utilizing various\
      \ Ethernet protocols such as IEEE 802.3 for general Ethernet connectivity, IEEE\
      \ 802.1 for bridging and VLAN tagging, and IEEE 802.1CM for time-sensitive networking\
      \ in industrial automation. The Ethernet-based fronthaul interface establishes\
      \ a high-capacity and low-latency connection between the DU and the RU, facilitating\
      \ the efficient transmission of digital baseband data, synchronization signals,\
      \ control signals, and management information. Usually, RUs and Ethernet Switches\
      \ are placed near the antenna units, which are unmanned facilities and can be\
      \ physically breached due to detection and response time delays by personnel.\
      \ \r\n\r\nUnauthorized devices on this infrastructure can pose significant risks\
      \ to the O-RAN network. Such devices can be used towards a Denial-of-Service\
      \ (DoS) attack by sending malicious or bogus messages, disrupting network operations.\
      \ Additionally, they may attempt to eavesdrop on critical Control (C-Plane),\
      \ User (U-Plane), Synchronization (S-Plane), or Management (M-Plane) traffic,\
      \ compromising the confidentiality of the network."
    platforms:
    - O-RAN
    preconditions: []
    procedureexamples:
    - description: Addition of unauthorized hardware in the O-RAN fronthaul infrastructure
        may leak data to the adversary as the fronthaul interfaces normally are not
        confidentiality and integrity protected. [ATT&CK T1200]
      name: Adding hardware to insecure open switch ports
    - description: A compromised access via remote login or physical access to communication,
        technician interface can yield to creating span ports and tunneling traffic
        to network sniffer.
      name: Privileged access to a router or switch
    references:
    - <a name="1"> \[1\] </a> [O-RAN WG11 Threat Model 6.00 version, "ORAN Threat
      Model".](https://orandownloadsweb.azurewebsites.net/specifications)
    - <a name="2"> \[2\] </a> [NTIA Open RAN Security Report May 2023.](https://ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)
    software: []
  architecture-segment: RAN, O-RAN
  bluf: Adversaries may introduce computer accessories, networking hardware, or other
    computing devices into a system or network that can be used as a vector to gain
    access.
  campaigns: []
  criticalassets:
  - description: User plane, M-Plane, and S-plane may be impacted from compromise.
    name: O-RAN open fronthaul (CUS & M plane)
  - description: O-RU, O-DU, CU may be exposed to front haul design vulnerability
      or compromise.
    name: O-DU, O-RU
  - description: Control plane and user plane data communication between DU and RRU
      as well as UE.
    name: Control plane, user plane
  description: 'Adversaries may introduce computer accessories, networking hardware,
    or other computing devices into a system or network that can be used as a vector
    to gain access. Rather than just connecting and distributing payloads via removable
    storage (i.e. [Replication Through Removable Media](https://attack.mitre.org/techniques/T1091)),
    more robust hardware additions can be used to introduce new functionalities and/or
    features into a system that can then be abused. While public references of usage
    by threat actors are scarce, many red teams/penetration testers leverage hardware
    additions for initial access. Commercial and open source products can be leveraged
    with capabilities such as passive network tapping, network traffic modification
    (i.e. [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)), keystroke
    injection, kernel memory reading via DMA, addition of new wireless access to an
    existing network, and others.(Citation: Ossmann Star Feb 2011)(Citation: Aleks
    Weapons Nov 2015)(Citation: Frisk DMA August 2016)(Citation: McMillan Pwn March
    2012)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1200)'
  detections:
  - component: Network Connection Creation
    detects: 'Initial construction of a network connection, such as capturing socket
      information with a source/destination IP and port(s) (ex: Windows EID 5156,
      Sysmon EID 3, or Zeek conn.log)'
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: 'Logged network traffic data showing both protocol header and body values
      (ex: PCAP)'
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: 'Summarized network packet data, with metrics, such as protocol headers
      and volume (ex: Netflow or Zeek http.log)'
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: Asset inventory
    detects: New ports, devices on the network, this includes sources of current and
      expected devices on the network, including the manufacturer, model, and necessary
      identifiers (e.g., IP and hardware addresses)
    fgdsid: FGDS0039.001
    name: Asset
  groups: []
  id: FGT1200
  mitigations:
  - fgmid: FGM1026
    mitigates: Implement strong access control for all types of interfaces on originating
      switch and any intermediary devices on the fronthaul.
    name: Privileged Account Management
  - fgmid: FGM1030
    mitigates: Implement network segmentation.
    name: Network Segmentation
  - fgmid: FGM1047
    mitigates: Perform hardware and software installation audits of all O-RAN open
      fronthaul components.
    name: Audit
  - fgmid: FGM1034
    mitigates: Limit new hardware installation.
    name: Limit Hardware Installation
  name: Hardware Additions
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Addition of unauthorized hardware in the O-RAN fronthaul infrastructure
      may leak data to the adversary as the fronthaul interfaces normally are not
      confidentiality and integrity protected. [ATT&CK T1200]
    name: Adding hardware to insecure open switch ports
  - description: A compromised access via remote login or physical access to communication,
      technician interface can yield to creating span ports and tunneling traffic
      to network sniffer.
    name: Privileged access to a router or switch
  references:
  - <a name="1"> \[1\] </a> [O-RAN WG11 Threat Model 6.00 version, "ORAN Threat Model".](https://orandownloadsweb.azurewebsites.net/specifications)
  - <a name="2"> \[2\] </a> [NTIA Open RAN Security Report May 2023.](https://ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: attack_technique_addendum
- bluf: Adversaries may exploit software vulnerabilities in client applications to
    execute code.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may exploit software vulnerabilities in client applications
    to execute code. Vulnerabilities can exist in software due to unsecure coding
    practices that can lead to unanticipated behavior. Adversaries can take advantage
    of certain vulnerabilities through targeted exploitation for the purpose of arbitrary
    code execution. Oftentimes the most valuable exploits to an offensive toolkit
    are those that can be used to obtain code execution on a remote system because
    they can be used to gain access to that system. Users will expect to see files
    related to the applications they commonly used to do work, so they are a useful
    target for exploit research and development because of their high utility. Several
    types exist: ### Browser-based Exploitation Web browsers are a common target through
    [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing
    Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be
    compromised through normal web browsing or from certain users being targeted by
    links in spearphishing emails to adversary controlled sites used to exploit the
    web browser. These often do not require an action by the user for the exploit
    to be executed. ### Office Applications Common office and productivity applications
    such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566).
    Malicious files will be transmitted directly as attachments or through links to
    download them. These require the user to open the document or file for the exploit
    to run. ### Common Third-party Applications Other applications that are commonly
    seen or are part of the software deployed in a target network may also be used
    for exploitation. Applications such as Adobe Reader and Flash, which are common
    in enterprise environments, have been routinely targeted by adversaries attempting
    to gain access to systems. Depending on the software and nature of the vulnerability,
    some may be exploited in the browser or require the user to open a file. For instance,
    some Flash exploits have been delivered as objects within Microsoft Office documents.[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1203)'
  detections: []
  groups: []
  id: FGT1203
  mitigations: []
  name: Exploitation for Client Execution
  object-type: technique
  platforms: Linux, Windows, macOS
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0002
  typecode: attack_technique_with_fight_subs
- access-required: N/A
  architecture-segment: UE
  bluf: An adversary may send specially crafted data to the UE over-the-air via the
    radio interface to execute malicious code.
  campaigns: []
  criticalassets:
  - description: Subscriber loses some of the control of the UE
    name: User device
  description: "An adversary may send specially crafted data to the UE over-the-air\
    \ via the radio interface to execute malicious code. An adversary with a position\
    \ to send data to the UE, such as control of an IMS service or the UPF may send\
    \ data to the UE that can, using a previously identified vulnerability, cause\
    \ adversary execution on the UE.\r\n\r\nThe adversary may identify a vulnerability\
    \ in the radio interface through fuzzing techniques against the baseband and supporting\
    \ chips used in the UE. Vulnerabilities that could enable an adversary to execute\
    \ code include heap corruptions and use-after-frees [1]. Additionally, vulnerabilities\
    \ such as buffer overflow vulnerabilities are often found due to insecure coding\
    \ practices. Although fuzzing has been demonstrated to be a viable approach to\
    \ identify vulnerabilities, vulnerabilities may be discovered by adversaries through\
    \ additional techniques including physical examination/tampering and binary executable\
    \ analysis."
  detections: []
  groups: []
  id: FGT1203.501
  mitigations:
  - fgmid: FGM1050
    mitigates: UE application processor should run exploit protection security applications
      that look for behavior e.g. flow control integrity checking.
    name: Exploit Protection
  name: Over-the-Air Input
  object-type: technique
  platforms: 5G core, UE
  postconditions:
  - description: Can execute IMEI change, take over microphone, and others [1]
    name: Adversary has some control over the UE
  preconditions:
  - description: Adversary must have identified a vulnerability in the target UE baseband
      or supporting chips to enable OTA exploitation.
    name: Identified vulnerability on baseband or supporting chips
  procedureexamples:
  - description: Proof of Concept demonstration of technique exploiting modem vulnerability
      from IMS service over an adversary controlled 5G core and base station.
    name: Adversary controlled IMS
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi & X. Chen, "Over The Air Baseband Exploit:
    Gaining RemoteCode Execution on 5G Smartphones," retrieved May 16, 2023](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1203
  tactics:
  - TA0002
  typecode: fight_subtechnique_to_attack_technique
- access-required: Privileged
  architecture-segment: UE
  bluf: An adversary may send specially crafted data to the UE's application processor's
    interface to the baseband API to execute malicious code.
  campaigns: []
  criticalassets:
  - description: An adversary can execute malicious on the compromised UE.
    name: UE
  description: "An adversary may send specially crafted data to the UE's application\
    \ processor's interface to the baseband API to execute malicious code. The adversary\
    \ with a position on the UE to communicate to the baseband API may execute malicious\
    \ code on the baseband processing system.\r\n\r\nThe adversary may identify a\
    \ vulnerability in the baseband API through fuzzing techniques [1]. Vulnerabilities\
    \ that could enable an adversary to execute code include memory boundary violations,\
    \ including buffer overflows that affect the stack and the heap on the baseband.\
    \ Vulnerabilities such as buffer overflow vulnerabilities are often found due\
    \ to insecure coding practices. Although fuzzing has been demonstrated to be a\
    \ viable approach to identify vulnerabilities, vulnerabilities may be discovered\
    \ by adversaries through additional techniques including physical examination/tampering\
    \ and binary executable analysis."
  detections:
  - component: MNO logs for service issues in core
    detects: UE experiences frequent dropped connections, difficulty connecting and
      throttled data.
    fgdsid: FGDS5011.001
    name: MNO logs in core for subscriber service complaints
  - component: Firmware Mismatch
    detects: Baseband firmware on the UE does not match authorized version by the
      OEM or carrier.
    fgdsid: FGDS0001.002
    name: Firmware
  - component: UE battery performance
    detects: Unexpected power consumption or unexplained battery drain.
    fgdsid: FGDS5006.001
    name: UE logs for resource usage
  groups: []
  id: FGT1203.502
  mitigations:
  - fgmid: FGM1040
    mitigates: Use capabilities to prevent suspicious behavior patterns from occurring
      on endpoint systems. This could include suspicious process, file, API call,
      etc. behavior.
    name: Behavior Prevention On Endpoint
  - fgmid: FGM1058
    mitigates: Mobile security products, such as Mobile Threat Defense (MTD), offer
      various device-based mitigations against certain behaviors.
    name: Antivirus/Antimalware
  - fgmid: FGM1010
    mitigates: Enterprises can identify compromised devices using built-in security
      mechanisms, third-party mobile security apps, EMM/MDM capabilities, or other
      methods, with varying levels of sophistication and evasion difficulty.
    name: Deploy Compromised Device Detection Method
  name: Baseband API
  object-type: technique
  platforms: UE
  postconditions:
  - description: The adversary exploits vulnerabilities in the UE's baseband API,
      such as buffer overflows, to execute malicious code on the baseband processing
      system.
    name: Exploited baseband
  preconditions:
  - description: Exploitation requires the ability to communicate with the baseband
      API.
    name: Baseband API Access
  procedureexamples:
  - description: The adversary uses fuzzing techniques to discover a stack-based buffer
      overflow vulnerability in the baseband API of a User Equipment (UE) device.
      [1]
    name: Exploiting a Stack-Based Buffer Overflow
  - description: The adversary uses binary executable analysis to find a heap-based
      buffer overflow vulnerability in the baseband API of a User Equipment (UE) device.
      They create a data payload that, when processed, overflows a heap buffer and
      includes malicious code to overwrite function pointers or other critical data
      structures in the heap. [1]
    name: Exploiting a Heap-Based Buffer Overflow
  references:
  - '<a name="1"> \[1\] </a> [Imtiaz Karim, Fabrizio Cicala, Syed Rafiul Hussain,
    Omar Chowdhury, and Elisa Bertino; Digital Threats 1, 4, Article 23 (December
    2020): "ATFuzzer: Dynamic Analysis Framework of AT Interface for Android Smartphones."](https://dl.acm.org/doi/10.1145/3416125)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1203
  tactics:
  - TA0002
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: ''
    campaigns: []
    criticalassets:
    - description: All core network functions of victim MNO may be impacted by this
        behavior.
      name: MNO core network functions
    - description: Victim MNO's network data may be exposed to adversaries due to
        this behavior.
      name: MNO network data
    detections:
    - component: Network Traffic Content
      detects: Inspect network traffic contents especially all payloads of traffic
        received on TCP port 53.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Process Creation
      detects: Monitor all process creations in host systems for any unusual activity
        e.g. TCP reverse shell process to connect to remote server.
      fgdsid: FGDS0009.003
      name: Process
    groups:
    - description: Liminal Panda established a command and control channel between
        eDNS server of a partner network and another server controlled by them using
        TCP port 53 for transport. [1,2]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1037
      mitigates: Filter all network traffic received on TCP port 53 with unusually
        long payloads.
      name: Filter Network Traffic
    - fgmid: FGM5542
      mitigates: Use application layer firewall for unusual payloads sent and received
        on TCP port 53.
      name: Application Layer Firewall
    name: "## Addendum Name: Alternate Port Number\r\n### Architecture Segments: User\
      \ Plane\r\n Adversaries may use an unconventional port to hide C2 messages.\r\
      \n\r\nAdversaries may establish a command and control channel by hiding communication\
      \ using an unconventional port. They may compromise the external DNS (eDNS)\
      \ server of a partner network using SSH for initial access with password spraying.\
      \ Then they launch the pingpong malware which listens for ICMP echo requests\
      \ from compromised hosts of other partner networks. It establishes a TCP reverse\
      \ shell connection to the partner network when it finds the remote IP address\
      \ and port number. The remote IP address and port number are embedded at a fixed\
      \ offset of the ICMP echo request. Then the adversaries exchange C2 messages\
      \ with the remote server using TCP port 53 for transport. This particular port\
      \ is chosen for C2 because it is allowed by most firewalls for DNS queries to\
      \ pass through."
    platforms:
    - 5G core
    preconditions:
    - description: eDNS server of an MNO partner network must be compromised before
        launching this behavior. Then the adversaries may install the pingpong backdoor
        in the compromised eDNS server.
      name: MNOs eDNS server is compromised
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
      Look at China''s Cyber Threats to the Telecom Sector", updated November 19,
      2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
    software:
    - description: Pingpong malware was used by Liminal Panda to listen to ICMP echo
        requests from remote hosts. This helped determine the IP address and port
        number to connect to the remote host via TCP reverse shell.
      fgsid: FGS5001
      name: PingPong
  architecture-segment: User Plane
  bluf: Adversaries may use traffic signaling to hide open ports or other malicious
    functionality used for persistence or command and control.
  campaigns: []
  criticalassets:
  - description: All core network functions of victim MNO may be impacted by this
      behavior.
    name: MNO core network functions
  - description: Victim MNO's network data may be exposed to adversaries due to this
      behavior.
    name: MNO network data
  description: 'Adversaries may use traffic signaling to hide open ports or other
    malicious functionality used for persistence or command and control. Traffic signaling
    involves the use of a magic value or sequence that must be sent to a system to
    trigger a special response, such as opening a closed port or executing a malicious
    task. This may take the form of sending a series of packets with certain characteristics
    before a port will be opened that the adversary can use for command and control.
    Usually this series of packets consists of attempted connections to a predefined
    sequence of closed ports (i.e. [Port Knocking](https://attack.mitre.org/techniques/T1205/001)),
    but can involve unusual flags, specific strings, or other unique characteristics.
    After the sequence is completed, opening a port may be accomplished by the host-based
    firewall, but could also be implemented by custom software. Adversaries may also
    communicate with an already open port, but the service listening on that port
    will only respond to commands or trigger other malicious functionality if passed
    the appropriate magic value(s). The observation of the signal packets to trigger
    the communication can be conducted through different methods. One means, originally
    implemented by Cd00r (Citation: Hartrell cd00r 2002), is to use the libpcap libraries
    to sniff for the packets in question. Another method leverages raw sockets, which
    enables the malware to use ports that are already open for use by other programs.
    On network devices, adversaries may use crafted packets to enable [Network Device
    Authentication](https://attack.mitre.org/techniques/T1556/004) for standard services
    offered by the device such as telnet. Such signaling may also be used to open
    a closed service port such as telnet, or to trigger module modification of malware
    implants on the device, adding, removing, or changing malicious capabilities.
    Adversaries may use crafted packets to attempt to connect to one or more (open
    or closed) ports, but may also attempt to connect to a router interface, broadcast,
    and network address IP on the same port in order to achieve their goals and objectives.(Citation:
    Cisco Synful Knock Evolution)(Citation: Mandiant - Synful Knock)(Citation: Cisco
    Blog Legacy Device Attacks) To enable this traffic signaling on embedded devices,
    adversaries must first achieve and leverage [Patch System Image](https://attack.mitre.org/techniques/T1601/001)
    due to the monolithic nature of the architecture. Adversaries may also use the
    Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware
    feature that allows a powered down system to be powered on, or woken up, by sending
    a magic packet to it. Once the system is powered on, it may become a target for
    lateral movement.(Citation: Bleeping Computer - Ryuk WoL)(Citation: AMD Magic
    Packet)[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1205)'
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic contents especially all payloads of traffic received
      on TCP port 53.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Process Creation
    detects: Monitor all process creations in host systems for any unusual activity
      e.g. TCP reverse shell process to connect to remote server.
    fgdsid: FGDS0009.003
    name: Process
  groups:
  - description: Liminal Panda established a command and control channel between eDNS
      server of a partner network and another server controlled by them using TCP
      port 53 for transport. [1,2]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1205
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter all network traffic received on TCP port 53 with unusually long
      payloads.
    name: Filter Network Traffic
  - fgmid: FGM5542
    mitigates: Use application layer firewall for unusual payloads sent and received
      on TCP port 53.
    name: Application Layer Firewall
  name: Traffic Signaling
  object-type: technique
  postconditions: []
  preconditions:
  - description: eDNS server of an MNO partner network must be compromised before
      launching this behavior. Then the adversaries may install the pingpong backdoor
      in the compromised eDNS server.
    name: MNOs eDNS server is compromised
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software:
  - description: Pingpong malware was used by Liminal Panda to listen to ICMP echo
      requests from remote hosts. This helped determine the IP address and port number
      to connect to the remote host via TCP reverse shell.
    fgsid: FGS5001
    name: PingPong
  status: Observed
  tactics:
  - TA0005
  - TA0011
  - TA0003
  typecode: attack_technique_addendum
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: rApp gathers sensitive configuration network information, policies,
        etc.
      name: rApps
    - description: UE location, trajectory, navigation information etc.
      name: UE Location
    detections:
    - component: Cloud Service Metadata
      detects: Monitor logs for authentication/authorization of rApps to non-RT RIC.
        Audit logs and telemetry data for unauthorized activities.
      fgdsid: FGDS0025.003
      name: Cloud Service
    - component: Certificate Registration
      detects: Verify and refresh frequently digital signatures used for authenticating
        rApps by non-RT.
      fgdsid: FGDS0037.001
      name: Certificate
    - component: Image hash
      detects: Verify rApp image hash
      fgdsid: FGDS0007.005
      name: Image
    - component: 5G network host software and configurations
      detects: Monitor all rApps onboarding processes. Use host scanning tools to
        detect malware insertions.
      fgdsid: FGDS5029.001
      name: Host system software and configurations
    groups: []
    mitigations:
    - fgmid: FGM5091
      mitigates: Use strong authentication and authorization for 3rd party rApps during
        onboarding.
      name: Mutual Authentication
    - fgmid: FGM1033
      mitigates: Use only trusted supply chain, rigorous scanning of software images.
        Limit Software Installations especially from 3rd party sources.
      name: Limit Software Installation
    - fgmid: FGM1043
      mitigates: Credential Access Protection - Use capabilities to prevent successful
        credential access by adversaries; including blocking forms of credential dumping.
      name: Credential Access Protection
    - fgmid: FGM1045
      mitigates: Verify digital signature of all rApps.
      name: Code Signing
    - fgmid: FGM5500
      mitigates: Restrict access to operators OA&M resources.
      name: Restrict Access To Operator OA&M Resources
    - fgmid: FGM5516
      mitigates: Make the tokens short lived to prevent replay of token attacks (AiTM).
      name: Session Lifetime
    name: "## Addendum Name: Compromised rApp Exploits Services\r\n### Architecture\
      \ Segments: RAN, O-RAN\r\n An adversary may use a malicious rApp to exploit\
      \ the R1 interface for gaining unauthorized access to network configuration\
      \ and sensitive data.\r\n\r\nA malicious rApp may exploit the R1 interface to\
      \ manipulate the non-RT RIC, gaining unauthorized access to network configurations\
      \ and sensitive data. Such rApps, whether malware or compromised, could disrupt\
      \ non-RT RIC functions, including AI/ML model training, A1 policy management,\
      \ enrichment information handling, and network configuration optimization. Their\
      \ actions may lead to performance degradation, denial of service (DoS), or enrichment\
      \ data exposure, such as UE location, trajectory, navigation information, and\
      \ GPS data, etc."
    platforms:
    - Non-RT RIC
    preconditions:
    - description: This is either an rApp that is malicious but is not detected during
        the onboarding process or this is a trusted rApp that later becomes compromised.
      name: Onboarded malicious rApp
    procedureexamples:
    - description: A malicious rApp exploits the R1 interface to gain unauthorized
        access to network configuration and sensitive data by manipulating the non-RT
        RIC, which manages network wide policies and states. [2]
      name: Exploitation and data breach by compromised rApp
    references:
    - <a name="1"> \[1\] </a> [NTIA, "Open RAN Security Report", May 2023](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)
    - <a name="2"> \[2\] </a> [O-RAN Alliance, "O-RAN Security Threat Modeling and
      Risk Assessment", R004.v05.00, Feb 2025](https://specifications.o-ran.org/download?id=846)
    - '<a name="3"> \[3\] </a> [M. Liyanage, A. Braeken, S. Shahabuddin, P. Ranaweera,
      "Open RAN Securty: Challenges and Opportunities", 2023](https://doi.org/10.1016/j.jnca.2023.103621)'
    software: []
  architecture-segment: RAN, O-RAN
  bluf: Adversaries may exploit remote services to gain unauthorized access to internal
    systems once inside of a network.
  campaigns: []
  criticalassets:
  - description: rApp gathers sensitive configuration network information, policies,
      etc.
    name: rApps
  - description: UE location, trajectory, navigation information etc.
    name: UE Location
  description: 'Adversaries may exploit remote services to gain unauthorized access
    to internal systems once inside of a network. Exploitation of a software vulnerability
    occurs when an adversary takes advantage of a programming error in a program,
    service, or within the operating system software or kernel itself to execute adversary-controlled
    code. A common goal for post-compromise exploitation of remote services is for
    lateral movement to enable access to a remote system. An adversary may need to
    determine if the remote system is in a vulnerable state, which may be done through
    [Network Service Discovery](https://attack.mitre.org/techniques/T1046) or other
    Discovery methods looking for common, vulnerable software that may be deployed
    in the network, the lack of certain patches that may indicate vulnerabilities,
    or security software that may be used to detect or contain remote exploitation.
    Servers are likely a high value target for lateral movement exploitation, but
    endpoint systems may also be at risk if they provide an advantage or access to
    additional resources. There are several well-known vulnerabilities that exist
    in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and
    RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within
    internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services.(Citation:
    NVD CVE-2014-7169) Depending on the permissions level of the vulnerable remote
    service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)
    as a result of lateral movement exploitation as well.[To read more, please see
    the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1210)'
  detections:
  - component: Cloud Service Metadata
    detects: Monitor logs for authentication/authorization of rApps to non-RT RIC.
      Audit logs and telemetry data for unauthorized activities.
    fgdsid: FGDS0025.003
    name: Cloud Service
  - component: Certificate Registration
    detects: Verify and refresh frequently digital signatures used for authenticating
      rApps by non-RT.
    fgdsid: FGDS0037.001
    name: Certificate
  - component: Image hash
    detects: Verify rApp image hash
    fgdsid: FGDS0007.005
    name: Image
  - component: 5G network host software and configurations
    detects: Monitor all rApps onboarding processes. Use host scanning tools to detect
      malware insertions.
    fgdsid: FGDS5029.001
    name: Host system software and configurations
  groups: []
  id: FGT1210
  mitigations:
  - fgmid: FGM5091
    mitigates: Use strong authentication and authorization for 3rd party rApps during
      onboarding.
    name: Mutual Authentication
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1043
    mitigates: Credential Access Protection - Use capabilities to prevent successful
      credential access by adversaries; including blocking forms of credential dumping.
    name: Credential Access Protection
  - fgmid: FGM1045
    mitigates: Verify digital signature of all rApps.
    name: Code Signing
  - fgmid: FGM5500
    mitigates: Restrict access to operators OA&M resources.
    name: Restrict Access To Operator OA&M Resources
  - fgmid: FGM5516
    mitigates: Make the tokens short lived to prevent replay of token attacks (AiTM).
    name: Session Lifetime
  name: Exploitation of Remote Services
  object-type: technique
  postconditions:
  - description: rApp exploits and exfiltrates information.
    name: rApp breach
  preconditions:
  - description: This is either an rApp that is malicious but is not detected during
      the onboarding process or this is a trusted rApp that later becomes compromised.
    name: Onboarded malicious rApp
  procedureexamples:
  - description: A malicious rApp exploits the R1 interface to gain unauthorized access
      to network configuration and sensitive data by manipulating the non-RT RIC,
      which manages network wide policies and states. [2]
    name: Exploitation and data breach by compromised rApp
  references:
  - <a name="1"> \[1\] </a> [NTIA, "Open RAN Security Report", May 2023](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)
  - <a name="2"> \[2\] </a> [O-RAN Alliance, "O-RAN Security Threat Modeling and Risk
    Assessment", R004.v05.00, Feb 2025](https://specifications.o-ran.org/download?id=846)
  - '<a name="3"> \[3\] </a> [M. Liyanage, A. Braeken, S. Shahabuddin, P. Ranaweera,
    "Open RAN Securty: Challenges and Opportunities", 2023](https://doi.org/10.1016/j.jnca.2023.103621)'
  software: []
  status: Theoretical
  tactics:
  - TA0008
  - TA0007
  - TA0040
  typecode: attack_technique_addendum
- bluf: Adversaries may perform Network Denial of Service (DoS) attacks to degrade
    or block the availability of targeted resources to users.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may perform Network Denial of Service (DoS) attacks to
    degrade or block the availability of targeted resources to users. Network DoS
    can be performed by exhausting the network bandwidth services rely on. Example
    resources include specific websites, email services, DNS, and web-based applications.
    Adversaries have been observed conducting network DoS attacks for political purposes(Citation:
    FireEye OpPoisonedHandover February 2016) and to support other malicious activities,
    including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism,
    and extortion.(Citation: Symantec DDoS October 2014) A Network DoS will occur
    when the bandwidth capacity of the network connection to a system is exhausted
    due to the volume of malicious traffic directed at the resource or the network
    connections and network devices the resource relies on. For example, an adversary
    may send 10Gbps of traffic to a server that is hosted by a network with a 1Gbps
    connection to the internet. This traffic can be generated by a single system or
    multiple systems spread across the internet, which is commonly referred to as
    a distributed DoS (DDoS). To perform Network DoS attacks several aspects apply
    to multiple methods, including IP address spoofing, and botnets. Adversaries may
    use the original IP address of an attacking system, or spoof the source IP address
    to make the attack traffic more difficult to trace back to the attacking system
    or to enable reflection. This can increase the difficulty defenders have in defending
    against the attack by reducing or eliminating the effectiveness of filtering by
    the source address on network defense devices. For DoS attacks targeting the hosting
    system directly, see [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1499).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1498)'
  detections: []
  groups: []
  id: FGT1498
  mitigations: []
  name: Network Denial of Service
  object-type: technique
  platforms: Windows, Azure AD, Office 365, SaaS, IaaS, Linux, macOS, Google Workspace,
    Containers
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Control plane is not able to function well for UEs to use to register
        to the network.
      name: Control plane/signaling plane
    - description: Legitimate UEs do not get network access in the area where false
        base station is deployed.
      name: Data and voice services/service availability
    detections:
    - component: gNB broadcast messages
      detects: Monitor (at each gNB) for unexpected broadcast signals.
      fgdsid: FGDS5002.002
      name: Radio interface
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: '(not standards compliant as of now): Use integrity protection for
        all broadcast messages sent by gNB. This will have performance impact on the
        network and UE due to additional processing of integrity protection algorithm.'
      name: Integrity Protection Of Data Communication
    name: "## Addendum Name: TAU Signaling Storm\r\n### Architecture Segments: RAN\r\
      \n Adversary controlled false base station transmits crafted broadcast messages\
      \ to cause signaling storm on legitimate base stations.\r\n\r\nLTE sub-frames\
      \ are sent by adversary from a false base station which mimics legitimate eNB.\
      \ It sends fake System Information Block Type 1 (SIB1) messages which are aligned\
      \ in time-frequency domain with the messages sent by the legitimate eNB, but\
      \ with stronger transmit power. This is known as a type of sigover (signal overshadowing)\
      \ attack. The adversary does not send synchronization signals (PSS, SSS) for\
      \ this attack, which makes it harder to detect.\r\n\r\nAll UEs in the area may\
      \ get tricked by these fake broadcast messages into thinking they have entered\
      \ a new tracking area, and so they will all send Tracking Area Update (TAU)\
      \ messages to legitimate eNB(s). This can cause a signaling storm in the 4G\
      \ network.\r\n\r\n \r\n\r\nThe same attacks are possible in a 5G network, as\
      \ MIB and SIB1 messages in 5G are similar to 4G and those are not integrity\
      \ protected in 5G."
    platforms:
    - 5G RAN
    preconditions:
    - description: Adversary gets hold of a false base station which is capable of
        broadcasting fraudulent messages.
      name: Obtain a false base station to send fake broadcast messages
    - description: False base station must be deployed in the area where target UEs
        are located.
      name: Adversary must be in the same vicinity of target UEs
    procedureexamples:
    - description: Adversary broadcasts fake SIB1 messages with a different Tracking
        Area Code (TAC) than the TAC sent by legitimate gNB. The fake SIB1 messages
        are aligned in the time-frequency domain exactly the same as legitimate eNB,
        but with higher power. All UEs in the area may get tricked to process these
        fake SIB1 messages and they may send Tracking Area Update (TAU) messages to
        the legitimate eNB. This may cause signaling storm in the 4G network and may
        also cause DoS attack by denying access to network for legitimate UEs [1,
        5].The same attack is possible in 5G as SIB1 messages are sent without integrity
        protection and the format of the messages are similar to 4G.
      name: Fake SIB1 messages
    references:
    - '<a name="1"> \[1\] </a> [Usenix paper: Hojoon Yang et al. "Hiding in Plain
      Signal: Physical Signal Overshadowing Attack on LTE".](https://www.usenix.org/system/files/sec19-yang-hojoon.pdf)'
    - '<a name="2"> \[2\] </a> [3GPP TS 38.331: "Radio Resource Control (RRC); Protocol
      specification" Release 16.](https://www.3gpp.org/DynaReport/38331.htm)'
    - '<a name="3"> \[3\] </a> [3GPP TR 33.809: "Study on 5G security enhancements
      against False Base Stations (FBS)", Technical Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
    - '<a name="4"> \[4\] </a> [Jingya Li et al: "An Overview of 5G System Accessibility
      Differentiation and Control".](https://arxiv.org/ftp/arxiv/papers/2012/2012.05520.pdf)'
    - '<a name="5"> \[5\] </a> [ACM article, Chuan Yu et al: "Improving 4G/5G air
      interface security: A survey of existing attacks on different LTE layers".](https://dl.acm.org/doi/abs/10.1016/j.comnet.2021.108532)'
    software: []
  architecture-segment: RAN
  bluf: Adversaries may attempt to cause a denial of service (DoS) by reflecting a
    high-volume of network traffic to a target.
  campaigns: []
  criticalassets:
  - description: Control plane is not able to function well for UEs to use to register
      to the network.
    name: Control plane/signaling plane
  - description: Legitimate UEs do not get network access in the area where false
      base station is deployed.
    name: Data and voice services/service availability
  description: 'Adversaries may attempt to cause a denial of service (DoS) by reflecting
    a high-volume of network traffic to a target. This type of Network DoS takes advantage
    of a third-party server intermediary that hosts and will respond to a given spoofed
    source IP address. This third-party server is commonly termed a reflector. An
    adversary accomplishes a reflection attack by sending packets to reflectors with
    the spoofed address of the victim. Similar to Direct Network Floods, more than
    one system may be used to conduct the attack, or a botnet may be used. Likewise,
    one or more reflectors may be used to focus traffic on the target.(Citation: Cloudflare
    ReflectionDoS May 2017) This Network DoS attack may also reduce the availability
    and functionality of the targeted system(s) and network. Reflection attacks often
    take advantage of protocols with larger responses than requests in order to amplify
    their traffic, commonly known as a Reflection Amplification attack. Adversaries
    may be able to generate an increase in volume of attack traffic that is several
    orders of magnitude greater than the requests sent to the amplifiers. The extent
    of this increase will depending upon many variables, such as the protocol in question,
    the technique used, and the amplifying servers that actually produce the amplification
    in attack volume. Two prominent protocols that have enabled Reflection Amplification
    Floods are DNS(Citation: Cloudflare DNSamplficationDoS) and NTP(Citation: Cloudflare
    NTPamplifciationDoS), though the use of several others in the wild have been documented.(Citation:
    Arbor AnnualDoSreport Jan 2018) In particular, the memcache protocol showed itself
    to be a powerful protocol, with amplification sizes up to 51,200 times the requesting
    packet.(Citation: Cloudflare Memcrashed Feb 2018)[To read more, please see the
    MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1498/002)'
  detections:
  - component: gNB broadcast messages
    detects: Monitor (at each gNB) for unexpected broadcast signals.
    fgdsid: FGDS5002.002
    name: Radio interface
  groups: []
  id: FGT1498.002
  mitigations:
  - fgmid: FGM5024
    mitigates: '(not standards compliant as of now): Use integrity protection for
      all broadcast messages sent by gNB. This will have performance impact on the
      network and UE due to additional processing of integrity protection algorithm.'
    name: Integrity Protection Of Data Communication
  name: Reflection Amplification
  object-type: technique
  postconditions:
  - description: No UE in the area where false base station is present can get connection
      to the network.
    name: Network access denied
  preconditions:
  - description: Adversary gets hold of a false base station which is capable of broadcasting
      fraudulent messages.
    name: Obtain a false base station to send fake broadcast messages
  - description: False base station must be deployed in the area where target UEs
      are located.
    name: Adversary must be in the same vicinity of target UEs
  procedureexamples:
  - description: Adversary broadcasts fake SIB1 messages with a different Tracking
      Area Code (TAC) than the TAC sent by legitimate gNB. The fake SIB1 messages
      are aligned in the time-frequency domain exactly the same as legitimate eNB,
      but with higher power. All UEs in the area may get tricked to process these
      fake SIB1 messages and they may send Tracking Area Update (TAU) messages to
      the legitimate eNB. This may cause signaling storm in the 4G network and may
      also cause DoS attack by denying access to network for legitimate UEs [1, 5].The
      same attack is possible in 5G as SIB1 messages are sent without integrity protection
      and the format of the messages are similar to 4G.
    name: Fake SIB1 messages
  references:
  - '<a name="1"> \[1\] </a> [Usenix paper: Hojoon Yang et al. "Hiding in Plain Signal:
    Physical Signal Overshadowing Attack on LTE".](https://www.usenix.org/system/files/sec19-yang-hojoon.pdf)'
  - '<a name="2"> \[2\] </a> [3GPP TS 38.331: "Radio Resource Control (RRC); Protocol
    specification" Release 16.](https://www.3gpp.org/DynaReport/38331.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TR 33.809: "Study on 5G security enhancements against
    False Base Stations (FBS)", Technical Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  - '<a name="4"> \[4\] </a> [Jingya Li et al: "An Overview of 5G System Accessibility
    Differentiation and Control".](https://arxiv.org/ftp/arxiv/papers/2012/2012.05520.pdf)'
  - '<a name="5"> \[5\] </a> [ACM article, Chuan Yu et al: "Improving 4G/5G air interface
    security: A survey of existing attacks on different LTE layers".](https://dl.acm.org/doi/abs/10.1016/j.comnet.2021.108532)'
  software: []
  status: POC
  subtechnique-of: FGT1498
  tactics:
  - TA0040
  typecode: attack_subtechnique_addendum
- access-required: N/A
  architecture-segment: Control Plane, Network Slice
  bluf: An adversary may send high volumes of signaling messages to core network functions
    in order to cause a denial of service.
  campaigns: []
  criticalassets:
  - description: AMF functionality serving the UEs should be available always.
    name: AMF
  description: "An adversary may send high volumes of signaling messages to core network\
    \ functions in order to cause a denial of service.\r\n\r\nUpon power on or coming\
    \ out of flight mode, a UE needs to register with 5G network in order to get services\
    \ from the network. After it gets connected to the network, UE sends several signaling\
    \ messages to maintain the connection and to request new services. If any of those\
    \ signaling messages are sent repeatedly to 5G network, the network spends its\
    \ resources to process those request messages, which may overwhelm some critical\
    \ Network Functions (NFs) such as Access and Mobility Function (AMF).\r\n\r\n\
    A malicious UE sends repeated Attach requests which cause AMF to start many registrations.\
    \ Alternatively, when a load balancing Service Communication Proxy (SCP) is not\
    \ employed, an adversary in the network sends many otherwise-legitimate control\
    \ messages to a NF so as to overload it. Network service is degraded for all other\
    \ users in that area (served by AMF)."
  detections:
  - component: Firewall metadata
    detects: NAS or RRC Application layer firewall metadata can be used to detect
      repeated attempt of UE attach-detach cycle within a short period.
    fgdsid: FGDS0018.003
    name: Firewall
  - component: gNB log content for flooding of messages from UE
    detects: Keep track of the number of access requests received from UEs (or a single
      UE) at the gNB. If a threshold is reached, ignore any new such messages from
      that UE.
    fgdsid: FGDS5017.003
    name: gNB or 5G core logs
  - component: Network Connection Creation
    detects: Monitor the new connections UE is trying to make. Use any RAN temporary
      ID or even estimated UE location to tie all the new connections to a single
      UE
    fgdsid: FGDS0029.001
    name: Network Traffic
  groups: []
  id: FGT1498.501
  mitigations:
  - fgmid: FGM5509
    mitigates: Employ a firewall or other rate control device on the N2 interface
      [from RAN to AMF](May not be available in the market). Employ a NAS-MM (Non-access
      stratum Mobility Mgmt) application layer proxy at the edge of the network, having
      the capability to limit UE request rate.In addition, SCP can act as load balancer
      between the service consumer (AMF) and service producer (UDM). (Annex E of [2])
    name: Screen Signaling And User Plane Messages
  name: Flooding Core Network Component
  object-type: technique
  platforms: 5G RAN, 5G Core
  postconditions:
  - description: 'If AMF services are down, all services for the existing UEs which
      use NAS layer will not be available. For example: mobility, session management
      (QoS etc.), PDU session set up / tear down, SMS over NAS, location management.
      New UE connection attempts will also fail when AMF services are down. Clause
      8.2.2.1 of [2].'
    name: AMF service will not be available to legitimate users during attack.
  preconditions: []
  procedureexamples:
  - description: 'Because network slices and network functions can be shared, malicious
      UE can create control plane storms.AMF Message Flooding for a shared slice with
      shared NFs:(1) An initial AMF validates if the user (UE) is allowed to access
      the subscribed S-NSSAI: AMF contacts the UDM to request the UE''s Slice Selection
      Subscription data.  The initial UDM may contact the UDR for the UE''s Slice
      Selection Subscription data, then provides the data to the AMF.(2) During the
      t0 to t-delta time interval that it takes to perform (1), the UE drops the initial
      AMF then re-attaches to the AMF, restarting the validation.(3) The UE recursively
      performs (2), which recursively performs (1), creating a "UE-AMF-UDM-UDR-AMF"
      message storm sandwiched in between an "Attach-Detach" storm.(4) Since this
      is a shared slice with shared NFs, the control plane storm (Attach-UE-AMF-UDM-UDR-AMF-Detach-Attach-recursively
      repeat) creates a DoS condition.'
    name: NAS Control plane signaling storm
  - description: At least for 5G Non standalone, the initial RRC message is not protected.
      Thus, a malicious UE can deplete the capacity of active RRC connections at a
      gNB or eNB [3]
    name: RRC control plane signaling storm
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [3GPP TS 23.501: System architecture for the 5G System
    (5GS)](https://www.3gpp.org/DynaReport/23501.htm)'
  - '<a name="3"> \[3\] </a> [Wani M., Rademacher M., Horstmann T, Kretschmer M. "Security
    Vulnerabilities in 5G Non-Stand-Alone Networks: A Systematic Analysis and Attack
    Taxonomy". Journal of Cybersecurity and Privacy10.3390/jcp40100024:1(23-40)Online
    publication date: 2-Jan-2024](https://www.mdpi.com/2624-800X/4/1/2)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1498
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: Network Slice
  bluf: Adversaries may exhaust common resources of a slice to cause denial of service
    (service degradation) to all other slices that use the same common resources.
  campaigns: []
  criticalassets:
  - description: NFVI network and compute resources.
    name: NFVI
  - description: 5G core, RAN and Non-SBI functions, virtual resources supporting
      VNF.
    name: VNFs
  description: "Adversaries may exhaust common resources of a slice to cause denial\
    \ of service (service degradation) to all other slices that use the same common\
    \ resources.\r\n\r\n5G network slices may be built using same NFVI resources or\
    \ may be sharing a common core or RAN function. A network slice may have dedicated\
    \ AMF, SMF and UPF but NEF, NRF, UDM are usually shared for a deployment. Adversary's\
    \ slice A may target a slice B by exhausting resources common to slice A and B\
    \ such as NEF.\r\n\r\nIt is possible for adversary's slice to oversubscribe a\
    \ resource (NF or NFVI resource) to an extent where other slices cannot get their\
    \ messages and process executed in due time. This results in UEs or some network\
    \ functions experiencing denial of service within target slices.   "
  detections:
  - component: User and resource policy configuration logs in core network
    detects: Automated user and resource policy compliance checks and instrumentation
      to alert on violation attempts.
    fgdsid: FGDS5023.001
    name: User and resource policy configuration
  - component: Security logs in core
    detects: SIEM - Auditing logs for security, authentication and authorization activity,
      host access, hosts, virtualization orchestrator and managers can reveal behavioral
      anomalies.
    fgdsid: FGDS5012.001
    name: Security logs in network
  - component: Host Status
    detects: Monitor systems performance and alert on quota exceptions on hosts, applications
      and networks.
    fgdsid: FGDS0013.001
    name: Sensor Health
  groups: []
  id: FGT1498.502
  mitigations:
  - fgmid: FGM5518
    mitigates: Create and enforce resource policy; policy can include SLA, quotas,
      QOS etc.
    name: Resource Policy Enforcement
  - fgmid: FGM5506
    mitigates: Use inter-slice isolation method which uses separate hardware components
      for each slice. [5]
    name: Network Slice Templates
  - fgmid: FGM1030
    mitigates: Implementing segmentation policy at granular level, network and compute
      resources can prevent some co-residency threats when mapped to SLAs, users,
      and resource policies.
    name: Network Segmentation
  - fgmid: FGM5005
    mitigates: Hardware, network, and point of presence can be separated to provide
      additional isolation.
    name: Physical And Environmental Protection
  - fgmid: FGM5512
    mitigates: Horizontal Elastic Scale helps with resource exhaustion.
    name: Use High Availability
  name: Shared Slice Common Control Network Function Resource Exhaustion
  object-type: technique
  platforms: Slice, Compute
  postconditions: []
  preconditions:
  - description: Adversary must have administrative control of an NF in the core network
      to launch the resource exhaustion behavior on the target NF.
    name: Adversary has administrative access to core
  procedureexamples:
  - description: An insider adversary or a compromised network function may launch
      resource exhaustion behavior on another NF of its own slice. For example, it
      can drain CPU resources of the victim NF. Normal operations of the network slice
      will be impacted due to this behavior which may cause outage of the entire slice.
    name: DoS by an adversary with administrative access in core
  - description: Adversary launches distributed DoS on an interface of a target network
      slice. Some examples of DDoS are TCP syn flood and UDP ping flood. The interface
      may become unusable due to the behavior and the victim slice gets a DoS. If
      the same interface is shared by another slice, that slice will be also impacted.
    name: DDoS on target slice from external interface
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC026: "Isolation and trust domain specification",
    section 4.2.3, Accessed 6/27/2022.](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC026_Isolation_and_trust_domain)'
  - '<a name="2"> \[2\] </a> [GSMA Official Document NG.126: "Cloud Infrastructure
    Reference Model", NG.126-v1.0-2, Accessed 6/27/2022.](https://www.gsma.com/newsroom/wp-content/uploads//NG.126-v1.0-2.pdf)'
  - "<a name=\"3\"> \\[3\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:\
    \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
    ,\_October 2021.](https://arxiv.org/abs/2108.11206)"
  - '<a name="4"> \[4\] </a> [NGMN: "5G Security Recommendation Package #2 Network
    Slicing", Accessed 6/27/2022.](https://www.ngmn.org/wp-content/uploads/Publications/2016/160429_NGMN_5G_Security_Network_Slicing_v1_0.pdf)'
  - '<a name="5"> \[5\] </a> [Danish Sattar et al: "Towards Secure Slicing: Using
    Slice Isolation to Mitigate DDoS Attacks on 5G Core Network Slices".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8802852)'
  - '<a name="6"> \[6\] </a> [S. Sullivan et al.: "5G Security Challenges and Solutions:
    A Review by OSI Layers".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9514842)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1498
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: Control Plane, User Plane
  bluf: An adversary controlled UE or gNB may be used to send crafted NAS or GTP-U
    messages to crash or slow down the AMF or UPF.
  campaigns: []
  criticalassets:
  - description: 5G core network functions can be slowed down or crashed which causes
      temporary network outage for UEs and gNBs.
    name: Core network functions
  description: "An adversary controlled UE or gNB may be used to send crafted NAS\
    \ or GTP-U messages to crash or slow down the AMF or UPF.\r\n\r\nUEs use NAS protocol\
    \ (via N1 interface) to communicate with the core AMF function. AMF processes\
    \ registration request messages from UE, and it works with other NFs in the core\
    \ to respond to those messages. Message parsing vulnerabilities can be exploited\
    \ to result in memory exhaustion or application crash. Thus, a specially crafted\
    \ message can - upon processing-- cause memory corruption or parsing error which\
    \ can potentially crash the AMF. By sending crafted NAS messages from UE, an adversary\
    \ may force the AMF or other 5G Control Plane functions to go into undefined states,\
    \ which might result in DoS. Existing UEs and new UEs may not be able to get service\
    \ from the 5G network. \r\n\r\nA fake or compromised gNB uses the NGAP protocol\
    \ to communicate with the AMF. NGAP, like its 4G predecessor S1AP, uses ASN.1\
    \ encoding, which has very strict formatting rules. The NGAP handler (e.g. ASN.1\
    \ deserialization) at the AMF may not handle correctly malformed or incorrect\
    \ messages, resulting in memory corruption or other faults that cause a denial\
    \ or degradation of service at the AMF. \r\n\r\nAn adversary may use a rogue UE\
    \ to send packets with modified GTP-U headers or payloads that will cause a denial\
    \ of service of the UPF; this is due to message parsing vulnerabilities which\
    \ can result in memory exhaustion or application crash. If UPF slows down or crashes,\
    \ the existing user data sessions may be degraded or dropped and/or future user\
    \ data sessions may be dropped.\r\n\r\nBackground info: The NAS protocol has its\
    \ own structure and carries signaling data between the UE and the MM component\
    \ (AMF for 5G, MME for 4G), and is treated as opaque data by the gNB/eNB. The\
    \ NGAP (for 5G) or S1AP (for 4G) protocols are ASN.1 formatted and used to carry\
    \ signaling from the base station (gNB/eNB) to the MM component."
  detections:
  - component: Network Traffic Content
    detects: Examine all header fields and IEs of control plane messages received
      in the uplink direction from UE to the AMF, and from the gNB to the AMF, and
      from UE to UPF.This can be done either by logging all messages received by the
      AMF and UPF or by using a proxy or firewall at the core network entry point.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Image Metadata
    detects: Check to see if software (including patches) for each AMF, UPF, core
      NF, and gNB has been modified.
    fgdsid: FGDS0007.003
    name: Image
  groups: []
  id: FGT1498.503
  mitigations:
  - fgmid: FGM5509
    mitigates: Use cyber-threat aware DPI firewalls. Check for NAS and NGAP message
      with incorrect, zero, or very large length, incorrect formats. Improve message
      parsing mechanism by discarding messages with improper header lengths. Watch
      out for misuse of GTP-U tunnels (NGAP in GTP-U, GTP-U in GTP-U)- for example
      by doing cross verification of User plane IP addresses with Control plane IP
      addresses.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM1051
    mitigates: Patch all vulnerabilities discovered in ASN.1 handlers in 5G core network
      functions and UPF.
    name: Update Software
  - fgmid: FGM5512
    mitigates: Use high availability feature for all core network functions.
    name: Use High Availability
  name: Malicious Packets To Network Functions
  object-type: technique
  platforms: 5G Core, 5G RAN, 5G UE
  postconditions:
  - description: Some 5G core network services will be unavailable causing temporary
      network outage.
    name: Network services unavailable
  preconditions:
  - description: A compromised COTS UE or a UE with open-source code running in an
      SDR can be used to run malicious application code. This can be used to generate
      the specially crafted NAS message to be sent towards AMF.
    name: Compromise a UE or obtain a purpose built UE
  procedureexamples:
  - description: Adversary controlled UE sends a crafted NAS message towards AMF with
      the length field increased to a very large value. If AMF does not do proper
      header parameters check including length check, it can cause buffer overflow
      in the AMF which can force AMF to go to an undefined state or crash. This will
      cause Denial of Service for existing and future UEs. [1,2,3,6].Alternatively
      the malformed NAS message may contain an absent field or malformed field. These
      NAS messages are sent before authentication completes between the UE and AMF
      [5]..
    name: Malicious UE sends malformed NAS message to AMF
  - description: Adversary controlled gNB sends a crafted NGAP message towards AMF.
      [7] shows that many such malformed messages were discovered in their fuzzing
      experiments, due to faulty implementation at the AMF/MME of the handler of ASN.1
      deserialization and NGAP messages. Reference [7] also states that the fuzzed
      NGAP messages trigger invalid memory use or memory corruption, which could potentially
      be used for remote code execution.
    name: Malicious/compromised gNB sends malformed NGAP messages to AMF
  - description: UE sends GTP-U packet with another telecom protocol encapsulated
      inside (NGAP or GTP-U again), or with incorrect packet length in header ([4],[5]).
      UPF crashes upon processing.
    name: UE sends malicious GTP-U packet to UPF
  references:
  - '<a name="1"> \[1\] </a> [Github post: "[NAS] fix the security issue (ZDI-CAN-14043)".](https://github.com/open5gs/open5gs/commit/00c96a3f0ffd12c4330bee9a3f9596f8e4b86b6f)'
  - '<a name="2"> \[2\] </a> [CVE-2021-44081: "A buffer overflow vulnerability exists
    in the AMF of open5gs 2.1.4. When the length of MSIN in Supi exceeds 24 characters,
    it leads to AMF denial of service."](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44081)'
  - '<a name="3"> \[3\] </a> [CVE-2022-43677: "A crafted malformed NGAP message can
    crash AMF and NGAP decoder".](https://github.com/free5gc/free5gc/issues/402)'
  - '<a name="4"> \[4\] </a> [CVE-2021-45462: "In Open5GS 2.4.0, a crafted packet
    from UE can crash SGW-U/UPF".](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45462)'
  - '<a name="5"> \[5\] </a> [TrendMicro blog, "Attacks on 5G Infrastructure From
    User Devices: ASN.1 Vulnerabilities in 5G Cores", Oct. 2023.](https://www.trendmicro.com/en_us/research/23/j/asn1-vulnerabilities-in-5g-cores.html)'
  - '<a name="6"> \[6\] </a> [TrendMicro blog, "Vulnerabilities in Cellular Packet
    Cores Part IV: Authentication", Sept. 2024.](https://www.trendmicro.com/en_us/research/24/i/vulnerabilities-in-cellular-packet-cores-part-iv-authentication.html)'
  - '<a name="7"> \[7\] </a> [Bennett, Nathaniel & Zhu, Weidong & Simon, Benjamin
    & Kennedy, Ryon & Enck, William & Traynor, Patrick & Butler, Kevin. (2024). RANsacked:
    A Domain-Informed Approach for Fuzzing LTE and 5G RAN-Core Interfaces. 2027-2041.
    10.1145/3658644.3670320.](https://www.researchgate.net/publication/386590587_RANsacked_A_Domain-Informed_Approach_for_Fuzzing_LTE_and_5G_RAN-Core_Interfaces)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1498
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: O-RAN
  bluf: Adversary may change the main clock source of PTP in a legitimate gNB to achieve
    Denial of Service on RAN.
  campaigns: []
  criticalassets:
  - description: Service outage in the coverage area of the victim gNB.
    name: gNB
  description: "Adversary may change the main clock source of PTP in a legitimate\
    \ gNB to achieve Denial of Service on RAN.\r\n\r\nPrecise timing and synchronization\
    \ are essential in operation of O-RAN open fronthaul (FH). O-DU and O-RU synchronize\
    \ timing using Precision Timing Protocol (PTP) on the open FH synchronization\
    \ plane or S plane. gNB/O-RU synchronizes timing with the UEs by sending periodic\
    \ New Radio - Positioning Reference Signal (NR-PRS) to all UEs. The UEs send responses\
    \ to the gNB by sending Sounding Reference Signal (SRS) for positioning.\r\n\r\
    \nAn adversary controlled gNB may compromise its own PTP grand master clock. Then\
    \ O-RU to O-DU synchronization in O-RAN fronthaul S plane will be lost and the\
    \ gNB will send NR-PRS signals to all UEs in the area with incorrect timing. This\
    \ behavior may cause degradation of timing and synchronization accuracy of the\
    \ victim gNB and it may potentially cause network outage.\r\n\r\nThe Location\
    \ Management Function (LMF) initiates multi-cell round trip time (multi-RTT) positioning\
    \ procedure involving multiple gNBs and a single UE. Refer clause 8.10.4 of [5].\r\
    \n\r\nUE multi-RTT procedure: The UE reports to the LMF the UE Rx-Tx time difference\
    \ and the UE Rx-Tx time difference subframe offset based on the NR-PRSes it receives\
    \ from the gNBs in the vicinity and SRSes it sends to those gNBs. UE uses LTE\
    \ Positioning Protocol (LPP) to send the timing data to LMF.\r\n\r\ngNB multi-RTT\
    \ procedure: Each gNB sends to the LMF the gNB Rx-TX time difference based on\
    \ the NR-PRSes it sends to the UE and the SRSes it receives from the UE using\
    \ New Radio Positioning Protocol A (NRPPa).\r\n\r\nThe LMF runs an algorithm to\
    \ detect timing anomalies based on the timing information received from a specific\
    \ UE and all gNBs which are reachable from that UE. LMF can identify the location\
    \ of compromised gNB which could be causing the timing issue. LMF can notify the\
    \ Network Operations Center (NOC) which may take appropriate actions to restore\
    \ PTP grand master clock in the compromised gNB. [1]\r\n\r\nNote: 5G 3GPP specifications\
    \ have defined another SRS signal which is used for UE uplink power control. [2,6,7]"
  detections:
  - component: Signals sent by UEs
    detects: Monitor gNB logs for SRS signals received from the UEs for any irregular
      timing of SRS transmission by UE.
    fgdsid: FGDS5002.001
    name: Radio interface
  - component: Application Log Content
    detects: Monitor LMF logs for LPP messages received from UEs and NRPPa messages
      received from gNBs for presence of  anomalous NR-PRSes sent from the victim
      gNB.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: File Modification
    detects: Monitor the following in the OAM system:PTP related changes in gNB config
      files.Monitor the gNB timing source changes and gNB timing adjustments in gNB
      config which may be accidental or adversarial.
    fgdsid: FGDS0022.005
    name: File
  - component: User Account Modification
    detects: Audit access logs of gNBs and grand master clocks (any relays between
      network elements and GM clock) for any suspicious and unaccounted for changes.
    fgdsid: FGDS0002.005
    name: User Account
  groups: []
  id: FGT1498.504
  mitigations: []
  name: O-RAN Synchronization
  object-type: technique
  platforms: RAN, Open Fronthaul
  postconditions:
  - description: Service outage in the coverage area of victim gNB.
    name: RAN service outage
  preconditions:
  - description: Adversary has unauthorized access to a legitimate gNB and they have
      the capability to compromise its grand master clock.
    name: Access to a legitimate gNB
  procedureexamples:
  - description: Adversary compromises a legitimate base station's PTP grand master
      clock. The victim gNB loses synchronization in its fronthaul S plane. Then it
      starts broadcasting periodic NR-PRS signals with incorrect timing. All UEs in
      victim gNB's coverage area may experience network outage. [1]
    name: Send fraudulent NR-PRS signals to all UEs in the area from compromised gNB
  references:
  - '<a name="1"> \[1\] </a> [NYU paper Marco Mezzavilla et al: "Detecting O-RAN Synchronization
    Attacks via 5G NR Positioning".](https://ieeexplore.ieee.org/document/10615754)'
  - '<a name="2"> \[2\] </a> [Ericsson white paper S. Dwivedi et al: "5G positioning:
    What you need to know", December 2020.](https://www.ericsson.com/en/blog/2020/12/5g-positioning--what-you-need-to-know)'
  - '<a name="3"> \[3\] </a> [3GPP TS 38.455: "NR Positioning Protocol A (NRPPa)".](https://www.3gpp.org/DynaReport/38455.htm)'
  - '<a name="4"> \[4\] </a> [3GPP TS 37.355: "LTE Positioning Protocol (LPP)".](https://www.3gpp.org/DynaReport/37355.htm)'
  - '<a name="5"> \[5\] </a> [3GPP TS 38.305: "NG Radio Access Network (NG-RAN); Stage
    2 functional specification of User Equipment (UE) positioning in NG-RAN".](https://www.3gpp.org/DynaReport/38305.htm)'
  - '<a name="6"> \[6\] </a> [Ericsson white paper S. Dwivedi et al: "Positioning
    in 5G networks", February 2021.](https://arxiv.org/pdf/2102.03361)'
  - '<a name="7"> \[7\] </a> [3GPP TS 38.211: "Physical channels and modulation".](https://www.3gpp.org/DynaReport/38211.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1498
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: SMO internal operations may be degraded due to this behavior.
      name: SMO
    - description: OAM data sent over O1 interface may be interrupted and may impact
        O-CU-CP and O-CU-UP operations.
      name: O-CU-CP and O-CU-UP
    - description: OAM data sent over O1 interface may be interrupted and may impact
        O-DU operations.
      name: O-DU
    - description: OAM data sent over open fronthaul M-plane interface (in hybrid
        mode) may be interrupted and may impact O-RU operations.
      name: O-RU
    - description: Enrichment data sent over A1 interface or OAM data sent over O1
        interface may be interrupted and may impact near-RT RIC operations.
      name: Near-RT RIC
    - description: Degraded performance of SMO may impact non-RT RIC operations.
      name: Non-RT RIC
    - description: OAM data sent over O2 interface may be interrupted and may impact
        O-CLOUD operations.
      name: O-CLOUD
    detections:
    - component: Network Traffic Content
      detects: Monitor data traffic on network elements of all SMO external interfaces
        and on the infrastructure supporting external interfaces to detect any unusual
        volume of traffic sent from external devices to SMO.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM5509
      mitigates: Use firewalls with allow/deny list at the entry point of all external
        interfaces of the SMO. Measure the number of hits/misses on the firewall to
        determine onset of behavior.Use rate limiters at the entry point of all external
        interfaces of the SMO.Measure the number of hits/misses on the rate limiter
        to determine onset of behavior.
      name: Screen Signaling And User Plane Messages
    - fgmid: FGM5541
      mitigates: Particular implementation of SMO function should consider risk modeling
        of external interfaces as part of architecture design and implement mitigations.
      name: Risk Modeling
    name: "## Addendum Name: SMO Flood\r\n### Architecture Segments: O-RAN\r\n An\
      \ adversary may flood an external interface to cause a denial of service to\
      \ the SMO.\r\n\r\nO-RAN SMO exposes several services to external clients. Some\
      \ examples of service exposure are data management and service management services,\
      \ AI/ML related services including enrichment information processing. External\
      \ clients interface SMO using service-based interfaces (SBI) which use REST\
      \ API over HTTPS. External interfaces are normally protected by firewalls and\
      \ rate limiters. \r\n\r\nIf the external interface is not protected by firewall\
      \ and rate limiter, an adversary may flood an external interface to overload\
      \ the SMO. For example, adversary may flood the SMO external interface by sending\
      \ large number of TCP SYNs from multiple sources. This can prevent legitimate\
      \ messages and data from reaching the SMO, cause heavy processing load and/or\
      \ resource exhaustion at the SMO, resulting in performance degradation or outage\
      \ of the SMO.\r\n\r\n "
    platforms:
    - O-RAN management SMO
    preconditions:
    - description: Adversary has knowledge of SMO external interface IP address and
        they can reach that IP from an external device.
      name: Reachability to the SMO via external interface
    procedureexamples:
    - description: Adversary achieves DDoS by sending large volumes of bogus messages
        to the SMO from various sources on the external interface. If the SMO external
        interface is not protected by strong firewall and rate limiters, the behavior
        may cause resource exhaustion in the SMO. The performance of SMO may be degraded,
        and it may cause outage of SMO services.Refer T-SMO-29 in clause 7.4.8 of
        [3].
      name: DoS on SMO from external interface
    references:
    - '<a name="1"> \[1\] </a> [NTIA: "Open RAN Security Report", May 2023.](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)'
    - '<a name="2"> \[2\] </a> [O-RAN WG1 R003-v12.00: "O-RAN Architecture Description".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="3"> \[3\] </a> [O-RAN WG11 O-R004-v05.00: "O-RAN Security Threat Modeling
      and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="4"> \[4\] </a> [O-RAN WG1 R003-v02.00: "Decoupled SMO Architecture".](https://orandownloadsweb.azurewebsites.net/specifications)'
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: Security Edge Protection Proxy function which provides roaming
        interface for signaling traffic to roaming partner (MNO) networks
      name: SEPP
    - description: User Plane Function which provides roaming interface for user plane
        traffic to roaming partner (MNO) networks
      name: UPF
    - description: Access and Mobility Function which provides roaming interface for
        signaling traffic to 4G networks via N26 interface and mobility function to
        5G networks via N2 interface
      name: AMF
    detections:
    - component: Application Log Content
      detects: Monitor application logs for unusual requests or rate of requests
      fgdsid: FGDS0015.001
      name: Application Log
    - component: Network Traffic Flow
      detects: Monitor for unusual volumes or sources of requests to the service
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1016
      mitigates: Vulnerability scanning of public APIs
      name: Vulnerability Scanning
    - fgmid: FGM1050
      mitigates: Use Web Application Firewall (WAF) to minimize potential exploit
        of vulnerabilities
      name: Exploit Protection
    - fgmid: FGM1037
      mitigates: Use of network based DDoS mitigation capabilities to filter traffic
        upstream
      name: Filter Network Traffic
    name: "## Addendum Name: Interworking Denial Of Service\r\n### Architecture Segments:\
      \ Control Plane, Roaming\r\n An adversary on a semi-public/roaming partner network\
      \ may exploit weaknesses in Application Programming (API) interfaces on Network\
      \ Functions (NF) that are exposed to the semi-public network, i.e. roaming partner\
      \ network, which can lead to denial of service of the exposed NF.\r\n\r\nSome\
      \ 5G functions such as the SEPP and UPF have API's that are exposed and accessible\
      \ to other providers over an interworking network that is not Internet accessible.\
      \ An adversary with a position on another organization, outside the targeted\
      \ operator's trust zone, could exploit a previously identified weakness in the\
      \ target API to cause the NF to crash resulting in denial of service. The adversary\
      \ may also potentially use volumetric techniques to degrade or deny service."
    platforms:
    - 5G core
    - interconnect
    preconditions:
    - description: Adversary may need to identify vulnerabilities in the API to obtain
        initial-access, unauthorized information, or perform a denial of service
      name: API vulnerability
    - description: Adversary may need to obtain credentials to collect unauthorized
        information
      name: API credentials
    procedureexamples:
    - description: Adversary uses a vulnerability to cause the NF to crash
      name: Vulnerability Exploit
    - description: Adversary uses one or more volumetric techniques to degrade or
        deny availability of the NF
      name: Volumetric attack
    references:
    - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
      Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
    - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",  October
      2021](https://arxiv.org/abs/2108.11206)
    - <a name="3"> \[3\] </a> [TOP 7 REST API Security Threats, blog January 2019](https://blog.restcase.com/top-7-rest-api-security-threats/)
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: Network Exposure Function which provides API access to external
        (to the operator) Application Functions (AF)
      name: NEF
    detections:
    - component: Application Log Content
      detects: Monitor application logs for unusual requests or rate of requests
      fgdsid: FGDS0015.001
      name: Application Log
    - component: Network Traffic Flow
      detects: Monitor for unusual volumes or sources of requests to the service
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1016
      mitigates: Vulnerability scanning of public APIs
      name: Vulnerability Scanning
    - fgmid: FGM1050
      mitigates: Use Web Application Firewall (WAF) to minimize potential exploit
        of vulnerabilities
      name: Exploit Protection
    - fgmid: FGM1037
      mitigates: Use of network based DDoS mitigation capabilities to filter traffic
        upstream
      name: Filter Network Traffic
    name: "## Addendum Name: Public Function Denial Of Service\r\n### Architecture\
      \ Segments: Control Plane, User Plane\r\n An adversary may exploit weaknesses\
      \ in Application Programming (API) interfaces on Network Functions (NF) that\
      \ are exposed to the public Internet, which exposes those functions to potential\
      \ adversary denial of service of the NF.\r\n\r\nSome 5G functions such as the\
      \ Network Exposure Function (NEF) have APIs that are public facing and are subject\
      \ to potential exploit by adversaries similarly to public facing websites and\
      \ services. The adversary could exploit a previously identified weakness in\
      \ the API to cause the NF to crash, resulting in denial of service. The adversary\
      \ may also potentially use volumetric techniques to degrade or deny service."
    platforms:
    - 5G core
    preconditions:
    - description: Adversary may need to identify vulnerabilities in the API to obtain
        initial-access, unauthorized information, or perform a denial of service
      name: API vulnerability
    - description: Adversary may need to obtain credentials to collect unauthorized
        information
      name: API credentials
    procedureexamples:
    - description: Adversary uses a vulnerability to cause the NF to crash
      name: Vulnerability Exploit
    - description: Adversary uses one or more volumetric techniques to degrade or
        deny availability of the NF
      name: Volumetric attack
    references:
    - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
      Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
    - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",  October
      2021](https://arxiv.org/abs/2108.11206)
    - <a name="3"> \[3\] </a> [TOP 7 REST API Security Threats, blog January 2019](https://blog.restcase.com/top-7-rest-api-security-threats/)
    software: []
  architecture-segment: Control Plane, User Plane, Roaming, O-RAN
  bluf: Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade
    or block the availability of services to users.
  campaigns: []
  criticalassets:
  - description: SMO internal operations may be degraded due to this behavior.
    name: SMO
  - description: OAM data sent over O1 interface may be interrupted and may impact
      O-CU-CP and O-CU-UP operations.
    name: O-CU-CP and O-CU-UP
  - description: OAM data sent over O1 interface may be interrupted and may impact
      O-DU operations.
    name: O-DU
  - description: OAM data sent over open fronthaul M-plane interface (in hybrid mode)
      may be interrupted and may impact O-RU operations.
    name: O-RU
  - description: Enrichment data sent over A1 interface or OAM data sent over O1 interface
      may be interrupted and may impact near-RT RIC operations.
    name: Near-RT RIC
  - description: Degraded performance of SMO may impact non-RT RIC operations.
    name: Non-RT RIC
  - description: OAM data sent over O2 interface may be interrupted and may impact
      O-CLOUD operations.
    name: O-CLOUD
  description: 'Adversaries may perform Endpoint Denial of Service (DoS) attacks to
    degrade or block the availability of services to users. Endpoint DoS can be performed
    by exhausting the system resources those services are hosted on or exploiting
    the system to cause a persistent crash condition. Example services include websites,
    email services, DNS, and web-based applications. Adversaries have been observed
    conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover
    February 2016) and to support other malicious activities, including distraction(Citation:
    FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec
    DDoS October 2014) An Endpoint DoS denies the availability of a service without
    saturating the network used to provide access to the service. Adversaries can
    target various layers of the application stack that is hosted on the system used
    to provide the service. These layers include the Operating Systems (OS), server
    applications such as web servers, DNS servers, databases, and the (typically web-based)
    applications that sit on top of them. Attacking each layer requires different
    techniques that take advantage of bottlenecks that are unique to the respective
    components. A DoS attack may be generated by a single system or multiple systems
    spread across the internet, which is commonly referred to as a distributed DoS
    (DDoS). To perform DoS attacks against endpoint resources, several aspects apply
    to multiple methods, including IP address spoofing and botnets. Adversaries may
    use the original IP address of an attacking system, or spoof the source IP address
    to make the attack traffic more difficult to trace back to the attacking system
    or to enable reflection. This can increase the difficulty defenders have in defending
    against the attack by reducing or eliminating the effectiveness of filtering by
    the source address on network defense devices. Botnets are commonly used to conduct
    DDoS attacks against networks and services. Large botnets can generate a significant
    amount of traffic from systems spread across the global internet. Adversaries
    may have the resources to build out and control their own botnet infrastructure
    or may rent time on an existing botnet to conduct an attack. In some of the worst
    cases for DDoS, so many systems are used to generate requests that each one only
    needs to send out a small amount of traffic to produce enough volume to exhaust
    the target''s resources. In such circumstances, distinguishing DDoS traffic from
    legitimate clients becomes exceedingly difficult. Botnets have been used in some
    of the most high-profile DDoS attacks, such as the 2012 series of incidents that
    targeted major US banks.(Citation: USNYAG IranianBotnet March 2016) In cases where
    traffic manipulation is used, there may be points in the global network (such
    as high traffic gateway routers) where packets can be altered and cause legitimate
    clients to execute code that directs network packets toward a target in high volume.
    This type of capability was previously used for the purposes of web censorship
    where client HTTP traffic was modified to include a reference to JavaScript that
    generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica
    Great Firewall of China) For attacks attempting to saturate the providing network,
    see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1499)'
  detections:
  - component: Network Traffic Content
    detects: Monitor data traffic on network elements of all SMO external interfaces
      and on the infrastructure supporting external interfaces to detect any unusual
      volume of traffic sent from external devices to SMO.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1499
  mitigations:
  - fgmid: FGM5509
    mitigates: Use firewalls with allow/deny list at the entry point of all external
      interfaces of the SMO. Measure the number of hits/misses on the firewall to
      determine onset of behavior.Use rate limiters at the entry point of all external
      interfaces of the SMO.Measure the number of hits/misses on the rate limiter
      to determine onset of behavior.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM5541
    mitigates: Particular implementation of SMO function should consider risk modeling
      of external interfaces as part of architecture design and implement mitigations.
    name: Risk Modeling
  name: Endpoint Denial of Service
  object-type: technique
  postconditions:
  - description: SMO suffers from very high processing load and/or resource exhaustion
      (CPU, memory, storage access).
    name: SMO operations impacted
  preconditions:
  - description: Adversary has knowledge of SMO external interface IP address and
      they can reach that IP from an external device.
    name: Reachability to the SMO via external interface
  procedureexamples:
  - description: Adversary achieves DDoS by sending large volumes of bogus messages
      to the SMO from various sources on the external interface. If the SMO external
      interface is not protected by strong firewall and rate limiters, the behavior
      may cause resource exhaustion in the SMO. The performance of SMO may be degraded,
      and it may cause outage of SMO services.Refer T-SMO-29 in clause 7.4.8 of [3].
    name: DoS on SMO from external interface
  references:
  - '<a name="1"> \[1\] </a> [NTIA: "Open RAN Security Report", May 2023.](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)'
  - '<a name="2"> \[2\] </a> [O-RAN WG1 R003-v12.00: "O-RAN Architecture Description".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [O-RAN WG11 O-R004-v05.00: "O-RAN Security Threat Modeling
    and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="4"> \[4\] </a> [O-RAN WG1 R003-v02.00: "Decoupled SMO Architecture".](https://orandownloadsweb.azurewebsites.net/specifications)'
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: attack_technique_addendum
- addendums:
  - access-required: Radio Access
    campaigns: []
    criticalassets:
    - description: Adversary targets access requests in Random Access CHannel (RACH)
      name: gNB
    detections:
    - component: gNB log content for flooding of messages from UE
      detects: Excessive number of access requests received at gNB.
      fgdsid: FGDS5017.003
      name: gNB or 5G core logs
    groups: []
    mitigations:
    - fgmid: FGM5021
      mitigates: Increase RACH resources on gNB.
      name: Increase RACH (Random Access Channel) Resources
    name: "## Addendum Name: Base Station Flood With Fictitious Access Requests\r\n\
      ### Architecture Segments: RAN, UE\r\n An adversary may transmit an overwhelming\
      \ number of access requests to a gNB to degrade the ability of legitimate UE\
      \ to obtain access.\r\n\r\nAn adversary transmits large number of access requests\
      \ over Random Access CHannel (RACH) to degrade the ability of legitimate UE\
      \ to obtain access from the gNB. May be done via a compromised UE or a fake\
      \ UE."
    platforms:
    - RAN
    preconditions:
    - description: Adversary must be able to transmit to gNB with sufficient power
        to be received.
      name: Transmit to gNB with sufficient power to succeed in flooding.
    procedureexamples:
    - description: Adversary transmits an overwhelming number of access requests over
        Random Access CHannel (RACH) to degrade the ability of legitimate UEs to obtain
        access. May be done via a compromised UE or a SDR running OAI-5G modified
        software.
      name: Access request flooding
    references:
    - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
      Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
    software: []
  - access-required: ''
    campaigns: []
    criticalassets:
    - description: UDM and SIDF resources are used for de-concealment of SUCI sent
        by legitimate UEs.
      name: UDM and SIDF resources
    detections:
    - component: Core network log content for flooding of messages from UE
      detects: Monitor logs in AMF/SEAF for excessive number of registration requests
        containing the same SUCI.
      fgdsid: FGDS5017.004
      name: gNB or 5G core logs
    groups: []
    mitigations:
    - fgmid: FGM5509
      mitigates: Rate limiting of incoming messages at NFs. The Security Anchor Function
        (SEAF) or the Authentication Server Function (AUSF), which are NFs upstream
        from SIDF, can apply rate limiting if they receive the same SUCI multiple
        times within a short period. Alternately, SCP may be used for rate limiting
        the repeated registration requests.
      name: Screen Signaling And User Plane Messages
    name: "## Addendum Name: UDM DOS Via SUCI Replay\r\n### Architecture Segments:\
      \ Control Plane\r\n An adversary may use a device (user or base station) to\
      \ replay registration requests with a valid Subscription Concealed Identifier\
      \ (SUCI) in order to degrade network availability to other device users.\r\n\
      \r\nAn adversary may intercept a legitimate SUCI sent by a legitimate device\
      \ to a base station. The adversary can then replay this SUCI in a registration\
      \ request towards the network many times, possibly from a false base station\
      \ or UE being used to send to the core network. This will cause the core network\
      \ function in charge of deconcealment of the SUCI, namely the UDM-SIDF (Unified\
      \ Data Management - Subscription Identifier De-Concealing Function), to work\
      \ on this computationally intensive asymmetric cryptographic operation. A Denial\
      \ of Service on the UDM can cause the available processing power of the UDM\
      \ to decrease and thus impact its ability to respond to the requests from legitimate\
      \ UEs."
    platforms:
    - Core
    - RAN
    - UE
    preconditions:
    - description: Access to false Base Station or fake UE to replay registration
        request messages with valid SUCI.
      name: Acquire base station or UE
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [3rd Generation Partnership Project (3GPP) TR 33.846:
      "Study on Authentication Enhancements in the 5G System", Technical Report, v17.0.0,
      Dec. 2021.](https://www.3gpp.org/DynaReport/33846.htm)'
    software: []
  architecture-segment: Control Plane, RAN, UE
  bluf: Adversaries may target the different network services provided by systems
    to conduct a denial of service (DoS).
  campaigns: []
  criticalassets:
  - description: Adversary targets access requests in Random Access CHannel (RACH)
    name: gNB
  description: 'Adversaries may target the different network services provided by
    systems to conduct a denial of service (DoS). Adversaries often target the availability
    of DNS and web services, however others have been targeted as well.(Citation:
    Arbor AnnualDoSreport Jan 2018) Web server software can be attacked through a
    variety of means, some of which apply generally while others are specific to the
    software being used to provide the service. One example of this type of attack
    is known as a simple HTTP flood, where an adversary sends a large number of HTTP
    requests to a web server to overwhelm it and/or an application that runs on top
    of it. This flood relies on raw volume to accomplish the objective, exhausting
    any of the various resources required by the victim software to provide the service.(Citation:
    Cloudflare HTTPflood) Another variation, known as a SSL renegotiation attack,
    takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes
    mechanisms for the client and server to agree on an encryption algorithm to use
    for subsequent secure connections. If SSL renegotiation is enabled, a request
    can be made for renegotiation of the crypto algorithm. In a renegotiation attack,
    the adversary establishes a SSL/TLS connection and then proceeds to make a series
    of renegotiation requests. Because the cryptographic renegotiation has a meaningful
    cost in computation cycles, this can cause an impact to the availability of the
    service when done in volume.(Citation: Arbor SSLDoS April 2012)[To read more,
    please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1499/002)'
  detections:
  - component: gNB log content for flooding of messages from UE
    detects: Excessive number of access requests received at gNB.
    fgdsid: FGDS5017.003
    name: gNB or 5G core logs
  groups: []
  id: FGT1499.002
  mitigations:
  - fgmid: FGM5021
    mitigates: Increase RACH resources on gNB.
    name: Increase RACH (Random Access Channel) Resources
  name: Service Exhaustion Flood
  object-type: technique
  postconditions:
  - description: Legitimate UEs have low probability of successfully obtaining network
      access.
    name: Degraded service for legitimate UEs
  preconditions:
  - description: Adversary must be able to transmit to gNB with sufficient power to
      be received.
    name: Transmit to gNB with sufficient power to succeed in flooding.
  procedureexamples:
  - description: Adversary transmits an overwhelming number of access requests over
      Random Access CHannel (RACH) to degrade the ability of legitimate UEs to obtain
      access. May be done via a compromised UE or a SDR running OAI-5G modified software.
    name: Access request flooding
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  software: []
  status: Observed
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: attack_subtechnique_addendum
- access-required: Application On UE
  architecture-segment: UE
  bluf: A malicious app consumes subscriber data allocation to deny or degrade service
    to that UE.
  campaigns: []
  criticalassets:
  - description: Communications is denied until additional data usage is purchased.
    name: Assured user communications
  description: "A malicious app consumes subscriber data allocation to deny or degrade\
    \ service to that UE.\r\n\r\nA malicious application might consume a UE's limited\
    \ data plan, denying or throttling service."
  detections:
  - component: Network Traffic Content
    detects: Excessive data usage reported by UE or service provider.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1499.501
  mitigations:
  - fgmid: FGM5007
    mitigates: 'Unlimited data plan. Attack is mitigated with an unlimited data plan
      legally defined by the MNO. (Note: MNOs may throttle data when user exceeds
      unlimited data plan threshold.)'
    name: Unlimited Data Plan
  - fgmid: FGM5008
    mitigates: Monitor installed applications on UE for data usage and perform throttling
      if necessary.
    name: Monitor Installed Applications For Data Usage
  name: Consume Data Allocation To Deny Or Degrade Service
  object-type: technique
  platforms: 5G UE
  postconditions:
  - description: Sustained degraded communication of legitimate UEs until additional
      data is purchased.
    name: Degraded communication of legitimate UEs.
  preconditions:
  - description: Introduction of malware via phishing email, etc.
    name: A malicious app or set of apps have to have been installed on the UE
  procedureexamples:
  - description: Convince user to download or maliciously introduce application that
      consumes excessive data.
    name: Malicious data consumption application
  references:
  - <a name="1"> \[1\] </a> [Android devices ensnared in DDoS botnet, Feb. 2021](https://www.zdnet.com/article/android-devices-ensnared-in-ddos-botnet/)
  - <a name="2"> \[2\] </a> [Massive Android DDoS Botnet Derailed, Aug. 2017](https://www.darkreading.com/attacks-breaches/massive-android-ddos-botnet-derailed)
  software: []
  status: Theoretical
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: RAN
  bluf: An adversary may trigger a fraud alert by sending fake registrations on behalf
    of a given UE.
  campaigns: []
  criticalassets:
  - description: Communications is denied.
    name: Assured user communications
  description: "An adversary may trigger a fraud alert by sending fake registrations\
    \ on behalf of a given UE.\r\n\r\nAn adversary might deny RAN access to a UE by\
    \ triggering a fraud alert through attempting simultaneous registrations at geographically\
    \ impossible locations. When the UE security profile allows, the adversary can\
    \ illegitimately use a known Subscription Permanent Identifier (SUPI) or, if a\
    \ valid Subscription Concealed Identifier (SUCI) is known, use a legitimate SUCI\
    \ for false registrations. "
  detections:
  - component: MNO logs for service issues in core
    detects: Check subscriber complaint logs about degraded or denied service.
    fgdsid: FGDS5011.001
    name: MNO logs in core for subscriber service complaints
  groups: []
  id: FGT1499.502
  mitigations:
  - fgmid: FGM5093
    mitigates: 'UDM/SIDF checks SUCI for freshness, whether it has been seen before,
      and for crypto parameters (example: if SUCI freshness parameter from the same
      UE (with same SUPI) is identical during SUCI deconcealment within a short period
      of time).'
    name: SUCI Parameter Checks
  - fgmid: FGM5014
    mitigates: MNO UDM can check the plausibility of the location of the UE for this
      new registration given most recent registration
    name: UE Location Plausibility
  name: Trigger Fraud Alert To Deny Service
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: Denial of service continues until service provider is convinced there
      is no fraud.
    name: Sustained denial of service
  preconditions:
  - description: There are several methods to achieve this by capturing over the air
      messages using a wireless sniffer.
    name: A valid SUPI or SUCI must be intercepted by attacker.
  procedureexamples:
  - description: 'Adversary may capture a registration attempt for a given UE, then
      replay it right away to a gNB much further away - so that the network receives
      two registrations at about the same time e.g. from two regions far away: New
      York and Georgia.  The network will trigger a fraud alert. Thus, RAN access
      may be denied to that victim UE because of the attempted simultaneous registrations
      at geographically impossible locations.'
    name: Adversary replays registration attempt for a victim UE to a gNB much further
      away ("geographically impossible").
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="2"> \[2\] </a> [ENISA "Threat Landscape for 5G Networks Report", Nov
    2019.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-for-5g-networks)
  - '<a name="3"> \[3\] </a> ["Bhadra framework": S.P. Rao, S. Holtmanns, T. Aura,
    "Threat modeling framework for mobile communication systems"](https://arxiv.org/abs/2005.05110v1)'
  - <a name="4"> \[4\] </a> [Systematic Analysis Method for 5G Non-Access Stratum
    Signaling Security.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957&tag=1)
  software: []
  status: Theoretical
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: RAN, Control Plane, User Plane
  bluf: An adversary controlling a gNB or control plane or user plane core Network
    Function (NF) may manipulate signaling to result in DoS for one or more UEs.
  campaigns: []
  criticalassets:
  - description: 5G network communications is denied to legitimate UEs.
    name: 5G data services
  description: "An adversary controlling a gNB or control plane or user plane core\
    \ Network Function (NF) may manipulate signaling to result in DoS for one or more\
    \ UEs.\r\n\r\nAdversary may use a false base station to deny service to a User\
    \ Equipment (UE) by issuing registration reject messages or other such messages\
    \ to deny radio access, or posing as a legitimate base station, but not relaying\
    \ traffic to or from the intended recipient. Adversary may compromise a core NF\
    \ and thus manipulate signaling for the UE registration or session management\
    \ procedures, in order to deny service to that UE."
  detections:
  - component: MNO logs for service issues in core
    detects: Subscriber notifies service provider of no or degraded service.
    fgdsid: FGDS5011.001
    name: MNO logs in core for subscriber service complaints
  - component: Application Log Content
    detects: Monitor core network logs for APIs that de-register or delete an NF in
      the NRF or an entry of a UE in UDM and APIs that de-activate UE's PDU sessions.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT1499.503
  mitigations:
  - fgmid: FGM1030
    mitigates: Implement industry standard core and edge network function security
      protection using network segmentation.
    name: Network Segmentation
  - fgmid: FGM5023
    mitigates: Periodically re-authenticate NFs in the network to assess whether they
      have been compromised. Remote attestation may also be employed.
    name: Periodic Authentication & Authorization Of NFs
  name: DOS A UE Via gNB Or NF Signaling
  object-type: technique
  platforms: RAN, core
  postconditions: []
  preconditions:
  - description: Adversary needs access to a false or compromised gNB or a compromised
      core NF.
    name: Compromise gNB or NF
  procedureexamples:
  - description: UE initiated de-registration:Adversary with a false UE can send a
      fake de-registration request NAS message to the victim UE's AMF with the victim's
      5G-GUTI. The victim UE's connection to 5G network is dropped by the network.
      Clause 4.2.2.3.2 of [7] & [2].Network initiated de-registration:Adversary with
      a false gNB can send a fake deregistration request NAS message to the victim
      UE. Victim UE drops the connection that was previously established to 5G network.
      Clause 4.2.2.3.3 of [7] & [2].
    name: DOS via UE or gNB control
  - description: Adversary with false UE can try to register as the victim UE, and
      when the victim UE tries to RRC connect again, it will be rejected. [2]
    name: DOS via impersonating UE
  - description: Adversary controlling Access and Mobility Management Function (AMF)
      can cause authentication to fail or deny SMS service by deactivating SMS for
      a given SUPI [1]. Control of AMF (with or without its Security Anchor Function
      (SEAF) functionality) can give an adversary the ability to manipulate the AKA
      procedure (e.g. change parameters exchanged) between the AMF and any other UE,
      so that (at the simplest) the UE authentication fails and it cannot get services.
      Alternatively, rogue or misconfigured AMF modifies the registration accept message
      for legitimate subscribers to deny access to some or all services that are configured
      in their profile. For the UEs it already serves, whose registration was successful
      in the past, a rogue AMF can simply de-register one or more of those UEs.
    name: DOS via AMF control
  - description: Adversary controlling Session Management Function (SMF) can release
      an existing PDU session or not create a new one; or send a N4 Session Release
      request to User Plane Function (UPF) currently serving the UE.Alternately, a
      compromised SMF sends a DELETE message to the UDM to de-register a UE. [5]/{ueId}/registrations/smf-registrations/{pduSessionId}
    name: DOS via SMF control
  - description: Adversary controlling UPF can send a report of PDU session inactivity
      to SMF, which results in de-activating the UE session. Or the UPF can alter
      secondary authentication between DN AAA and SMF, so it fails.
    name: DOS via UPF control
  - description: Adversary controlling Authentication Server Function (AUSF) can produce
      incorrect AKA parameters or change data out of UDM to fail the UE authentication.
    name: DOS via AUSF control
  - description: Adversary controlling Unified Data Management (UDM) can fail the
      SUPI de-concealing operation, so that the UE key will be different and Non-Access
      Stratum (NAS) Security Mode Command (SMC) will fail (e.g., responding to SUCI
      de-concealment with an incorrect SUPI). See clause E.2.2.1 of [3].
    name: DOS via UDM control
  - description: Adversary controlling Authentication Credential Repository and Processing
      Function (ARPF) can either (a) Alter the root key (K) or provide wrong root
      key for the UE; or (b) Generate wrong authentication vector (AV) during UE authentication
      procedure using EAP-AKA' or 5G AKA.Both will result in authentication failure
      for the UE. Clause 6.1.3 of [4].
    name: DOS via ARPF control
  - description: Adversary controlling the Unified Data Repository (UDR) may give
      UDM incorrect security parameters or remove UE authentication status. This will
      cause UE authentication to fail.
    name: DOS via UDR control
  - description: Adversary controlling Policy and Charging Function (PCF) may return
      a very restrictive policy for a UE. The UE will not be able to avail some or
      all services which are allowed in its profile.
    name: DOS via PCF control
  - description: Adversary controlling the Network Slicing Selection Function (NSSF)
      and/or the Network Slicing Selection Authentication and Authorization Function
      (NSSAAF) may deny UE access to a slice by mishandling NSSAI (saying it's unavailable)
      or altering authentication parameters so that authentication procedure fails.
    name: DOS via NSSF and NSSAAF control
  - description: Adversary controlling Charging Function (CHF) may send a message
      to SMF to start PDU session release of a particular UE.
    name: DOS via CHF control
  - description: Adversary controlling SMS Function (SMSF) may achieve DoS only for
      SMS for a given UE; i.e. the device does not receive or send text messages.Compromised
      SMSF sends a DELETE message to the UDM via N21 interface to de-register a UE.
      [5]/{ueId}/registrations/smsf-3gpp-access.
    name: DOS via SMSF control
  - description: Adversary controlling 5G Equipment Identity Register (5G EIR) can
      mark UE as stolen. The UE will be denied service when it attempts to connect
      to 5G network.
    name: DOS via 5G EIR control
  - description: Adversary controlling home network Security Edge Protection Proxy
      (SEPP) or visited SEPP can alter or discard registration request/response message
      and/or other signaling messages to deny access for a UE.
    name: DOS via Home or visited network SEPP
  - description: Adversary discovers the UPF instance by querying NRF using fraudulent
      APIs. Then they delete the UPF and SMF entry in the NRF. They also delete the
      PDU session information of the target UE in SMF and UPF. All PDU sessions of
      the target UE will be dropped. [6]
    name: DoS a UE via NRF and SMF/UPF
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [Hu, X. et al: "A Systematic Analysis Method for 5G Non-Access
    Stratum Signalling Security", August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)'
  - '<a name="3"> \[3\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes", Technical Report,
    v17.3.0, December. 2021.](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="4"> \[4\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System", Technical Specification, v17.6.0, June 2022.](https://www.3gpp.org/DynaReport/33501.htm)'
  - '<a name="5"> \[5\] </a> [Mobileum: "OAuth2.0 Security and Protocol Exploit Analysis
    in 5G Ecosystem".](https://www.researchgate.net/publication/371401470_OAuth20_Security_and_Protocol_Exploit_Analysis_in_5G_Ecosystem)'
  - '<a name="6"> \[6\] </a> [GSMA: "Intruding 5G SA core networks from outside and
    inside".](https://penthertz.com/resources/Intruding%205G%20SA%20core%20networks%20from%20outside%20and%20inside.pdf)'
  - '<a name="7"> \[7\] </a> [3GPP TS 23.502: "Procedures for the 5G System (5GS);
    Stage 2", Technical Specification, v17.3.0, December 2021.](https://www.3gpp.org/DynaReport/23502.htm)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: User Plane
  bluf: An adversary may send crafted GTP-U packets to a UE via established user plane
    to crash or slow down UE.
  campaigns: []
  criticalassets:
  - description: The base station (gNB) is critical nodes connected by the GTP-U.
    name: gNB (all)
  - description: The UPF is a critical nodes connected by the GTP-U.
    name: UPF
  - description: The UE is affected
    name: User data (calls/data/SMS)
  description: "An adversary may send crafted GTP-U packets to a UE via established\
    \ user plane to crash or slow down UE.\r\n\r\nAdversary gains knowledge of the\
    \ victim UE's Tunnel Endpoint Identifier (TEID) and UE's private IP address before\
    \ launching this attack. Then they may abuse GTP-U interfaces to send malicious\
    \ packets to UE from external networks. This may cause DoS attack (by slowing\
    \ down or crashing the UE) or it can be used for other attacks (e.g. stack overflow).\r\
    \n\r\nBackground: GTP-U nodes (UPF and gNB) use TEID to route packets between\
    \ themselves from/to a particular UE. If the adversary knows TEID and IP address\
    \ of UE, they can send a crafted GTP-U message with the target UE's TEID to the\
    \ UPF by encapsulating with the outer IP source address with its own IP or a random\
    \ IP and the inner destination IP with UE's IP address."
  detections:
  - component: Application Log Content
    detects: When authentication is not required to access an exposed remote service,
      monitor for follow-on activities such as anomalous external use of the exposed
      API or application.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Connection Creation
    detects: Monitor for newly constructed network connections that are sent or received
      by untrusted hosts.
    fgdsid: FGDS0029.001
    name: Network Traffic
  groups: []
  id: FGT1499.504
  mitigations:
  - fgmid: FGM5023
    mitigates: Periodically re-authenticate NFs in the network to assess whether they
      have been compromised. Remote attestation may also be employed.
    name: Periodic Authentication & Authorization Of NFs
  - fgmid: FGM1030
    mitigates: Implement industry standard core and edge network function security
      protection.
    name: Network Segmentation
  name: DOS A UE Via Established GTP-U Tunnel
  object-type: technique
  platforms: 5G Core, 5G RAN
  postconditions:
  - description: The adversary successfully disrupted the victim UE's functionality
      by exploiting its TEID and private IP address, leading to potential denial-of-service
      or other attacks.
    name: Compromised GTPU
  preconditions:
  - description: The lack of IPsec between the base station and the UPF.
    name: Gain access to TIED and UE IP address
  procedureexamples:
  - description: Adversary gains knowledge of the victim UE's Tunnel Endpoint Identifier
      (TEID) and UE's private IP address before launching this attack. Then they may
      abuse GTP-U interfaces to send malicious packets to UE from external networks.
      This may cause DoS attack (by slowing down or crashing the UE) or it can be
      used for other attacks (e.g. stack overflow).
    name: Adversary injects crafted GTP-U message with targeted UE's TEID
  references:
  - <a name="1"> \[1\] </a> [Salim, S.I., "Attacks on 5G Infrastructure from Users'
    Devices", September 20, 2023](https://www.trendmicro.com/en_us/research/23/i/attacks-on-5g-infrastructure-from-users-devices.html)
  software: []
  status: Theoretical
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: User Plane
  bluf: Adversary may send crafted GTP-U packets to UPF in order to cause a response
    from a server that will crash or slow down a UE.
  campaigns: []
  criticalassets:
  - description: The base station (gNB) and the UPF are the two critical nodes connected
      by the GTP-U.
    name: GTP-U Nodes
  description: "Adversary may send crafted GTP-U packets to UPF in order to cause\
    \ a response from a server that will crash or slow down a UE.\r\n\r\nAdversary\
    \ sends crafted GTP-U packet to UPF. UPF decapsulates the packet and forwards\
    \ the crafted packet embedded in the received packet to a server controlled by\
    \ the adversary on the internet. The server responds to the packet which has destination\
    \ address of the UE. UPF forwards the packet to the UE. This can either crash\
    \ or slow down UE.\r\n\r\nBackground: GTP-U nodes (UPF and gNB) use TEID to route\
    \ packets between themselves from/to a particular UE. If the adversary knows TEID\
    \ and IP address of UE, they can send a crafted GTP-U message with the target\
    \ UE's TEID to the UPF by encapsulating with the outer IP source address with\
    \ its own IP or a random IP and the inner destination IP with UE's IP address."
  detections:
  - component: Network Traffic Content
    detects: Monitor for newly constructed network connections that are sent or received
      by untrusted hosts (TBC)
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Host Status
    detects: Information from host telemetry providing insights about system status,
      errors, or other notable functional activity
    fgdsid: FGDS0013.001
    name: Sensor Health
  groups: []
  id: FGT1499.505
  mitigations:
  - fgmid: FGM5509
    mitigates: Filter control plane and user plane messages to rate limit or block
      the ones with malicious contents.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM5512
    mitigates: Use high availability feature for all core network functions.
    name: Use High Availability
  name: DOS A UE By GTP-U Exploit To The UPF
  object-type: technique
  platforms: 5G
  postconditions:
  - description: The adversary uses the UPF to send malicious packets, causing the
      victim UE to crash or slow down.
    name: UE Disruption
  preconditions:
  - description: The lack of IPsec between the base station and the UPF.
    name: Gain access to TIED and UE IP address
  procedureexamples:
  - description: Adversary may send crafted GTP-U packet to UPF. UPF decapsulates
      the packet and forwards the crafted packet embedded in the received packet to
      a server controlled by the adversary on the internet. The server responds to
      the packet which has destination address of the UE. UPF forwards the packet
      to the UE. This can either crash or slow down UE.
    name: Adversary injects crafted GTP-U message with targeted UPF's TEID
  references:
  - <a name="1"> \[1\] </a> [S.I. Salim, "Attacks on 5G Infrastructure from Users'
    Devices" September 20,2023.](https://www.trendmicro.com/en_us/research/23/i/attacks-on-5g-infrastructure-from-users-devices.html)
  software: []
  status: Observed
  subtechnique-of: FGT1499
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: User, Admin
    campaigns: []
    criticalassets:
    - description: MNO's service management and orchestration tools used for O-RAN
        operations.
      name: Operator MANO or OA&M
    - description: MNO's NFV management and orchestration tools used for O-RAN operations.
      name: Operator NFV MANO
    - description: O-RAN Specific service management and orchestration system for
        O-RAN deployment, including any Cloud or MEC tools.
      name: SMO
    detections:
    - component: Image Creation
      detects: 'Initial construction of a virtual machine image (ex: Azure Compute
        Service Images PUT)'
      fgdsid: FGDS0007.001
      name: Image
    - component: Image Deletion
      detects: 'Removal of a virtual machine image (ex: Azure Compute Service Images
        DELETE)'
      fgdsid: FGDS0007.002
      name: Image
    - component: Image Metadata
      detects: Contextual data about a virtual machine image such as name, resource
        group, state, or type
      fgdsid: FGDS0007.003
      name: Image
    - component: Image Modification
      detects: 'Changes made to a virtual machine image, including setting and/or
        control data (ex: Azure Compute Service Images PATCH)'
      fgdsid: FGDS0007.004
      name: Image
    - component: Image hash
      detects: Verify the image hash of core NF or O-RAN applications (xApp/rApp)
        against known reference values for these hashes. Ensure the applications have
        the correct software patches installed.
      fgdsid: FGDS0007.005
      name: Image
    - component: Execution
      detects: A file or stream containing a list of commands, allowing them to be
        launched in sequence
      fgdsid: FGDS0012.001
      name: Script
    - component: Application Log Content
      detects: 'Logging, messaging, and other artifacts provided by third-party services
        (ex: metrics, errors, and/or alerts)'
      fgdsid: FGDS0015.001
      name: Application Log
    groups: []
    mitigations:
    - fgmid: FGM1045
      mitigates: Enforce binary and application integrity with digital signature verification
        to prevent untrusted code from executing. Require signed software from trusted
        vendors and validate signatures during deployment.
      name: Code Signing
    - fgmid: FGM1047
      mitigates: Regularly audit the build and deployment environments for unauthorized
        changes or access.
      name: Audit
    - fgmid: FGM1026
      mitigates: Limit permissions associated with creating and modifying platform
        images or containers based on the principle of least privilege.
      name: Privileged Account Management
    name: "## Addendum Name: Inject Malware In ORAN Component\r\n### Architecture\
      \ Segments: O-RAN, OA&M\r\n Threat actors may insert malicious components, configurations,\
      \ or firmware into Open Radio Access Network (O-RAN) network functions during\
      \ the deployment phase to gain access to radio network for further exploits.\r\
      \n\r\nThis risk is elevated in O-RAN environments due to their inherent multi-vendor\
      \ and cloud-native architecture, which introduces a complex and extended supply\
      \ chain. Malicious payloads may be injected into vendor images, infrastructure-as-code\
      \ (IaC) templates, configuration manifests, or container images used in CI/CD\
      \ pipelines. If a Mobile Network Operator's (MNO) deployment repositories or\
      \ orchestrators (e.g., Kubernetes clusters, Helm charts, Ansible playbooks)\
      \ are compromised, adversaries can embed altered artifacts that are deployed\
      \ directly into live RAN or cloud infrastructure. This can lead to long-term\
      \ persistence, disruption, or stealthy data exfiltration."
    platforms:
    - 5G RAN
    - 'O-RAN Transport: Backhaul'
    - Midhaul
    - Open fronthaul
    - O-RAN nodes (O-CU
    - O-DU
    - O-RU)
    preconditions:
    - description: Adversary needs access to target organization's CI/CD tools such
        as deployment server, deployment repo, or an orchestrator like Kubernetes
        with additional built-in capabilities.
      name: Access to CI/CD tools
    procedureexamples:
    - description: An attacker compromises a CI/CD pipeline of an MNO responsible
        for deploying near-real-time RAN Intelligent Controller (RIC) components.
        They insert modified Docker images with embedded backdoors into the internal
        container registry. These images are later deployed into edge cloud clusters
        during automated provisioning, enabling the adversary to maintain covert access.
      name: CI/CD Compromise
    references:
    - <a name="1"> \[1\] </a> [Solarwind Orion](https://www.zdnet.com/article/sec-filings-solarwinds-says-18000-customers-are-impacted-by-recent-hack/)
    software: []
  - access-required: User Or Administrative Access To Repository
    campaigns: []
    criticalassets:
    - description: An adversary may target the 5G core network domain.
      name: Core network functions
    - description: An adversary may target the 5G RAN network domain.
      name: gNB (all)
    - description: An adversary may target CI/CD pipeline components.
      name: CI/CD Tools
    - description: An adversary may target security and operations tools.
      name: Operator MANO or OA&M
    detections:
    - component: Image Modification
      detects: An automated image hash verification should be performed.
      fgdsid: FGDS0007.004
      name: Image
    - component: Image Creation
      detects: Monitor interactions with images and containers. Periodically baseline
        images to identify malicious modifications or additions. In containerized
        environments, changes may be detectable by monitoring the daemon logs or audit
        logs depending on registry configuration.
      fgdsid: FGDS0007.001
      name: Image
    groups: []
    mitigations:
    - fgmid: FGM1043
      mitigates: Restricted Permissions to add images to repositories for person and
        non-person accounts.
      name: Credential Access Protection
    - fgmid: FGM1049
      mitigates: Manual or automated image creation and storage must include image
        hash.
      name: Anti-virus & Anti-malware
    - fgmid: FGM0947
      mitigates: In addition to image name, deployment tools must use hash and verify
        image during deployment.
      name: Audit
    - fgmid: FGM5088
      mitigates: Development and production repositories should be separated to avoid
        access and image slipovers. Production repositories should be access controlled
        for accounts responsible for deployments and operations accounts only.
      name: Separate Repositories For Development And Production
    - fgmid: FGM1035
      mitigates: Access to repositories should be restricted to known networks from
        where any authorized actions need be executed.
      name: Limit Access To Resource Over Network
    - fgmid: FGM1045
      mitigates: Sign all software images.
      name: Code Signing
    name: "## Addendum Name: Compromised Image\r\n### Architecture Segments: Virtualization,\
      \ Cloud Service Provider, OA&M, Supply Chain\r\n An adversary may install a\
      \ compromised image in a 5G environment to achieve persistence. This could be\
      \ achieved by either poisoning an image repository, compromising the MANO, or\
      \ other means.\r\n\r\nThe 5G Virtual Network Function (VNF) software is either\
      \ developed in house or supplied by a product vendor. Typically, software is\
      \ stored in a deployment repository for deployment or for an orchestrator to\
      \ use as part of an automated workload deployment activity. An adversary may\
      \ install a compromised image in the repository of 5G VNFs and or VM (Virtual\
      \ Machine)/Container images to later establish Command and Control (C2) connection\
      \ and subsequent modification, discovery, and exfiltration operations.\r\n\r\
      \nManagement and Orchestration (MANO) is a framework for managing and orchestrating\
      \ network functions virtualization (NFV) infrastructure, resources, and services.\
      \ It provides a standard approach for the management and orchestration of network\
      \ services in NFV environments, including the automation of tasks such as network\
      \ service deployment, scaling, and network function lifecycle management. A\
      \ poisoned image can be installed using compromised MANO tool set during image\
      \ acquisition, repository manipulation or deployment and configuration scripts."
    platforms:
    - Amazon Web Services (AWS)
    - Microsoft Azure
    - VMware vSphere
    - Container
    - O-Cloud
    - SDN
    - Virtual infrastructure orchestrator
    preconditions:
    - description: An image can be manipulated, or a new image can be introduced to
        have same impact.  Privileged Access to tool or repo is required.
      name: Credential and access to repository and or image creation tools (i.e.
        Docker)
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [ENISA: "THREAT LANDSCAPE FOR 5G NETWORKS", December
      2020, section 6.2. Accessed April 13, 2021.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks/)'
    - <a name="2"> \[2\] </a> [Docker Documentation, Security, Content in Trust.](https://docs.docker.com/engine/security/trust/)
    software: []
  architecture-segment: Virtualization, Cloud Service Provider, OA&M, Supply Chain,
    O-RAN
  bluf: Adversaries may implant cloud or container images with malicious code to establish
    persistence after gaining access to an environment.
  campaigns: []
  criticalassets:
  - description: MNO's service management and orchestration tools used for O-RAN operations.
    name: Operator MANO or OA&M
  - description: MNO's NFV management and orchestration tools used for O-RAN operations.
    name: Operator NFV MANO
  - description: O-RAN Specific service management and orchestration system for O-RAN
      deployment, including any Cloud or MEC tools.
    name: SMO
  description: 'Adversaries may implant cloud or container images with malicious code
    to establish persistence after gaining access to an environment. Amazon Web Services
    (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure
    Images as well as popular container runtimes such as Docker can be implanted or
    backdoored. Unlike [Upload Malware](https://attack.mitre.org/techniques/T1608/001),
    this technique focuses on adversaries implanting an image in a registry within
    a victim''s environment. Depending on how the infrastructure is provisioned, this
    could provide persistent access if the infrastructure provisioning tool is instructed
    to always use the latest image.(Citation: Rhino Labs Cloud Image Backdoor Technique
    Sept 2019) A tool has been developed to facilitate planting backdoors in cloud
    container images.(Citation: Rhino Labs Cloud Backdoor September 2019) If an adversary
    has access to a compromised AWS instance, and permissions to list the available
    container images, they may implant a backdoor such as a [Web Shell](https://attack.mitre.org/techniques/T1505/003).(Citation:
    Rhino Labs Cloud Image Backdoor Technique Sept 2019)[To read more, please see
    the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1525)'
  detections:
  - component: Image Creation
    detects: 'Initial construction of a virtual machine image (ex: Azure Compute Service
      Images PUT)'
    fgdsid: FGDS0007.001
    name: Image
  - component: Image Deletion
    detects: 'Removal of a virtual machine image (ex: Azure Compute Service Images
      DELETE)'
    fgdsid: FGDS0007.002
    name: Image
  - component: Image Metadata
    detects: Contextual data about a virtual machine image such as name, resource
      group, state, or type
    fgdsid: FGDS0007.003
    name: Image
  - component: Image Modification
    detects: 'Changes made to a virtual machine image, including setting and/or control
      data (ex: Azure Compute Service Images PATCH)'
    fgdsid: FGDS0007.004
    name: Image
  - component: Image hash
    detects: Verify the image hash of core NF or O-RAN applications (xApp/rApp) against
      known reference values for these hashes. Ensure the applications have the correct
      software patches installed.
    fgdsid: FGDS0007.005
    name: Image
  - component: Execution
    detects: A file or stream containing a list of commands, allowing them to be launched
      in sequence
    fgdsid: FGDS0012.001
    name: Script
  - component: Application Log Content
    detects: 'Logging, messaging, and other artifacts provided by third-party services
      (ex: metrics, errors, and/or alerts)'
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT1525
  mitigations:
  - fgmid: FGM1045
    mitigates: Enforce binary and application integrity with digital signature verification
      to prevent untrusted code from executing. Require signed software from trusted
      vendors and validate signatures during deployment.
    name: Code Signing
  - fgmid: FGM1047
    mitigates: Regularly audit the build and deployment environments for unauthorized
      changes or access.
    name: Audit
  - fgmid: FGM1026
    mitigates: Limit permissions associated with creating and modifying platform images
      or containers based on the principle of least privilege.
    name: Privileged Account Management
  name: Implant Internal Image
  object-type: technique
  postconditions: []
  preconditions:
  - description: Adversary needs access to target organization's CI/CD tools such
      as deployment server, deployment repo, or an orchestrator like Kubernetes with
      additional built-in capabilities.
    name: Access to CI/CD tools
  procedureexamples:
  - description: An attacker compromises a CI/CD pipeline of an MNO responsible for
      deploying near-real-time RAN Intelligent Controller (RIC) components. They insert
      modified Docker images with embedded backdoors into the internal container registry.
      These images are later deployed into edge cloud clusters during automated provisioning,
      enabling the adversary to maintain covert access.
    name: CI/CD Compromise
  references:
  - <a name="1"> \[1\] </a> [Solarwind Orion](https://www.zdnet.com/article/sec-filings-solarwinds-says-18000-customers-are-impacted-by-recent-hack/)
  software: []
  status: Theoretical
  tactics:
  - TA0003
  - TA0005
  typecode: attack_technique_addendum
- bluf: Adversaries may abuse Pre-OS Boot mechanisms as a way to establish persistence
    on a system.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may abuse Pre-OS Boot mechanisms as a way to establish
    persistence on a system. During the booting process of a computer, firmware and
    various startup services are loaded before the operating system. These programs
    control flow of execution before the operating system takes control.(Citation:
    Wikipedia Booting) Adversaries may overwrite data in boot drivers or firmware
    such as BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface
    (UEFI) to persist on systems at a layer below the operating system. This can be
    particularly difficult to detect as malware at this level will not be detected
    by host software-based defenses.[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1542)'
  detections: []
  groups: []
  id: FGT1542
  mitigations: []
  name: Pre-OS Boot
  object-type: technique
  platforms: Linux, Windows, Network, macOS
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0003
  - TA0005
  typecode: attack_technique_with_fight_subs
- access-required: Administrative Access
  architecture-segment: Virtualization, OA&M
  bluf: An adversary may implant malware in the Network Function Virtualization Infrastructure
    (NFVI) that will load during the pre-boot sequence to achieve persistence.
  campaigns: []
  criticalassets:
  - description: Any network functions within NFVI sphere of responsibility
    name: Physical, Virtual, and Cloud Native Functions
  - description: Any hosts in NFVI within 5G security zone or in CI/CD pipeline, security
      and OSS tools
    name: Hosts
  description: "An adversary may implant malware in the Network Function Virtualization\
    \ Infrastructure (NFVI) that will load during the pre-boot sequence to achieve\
    \ persistence.\r\n\r\nAn adversary may implant unauthorized software in the NFVI\
    \ to persist in the boot sequence or launch malicious software. 5G VNF deployments\
    \ rely on underlying NFVI (Kubernetes, Openstack) resources and do not offer any\
    \ checks of their own to validate resources. Possibilities exist to add malware\
    \ in deployment pipelines, image building and storage process and thru add on\
    \ tools. Unless Hardware Mediated Execution Environment (HMEE) is used to validate\
    \ host resources, malware inserted during boot process may not be easily detected. "
  detections:
  - component: Kernel Module Load
    detects: Kernel executing unknown processes or unauthorized processes not typical
      of the host.
    fgdsid: FGDS0008.001
    name: Kernel
  - component: Network Connection Creation
    detects: Network connections from hosts
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Content
    detects: Packet headers and payload may reveal anomalous and unauthorized communication
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Network traffic pattern may reveal remote C2 communication from rootkit
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: OS API Execution
    detects: Active processes or process log may reveal unauthorized activity due
      to rootkits
    fgdsid: FGDS0009.001
    name: Process
  - component: Firmware Modification
    detects: Monitor for changes made to firmware for unexpected modifications to
      settings and/or data that may be used by rootkits to hide the presence of programs,
      files, network connections, services, drivers, and other system components.
      There are dedicated rootkit detection tools that look for specific types of
      rootkit behavior.
    fgdsid: FGDS0001.001
    name: Firmware
  - component: Command Execution
    detects: Command execution logs may reveal unauthorized sources.
    fgdsid: FGDS0017.001
    name: Command
  groups: []
  id: FGT1542.501
  mitigations:
  - fgmid: FGM1046
    mitigates: Boot integrity, TPM and remote attestation
    name: Boot Integrity
  - fgmid: FGM1045
    mitigates: Code Signing of all 5G NF and infrastructure node software
    name: Code Signing
  - fgmid: FGM1051
    mitigates: Update Software for 5G NF and infrastructure node software
    name: Update Software
  - fgmid: FGM1018
    mitigates: User Account Management, active monitoring of access attempts to CI/CD
      tools
    name: User Account Management
  - fgmid: FGM1047
    mitigates: System audits can reveal anomalous behavior that may be caused by rootkits.  Audits
      of software repositories
    name: Audit
  name: Unauthorized Software In NFVI
  object-type: technique
  platforms: Infrastructure, PNF, OS platforms
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC025, Secure E2E VNF & NS management spec
    (WIP) v006, retrieved April 26, 2021](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC025_Secure_E2E_VNF_%26_NS_management)
  software: []
  status: Theoretical
  subtechnique-of: FGT1542
  tactics:
  - TA0003
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may search for common password storage locations to obtain user
    credentials.
  campaigns: []
  criticalassets: []
  description: Adversaries may search for common password storage locations to obtain
    user credentials. Passwords are stored in several places on a system, depending
    on the operating system or application holding the credentials. There are also
    specific applications and services that store passwords to make them easier for
    users to manage and maintain, such as password managers and cloud secrets vaults.
    Once credentials are obtained, they can be used to perform lateral movement and
    access restricted information.[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1555)
  detections: []
  groups: []
  id: FGT1555
  mitigations: []
  name: Credentials from Password Stores
  object-type: technique
  platforms: Linux, macOS, Windows, IaaS
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0006
  typecode: attack_technique_with_fight_subs
- access-required: Service Account
  architecture-segment: Application Layer
  bluf: Adversaries may gain unauthorized access to a Hardware Security Module (HSM)
    to sign keys and/or other derived key material that can be used to achieve additional
    goals.
  campaigns: []
  criticalassets:
  - description: A physical computing device that safeguards and manages digital key
      material, performs operations such as encryption and decryption, signature generation.
    name: HSM
  description: "Adversaries may gain unauthorized access to a Hardware Security Module\
    \ (HSM) to sign keys and/or other derived key material that can be used to achieve\
    \ additional goals.\r\n\r\nAn HSM is a hardware component that handles keying\
    \ material (storage, computation). They can take the form of a plug-in card or\
    \ an external device that attaches directly to a server. An HSM contains secure\
    \ crypto-processor chips. MNOs use HSM\r\n\r\nappliances as a Root of Trust to\
    \ secure their PKI infrastructure, which is used to sign certificates for gNBs\
    \ and NFs. \r\n\r\nAlthough an HSM protects key material from compromise and from\
    \ export if configured properly, an adversary may obtain privileges allowing them\
    \ to utilize a legitimate HSM functions, e.g., through PKCS #11 function calls,\
    \ Cryptoki library, etc., such that an adversary may obtain signatures and derivative\
    \ key material seen as legitimate by other MNO NFs. "
  detections:
  - component: Logon Session Metadata
    detects: Analyze access logs for appropriate use by admins
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Analyze the application logs for access from appropriate NFs and appropriate/typical
      use
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Monitor for activity from unexpected sources
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1555.501
  mitigations:
  - fgmid: FGM1017
    mitigates: Train users to be aware of access or manipulation attempts by an adversary
      to reduce the risk of unauthorized access to the HSM
    name: User Training
  - fgmid: FGM1018
    mitigates: Restrict users of HSM to minimal privileges from only permitted NFs
    name: User Account Management
  - fgmid: FGM1026
    mitigates: Ensure administrative accounts for HSM are carefully managed to minimize
      potential admin credential compromise. This may include use of privileged access
      workstations, privileged account management solutions, separation of duties
      approaches, etc.
    name: Privileged Account Management
  name: Hardware Security Module Key Signing
  object-type: technique
  platforms: HSM
  postconditions:
  - description: Adversary would have the ability to perform signing and cryptographic
      operations that would permit the adversary to masquerade as a legitimate authorized
      user and perform operations against NFs.
    name: Adversary is able to perform crypto operations fraudulenty.
  preconditions:
  - description: Adversary acquires credentials with legitimate privileges to conduct
      operations using the HSM. Adversary has a position to initiate transactions
      with the HSM.
    name: Obtain service account credentials
  procedureexamples:
  - description: An adversary would compromise a function or service that has privileges
      to perform operations using the HSM and use other techniques to obtain the credentials.
      The adversary may perform operations from the compromised environment or exfiltrate
      the credentials to another system to perform the operations and conduct further
      activities.
    name: Credential compromise
  references:
  - "<a name=\"1\"> \\[1\\] </a> [Baseline Security Controls\_-NO-009, FS.31 version\
    \ 2.0,GSMA, February 2020](https://www.gsma.com/security/wp-content/uploads/2020/02/FS.31-v2.0.pdf)"
  - <a name="2"> \[2\] </a> [A New Trust Model For The 5G Era, Thales, October 2020](https://cpl.thalesgroup.com/sites/default/files/content/research_reports_white_papers/field_document/2020-10/New-Trust-Model-For-5G-Era-WP.pdf)
  software: []
  status: Theoretical
  subtechnique-of: FGT1555
  tactics:
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may attempt to position themselves between two or more networked
    devices using an adversary-in-the-middle (AiTM) technique to support follow-on
    behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040),
    [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002),
    or replay attacks ([Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212)).
  campaigns: []
  criticalassets: []
  description: 'Adversaries may attempt to position themselves between two or more
    networked devices using an adversary-in-the-middle (AiTM) technique to support
    follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040),
    [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002),
    or replay attacks ([Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212)).
    By abusing features of common networking protocols that can determine the flow
    of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device
    to communicate through an adversary controlled system so they can collect information
    or perform additional actions.(Citation: Rapid7 MiTM Basics) For example, adversaries
    may manipulate victim DNS settings to enable other malicious activities such as
    preventing/redirecting users from accessing legitimate sites and/or pushing additional
    malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner)
    Adversaries may also manipulate DNS and leverage their position in order to intercept
    user credentials and session cookies.(Citation: volexity_0day_sophos_FW) [Downgrade
    Attack](https://attack.mitre.org/techniques/T1562/010)s can also be used to establish
    an AiTM position, such as by negotiating a less secure, deprecated, or weaker
    version of communication protocol (SSL/TLS) or encryption algorithm.(Citation:
    mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att)
    Adversaries may also leverage the AiTM position to attempt to monitor and/or modify
    traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).
    Adversaries can setup a position similar to AiTM to prevent traffic from flowing
    to the appropriate destination, potentially to [Impair Defenses](https://attack.mitre.org/techniques/T1562)
    and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1557)'
  detections: []
  groups: []
  id: FGT1557
  mitigations: []
  name: Adversary-in-the-Middle
  object-type: technique
  platforms: Windows, macOS, Linux, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0009
  - TA0006
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: Admin
    campaigns: []
    criticalassets:
    - description: Sensitive subscriber and network data sent by E2 nodes to E2Term
        may be visible to adversary.
      name: Sensitive subscriber and network data
    - description: All communications between O-CU-CP and near-RT RIC and between
        O-CU-UP and near-RT RIC may be impacted.
      name: O-CU-CP and O-CU-UP
    - description: All communications between O-DU and near-RT RIC may be impacted.
      name: O-DU
    detections:
    - component: Network Traffic Content
      detects: Monitor layer 2 traffic specifically ARP messages and ARP tables in
        the router/switch between E2 node and near-RT RIC.Also, monitor traffic on
        E2 interface for unusual patterns e.g. abnormal traffic re-direction.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: Monitor for network traffic originating from unknown/unexpected hardware
        devices on E2 interface.Local network traffic metadata (such as source MAC
        addressing) as well as usage of network management protocols such as DHCP
        may be helpful in identifying hardware.Use normal network traffic flows (L2,
        L3) as baseline and compare that with actual traffic flows for any deviations.
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1033
      mitigates: Use only trusted supply chain, rigorous scanning of software images.
        Limit Software Installations especially from 3rd party sources.
      name: Limit Software Installation
    - fgmid: FGM1047
      mitigates: Scan all software in the near-RT RIC for detecting and deleting unauthorized
        xApps.
      name: Audit
    - fgmid: FGM1025
      mitigates: Configure all xApps security settings to assign least privilege access
        to near-RT RIC resources. For example, it should be barred from using commands
        which sends ARP messages.
      name: Privileged Process Integrity
    - fgmid: FGM1035
      mitigates: Create static ARP entries for networked devices. Implementing static
        ARP entries may be infeasible for large networks.
      name: Limit Access To Resource Over Network
    - fgmid: FGM1037
      mitigates: Consider enabling DHCP Snooping and Dynamic ARP Inspection on switches
        to create mappings between IP addresses requested via DHCP and ARP tables
        and tie the values to a port on the switch that may block bogus traffic.
      name: Filter Network Traffic
    name: "## Addendum Name: O-RAN E2Term\r\n### Architecture Segments: O-RAN\r\n\
      \ Rogue xApp sends spoofed ARP message by impersonating E2Term's IP address\
      \ thereby causing traffic re-direction from all E2 nodes to rogue xApp.\r\n\r\
      \nRogue xApp with its own IP address may scan the IP address of E2Term using\
      \ commonly available tools such as nmap. Then it creates and sends a fake ARP\
      \ message to map E2Term's IP address to its own MAC address. Once ARP caches\
      \ are updated in the E2 nodes, the rogue xApp starts receiving all messages\
      \ sent from E2 nodes to E2Term. This is known as ARP spoofing or ARP poisoning.\
      \ The compromised xApp may also send a gratuitous ARP reply message to all E2\
      \ nodes announcing that it owns E2Term's IP address.\r\n\r\nNote: This scenario\
      \ is possible only if xApps are deployed as separate CNF/VNFs with their own\
      \ IP addresses."
    platforms:
    - O-RAN near real-time RIC
    preconditions:
    - description: Adversary has physical access to network devices supporting E2
        interface for sniffing messages.
      name: Physical access to E2 interface network devices
    procedureexamples:
    - description: Adversary compromises an xApp which has its own IP address. They
        scan the IP address of E2Term with a network scanning tool such as nmap. Then
        they create and send a fake ARP message which has E2Term's IP and its own
        MAC address. When this ARP message is sent on the E2 interface and after ARP
        caches are updated in the E2 nodes, the rogue xApp receives all messages which
        are sent from E2 nodes to E2Term.Alternately, adversary may send a gratuitous
        ARP reply message to all E2 nodes announcing that it owns E2Term's IP address.All
        normal E2 communications in O-RAN may get impacted by this activity as the
        rogue xApp will be able to read all E2 messages sent by E2 nodes and then
        drop those messages. It may cause abnormal behavior in RAN and may cause network
        outage. [1]
      name: ARP spoofing of E2Term
    references:
    - '<a name="1"> \[1\] </a> [TrendMicro whitepaper: "Open RAN: Attack of the xApps".](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/open-ran-attack-of-the-xapps)'
    software: []
  architecture-segment: O-RAN
  bluf: Adversaries may poison Address Resolution Protocol (ARP) caches to position
    themselves between the communication of two or more networked devices.
  campaigns: []
  criticalassets:
  - description: Sensitive subscriber and network data sent by E2 nodes to E2Term
      may be visible to adversary.
    name: Sensitive subscriber and network data
  - description: All communications between O-CU-CP and near-RT RIC and between O-CU-UP
      and near-RT RIC may be impacted.
    name: O-CU-CP and O-CU-UP
  - description: All communications between O-DU and near-RT RIC may be impacted.
    name: O-DU
  description: 'Adversaries may poison Address Resolution Protocol (ARP) caches to
    position themselves between the communication of two or more networked devices.
    This activity may be used to enable follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040)
    or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002).
    The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such
    as a media access control (MAC) address.(Citation: RFC826 ARP) Devices in a local
    network segment communicate with each other by using link layer addresses. If
    a networked device does not have the link layer address of a particular networked
    device, it may send out a broadcast ARP request to the local network to translate
    the IP address to a MAC address. The device with the associated IP address directly
    replies with its MAC address. The networked device that made the ARP request will
    then use as well as store that information in its ARP cache. An adversary may
    passively wait for an ARP request to poison the ARP cache of the requesting device.
    The adversary may reply with their MAC address, thus deceiving the victim by making
    them believe that they are communicating with the intended networked device. For
    the adversary to poison the ARP cache, their reply must be faster than the one
    made by the legitimate IP address owner. Adversaries may also send a gratuitous
    ARP reply that maliciously announces the ownership of a particular IP address
    to all the devices in the local network segment. The ARP protocol is stateless
    and does not require authentication. Therefore, devices may wrongly add or update
    the MAC address of the IP address in their ARP cache.(Citation: Sans ARP Spoofing
    Aug 2003)(Citation: Cylance Cleaver) Adversaries may use ARP cache poisoning as
    a means to intercept network traffic. This activity may be used to collect and/or
    relay data such as credentials, especially those sent over an insecure, unencrypted
    protocol.(Citation: Sans ARP Spoofing Aug 2003)[To read more, please see the MITRE
    ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1557/002)'
  detections:
  - component: Network Traffic Content
    detects: Monitor layer 2 traffic specifically ARP messages and ARP tables in the
      router/switch between E2 node and near-RT RIC.Also, monitor traffic on E2 interface
      for unusual patterns e.g. abnormal traffic re-direction.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Monitor for network traffic originating from unknown/unexpected hardware
      devices on E2 interface.Local network traffic metadata (such as source MAC addressing)
      as well as usage of network management protocols such as DHCP may be helpful
      in identifying hardware.Use normal network traffic flows (L2, L3) as baseline
      and compare that with actual traffic flows for any deviations.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1557.002
  mitigations:
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1047
    mitigates: Scan all software in the near-RT RIC for detecting and deleting unauthorized
      xApps.
    name: Audit
  - fgmid: FGM1025
    mitigates: Configure all xApps security settings to assign least privilege access
      to near-RT RIC resources. For example, it should be barred from using commands
      which sends ARP messages.
    name: Privileged Process Integrity
  - fgmid: FGM1035
    mitigates: Create static ARP entries for networked devices. Implementing static
      ARP entries may be infeasible for large networks.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1037
    mitigates: Consider enabling DHCP Snooping and Dynamic ARP Inspection on switches
      to create mappings between IP addresses requested via DHCP and ARP tables and
      tie the values to a port on the switch that may block bogus traffic.
    name: Filter Network Traffic
  name: ARP Cache Poisoning
  object-type: technique
  postconditions:
  - description: Adversary may be able to view all sensitive subscriber and network
      data sent over E2 interface.
    name: Sensitive subscriber and network data exposed to adversary
  - description: RAN operations may be impacted if O-CU-CP/O-CU-UP/O-DU to near-RT
      RIC communications are re-directed to adversary controlled xApp.
    name: RAN operations impacted
  preconditions:
  - description: Adversary has physical access to network devices supporting E2 interface
      for sniffing messages.
    name: Physical access to E2 interface network devices
  procedureexamples:
  - description: Adversary compromises an xApp which has its own IP address. They
      scan the IP address of E2Term with a network scanning tool such as nmap. Then
      they create and send a fake ARP message which has E2Term's IP and its own MAC
      address. When this ARP message is sent on the E2 interface and after ARP caches
      are updated in the E2 nodes, the rogue xApp receives all messages which are
      sent from E2 nodes to E2Term.Alternately, adversary may send a gratuitous ARP
      reply message to all E2 nodes announcing that it owns E2Term's IP address.All
      normal E2 communications in O-RAN may get impacted by this activity as the rogue
      xApp will be able to read all E2 messages sent by E2 nodes and then drop those
      messages. It may cause abnormal behavior in RAN and may cause network outage.
      [1]
    name: ARP spoofing of E2Term
  references:
  - '<a name="1"> \[1\] </a> [TrendMicro whitepaper: "Open RAN: Attack of the xApps".](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/open-ran-attack-of-the-xapps)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1557
  tactics:
  - TA0009
  - TA0006
  typecode: attack_subtechnique_addendum
- access-required: None
  architecture-segment: RAN
  bluf: An adversary may position itself on the radio interface, to support follow-on
    behaviors such as [Network Sniffing](/techniques/FGT1040) or [Transmitted Data
    Manipulation](/techniques/FGT1565.002).
  campaigns: []
  criticalassets:
  - description: All signaling transmitted to and from subscriber on radio interface
      can be modified or intercepted in the clear.
    name: Subscriber signaling
  - description: UE/subscriber coarse geographical location can be intercepted.
    name: UE location
  - description: All user plane data transmitted to and from subscriber can be modified
      or intercepted in the clear.
    name: Subscriber user plane traffic
  description: "An adversary may position itself on the radio interface, to support\
    \ follow-on behaviors such as [Network Sniffing](/techniques/FGT1040) or [Transmitted\
    \ Data Manipulation](/techniques/FGT1565.002).\r\n\r\nAdversary can deploy a false\
    \ gNB, eNB (a 4G base station) or WiFi access point, or a back-to-back false gNB-UE\
    \ combination to act as an adversary-in-the-middle, in order to intercept, inject\
    \ and possibly modify communication and relay communication to and from intended\
    \ recipient over the radio interface. \r\n\r\nThis attack assumes the following\
    \ to have taken place: the UE has been bid-down (see [Bid down UE](/techniques/FGT1562.501))\
    \ to a less secure Radio Access Network such as 4G, or the UE connects to an eNB\
    \ because the network is 5G Non-Standalone, or due to EPS fallback, or the UE\
    \ connects to a Wi-Fi access point (to access 5G services)."
  detections:
  - component: Signals sent by UEs
    detects: UE measurements of received power levels from all base stations nearby,
      and their identifiers. Clause 6.24 of [3].
    fgdsid: FGDS5002.001
    name: Radio interface
  groups: []
  id: FGT1557.501
  mitigations:
  - fgmid: FGM1056
    mitigates: It is not possible to mitigate against this adversarial technique.
    name: Pre-compromise
  name: Radio Interface
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Transient technique; works only as long as adversary-in-the-middle
      is able to retain connection.
    name: Temporary loss of subscriber data confidentiality or integrity
  preconditions:
  - description: Subscriber security profile must allow bidding down to less secure
      service OR system must employ null integrity or encryption.
    name: Permissive subscriber security profile OR system employs null integrity
      or encryption.
  - description: UE has been bid-down to a less secure radio network.
    name: UE has been bid down
  procedureexamples:
  - description: The adversary employs a back-to-back false gNB-UE combination. When
      UE security profile allows bidding down, or the UE connects to 4G due to EPS
      fallback, or to WiFi, an adversary acts as an adversary-in-the-middle to intercept
      and possibly modify communication to and from intended recipient.
    name: Adversary-in-the-Middle on air interface for a given UE
  - description: Alternatively, if the 5G system employs null integrity or encryption,
      subscriber data traffic can be eavesdropped or modified in transit over the
      air interface for any UE.
    name: Adversary-in-the-Middle on air interface for any UE
  - description: Adversary uses a false base station to broadcast spoofed configuration
      messages to UEs nearby. Reference [3] (appendix B) contains a taxonomy of attacks
      against 5G UEs, passive and active. One concerns message attacks (fake MIB/SIB
      - Master Information Block/System Information Block).
    name: Spoofed configuration messages from false base station
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, section 4.4, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [Hu, X. et al: "A Systematic Analysis Method for 5G Non-Access
    Stratum Signalling Security", August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)'
  - '<a name="3"> \[3\] </a> [3rd Generation Partnership Project (3GPP) TR 33.809:
    "Study on 5G security enhancements against False Base Stations (FBS)", Technical
    Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1557
  tactics:
  - TA0009
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- access-required: Admin
  architecture-segment: Roaming
  bluf: An adversary may act as an adversary-in-the-middle (AITM) between two mobile
    network operators to enable activities like network sniffing (FGT1040) or transmitted
    data manipulation (FGT1565.002).
  campaigns: []
  criticalassets:
  - description: Adversary targets all roaming functions including UE access from
      visited networks and services.
    name: Roaming functions
  description: "An adversary may act as an adversary-in-the-middle (AITM) between\
    \ two mobile network operators to enable activities like network sniffing (FGT1040)\
    \ or transmitted data manipulation (FGT1565.002).\r\n\r\nRoaming and interconnect\
    \ interfaces, including IPX, exist between network operators. These interfaces\
    \ include connections between Security Edge Protection Proxies (SEPPs), interworking\
    \ functions like Access and Mobility Management Function (AMF) / 4G Mobility Management\
    \ Function (MME) via the N26 interface, and User Plane Functions (UPFs) via the\
    \ N9 interface. An adversary controlling the Visited Public Land Mobile Network\
    \ (VPLMN) SEPP can obtain roaming subscriber information by providing fraudulent\
    \ signaling information to the Home PLMN (HPLMN). This allows the adversary to\
    \ collect data about the roaming subscriber. The adversary could be an insider\
    \ within a VPLMN that is a roaming partner, having connections to the HPLMN through\
    \ one or more IPX providers or directly between V-SEPP and H-SEPP. The HPLMN trusts\
    \ the information from the VPLMN, but the VPLMN sends it fraudulently. The V-SEPP\
    \ may also be located at a Value-Added-Services (VAS) provider, where the compromise\
    \ of the VAS is a prerequisite instead of compromising the VPLMN. The adversary\
    \ may achieve an AITM position on an IP Exchange (IPX) network used by either\
    \ the home PLMN or the visited PLMN, through which roaming traffic flows. The\
    \ adversary may control a device in the path or redirect traffic to a device they\
    \ control."
  detections:
  - component: Application Log Content
    detects: Monitor for access to SEPP application/appliance for unexpected access.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Analyze network traffic to/from SEPP to determine if from unexpected
      source/dest and consistent with expected traffic from other operators.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1557.502
  mitigations:
  - fgmid: FGM1037
    mitigates: Ensure only traffic from expected sources can reach the SEPP
    name: Filter Network Traffic
  - fgmid: FGM1035
    mitigates: Minimize access to vSEPP from limited locations such as a privileged
      access workstation
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Limit network exposure of vSEPP from other core services in hPLMN
    name: Network Segmentation
  name: Roaming And Interconnection
  object-type: technique
  platforms: Interconnect
  postconditions:
  - description: The adversary established an AITM position between mobile operators,
      enabling data interception or manipulation.
    name: Roaming Exploit
  preconditions:
  - description: Adversary would need to be in control of the vSEPP which may be managed
      by a VAS
    name: SEPP control
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [P.Tommassen, "5G Security When Roaming," iBasis, October
    6, 2020](https://ibasis.com/5g-security-when-roaming/)
  - <a name="2"> \[2\] </a> ["5G System; Public Land Mobile Network (PLMN) Interconnection;
    Stage 3," 3GPP, TS 29.573 ver.16.9.0, March 2022](https://www.3gpp.org/DynaReport/29573.htm)
  - <a name="3"> \[3\] </a> ["Security architecture and procedures for 5G System,"
    3GPP, TS 33.501 ver. 16.3.0, July 2020,](https://www.3gpp.org/DynaReport/33501.htm)
  software: []
  status: Theoretical
  subtechnique-of: FGT1557
  tactics:
  - TA0009
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: Control Plane, User Plane
  bluf: An adversary with access to Non-Service Based Interfaces (Non-SBI) network
    nodes (including routers/switches/load balancers) may position themselves in order
    to support follow-on behaviors such as [Network Sniffing](/techniques/FGT1040)
    or [Transmitted Data Manipulation](/techniques/FGT1565.002).
  campaigns: []
  criticalassets:
  - description: UE user plane data integrity and confidentiality.
    name: UE user plane data
  - description: UE signaling data integrity and confidentiality.
    name: UE signaling data
  description: "An adversary with access to Non-Service Based Interfaces (Non-SBI)\
    \ network nodes (including routers/switches/load balancers) may position themselves\
    \ in order to support follow-on behaviors such as [Network Sniffing](/techniques/FGT1040)\
    \ or [Transmitted Data Manipulation](/techniques/FGT1565.002).\r\n\r\n\"Non-SBI\"\
    \ network interfaces are within the Radio Access Network (RAN) (e.g. Xn, F1, E1)\
    \ and core (e.g. N4), and between the RAN and the 5G Core (e.g. N2, N3 interfaces).\
    \ \r\n\r\nIf the network does not provide confidentiality or integrity protection\
    \ for control plane and user plane packets on the non-SBI interfaces, then an\
    \ AITM attack is possible. \r\n\r\nNote that the Non-Access Stratum (NAS) packets\
    \ sent on the N2 interface from the UE to the core function AMF are already integrity/confidentiality\
    \ protected. However, unlike radio communications, operator RAN to core communications\
    \ are not always employing the confidentiality or integrity protection mandated\
    \ by 3GPP standards."
  detections:
  - component: Application Log Content
    detects: Check configuration changes in all switches/routers. Monitor for access
      to non-SBI NFs for unexpected access.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Content
    detects: Inspect network traffic content and watch for unauthorized changes as
      the packets move through the routers/middle boxes.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1557.503
  mitigations:
  - fgmid: FGM5024
    mitigates: Use integrity (IPSec) on all non-SBI interfaces.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1041
    mitigates: Use encryption (IPSec) on all non-SBI interfaces.
    name: Encrypt Sensitive Information
  name: Non-SBI
  object-type: technique
  platforms: 5G core, 5G RAN, O-RAN Transport
  postconditions:
  - description: Both UE signaling and user plane data communication with network
      will be impacted.
    name: Both CP and UP data are eavesdropped or modified
  preconditions:
  - description: Malware or wrong configuration in switches/routers between RAN and
      core, between gNBs, in gNB itself, in SMF or UPF.
    name: Compromised or misconfigured switches/routers or gNB
  procedureexamples:
  - description: Integrity or confidentiality protection can be disabled on N2 interface
      for Control Plane (CP), N3 interface for User Plane (UP) and Xn, F1 interfaces
      for CP and UP and E1 interface. Clauses 9.2, 9.3 and 9.4 of [2].
    name: Compromised or misconfigured switches or routers between RAN and core and
      within RAN
  - description: Network does not provide protection on N2, N3, Xn, F1 and E1 interfaces,
      see clause D.2.2 of [1].
    name: Adversary configures the non-SBI interfaces to not use IPSec.
  - description: Compromised or misconfigured Session Management Function (SMF) or
      User Plane Function (UPF) can cause data manipulation on N4 interface between
      them, which in turn can cause DoS attack by diverting user traffic away from
      the intended recipient. It can also cause charging errors. If weak encryption
      algorithm is used on the N4 interface, adversary can eavesdrop on sensitive
      subscriber data. Clause L.2.3 of [1].
    name: N4 Interface is compromised
  references:
  - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes".](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System".](https://www.3gpp.org/DynaReport/33501.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1557
  tactics:
  - TA0009
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: Control Plane
  bluf: An adversary in the 5G core who compromised a proxy or middlebox may position
    themselves between Network Functions (NFs) that are communicating via the Service
    Based Interfaces (SBI), in order to support follow-on behaviors such as [Network
    Sniffing](/techniques/FGT1040) or [Transmitted Data Manipulation](/techniques/FGT1565.002).
  campaigns: []
  criticalassets:
  - description: There are many procedures that can be impacted if an adversary gets
      in the middle of a TLS connection between two network functions on the SBI.
    name: 5G data services, including service discovery
  - description: Core functions handle UE signaling for the provisioning and configuration
      of services.
    name: UE provisioning and configuration data
  description: "An adversary in the 5G core who compromised a proxy or middlebox may\
    \ position themselves between Network Functions (NFs) that are communicating via\
    \ the Service Based Interfaces (SBI), in order to support follow-on behaviors\
    \ such as [Network Sniffing](/techniques/FGT1040) or [Transmitted Data Manipulation](/techniques/FGT1565.002).\r\
    \n\r\nSBI network interfaces are between core NFs within an operator network.\
    \ An adversary may compromise a proxy on the SBI, such as the Service Communication\
    \ Proxy (SCP), API proxy, or a load-balancer. Then an adversary may also exploit\
    \ improper TLS configuration (including weaker cipher, profile) of the SBI connections,\
    \ which may arise for example due to the use of TLS profiles forbidden in 3GPP\
    \ TS 33.310 [3] for NF mutual authentication and NF transport layer protection."
  detections:
  - component: Application Log Content
    detects: Check configuration changes in all switches/routers. Monitor for access
      to SBI NFs for unexpected access.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Content
    detects: Inspect network traffic content and watch for unauthorized changes as
      the packets move through the routers/middle boxes.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1557.504
  mitigations:
  - fgmid: FGM5095
    mitigates: TLS certificate thorough checking. Ensure that all certificates received
      over a connection are valid for the current server endpoint, and abort the handshake
      if they are not. In some usages, it may be simplest to refuse any change of
      certificates during renegotiation.
    name: TLS Certificate Check
  - fgmid: FGM5024
    mitigates: Use TLS 1.3 or TLS 1.2 integrity protection with only strong cipher
      suites.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1041
    mitigates: Use TLS 1.3 or TLS 1.2 encryption with only strong cipher suites.
    name: Encrypt Sensitive Information
  - fgmid: FGM1047
    mitigates: Audit NF configuration for SBIs, e.g. if TLS is disabled or what version
      of TLS is being used.
    name: Audit
  name: Service Based Interface
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: If a TLS client connects to a malicious server and presents a client
      credential, the server can then impersonate the client at any other server that
      accepts the same credential. Concretely, the malicious server performs an adversary-in-the-middle
      attack on three successive handshakes between the honest client and server,
      and succeeds in impersonating the client on the third handshake. See [5], clause
      4.2.2.2 of [2].
    name: Triple Handshake
  - description: A compromised SCP can eavesdrop or alter signaling data between any
      two core NFs.
    name: SCP as AITM
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TS 33.117:
    "Catalogue of general security assurance requirements (Release 17)", v17.0.0,
    June 2021.](https://www.3gpp.org/DynaReport/33117.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TS 33.310: "Network Domain Security (NDS); Authentication
    Framework (AF)".](https://www.3gpp.org/DynaReport/33310.htm)'
  - '<a name="4"> \[4\] </a> [G. Koien: "On Threats to the 5G Service Based Architecture",
    2021.](https://www.researchgate.net/journal/Wireless-Personal-Communications-1572-834X/publication/349455036_On_Threats_to_the_5G_Service_Based_Architecture/links/6030a03a4585158939b7bcae/On-Threats-to-the-5G-Service-Based-Architecture.pdf)'
  - '<a name="5"> \[5\] </a> [3SHAKE: "Triple Handshakes Considered Harmful: Breaking
    and Fixing Authentication over TLS".](https://mitls.org/pages/attacks/3SHAKE)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1557
  tactics:
  - TA0009
  - TA0006
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may maliciously modify components of a victim environment in order
    to hinder or disable defensive mechanisms.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may maliciously modify components of a victim environment
    in order to hinder or disable defensive mechanisms. This not only involves impairing
    preventative defenses, such as firewalls and anti-virus, but also detection capabilities
    that defenders can use to audit activity and identify malicious behavior. This
    may also span both native defenses as well as supplemental capabilities installed
    by users and administrators. Adversaries may also impair routine operations that
    contribute to defensive hygiene, such as blocking users from logging out of a
    computer or stopping it from being shut down. These restrictions can further enable
    malicious operations as well as the continued propagation of incidents.(Citation:
    Emotet shutdown) Adversaries could also target event aggregation and analysis
    mechanisms, or otherwise disrupt these procedures by altering other system components.[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1562)'
  detections: []
  groups: []
  id: FGT1562
  mitigations: []
  name: Impair Defenses
  object-type: technique
  platforms: Windows, Office 365, IaaS, Linux, macOS, Containers, Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: Admin
    campaigns: []
    criticalassets:
    - description: The external DNS server that MNOs employ to support roaming services.
      name: DNS server
    - description: Host based firewalls
      name: Firewalls
    detections:
    - component: Process Access
      detects: Employ EDR (Extended Detection and Response) for process execution
      fgdsid: FGDS0009.002
      name: Process
    - component: File Modification
      detects: Employ File integrity monitoring (FIM) for recording file changes of
        key configuration files
      fgdsid: FGDS0022.005
      name: File
    groups:
    - description: Liminal Panda modified the eDNS host-based firewall to allow communication
        from a compromised telecom network ([1].[2]).
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1018
      mitigates: Ensure proper user permissions are in place to prevent adversaries
        from disabling or modifying firewall settings on the eDNS servers.
      name: User Account Management
    - fgmid: FGM1022
      mitigates: Ensure proper process and file permissions are in place to prevent
        adversaries from disabling or modifying firewall settings
      name: Restrict File And Directory Permissions
    name: "## Addendum Name: External DNS\r\n### Architecture Segments: OA&M, Roaming\r\
      \n An adversary uses a wrapper to modify the external DNS (eDNS) firewall and\
      \ thus evade detection of firewall changes.\r\n\r\nAn adversary may modify the\
      \ host-based firewall rules (iptables) that allow incoming traffic from disallowed\
      \ IP addresses, in order to maintain a connection to IP hosts they control outside\
      \ of the MNO's network - hosts whose IP address ranges may be blocked by the\
      \ MNO's host based firewall on the external DNS server. In order to remain undetected,\
      \ adversary may use a binary wrapper function (to replace the original iptables\
      \ binary), that modifies the output from iptables queries to conceal the firewall\
      \ rules the adversary added. Thus, an administrator would not notice anything\
      \ amiss with the firewall rules by simply reviewing the iptables output."
    platforms:
    - Interconnect
    - Transport
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat
      to Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
    - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
      Look at China''s Cyber Threats to the Telecom Sector", updated November 19,
      2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
    software: []
  architecture-segment: OA&M, Roaming
  bluf: Adversaries may disable or modify system firewalls in order to bypass controls
    limiting network usage.
  campaigns: []
  criticalassets:
  - description: The external DNS server that MNOs employ to support roaming services.
    name: DNS server
  - description: Host based firewalls
    name: Firewalls
  description: 'Adversaries may disable or modify system firewalls in order to bypass
    controls limiting network usage. Changes could be disabling the entire mechanism
    as well as adding, deleting, or modifying particular rules. This can be done numerous
    ways depending on the operating system, including via command-line, editing Windows
    Registry keys, and Windows Control Panel. Modifying or disabling a system firewall
    may enable adversary C2 communications, lateral movement, and/or data exfiltration
    that would otherwise not be allowed. For example, adversaries may add a new firewall
    rule for a well-known protocol (such as RDP) using a non-traditional and potentially
    less securitized port (i.e. [Non-Standard Port](https://attack.mitre.org/techniques/T1571)).(Citation:
    change_rdp_port_conti)[To read more, please see the MITRE ATT&CK page for this
    subtechnique](https://attack.mitre.org/techniques/T1562/004)'
  detections:
  - component: Process Access
    detects: Employ EDR (Extended Detection and Response) for process execution
    fgdsid: FGDS0009.002
    name: Process
  - component: File Modification
    detects: Employ File integrity monitoring (FIM) for recording file changes of
      key configuration files
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: Liminal Panda modified the eDNS host-based firewall to allow communication
      from a compromised telecom network ([1].[2]).
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1562.004
  mitigations:
  - fgmid: FGM1018
    mitigates: Ensure proper user permissions are in place to prevent adversaries
      from disabling or modifying firewall settings on the eDNS servers.
    name: User Account Management
  - fgmid: FGM1022
    mitigates: Ensure proper process and file permissions are in place to prevent
      adversaries from disabling or modifying firewall settings
    name: Restrict File And Directory Permissions
  name: Disable or Modify System Firewall
  object-type: technique
  postconditions:
  - description: SSH connection (or similar) from victim MNO network to an already
      compromised telecom network is maintained
    name: Maintain connection to external adversary controlled host
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog, "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog, "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  software: []
  status: Observed
  subtechnique-of: FGT1562
  tactics:
  - TA0005
  typecode: attack_subtechnique_addendum
- architecture-segment: RAN
  bluf: An adversary may employ a false base station to bid down (downgrade) the victim
    UE to a less secure Radio Access Network in order to exploit the vulnerabilities
    in that network.
  campaigns: []
  criticalassets:
  - description: Sensitive subscriber data that the UE sends to/from the network (including
      identifiers).
    name: User data
  description: "An adversary may employ a false base station to bid down (downgrade)\
    \ the victim UE to a less secure Radio Access Network in order to exploit the\
    \ vulnerabilities in that network.\r\n\r\nAn adversary located between the victim\
    \ UE and real base stations may jam the 5G radio frequencies and use the false\
    \ base station to generate illegitimate over-the-air signaling to deny service\
    \ to 5G and induce the UE to operate over a less secure radio access network,\
    \ such as 3G or 4G. This requires a UE profile that permits attaching to networks\
    \ other than 5G.\r\n\r\nWhen the security profile in the UE allows connection\
    \ to a less secure service, adversary denies service to 5G, bids down victim UE\
    \ to less secure network (4G or 3G) with illegitimate signaling. Then the adversary\
    \ bids down the UE to 2G network and orders the UE to transmit with no or weak\
    \ encryption/integrity protection. However, note that 5G (Release 15 and later)\
    \ supports an anti-bid-down feature: during the Authentication and Key Agreement\
    \ (AKA) procedure, the network sends to the UE an \"ABBA\" parameter (Anti Bidding\
    \ Down between Architectures), which indicates the security features that the\
    \ network possesses. When this feature is enabled, the UE is not to attach to\
    \ earlier generation networks.\r\n\r\nAlso known as downgrading, the bidding down\
    \ enables the adversary to perform additional follow up techniques using over\
    \ the air interfaces, such as eavesdropping of user SMS and voice calls, user\
    \ data or signaling manipulation, and privacy breaches. These privacy breaches\
    \ may include exposure of the IMSI, location tracking of user, and impersonation\
    \ of a user. "
  detections:
  - component: UE logs for radio network transition events
    detects: UE logs of RAT transition event to less secure service e.g. from 5G to
      4G or 3G. UE responds to requests that were not sent by legitimate network.
    fgdsid: FGDS5010.001
    name: UE  logs
  - component: Signals sent by UEs
    detects: gNB logs of UE measurement reports of received power levels from all
      base stations nearby, and their identifiers. Clause 6.24 of [4].
    fgdsid: FGDS5002.001
    name: Radio interface
  groups: []
  id: FGT1562.501
  mitigations:
  - fgmid: FGM5002
    mitigates: UE should discard RRC redirection messages that are not integrity protected,
      and go search for other gNBs. UE should only accept to register to networks
      that require mutual authentication and strong encryption, also integrity protection
      of user plane. [2]
    name: Discard RAN Signaling Received Without Integrity Protection
  - fgmid: FGM5092
    mitigates: UE warns user of connecting to a less secure network (and the user
      can take action to limit data or type of data, or to disconnect).
    name: Warn User
  - fgmid: FGM5006
    mitigates: Set security UE profile to prohibit bidding down to less secure service.
    name: Restrictive User Profile
  name: Bid Down UE
  object-type: technique
  platforms: RAN
  postconditions:
  - description: UE is connected to legacy network and is now vulnerable to privacy
      threats.
    name: UE is connected to a less secure network
  preconditions:
  - description: Adversary has procured a UE and gNB under its control, and the victim
      UE is nearby.
    name: False base station with strong signal and UE system
  procedureexamples:
  - description: UEs tend to attach to gNBs which have better signal condition than
      the gNB the UE is currently attached. False gNB with stronger signal strength
      than legitimate gNBs lures UE to connect, then sends RRC redirection message
      that is not integrity protected, so that the UE can't check its legitimacy.
      This RRCRelease message has the instruction for the UE to attach to a 4G cell
      instead (i.e, RedirectInfo as E-UTRA Absolute Radio Frequency Channel Number
      (E-ARFCN) [2][3].
    name: False gNB redirects UE to 4G.
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
  - <a name="2"> \[2\] </a> [DEFCON 24 article "Forcing Targeted LTE Cellphone Into
    Unsafe Network".](https://www.scribd.com/document/350156530/forcing-targeted-lte-cellphone-into-unsafe-network)
  - '<a name="3"> \[3\] </a> [GSMA paper: "Never let me down again: Bidding-Down Attacks
    and Mitigations in 5G and 4G".](https://www.gsma.com/solutions-and-impact/technologies/security/wp-content/uploads/2023/10/0064-Never-let-me-down-again-Bidding-Down-Attacks.pdf)'
  - '<a name="4"> \[4\] </a> [3GPP TR 33.809: "Study on 5G security enhancements against
    False Base Stations (FBS)", Technical Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1562
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may attempt to hide artifacts associated with their behaviors
    to evade detection.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may attempt to hide artifacts associated with their behaviors
    to evade detection. Operating systems may have features to hide various artifacts,
    such as important system files and administrative task execution, to avoid disrupting
    user work environments and prevent users from changing files or features on the
    system. Adversaries may abuse these features to hide artifacts such as files,
    directories, user accounts, or other system activity to evade detection.(Citation:
    Sofacy Komplex Trojan)(Citation: Cybereason OSX Pirrit)(Citation: MalwareBytes
    ADS July 2015) Adversaries may also attempt to hide artifacts associated with
    malicious behavior by creating computing regions that are isolated from common
    security instrumentation, such as through the use of virtualization technology.(Citation:
    Sophos Ragnar May 2020)[To read more, please see the MITRE ATT&CK page for this
    technique](https://attack.mitre.org/techniques/T1564)'
  detections: []
  groups: []
  id: FGT1564
  mitigations: []
  name: Hide Artifacts
  object-type: technique
  platforms: Linux, macOS, Windows, Office 365
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_with_fight_subs
- access-required: None
  architecture-segment: User Plane, Control Plane
  bluf: An adversary may attempt to disguise communications using malware.
  campaigns: []
  criticalassets:
  - description: MNO roaming partner network operations.
    name: Network operations
  - description: MNO roaming partner network sensitive data may be leaked to the adversary.
    name: Sensitive network data
  description: "An adversary may attempt to disguise communications using malware.\r\
    \n\r\nAdversary may install SIGTRANslator Linux binary in a compromised host of\
    \ MNO roaming partner network. Then they use SIGTRANslator to establish a Command\
    \ and Control (C2) channel from the compromised host to a remote server controlled\
    \ by them. SIGTRANslator uses SIGTRAN protocol for underlying transport and SIGTRAN\
    \ uses IP network to transport SS7 protocol messages. All data transferred over\
    \ the C2 channel is encrypted to avoid detection. As a follow-on behavior, the\
    \ adversary opened a port on the compromised host and the port was used for exfiltration\
    \ of data from the host to the remote server."
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic contents especially traffic received over roaming
      interfaces.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Core network packet captures (pcaps)
    detects: Inspect payloads of all messages received using SIGTRAN protocol.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  groups:
  - description: Liminal Panda used SIGTRANslator to establish a C2 channel from the
      compromised host of a partner network to a remote server controlled by them.
      [1]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1564.501
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of enterprise
      defenses and controls.
    name: Pre-compromise
  name: Command Output Filtering
  object-type: technique
  platforms: 5G core
  postconditions: []
  preconditions:
  - description: Adversary must have compromised a network element in the roaming
      partner network. Then they installed the SIGTRANslator binary in the compromised
      system.
    name: MNO partner network host compromised
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Crowdstrike blog on Lightbasin threats](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
  software:
  - description: SIGTRANslator software tool was used by Liminal Panda to connect
      to remote server.
    fgsid: FGS5005
    name: SIGTRANslator
  status: Observed
  subtechnique-of: FGT1564
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may insert, delete, or manipulate data in order to influence external
    outcomes or hide activity, thus threatening the integrity of the data.
  campaigns: []
  criticalassets: []
  description: Adversaries may insert, delete, or manipulate data in order to influence
    external outcomes or hide activity, thus threatening the integrity of the data.
    By manipulating data, adversaries may attempt to affect a business process, organizational
    understanding, or decision making. The type of modification and the impact it
    will have depends on the target application and process as well as the goals and
    objectives of the adversary. For complex systems, an adversary would likely need
    special expertise and possibly access to specialized software related to the system
    that would typically be gained through a prolonged information gathering campaign
    in order to have the desired impact.[To read more, please see the MITRE ATT&CK
    page for this technique](https://attack.mitre.org/techniques/T1565)
  detections: []
  groups: []
  id: FGT1565
  mitigations: []
  name: Data Manipulation
  object-type: technique
  platforms: Linux, macOS, Windows
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Legitimate subscribers may be denied access or existing subscriber
        sessions may be terminated or directed to malicious server.
      name: 5G network access
    detections:
    - component: Core security configuration logs
      detects: Monitor whether integrity protection algorithm configurations in SMF
        are downgraded to weak or no security levels. Clause 5.3.3 of [4].
      fgdsid: FGDS5022.002
      name: Security configuration
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: Ensure UE user plane data is protected with strong integrity mechanism.
        This will have performance impact on devices which implement integrity protection.
      name: Integrity Protection Of Data Communication
    name: "## Addendum Name: Fronthaul User Plane Data\r\n### Architecture Segments:\
      \ O-RAN\r\n Adversary manipulates User Plane data on Open Fronthaul interface\
      \ between O-DU and O-RU to re-direct the data to a wrong destination or get\
      \ discarded by the recipient due to incorrect message parameters.\r\n\r\nThe\
      \ O-RAN open fronthaul interface needs to implement strict performance requirements\
      \ which include very high throughput and very low latency (clause 4.4 of [2]).\
      \ Confidentiality and integrity protection requirements are not specified by\
      \ O-RAN Alliance for control, user and synchronization (CUS) planes, and those\
      \ are mandatory for M plane. See clause 6.1 of [2] and clause 5.4 of [3]. Also,\
      \ 3GPP has defined algorithms for user plane data integrity protection. Many\
      \ MNOs do not use those algorithms to reduce processing delay. Hence, an AiTM\
      \ adversary behavior on open fronthaul interface is possible which results in\
      \ manipulation of user plane data. The adversary may manipulate user plane data\
      \ to cause DoS and/or session redirection behavior (e.g. DNS redirection) on\
      \ legitimate subscribers. \r\n\r\nBackground info: The O-RAN Alliance has defined\
      \ the open fronthaul interface which connects one O-DU to one or more O-RUs\
      \ inside the gNB. The open fronthaul interface makes it possible to distribute\
      \ the physical layer functionalities between RU and DU, and to control RU operations\
      \ from DU. O-RAN Alliance has selected a specific configuration (split 7.2x)\
      \ for splitting the physical layer among those proposed by 3GPP. The lower part\
      \ of the physical layer (low PHY) resides in RU and performs Orthogonal Frequency\
      \ Division Multiplexing (OFDM) phase compensation, inverse FFT and Cyclic Prefix\
      \ (CP) insertion for frequency-to-time conversion in downlink, and FFT and CP\
      \ removal in uplink. The physical layer in DU (high PHY) performs scrambling,\
      \ modulation, layer mapping, and resource element mapping. Open fronthaul consists\
      \ of four types of interfaces: Control or C plane is used to carry control plane\
      \ messages for the RAN such as beamforming and scheduling commands. User or\
      \ U plane is used to carry user plane data which includes IQ data (contains\
      \ UE's CP & UP data) in FFT frequency domain for both DL & UL directions. Synchronization\
      \ or S plane is used to carry timing and synchronization information and Management\
      \ or M plane is used to carry management data."
    platforms:
    - RAN
    - Open Fronthaul
    preconditions:
    - description: Adversary must have physical access to open fronthaul network devices
        to collect data and then manipulate and replay the data.
      name: Adversary has access to open fronthaul network
    procedureexamples:
    - description: Adversary as AitM  manipulates the open fronthaul U plane data
        traffic by using a simple sniffer and replay device. If weak or no integrity
        protection is used on user plane data, DoS can be done by manipulating IP
        header so that those messages will get discarded by the recipient. An Adversary
        may achieve session redirection by changing the destination IP of a DNS request
        message which will re-direct the DNS request to an adversary-controlled DNS
        server. See clause 5.4.1.2 T-UPLANE-01 of [1].
      name: Manipulate U plane data on open fronthaul interface.
    references:
    - '<a name="1"> \[1\] </a> [O-RAN WG11 Threat Modeling.O-R003-v02.00: "O-RAN Security
      Threat Modeling and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="2"> \[2\] </a> [O-RAN WG4 CUS.0-R003-v14.00: "Control, User and Synchronization
      Plane Specification".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="3"> \[3\] </a> [O-RAN WG4 MP.0-R003-v11.00: "Management Plane Specification".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="4"> \[4\] </a> [3GPP TS33.501: "Security architecture and procedures
      for 5G System."](https://www.3gpp.org/DynaReport/33501.htm)'
    software: []
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Compromised OAM data sent over O1 interface may impact O-CU-CP
        and O-CU-UP operations.
      name: O-CU-CP and O-CU-UP
    - description: Compromised OAM data sent over O1 interface may impact O-DU operations.
      name: O-DU
    - description: Compromised OAM data sent over open fronthaul M-plane interface
        (in hybrid mode) may impact O-RU operations.
      name: O-RU
    - description: Compromised enrichment data sent over A1 interface or compromised
        OAM data sent over O1 interface may impact near-RT RIC operations.
      name: Near-RT RIC
    - description: Compromised configurations in SMO may impact non-RT RIC operations.
      name: Non-RT RIC
    - description: Compromised OAM data sent over O2 interface may impact O-CLOUD
        operations.
      name: O-CLOUD
    - description: SMO configurations and policies may be compromised.
      name: SMO
    detections:
    - component: Network Traffic Content
      detects: Monitor data traffic between SMO and all external services to identify
        data being sent without integrity protection or with weak integrity protection.
        Look for abnormal changes in the transmitted data (payload).Use normal network
        traffic flows (L2, L3) as baseline and compare that with actual traffic flows
        for any deviations.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: Monitor for network traffic originating from unknown/unexpected hardware
        devices. Local network traffic metadata (such as source MAC addressing) as
        well as usage of network management protocols such as DHCP may be helpful
        in identifying hardware.
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1041
      mitigates: Use strong encryption methods on all SMO external interfaces.
      name: Encrypt Sensitive Information
    - fgmid: FGM5024
      mitigates: Use strong integrity protection methods on all SMO external interfaces.
      name: Integrity Protection Of Data Communication
    - fgmid: FGM1037
      mitigates: Filter received network traffic that uses legacy protocols which
        are prone to AiTM behaviors.
      name: Filter Network Traffic
    - fgmid: FGM1031
      mitigates: Network intrusion detection and prevention systems that can identify
        traffic patterns indicative of AiTM activity can be used to mitigate activity
        at the network level.
      name: Network Intrusion Prevention
    name: "## Addendum Name: Modify Data On SMO External Interfaces\r\n### Architecture\
      \ Segments: O-RAN\r\n Adversary modifies data in transit between Service Management\
      \ and Orchestration (SMO) and external service to disrupt O-RAN network operations.\r\
      \n\r\nO-RAN SMO exposes several services to external clients. Some examples\
      \ of service exposure are data management and service management services, AI/ML\
      \ related services including enrichment information processing. External clients\
      \ interface SMO using service-based interfaces (SBI) which use REST API over\
      \ HTTPS. SBI's are normally protected by TLS. \r\n\r\nIf the external interface\
      \ is not protected or protected with a weak integrity algorithm, an Adversary\
      \ in the Middle (AiTM) may modify data in transit between SMO and external clients.\
      \ This data modification may result in unexpected service behavior or service\
      \ denial. For example, if enrichment information is maliciously modified, it\
      \ can degrade network performance.\r\n\r\n "
    platforms:
    - O-RAN management SMO
    preconditions:
    - description: An inadvertent configuration change is made in the SMO associated
        with the external interfaces of SMO. The configuration change allows an AiTM
        to alter data passing through any SMO external interface.
      name: Inadvertent configuration change in SMO
    - description: Adversary has access to devices on one or more of the network hops
        of SMO external interfaces and they can perform AiTM role.
      name: Access to the network path of the SMO external interfaces
    procedureexamples:
    - description: AiTM may modify the data in transit between SMO and an external
        server. This can happen if no integrity protection is used or weak integrity
        protection method is used on the external interfaces. If any data in transit
        between SMO and external server is modified, it can change behavior of O-RAN.
        For example, if enrichment data is modified on the external interface by adversary,
        it can degrade O-RAN network performance which may also cause DoS.Refer T-SMO-27
        in clause 7.4.8 of [3].
      name: Data manipulation on SMO external interface
    references:
    - '<a name="1"> \[1\] </a> [NTIA: "Open RAN Security Report", May 2023.](https://www.ntia.gov/sites/default/files/publications/open_ran_security_report_full_report_0.pdf)'
    - '<a name="2"> \[2\] </a> [O-RAN.WG1.OAD-R003-v12.00: "O-RAN Architecture Description".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="3"> \[3\] </a> [O-RAN WG11 Threat Modeling.O-R004-v05.00: "O-RAN Security
      Threat Modeling and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
    - '<a name="4"> \[4\] </a> [O-RAN.WG1.R003-v02.00: "Decoupled SMO Architecture".](https://orandownloadsweb.azurewebsites.net/specifications)'
    software: []
  - access-required: User
    campaigns: []
    criticalassets:
    - description: Whoever controls the DNS servers controls how and what end users
        connect to over the network, making DNS servers a type of critical infrastructure.
      name: DNS Servers
    detections:
    - component: Network Traffic Content
      detects: 'Data transmitted across a network (ex: Web, DNS, Mail, File, etc.),
        that is either summarized (ex: Netflow) and/or captured as raw data in an
        analyzable format (ex: PCAP).'
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: Use strong user plane data integrity protection algorithms on the
        air interface.
      name: Integrity Protection Of Data Communication
    - fgmid: FGM1020
      mitigates: Break and inspect SSL/TLS sessions to look at encrypted web traffic
        for adversary activity.
      name: SSL/TLS Inspection
    name: "## Addendum Name: Redirection Of DNS Requests\r\n### Architecture Segments:\
      \ User Plane\r\n An adversary may manipulate encrypted traffic to achieve redirection\
      \ of DNS requests sent by the victim UE to the network over the radio interface.\r\
      \n\r\nUsing a fake gNB and fake UE device, the adversary may modify DNS requests\
      \ the UE sends over the air, even though those are encrypted, if the adversary\
      \ knows the correct DNS address and there is no integrity protection on user\
      \ plane data. User plane integrity protections prevent this behavior on typical\
      \ 5G air interfaces, however these protections are mandatory to implement and\
      \ optional to use. Alternatively, an adversary may have bid-down the UE as a\
      \ precondition to achieve the effect.\r\n\r\n "
    platforms:
    - UE
    - RAN
    preconditions:
    - description: Adversary must have deployed a false gNB and a fake UE which modifies
        the payload and then replays the message towards the legitimate gNB.
      name: Adversary in the Middle
    - description: 'No integrity protection on the air interface. See technique Weaken
        Integrity: Radio Interface [FGT5009.001]( https://fight.mitre.org/techniques/FGT5009.001).'
      name: Weakened or disabled integrity protection
    procedureexamples:
    - description: In this active procedure named aLTEr, adversary exploits the fact
        that LTE user data is encrypted in counter mode (AES-CTR) but not integrity
        protected, which allows an adversary to modify the message payload. This is
        applicable in 5G when the user data integrity algorithm is set to NULL. [1]
      name: Adversary employs the aLTEr procedure
    references:
    - '<a name="1"> \[1\] </a> [D. Rupprecht, K. Kohls, T. Holtz, and C. Popper: "Breaking
      LTE on Layer Two".](https://www.gsma.com/security/wp-content/uploads/2023/10/0008-breaking_lte_on_layer_two.pdf)'
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: Any of the subscriber user plane data sourced or destined to the
        UE.
      name: UE user plane data
    - description: Any of the signaling traffic sourced or destined to the UE.
      name: UE signaling
    detections:
    - component: Network Traffic Content
      detects: Inspect network traffic and watch for unauthorized changes as the packets
        move through the interfaces.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: MNO logs for service issues in core
      detects: Legitimate UEs notify their service provider about DoS and abnormal
        session terminations.
      fgdsid: FGDS5011.001
      name: MNO logs in core for subscriber service complaints
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: Use integrity (IPSec) on all non-SBI interfaces, TLS 1.3 on all SBI
        interfaces including roaming interfaces (e.g. N32).
      name: Integrity Protection Of Data Communication
    name: "## Addendum Name: Network Interfaces\r\n### Architecture Segments: Control\
      \ Plane, User Plane, Roaming\r\n Adversary with access to a non-Service Based\
      \ Interface (non-SBI) node or an SBI Network Function (NF), or a function on\
      \ the roaming/interconnect interfaces, may manipulate or spoof user plane and\
      \ control plane traffic on that interface without integrity protection, towards\
      \ a DoS or other behaviors on the UE or an NF.\r\n\r\nThe following Network\
      \ interfaces are in the scope of this document.\r\n\r\n1. \"Non-SBI\" (non-Service\
      \ Based Interface) network interfaces are within 5G core (e.g. N4) and RAN (e.g.\
      \ Xn, F1, E1), and between the RAN and the 5G Core (e.g. N2, N3 interfaces).\
      \ \r\n\r\n2. SBI network interfaces are between core NFs within an operator\
      \ network; they use REST APIs.\r\n\r\n3. Roaming and interconnect interfaces,\
      \ including IPX, are between network operators (between SEPPs (N32), between\
      \ UPFs (N9), or interworking functions like between AMF and MME (N26)).\r\n\r\
      \nUnlike radio communications, within operator RAN and from RAN to core communications\
      \ do not always employ integrity protection as per standards. If the gNB does\
      \ not provide integrity protection for control plane (CP) packets sent on the\
      \ N2/Xn-C/F1-C/E1 interfaces or does not provide user plane (UP) integrity protection\
      \ for user plane packets sent on the N3/Xn-U/F1-U interfaces, or UPF does not\
      \ provide integrity protection for user plane packets sent on the N9 interface,\
      \ then data manipulation (alteration of messages, insertion/spoofing of messages,\
      \ or replay of legitimate signaling messages) is possible. This may result in\
      \ DoS. \r\n\r\nThe adversary with access to the SBI links, for example, with\
      \ control over a middlebox (not including the Service Communication Proxy or\
      \ SCP), may manipulate or inject spoofed signaling messages if TLS integrity\
      \ is not enabled or is using a weak algorithm.\r\n\r\n \r\n\r\nIf an IPX disables\
      \ JWS signature or uses a weak algorithm for JWS signature, an AiTM may manipulate\
      \ data over the N32 interface while a UE is roaming.\r\n\r\nSimilarly, if the\
      \ EPC interworking interface N26 for non-roaming is not integrity protected,\
      \ all subscriber signaling data may be manipulated by adversary. Refer clause\
      \ 4.3.1 of [3]."
    platforms:
    - Core
    - RAN
    - Interconnect
    - Transport
    preconditions:
    - description: 'See technique Weaken Integrity: Network Interfaces.'
      name: Weakened or disabled integrity protection
    procedureexamples:
    - description: If gNB is compromised or misconfigured, CP and UP data can be manipulated
        by adversary on N2, N3, F1, E1 and Xn interfaces. Clause D.2.2 of [1], 5.3.3
        of [2].If AMF or SMF is compromised or misconfigured, CP data can be manipulated
        by adversary on N2 or N4 interfaces. Clauses 5.5.2 & 9.9 of [2].If UPF is
        compromised or misconfigured, UP data can be manipulated by adversary on N3
        interface. Clause D.2.2 of [1], 9.3 of [2].
      name: Data manipulation on the non-SBI
    - description: If an NF is compromised or misconfigured, CP data can be manipulated
        on SBI interface. Clause 13.1 of [2].If SCP is compromised or misconfigured,
        CP data can be manipulated on SBI. Clause 5.9.2.4 of [2].
      name: Data manipulation on the SBI
    - description: If SEPP or IPX component is compromised or misconfigured, CP data
        can be manipulated by adversary on N32 interface. Clauses 9.9, 13.1, 13.2
        of [2].If UPF is compromised or misconfigured, UP data can be manipulated
        by adversary on N9 interface. Clause 9.9 of [2].If AMF or MME is compromised
        or misconfigured, CP data can be manipulated by adversary on N26 interface.
        Clause K.2.1 of [1], 8.4 of [2].
      name: Data manipulation on roaming/interconnect
    references:
    - '<a name="1"> \[1\] </a> [3GPP TR33.926: "Security Assurance Specification (SCAS)
      threats and critical assets in 3GPP network product classes."](https://www.3gpp.org/DynaReport/33926.htm)'
    - '<a name="2"> \[2\] </a> [3GPP TS33.501: "Security architecture and procedures
      for 5G System."](https://www.3gpp.org/DynaReport/33501.htm)'
    - '<a name="3"> \[3\] </a> [3GPP TS 23.501: "System architecture for the 5G System
      (5GS)."](https://www.3gpp.org/DynaReport/23501.htm)'
    - '<a name="4"> \[4\] </a> [3GPP TS 23.502: "Procedures for the 5G System (5GS)."](https://www.3gpp.org/DynaReport/23502.htm)'
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: Any of the subscriber data sent by or towards the UE.
      name: UE user plane data
    - description: Any of the signaling traffic sent by or towards the UE.
      name: UE signaling
    detections:
    - component: Network Traffic Content
      detects: Radio traffic content can be examined to detect unauthorized modification.
        Inspect radio traffic and watch for unauthorized changes as the packets move
        through the interfaces.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: Use strong integrity protection on radio interface for both control
        plane and user plane.
      name: Integrity Protection Of Data Communication
    name: "## Addendum Name: Radio Interface\r\n### Architecture Segments: RAN\r\n\
      \ Adversary with access to radio interface manipulates user and control plane\
      \ traffic received on that interface without integrity protection, for example\
      \ to redirect traffic.\r\n\r\nIf the gNB does not provide integrity for control\
      \ plane or user plane packets on radio interfaces, then data manipulation (alteration\
      \ of data frame content, insertion/spoofing of messages, or replay of old messages)\
      \ is possible. "
    platforms:
    - RAN
    preconditions:
    - description: gNB is compromised or incorrectly configured to disable integrity
        protection for control and user plane traffic.
      name: Malware or incorrect configuration in gNB.
    procedureexamples:
    - description: '[3] describes an attack on 4G but applicable to 5G where radio
        interface integrity is not applied, whereby an adversary changes the DNS request
        sent by the victim UE over the radio interface so as to redirect to its own
        DNS server. See technique Redirection of DNS Requests [FGT1565.002]( https://fight.mitre.org/techniques/FGT1565.002/).'
      name: Altering DNS requests not integrity protected over the radio interface.
    - description: RRC messages can be manipulated by AiTM to cause authentication
        of legitimate subscribers to fail. Also, AiTM can manipulate RRC or UP messages
        of an existing data session which can cause disruption or termination of session.
      name: DoS attack by data manipulation
    references:
    - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification
      (SCAS) threats and critical assets in 3GPP network product classes".](https://www.3gpp.org/DynaReport/33926.htm)'
    - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
      for 5G System".](https://www.3gpp.org/DynaReport/33501.htm)'
    - '<a name="3"> \[3\] </a> [D. Rupprecht, K. Kohls, T. Holtz, and C. Popper: "Breaking
      LTE on Layer two", in Proc. IEEE Symposium on Security and Privacy (SP), 2019,
      pp. 1-16.](https://alter-attack.net/media/breaking_lte_on_layer_two.pdf)'
    software: []
  architecture-segment: Control Plane, User Plane, Roaming, RAN, O-RAN
  bluf: 'Adversaries may alter data en route to storage or other systems in order
    to manipulate external outcomes or hide activity, thus threatening the integrity
    of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018)
    By manipulating transmitted data, adversaries may attempt to affect a business
    process, organizational understanding, and decision making.'
  campaigns: []
  criticalassets:
  - description: Legitimate subscribers may be denied access or existing subscriber
      sessions may be terminated or directed to malicious server.
    name: 5G network access
  description: 'Adversaries may alter data en route to storage or other systems in
    order to manipulate external outcomes or hide activity, thus threatening the integrity
    of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018)
    By manipulating transmitted data, adversaries may attempt to affect a business
    process, organizational understanding, and decision making. Manipulation may be
    possible over a network connection or between system processes where there is
    an opportunity deploy a tool that will intercept and change information. The type
    of modification and the impact it will have depends on the target transmission
    mechanism as well as the goals and objectives of the adversary. For complex systems,
    an adversary would likely need special expertise and possibly access to specialized
    software related to the system that would typically be gained through a prolonged
    information gathering campaign in order to have the desired impact.[To read more,
    please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1565/002)'
  detections:
  - component: Core security configuration logs
    detects: Monitor whether integrity protection algorithm configurations in SMF
      are downgraded to weak or no security levels. Clause 5.3.3 of [4].
    fgdsid: FGDS5022.002
    name: Security configuration
  groups: []
  id: FGT1565.002
  mitigations:
  - fgmid: FGM5024
    mitigates: Ensure UE user plane data is protected with strong integrity mechanism.
      This will have performance impact on devices which implement integrity protection.
    name: Integrity Protection Of Data Communication
  name: Transmitted Data Manipulation
  object-type: technique
  postconditions: []
  preconditions:
  - description: Adversary must have physical access to open fronthaul network devices
      to collect data and then manipulate and replay the data.
    name: Adversary has access to open fronthaul network
  procedureexamples:
  - description: Adversary as AitM  manipulates the open fronthaul U plane data traffic
      by using a simple sniffer and replay device. If weak or no integrity protection
      is used on user plane data, DoS can be done by manipulating IP header so that
      those messages will get discarded by the recipient. An Adversary may achieve
      session redirection by changing the destination IP of a DNS request message
      which will re-direct the DNS request to an adversary-controlled DNS server.
      See clause 5.4.1.2 T-UPLANE-01 of [1].
    name: Manipulate U plane data on open fronthaul interface.
  references:
  - '<a name="1"> \[1\] </a> [O-RAN WG11 Threat Modeling.O-R003-v02.00: "O-RAN Security
    Threat Modeling and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="2"> \[2\] </a> [O-RAN WG4 CUS.0-R003-v14.00: "Control, User and Synchronization
    Plane Specification".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [O-RAN WG4 MP.0-R003-v11.00: "Management Plane Specification".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="4"> \[4\] </a> [3GPP TS33.501: "Security architecture and procedures
    for 5G System."](https://www.3gpp.org/DynaReport/33501.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1565
  tactics:
  - TA0040
  typecode: attack_subtechnique_addendum
- bluf: Adversaries may use an existing, legitimate external Web service to exfiltrate
    data rather than their primary command and control channel.
  campaigns: []
  criticalassets: []
  description: Adversaries may use an existing, legitimate external Web service to
    exfiltrate data rather than their primary command and control channel. Popular
    Web services acting as an exfiltration mechanism may give a significant amount
    of cover due to the likelihood that hosts within a network are already communicating
    with them prior to compromise. Firewall rules may also already exist to permit
    traffic to these services. Web service providers also commonly use SSL/TLS encryption,
    giving adversaries an added level of protection.[To read more, please see the
    MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1567)
  detections: []
  groups: []
  id: FGT1567
  mitigations: []
  name: Exfiltration Over Web Service
  object-type: technique
  platforms: Linux, macOS, Windows, Office 365, SaaS, Google Workspace
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0010
  typecode: attack_technique_with_subs_with_addendums
- addendums:
  - access-required: User/subscriber, Admin, Expanded Privilege.
    campaigns: []
    criticalassets:
    - description: Confidentiality of sensitive subscriber data in the form of (calls/data/SMS)
      name: Subscriber data
    detections:
    - component: Core network packet captures (pcaps)
      detects: Inspect all incoming signaling packet payloads for any abnormal encrypted
        communications.
      fgdsid: FGDS5016.001
      name: Packet capture for user plane packets
    - component: Network Traffic Content
      detects: Monitor all incoming and outgoing network traffic over roaming interfaces
        for any unauthorized activities.
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups:
    - description: "Salt Typhoon exfiltrated collected data to external servers using\
        \ cURL to public repository (e.g., AnonFiles,\_File.io, etc.) ([1],[2],[3])"
      fggid: G1045
      name: Salt Typhoon
    mitigations:
    - fgmid: FGM1057
      mitigates: Data loss prevention can detect and block sensitive data being uploaded
        via web browsers.
      name: Data Loss Prevention
    - fgmid: FGM1031
      mitigates: Network intrusion detection and prevention systems that use network
        signatures to identify traffic for specific adversary command and control
        infrastructure.
      name: Network Intrusion Prevention
    - fgmid: FGM1030
      mitigates: Follow best practices for network firewall configurations to allow
        only necessary ports and traffic to enter and exit the network.
      name: Network Segmentation
    - fgmid: FGM1037
      mitigates: Use a firewall and/or rate limiter for all incoming signaling traffic
        to 5G network especially over interfaces, such as N32 and N9.
      name: Filter Network Traffic
    - fgmid: FGM1040
      mitigates: Limit APIs use per NF deployed to minimum required webservices and
        APIs.
      name: Behavior Prevention On Endpoint
    - fgmid: FGM5019
      mitigates: NFs should authorize all API calls.
      name: Authorize External API Calls
    name: "## Addendum Name: Exfiltration To Public Cloud\r\n### Architecture Segments:\
      \ User Plane, Cloud Service Provider\r\n Adversaries may exfiltrate data to\
      \ a cloud storage service rather than over their primary command and control\
      \ channel.\r\n\r\nWhile Network Functions tend to have limited external routes,\
      \ cloud storage and code repositories may offer opportunities to move data to\
      \ adversary-controlled C2 servers, bypassing controls placed on network functions.\
      \ After data collection, the adversary exfiltrates the stolen data and uploads\
      \ files to anonymized file-sharing services. Exposed APIs in code repositories\
      \ or cloud storage services may allow the storage and retrieval of data to a\
      \ remote server over the Internet. "
    platforms:
    - 5G core
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [Vectra AI blog: "Salt Typhoon Threat Actor TTPs".](https://www.vectra.ai/threat-actors/salt-typhoon#TTPs)'
    - '<a name="2"> \[2\] </a> [Tenable blog: "Salt Typhoon: An Analysis of Vulnerabilities
      Exploited by This State-Sponsored Actor".](https://www.tenable.com/blog/salt-typhoon-an-analysis-of-vulnerabilities-exploited-by-this-state-sponsored-actor)'
    - '<a name="3"> \[3\] </a> [Picus security: "Salt Typhoon: A Persistent Threat
      to Global Telecommunications Infrastructure", Dec. 20, 2024.](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
    software: []
  architecture-segment: User Plane, Cloud Service Provider
  bluf: Adversaries may exfiltrate data to a cloud storage service rather than over
    their primary command and control channel.
  campaigns: []
  criticalassets:
  - description: Confidentiality of sensitive subscriber data in the form of (calls/data/SMS)
    name: Subscriber data
  description: Adversaries may exfiltrate data to a cloud storage service rather than
    over their primary command and control channel. Cloud storage services allow for
    the storage, edit, and retrieval of data from a remote cloud storage server over
    the Internet. Examples of cloud storage services include Dropbox and Google Docs.
    Exfiltration to these cloud storage services can provide a significant amount
    of cover to the adversary if hosts within the network are already communicating
    with the service.[To read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1567/002)
  detections:
  - component: Core network packet captures (pcaps)
    detects: Inspect all incoming signaling packet payloads for any abnormal encrypted
      communications.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  - component: Network Traffic Content
    detects: Monitor all incoming and outgoing network traffic over roaming interfaces
      for any unauthorized activities.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: "Salt Typhoon exfiltrated collected data to external servers using\
      \ cURL to public repository (e.g., AnonFiles,\_File.io, etc.) ([1],[2],[3])"
    fggid: G1045
    name: Salt Typhoon
  id: FGT1567.002
  mitigations:
  - fgmid: FGM1057
    mitigates: Data loss prevention can detect and block sensitive data being uploaded
      via web browsers.
    name: Data Loss Prevention
  - fgmid: FGM1031
    mitigates: Network intrusion detection and prevention systems that use network
      signatures to identify traffic for specific adversary command and control infrastructure.
    name: Network Intrusion Prevention
  - fgmid: FGM1030
    mitigates: Follow best practices for network firewall configurations to allow
      only necessary ports and traffic to enter and exit the network.
    name: Network Segmentation
  - fgmid: FGM1037
    mitigates: Use a firewall and/or rate limiter for all incoming signaling traffic
      to 5G network especially over interfaces, such as N32 and N9.
    name: Filter Network Traffic
  - fgmid: FGM1040
    mitigates: Limit APIs use per NF deployed to minimum required webservices and
      APIs.
    name: Behavior Prevention On Endpoint
  - fgmid: FGM5019
    mitigates: NFs should authorize all API calls.
    name: Authorize External API Calls
  name: Exfiltration to Cloud Storage
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [Vectra AI blog: "Salt Typhoon Threat Actor TTPs".](https://www.vectra.ai/threat-actors/salt-typhoon#TTPs)'
  - '<a name="2"> \[2\] </a> [Tenable blog: "Salt Typhoon: An Analysis of Vulnerabilities
    Exploited by This State-Sponsored Actor".](https://www.tenable.com/blog/salt-typhoon-an-analysis-of-vulnerabilities-exploited-by-this-state-sponsored-actor)'
  - '<a name="3"> \[3\] </a> [Picus security: "Salt Typhoon: A Persistent Threat to
    Global Telecommunications Infrastructure", Dec. 20, 2024.](https://www.picussecurity.com/resource/blog/salt-typhoon-telecommunications-threat)'
  software: []
  status: Observed
  subtechnique-of: FGT1567
  tactics:
  - TA0010
  typecode: attack_subtechnique_addendum
- addendums:
  - access-required: User
    campaigns: []
    criticalassets:
    - description: Whoever controls the DNS servers, controls how and what end users
        connect to over the network, making DNS servers a type of critical infrastructure.
      name: DNS servers
    detections:
    - component: Network Traffic Content
      detects: 'Data transmitted across a network (ex: Web, DNS, Mail, File, etc.),
        that is either summarized (ex: Netflow) and/or captured as raw data in an
        analyzable format (ex: PCAP).'
      fgdsid: FGDS0029.002
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM5024
      mitigates: Use strong data integrity protection algorithms within 5G network
        such as airlink, backhaul and core network.
      name: Integrity Protection Of Data Communication
    - fgmid: FGM1037
      mitigates: Filter network traffic to discard untrusted or known bad domains
        and resources.
      name: Filter Network Traffic
    - fgmid: FGM1031
      mitigates: "Network intrusion detection and prevention systems that use network\
        \ signatures to identify traffic for specific adversary malware can be used\
        \ to mitigate activity at the network level. Signatures are often for unique\
        \ indicators within protocols and may be based on the specific obfuscation\
        \ technique used by a particular adversary or tool, and will likely be different\
        \ across various malware families and versions. Adversaries will likely change\
        \ tool command and control signatures over time or construct protocols in\
        \ such a way to avoid detection by common defensive tools.\_Scan all external\
        \ traffic header fields to detect any suspicious protocol or port number use."
      name: Network Intrusion Prevention
    name: "## Addendum Name: DNS Encapsulation\r\n### Architecture Segments: User\
      \ Plane, Control Plane\r\n An adversary may piggyback user data within DNS requests,\
      \ so that the DNS server retrieves the user data for further processing.\r\n\
      \r\nDNS encapsulation involves adversaries transmitting data by encoding it\
      \ within hostname queries in the DNS lookup process. Specifically, the targeted\
      \ data is inserted into the names section of a DNS lookup request. The target\
      \ DNS server, operated by the adversary, records the query and extracts the\
      \ encoded information. This data is then reconstructed according to the intended\
      \ sequence derived from the named fields. This method allows for covert data\
      \ movement, exploiting the DNS protocol as a channel for unauthorized data transmission.\r\
      \n\r\nAdversaries may establish a command and control channel by hiding communication\
      \ using a well known port. They may compromise the external DNS (eDNS) server\
      \ of a partner network using SSH for initial access with password spraying.\
      \ Then they launch the pingpong malware which listens for ICMP echo requests\
      \ from compromised hosts of other partner networks. It establishes a TCP reverse\
      \ shell connection to the partner network when it finds the remote IP address\
      \ and port number. The remote IP address and port number are embedded at a fixed\
      \ offset of the ICMP echo request. The adversaries communicate to a remote C2\
      \ server using TCP port 53 for transport."
    platforms:
    - 5G RAN
    - 5G core
    preconditions:
    - description: There must not be an endpoint detection and response capability
        to validate whether host/network function/UE is communicating with a malicious
        DNS server or a valid one.
      name: Unauthenticated DNS services
    - description: eDNS server of an MNO partner network must be compromised before
        launching this behavior. Then they may install the pingpong backdoor in the
        compromised eDNS server.
      name: MNOs eDNS server is compromised
    procedureexamples:
    - description: Operators do not strictly enforce free DNS service via the standard
        five-tuple flow ID (src IP, dest IP, src port, dest port, protocol). Instead,
        they use only the destination port (or plus protocol ID), thus exposing a
        vulnerability. Adversary may setup fake DNS server to process the received
        data from victim network function/host/UE. [2]
      name: Free DNS loophole
    - description: The adversaries established C2 channel between eDNS server of a
        partner network and another server which is also controlled by them using
        DNS protocol for transport. [5]
      name: DNS tunneling for C2
    references:
    - '<a name="1"> \[1\] </a> ["Bhadra Framework": S.P. Rao, S. Holtmanns, T. Aura:
      "Threat modeling framework for mobile communication systems".](https://arxiv.org/pdf/2005.05110.pdf)'
    - '<a name="2"> \[2\] </a> [Peng, C, Li, C, Tu, G, Lu, S, Zhang, L, Proceedings
      of the 2012 ACM conference on Computer and communications security: "Mobile
      data charging: new attacks and countermeasures."](https://dl.acm.org/doi/pdf/10.1145/2382196.2382220)'
    - '<a name="3"> \[3\] </a> [Merve Sahin, Aurelien Francillon, Payas Gupta, Mustaque
      Ahamad, 2017 IEEE European Symposium on Security and Privacy (EuroS&P). IEEE,
      p235-250: "Sok: Fraud in telephony networks".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7961983&tag=1)'
    - '<a name="4"> \[4\] </a> [Kui Xu, Patrick Butler, Sudip Saha, Danfeng (Daphni)
      Yao, DNS CC Journal: "DNS for Massive-Scale Command and Control".](https://people.cs.vt.edu/~danfeng/papers/DNS-CC-JOURNAL.pdf)'
    - <a name="5"> \[5\] </a> [CrowdStrike blog on Lightbasin attacks.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
    - '<a name="6"> \[6\] </a> [LinkedIn article,Tauseef Nazar Khan: "Understanding
      Zero Trust DNS: A Low-Level Technical Overview".](https://www.linkedin.com/pulse/understanding-zero-trust-dns-low-level-technical-overview-khan-qjwof)'
    software: []
  architecture-segment: User Plane, Control Plane
  bluf: Adversaries may tunnel network communications to and from a victim system
    within a separate protocol to avoid detection/network filtering and/or enable
    access to otherwise unreachable systems.
  campaigns: []
  criticalassets:
  - description: Whoever controls the DNS servers, controls how and what end users
      connect to over the network, making DNS servers a type of critical infrastructure.
    name: DNS servers
  description: 'Adversaries may tunnel network communications to and from a victim
    system within a separate protocol to avoid detection/network filtering and/or
    enable access to otherwise unreachable systems. Tunneling involves explicitly
    encapsulating a protocol within another. This behavior may conceal malicious traffic
    by blending in with existing traffic and/or provide an outer layer of encryption
    (similar to a VPN). Tunneling could also enable routing of network packets that
    would otherwise not reach their intended destination, such as SMB, RDP, or other
    traffic that would be filtered by network appliances or not routed over the Internet.
    There are various means to encapsulate a protocol within another protocol. For
    example, adversaries may perform SSH tunneling (also known as SSH port forwarding),
    which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation:
    SSH Tunneling) [Protocol Tunneling](https://attack.mitre.org/techniques/T1572)
    may also be abused by adversaries during [Dynamic Resolution](https://attack.mitre.org/techniques/T1568).
    Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated
    within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) Adversaries
    may also leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572)
    in conjunction with [Proxy](https://attack.mitre.org/techniques/T1090) and/or
    [Protocol Impersonation](https://attack.mitre.org/techniques/T1001/003) to further
    conceal C2 communications and infrastructure.[To read more, please see the MITRE
    ATT&CK page for this technique](https://attack.mitre.org/techniques/T1572)'
  detections:
  - component: Network Traffic Content
    detects: 'Data transmitted across a network (ex: Web, DNS, Mail, File, etc.),
      that is either summarized (ex: Netflow) and/or captured as raw data in an analyzable
      format (ex: PCAP).'
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1572
  mitigations:
  - fgmid: FGM5024
    mitigates: Use strong data integrity protection algorithms within 5G network such
      as airlink, backhaul and core network.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1037
    mitigates: Filter network traffic to discard untrusted or known bad domains and
      resources.
    name: Filter Network Traffic
  - fgmid: FGM1031
    mitigates: "Network intrusion detection and prevention systems that use network\
      \ signatures to identify traffic for specific adversary malware can be used\
      \ to mitigate activity at the network level. Signatures are often for unique\
      \ indicators within protocols and may be based on the specific obfuscation technique\
      \ used by a particular adversary or tool, and will likely be different across\
      \ various malware families and versions. Adversaries will likely change tool\
      \ command and control signatures over time or construct protocols in such a\
      \ way to avoid detection by common defensive tools.\_Scan all external traffic\
      \ header fields to detect any suspicious protocol or port number use."
    name: Network Intrusion Prevention
  name: Protocol Tunneling
  object-type: technique
  postconditions:
  - description: Adversary will be able to route traffic through DNS channels to connect
      to internet free of charge.
    name: Billing Fraud
  - description: Adversary can route command and control traffic through DNS to control
      botnets or other entities.
    name: Command and Control Network
  - description: Adversary has a route to exfiltrate stolen data disguised as DNS
      packets.
    name: Exfiltration Route
  preconditions:
  - description: There must not be an endpoint detection and response capability to
      validate whether host/network function/UE is communicating with a malicious
      DNS server or a valid one.
    name: Unauthenticated DNS services
  - description: eDNS server of an MNO partner network must be compromised before
      launching this behavior. Then they may install the pingpong backdoor in the
      compromised eDNS server.
    name: MNOs eDNS server is compromised
  procedureexamples:
  - description: Operators do not strictly enforce free DNS service via the standard
      five-tuple flow ID (src IP, dest IP, src port, dest port, protocol). Instead,
      they use only the destination port (or plus protocol ID), thus exposing a vulnerability.
      Adversary may setup fake DNS server to process the received data from victim
      network function/host/UE. [2]
    name: Free DNS loophole
  - description: The adversaries established C2 channel between eDNS server of a partner
      network and another server which is also controlled by them using DNS protocol
      for transport. [5]
    name: DNS tunneling for C2
  references:
  - '<a name="1"> \[1\] </a> ["Bhadra Framework": S.P. Rao, S. Holtmanns, T. Aura:
    "Threat modeling framework for mobile communication systems".](https://arxiv.org/pdf/2005.05110.pdf)'
  - '<a name="2"> \[2\] </a> [Peng, C, Li, C, Tu, G, Lu, S, Zhang, L, Proceedings
    of the 2012 ACM conference on Computer and communications security: "Mobile data
    charging: new attacks and countermeasures."](https://dl.acm.org/doi/pdf/10.1145/2382196.2382220)'
  - '<a name="3"> \[3\] </a> [Merve Sahin, Aurelien Francillon, Payas Gupta, Mustaque
    Ahamad, 2017 IEEE European Symposium on Security and Privacy (EuroS&P). IEEE,
    p235-250: "Sok: Fraud in telephony networks".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7961983&tag=1)'
  - '<a name="4"> \[4\] </a> [Kui Xu, Patrick Butler, Sudip Saha, Danfeng (Daphni)
    Yao, DNS CC Journal: "DNS for Massive-Scale Command and Control".](https://people.cs.vt.edu/~danfeng/papers/DNS-CC-JOURNAL.pdf)'
  - <a name="5"> \[5\] </a> [CrowdStrike blog on Lightbasin attacks.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
  - '<a name="6"> \[6\] </a> [LinkedIn article,Tauseef Nazar Khan: "Understanding
    Zero Trust DNS: A Low-Level Technical Overview".](https://www.linkedin.com/pulse/understanding-zero-trust-dns-low-level-technical-overview-khan-qjwof)'
  software: []
  status: Observed
  tactics:
  - TA0011
  typecode: attack_technique_addendum
- access-required: None
  architecture-segment: User Plane, RAN, UE
  bluf: An adversary may send crafted GTP-U packets to the UPF/PGW-U in order to establish
    an illicit session with a target UE.
  campaigns: []
  criticalassets:
  - description: UE's privacy is violated by the data session established by adversary.
    name: UE
  description: "An adversary may send crafted GTP-U packets to the UPF/PGW-U in order\
    \ to establish an illicit session with a target UE.\r\n\r\nAdversary may send\
    \ an encapsulated GTP-U packet to UPF/PGW-U from the internet with destination\
    \ IP of inner IP the same as UE's private IP address and source IP of inner IP\
    \ as its own IP or a server IP on the internet which is controlled by the adversary.\
    \ UPF/PGW-U forwards the GTP-U packet to gNB/eNB. gNB/eNB decapsulates the GTP-U\
    \ header and forwards the inner packet to the victim UE. UE responds to the message.\
    \ The response message is received either by the adversary or by an adversary\
    \ controlled malicious server on the internet. Thus, adversary establishes a two-way\
    \ communication to the victim UE. Once the session is established, adversary can\
    \ launch further behaviors such as inserting malware, execute Remote Procedure\
    \ Call (RPC) etc."
  detections:
  - component: Core network packet captures (pcaps)
    detects: Examine all IP packets received from the internet at UPF/PGW-U with encapsulated
      GTP-U payload.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  - component: Network Traffic Content
    detects: Monitor incoming packets on N6/SGi interface for any unauthorized data
      sessions.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1572.501
  mitigations:
  - fgmid: FGM1041
    mitigates: Use IPSec tunnel between gNB and UPF to prevent Adversary on the side
      (AoTS) behaviors.
    name: Encrypt Sensitive Information
  - fgmid: FGM5509
    mitigates: Filter encapsulated GTP-U packets received on N6 interface from the
      internet.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM1031
    mitigates: Use Network Intrusion Prevention methods.
    name: Network Intrusion Prevention
  name: UE Access Via GTP-U
  object-type: technique
  platforms: 5G core, 5G RAN
  postconditions:
  - description: UE is subject to further behaviors such as malware insertion, RPC
      execution etc.
    name: UE security is compromised
  preconditions:
  - description: 'Adversary figures out UE''s private IP address by using open-source
      IP address scanning tools such as Shodan and they also figure out the TEID being
      used by the network. [See FGT5031 Discover TEID].Note: For LTE, the adversary
      needs to know TEIDs of two GTP tunnels: TEIDs on S5 and S1-U interfaces.'
    name: Adversary has knowledge of UE IP address and TEID
  procedureexamples:
  - description: 'Adversary may send encapsulated GTP-U packet to UPF/PGW-U from the
      internet with destination IP of inner IP the same as UE''s private IP address
      and source IP of inner IP as its own IP or a server IP on the internet which
      is controlled by the adversary. UPF/PGW-U forwards the GTP-U packet to gNB/eNB.
      gNB/eNB decapsulates the GTP-U header and forwards the inner packet to the victim
      UE. UE responds to the message. The response message is received either by the
      adversary or by an adversary controlled malicious server on the internet. Thus,
      adversary establishes a two-way communication to the victim UE. [1]Adversary
      may launch further behaviors on victim UE such as inserting malware, execute
      Remote Procedure Call (RPC) etc.Note: For LTE, two GTP tunnels are used in the
      user plane. The first GTP tunnel is between PGW-U and SGW-U on S5 interface
      and the second GTP tunnel is between SGW-U and eNB on S1-U interface. Hence,
      the adversary needs to know the TEIDs of both GTP tunnels to launch this behavior.'
    name: Two way session is established between victim UE and adversary
  references:
  - '<a name="1"> \[1\] </a> [Trend Micro article: "Outside Looking In: How a Packet
    Reflection Vulnerability Could Allow Attackers to Infiltrate Internal 5G Networks".](https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/plague-private-5g-networks)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1572
  tactics:
  - TA0011
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: User Plane, Roaming
  bluf: Adversary establishes a C2 tunnel to a server it controls, using GTP-U.
  campaigns: []
  criticalassets:
  - description: The compromised assets come under the control of the adversary where
      the user traffic can be exfiltrated.
    name: UPF and UEs
  description: "Adversary establishes a C2 tunnel to a server it controls, using GTP-U.\r\
    \n\r\nAn adversary may compromise a host in the MNO roaming partner network. Then\
    \ they emulate an SGSN using open-source tools (e.g. sgsnemu) in the compromised\
    \ host. They establish GTP-U tunnels from the emulated SGSN to the GGSN of the\
    \ home network for several UEs whose IMSI/MSISDN are known to the adversary. Once\
    \ the GTP tunnels and PDP contexts are established for at least one UE, the adversary\
    \ establishes a C2 channel to a server which is controlled by them. Then they\
    \ use this channel to exchange C2 data.\_ C2 messages can be used for further\
    \ behaviors such as exfiltration of sensitive data.\r\n\r\nIn 3G, GTP-U tunnel\
    \ is used between SGSN in (visited) vPLMN to GGSN in (home) hPLMN. 5G uses similar\
    \ connections for roaming partners using IPX network for signaling and user plane\
    \ traffic. In the user plane, GTP-U tunnel is used between the two UPFs on N9\
    \ interface - one UPF in vPLMN and one UPF in hPLMN.\r\n\r\nGTP-U carries user\
    \ data and is used in the roaming network (IPX), and also on the N9 interface\
    \ for 5G roaming. When malware is already running on the victim UPF (or another\
    \ user plane function) so that it then responds with GTP-U Echos and Echo responses,\
    \ it allows communication through the IPX fabric with Adversary C2 server. The\
    \ adversary may use the heartbeat protocol GTP- Echo as the medium for transmitting\
    \ data (command and control), taking advantage of the fact that GTP Echo cannot\
    \ be blocked or disabled by firewalls. As a pre-condition, this malware is already\
    \ running on the victim UPF (or another user plane function, for earlier generations\
    \ or a user plane function in the IMS) so that it then responds with GTP-U Echo\
    \ messages and Echo responses, communicating through the IPX fabric with an adversary-controlled\
    \ C2 server. \r\n\r\nNote: C2 data is sent unencrypted as GTP-U payload. However,\
    \ layer 3 encryption (IPSec) may be applied to protect all higher layer data."
  detections:
  - component: Process Creation
    detects: For 5G GTPDOOR monitor all user plane NFs for process creation that is
      unexpected. Examine software running on user plane functions, all open sockets
      with attention to raw sockets, and system processes. Look for mutex files, any
      suspicious configuration files, and any processes that could be disguising themselves
      (e.g. renaming itself as [syslogd]. for example [5]).
    fgdsid: FGDS0009.003
    name: Process
  - component: Firewall metadata
    detects: Inspect logs of application-layer firewalls that check GTP-U and other
      telecom signaling. Check for GTP-Echo packets that contain unexpected data.
    fgdsid: FGDS0018.003
    name: Firewall
  - component: Core network packet captures (pcaps)
    detects: Inspect all incoming GTP encapsulated packet payloads for any abnormal
      tunneled communications.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  - component: Network Traffic Content
    detects: Monitor all incoming and outgoing network traffic over roaming interfaces
      for any unusual packets.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1572.502
  mitigations:
  - fgmid: FGM5509
    mitigates: Use an application-layer firewall and/or rate limiter for all incoming
      signaling and user plane traffic to 5G network especially over the roaming interfaces
      such as N32 and N9.
    name: Screen Signaling And User Plane Messages
  - fgmid: FGM1031
    mitigates: Use Network Intrusion Prevention methods.
    name: Network Intrusion Prevention
  name: C2 Over GTP-U
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions:
  - description: It is assumed that the malware was downloaded onto the UPF or the
      NF (for 3G/4G) that handles GTP-U.
    name: Malware running on UPF
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [GTPDOOR Linux Malware Threatens Telecoms, Exploits GPRS
    Roaming Networks.](https://linuxsecurity.com/news/network-security/gtpdoor-linux-malware)
  - <a name="2"> \[2\] </a> [GTPDOOR - A novel backdoor tailored for covert access
    over the roaming exchange.](https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR#operational-detail)
  - '<a name="3"> \[3\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  - '<a name="4"> \[4\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - <a name="5"> \[5\] </a> ['LightBasin' hackers spent 5 years hiding on telco networks.](https://www.techtarget.com/searchsecurity/news/252508413/LightBasin-hackers-spent-5-years-hiding-on-telco-networks)
  - '<a name="6"> \[6\] </a> [Nokia: "Threat Intelligence Report 2024".](https://onestore.nokia.com/asset/214202)'
  software:
  - description: GTPDOOR embeds adversary commands into the GTP-U heartbeat message
      protocol to evade detection ([1], [2], [3], [4]).
    fgsid: FGS5012
    name: GTPDOOR
  status: Observed
  subtechnique-of: FGT1572
  tactics:
  - TA0011
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: None
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations:
    - fgmid: FGM1030
      mitigates: Network isolation. Deployment architecture should consider physical
        and virtual isolation from other tenants
      name: Network Segmentation
    - fgmid: FGM1041
      mitigates: Any traffic going from a security zone to another security zone must
        be protected with encryption. Key based user and resource authentication and
        authorization should be used
      name: Encrypt Sensitive Information
    - fgmid: FGM5504
      mitigates: Cloud compute, cloud storage and any serverless activity should be
        isolated from other tenants
      name: Resource Isolation In Virtualization Environment
    - fgmid: FGM5505
      mitigates: Hardware mediated execution environment
      name: Hardware Mediated Execution Environment
    name: "## Addendum Name: Access To Cloud Infrastructure Or MEC\r\n### Architecture\
      \ Segments: OA&M, MEC\r\n An adversary may purchase access to cloud infrastructure\
      \ or Multi-access Edge Computing (MEC) resources that will also be hosting the\
      \ operator's infrastructure.\r\n\r\nMobile Network Operators are looking to\
      \ commercial cloud and MEC providers to deploy 5G Core and RAN functions. Similar\
      \ resources may also be utilized to offer compute services for time sensitive\
      \ enterprise/user applications. Adversaries may attempt to target victims by\
      \ creating co-residency in cloud or MEC resources for bridging network, or lateral\
      \ movements by using software and configuration vulnerabilities. These are sometimes\
      \ referred to as colocation attacks."
    platforms:
    - 5G Network
    preconditions: []
    procedureexamples:
    - description: '[2] is a university research showing how an attacker can locate
        an entity''s systems in the cloud and work to instantiate profiling and other
        malicious hosts on the same physical platform.'
      name: Locate cloud resources of target
    references:
    - '<a name="1"> \[1\] </a> [S. Sahoo, S. K. Mishra, B. Sahoo & A. K. Turuk, "Co-resident
      Attack in Cloud Computing: An Overview", Encyclopedia of Big Data Technologies,
      March 2018](https://link.springer.com/content/pdf/10.1007%2F978-3-319-63962-8_322-1.pdf)'
    - '<a name="2"> \[2\] </a> [T. Ristenpart, E. Tromer, H. Shacham, S. Savage, "Hey,
      you, get off of my cloud: exploring information leakage in third-party compute
      clouds", In CCS ''09: Proceedings of the 16th ACM conference on Computer and
      communications security, November 2009 Pages 199-212](https://dl.acm.org/doi/10.1145/1653662.1653687)'
    software: []
  architecture-segment: OA&M, MEC
  bluf: Adversaries may buy, lease, or rent infrastructure that can be used during
    targeting.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may buy, lease, or rent infrastructure that can be used
    during targeting. A wide variety of infrastructure exists for hosting and orchestrating
    adversary operations. Infrastructure solutions include physical or cloud servers,
    domains, and third-party web services.(Citation: TrendmicroHideoutsLease) Additionally,
    botnets are available for rent or purchase. Use of these infrastructure solutions
    allows adversaries to stage, launch, and execute operations. Solutions may help
    adversary operations blend in with traffic that is seen as normal, such as contacting
    third-party web services or acquiring infrastructure to support [Proxy](https://attack.mitre.org/techniques/T1090),
    including from residential proxy services.(Citation: amnesty_nso_pegasus)(Citation:
    FBI Proxies Credential Stuffing)(Citation: Mandiant APT29 Microsoft 365 2022)
    Depending on the implementation, adversaries may use infrastructure that makes
    it difficult to physically tie back to them as well as utilize infrastructure
    that can be rapidly provisioned, modified, and shut down.[To read more, please
    see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1583)'
  detections: []
  groups: []
  id: FGT1583
  mitigations:
  - fgmid: FGM1030
    mitigates: Network isolation. Deployment architecture should consider physical
      and virtual isolation from other tenants
    name: Network Segmentation
  - fgmid: FGM1041
    mitigates: Any traffic going from a security zone to another security zone must
      be protected with encryption. Key based user and resource authentication and
      authorization should be used
    name: Encrypt Sensitive Information
  - fgmid: FGM5504
    mitigates: Cloud compute, cloud storage and any serverless activity should be
      isolated from other tenants
    name: Resource Isolation In Virtualization Environment
  - fgmid: FGM5505
    mitigates: Hardware mediated execution environment
    name: Hardware Mediated Execution Environment
  name: Acquire Infrastructure
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: '[2] is a university research showing how an attacker can locate
      an entity''s systems in the cloud and work to instantiate profiling and other
      malicious hosts on the same physical platform.'
    name: Locate cloud resources of target
  references:
  - '<a name="1"> \[1\] </a> [S. Sahoo, S. K. Mishra, B. Sahoo & A. K. Turuk, "Co-resident
    Attack in Cloud Computing: An Overview", Encyclopedia of Big Data Technologies,
    March 2018](https://link.springer.com/content/pdf/10.1007%2F978-3-319-63962-8_322-1.pdf)'
  - '<a name="2"> \[2\] </a> [T. Ristenpart, E. Tromer, H. Shacham, S. Savage, "Hey,
    you, get off of my cloud: exploring information leakage in third-party compute
    clouds", In CCS ''09: Proceedings of the 16th ACM conference on Computer and communications
    security, November 2009 Pages 199-212](https://dl.acm.org/doi/10.1145/1653662.1653687)'
  software: []
  status: Theoretical
  tactics:
  - TA0042
  typecode: attack_technique_addendum
- access-required: None
  architecture-segment: RAN
  bluf: An adversary may purchase, rent, or download software to stand up a false
    base station (gNB or gNB emulator) or WiFi access point in order to pave the way
    to other follow-on behaviors against UEs such as adversary in the middle, denial
    of service, data interception or manipulation.
  campaigns: []
  criticalassets: []
  description: "An adversary may purchase, rent, or download software to stand up\
    \ a false base station (gNB or gNB emulator) or WiFi access point in order to\
    \ pave the way to other follow-on behaviors against UEs such as adversary in the\
    \ middle, denial of service, data interception or manipulation.\r\n\r\nDue to\
    \ the radio spectrum bands used in 5G, 5G cellular base stations are expected\
    \ to have smaller footprint and so are often smaller in size and mounted on street\
    \ poles. A false cellular base station radio component can be mounted in a given\
    \ favorable location and be connected to a system of the adversary (instead of\
    \ a regular operator's core network). "
  detections:
  - component: Signals sent by UEs
    detects: Monitor gNB logs of UE measurements of received power levels from all
      base stations nearby, and their identifiers. Parsing the logs may reveal the
      presence of false base station in the area. Clause 6.24 of [2].
    fgdsid: FGDS5002.001
    name: Radio interface
  groups: []
  id: FGT1583.501
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of the mobile
      network operator.
    name: Pre-compromise
  name: False Base Station Or Access Point
  object-type: technique
  platforms: RAN
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TR 33.809:
    "Study on 5G security enhancements against False Base Stations (FBS)", Technical
    Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  - '<a name="3"> \[3\] </a> [Cablelabs article: "False Base Station or IMSI Catcher:
    What You Need to Know".](https://www.cablelabs.com/blog/false-base-station-or-imsi-catcher-what-you-need-to-know)'
  - <a name="4"> \[4\] </a> [Open-source O-RAN 5G CU/DU solution from Software Radio
    Systems (SRS).](https://github.com/srsran/srsRAN_Project)
  - <a name="5"> \[5\] </a> [Open Air Interface project source code.](https://gitlab.eurecom.fr/oai/openairinterface5g/)
  software: []
  status: Observed
  subtechnique-of: FGT1583
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: UE
  bluf: An adversary may purchase, rent, or download software to acquire a programmable
    User Equipment (UE) device, in order to pave the way to other follow-on behaviors
    against the Radio-Access Network (RAN) such as denial of service.
  campaigns: []
  criticalassets: []
  description: "An adversary may purchase, rent, or download software to acquire a\
    \ programmable User Equipment (UE) device, in order to pave the way to other follow-on\
    \ behaviors against the Radio-Access Network (RAN) such as denial of service.\r\
    \n\r\nFake UEs are used in many adversarial behaviors against the mobile network. "
  detections: []
  groups: []
  id: FGT1583.502
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of enterprise
      defenses and controls. Efforts should focus on minimizing the amount and sensitivity
      of data available to external parties.
    name: Pre-compromise
  name: Programmable UE Devices
  object-type: technique
  platforms: UE
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Adversary may use Software-Defined-Radio (SDR) running e.g. OAI-5G
      ("OpenAirInterface") modified software.
    name: Fake UE build
  - description: In [1], it is mentioned that the adversary must "forge a malicious
      UE", which is then used to replay messages from the malicious (adversary controlled)
      gNB to the legitimate gNB.
    name: Fake UE acquisition
  references:
  - '<a name="1"> \[1\] </a> [Hu, X. et al: "A Systematic Analysis Method for 5G Non-Access
    Stratum Signalling Security", August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)'
  - '<a name="2"> \[2\] </a> [Ericsson whitepaper: "Detecting false base stations
    in mobile networks".](https://www.ericsson.com/en/blog/2018/6/detecting-false-base-stations-in-mobile-networks)'
  software: []
  status: Observed
  subtechnique-of: FGT1583
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: Control Plane
  bluf: An adversary obtains use of network or signaling infrastructure in order to
    apply techniques against 5G networks or UEs.
  campaigns: []
  criticalassets: []
  description: "An adversary obtains use of network or signaling infrastructure in\
    \ order to apply techniques against 5G networks or UEs.\r\n\r\nAn adversary may\
    \ attempt to legitimately or illegitimately acquire network or signaling, e.g.\
    \ SS7, infrastructure capabilities that are able to communicate with other operator\
    \ environments. Unlike [T1650 - Acquire Access](https://attack.mitre.org/techniques/T1650),\
    \ the adversary is not acquiring access through an underground market and the\
    \ adversary may be part of a legitimate organization that has obtained access.\
    \ The adversary, working within the legitimate organization, may then use that\
    \ legitimately obtained access in unauthorized ways. The adversary may also be\
    \ acquiring infrastructure access through coercion or subterfuge from a legitimate\
    \ operator or service provider. The adversary may use this network infrastructure,\
    \ however obtained, as a position to apply additional follow-on behaviors. "
  detections:
  - component: Firewall metadata
    detects: Logs from firewalls may be useful for detecting adversary activities
      through signaling or via other network access protocols protected by firewalls.
    fgdsid: FGDS0018.003
    name: Firewall
  - component: Response Metadata
    detects: "Once adversaries leverage the telco infrastructure (ex: for command\
      \ and control), it may be possible to look for unique characteristics associated\
      \ with adversary software, if known.\_Much of this activity will take place\
      \ outside the visibility of the target organization, making detection of this\
      \ behavior difficult. Detection efforts may be focused on related stages of\
      \ the adversary lifecycle, such as during Command and Control"
    fgdsid: FGDS0035.002
    name: Internet Scan
  groups: []
  id: FGT1583.508
  mitigations:
  - fgmid: FGM1037
    mitigates: Use of firewall capabilities may allow filtering for a number of different
      paths, protocols, and networks.  Firewall capability may be able to block illegitimate
      or suspicious SS7, SMS, IP, Diameter and other protocols.
    name: Filter Network Traffic
  - fgmid: FGM1014
    mitigates: Filtering requests from unexpected/unauthorized providers may provide
      some defense against malicious use of SS7 networks by an adversary.
    name: Interconnection Filtering
  name: Network Access
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi & X. Chen, "Over The Air Baseband Exploit:
    Gaining RemoteCode Execution on 5G Smartphones," retrieved May 16, 2023](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1583
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations:
    - fgmid: FGM1056
      mitigates: This technique cannot be easily mitigated with preventive controls
        since it is based on behaviors performed outside of the scope of the mobile
        network operator.
      name: Pre-compromise
    name: "## Addendum Name: IMSI Catcher\r\n### Architecture Segments: RAN, UE\r\n\
      \ An adversary may build an International Mobile Subscriber Identity (IMSI)\
      \ catcher to capture IMSI numbers from nearby UEs in a target area.\r\n\r\n\
      IMSI catchers are very similar to fake base stations but may not have full capabilities\
      \ of the base station. The IMSI Catcher term has been traditionally associated\
      \ with UE identity discovery or location identification. Adversary may build\
      \ one with open-source code and generic radio transceivers. Open-source code\
      \ for software defined radio, or RAN test equipment, or simulators can also\
      \ be modified to create an IMSI catcher."
    platforms:
    - RAN
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [Adrian Dabrowski, Nicola Pianta, Thomas Klepp, Martin
      Mulazzani, and Edgar Weippl. "IMSI-catch me if you can: IMSI-catcher-catchers".
      In Proceedings of the 30th annual computer security applications Conference,
      pages 246-255, 2014.](https://its-wiki.no/images/f/fb/Dabrowski_ISMI_Catch_me_Catchers.pdf)'
    - <a name="2"> \[2\] </a> [Ravishankar Borgaonkar, Altaf Shaik, "5G IMSI Catchers
      Mirage", Blackhat USA Conference 2021.](https://blackhat.com/us-21/briefings/schedule/#g-imsi-catchers-mirage-23538)
    - <a name="3"> \[3\] </a> ["HOW COPS CAN SECRETLY TRACK YOUR PHONE", The Intercept
      online article, July 31, 2021. Accessed 6/22/2022.](https://theintercept.com/2020/07/31/protests-surveillance-stingrays-dirtboxes-phone-tracking/)
    - '<a name="4"> \[4\] </a> [A Knight, Brier & Thorn, "Hacking GSM: Building a
      Rogue Base Station to Hack Cellular Devices", Online Article.  Accessed 6/22/2022.](https://www.brierandthorn.com/post/hacking-gsm-building-a-rogue-base-station-to-hack-cellular-devices)'
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations: []
    name: "## Addendum Name: Silent Paging Tool\r\n### Architecture Segments: RAN,\
      \ UE\r\n An adversary may build or develop a silent SMS tool in order to send\
      \ SMSs to nearby phones in a target area.\r\n\r\nA silent SMS is described in\
      \ the specification GSM 03.40 as a Short Message of type 0, which indicates\
      \ that the UE must acknowledge receipt of the short message but may discard\
      \ its contents.\r\n\r\nIt is possible to build/develop an application to send\
      \ silent SMS messages, which can run on a regular phone (UE) that can register\
      \ to a local network. That application can be used to send a silent SMS to a\
      \ target UE using the phone number (MSISDN)."
    platforms:
    - RAN
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [Information Security Newspaper, "How to hack and track
      anybody's  phone location via silent SMS messages".](https://www.securitynewspaper.com/2023/06/20/how-to-hack-track-anybodys-phone-location-via-silent-sms-messages/)
    - <a name="2"> \[2\] </a> [Silent-sms-ping github repository](https://github.com/MatejKovacic/silent-sms-ping)
    software: []
  architecture-segment: RAN, UE
  bluf: Adversaries may build capabilities that can be used during targeting.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may build capabilities that can be used during targeting.
    Rather than purchasing, freely downloading, or stealing capabilities, adversaries
    may develop their own capabilities in-house. This is the process of identifying
    development requirements and building solutions such as malware, exploits, and
    self-signed certificates. Adversaries may develop capabilities to support their
    operations throughout numerous phases of the adversary lifecycle.(Citation: Mandiant
    APT1)(Citation: Kaspersky Sofacy)(Citation: Bitdefender StrongPity June 2020)(Citation:
    Talos Promethium June 2020) As with legitimate development efforts, different
    skill sets may be required for developing capabilities. The skills needed may
    be located in-house, or may need to be contracted out. Use of a contractor may
    be considered an extension of that adversary''s development capabilities, provided
    the adversary plays a role in shaping requirements and maintains a degree of exclusivity
    to the capability.[To read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1587)'
  detections: []
  groups: []
  id: FGT1587
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of the mobile
      network operator.
    name: Pre-compromise
  name: Develop Capabilities
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [Adrian Dabrowski, Nicola Pianta, Thomas Klepp, Martin
    Mulazzani, and Edgar Weippl. "IMSI-catch me if you can: IMSI-catcher-catchers".
    In Proceedings of the 30th annual computer security applications Conference, pages
    246-255, 2014.](https://its-wiki.no/images/f/fb/Dabrowski_ISMI_Catch_me_Catchers.pdf)'
  - <a name="2"> \[2\] </a> [Ravishankar Borgaonkar, Altaf Shaik, "5G IMSI Catchers
    Mirage", Blackhat USA Conference 2021.](https://blackhat.com/us-21/briefings/schedule/#g-imsi-catchers-mirage-23538)
  - <a name="3"> \[3\] </a> ["HOW COPS CAN SECRETLY TRACK YOUR PHONE", The Intercept
    online article, July 31, 2021. Accessed 6/22/2022.](https://theintercept.com/2020/07/31/protests-surveillance-stingrays-dirtboxes-phone-tracking/)
  - '<a name="4"> \[4\] </a> [A Knight, Brier & Thorn, "Hacking GSM: Building a Rogue
    Base Station to Hack Cellular Devices", Online Article.  Accessed 6/22/2022.](https://www.brierandthorn.com/post/hacking-gsm-building-a-rogue-base-station-to-hack-cellular-devices)'
  software: []
  status: Theoretical
  tactics:
  - TA0042
  typecode: attack_technique_addendum
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets:
    - description: User device is running malware.
      name: User Device
    detections: []
    groups: []
    mitigations:
    - fgmid: FGM1001
      mitigates: Install security updates for known vulnerabilities.  Timely updates
        by the baseband vendor may make finding exploits harder.by an adversary.
      name: Security Updates
    name: "## Addendum Name: Baseband Exploits\r\n### Architecture Segments: UE\r\n\
      \ An adversary may develop exploits that target the UE to execute malicious\
      \ code.\r\n\r\nThe adversary may identify a vulnerability in the UE modem and\
      \ exploit this to execute malicious code. The adversary may need specific knowledge\
      \ of the modems, e.g.[T1592.001]( https://attack.mitre.org/techniques/T1592/001/),\
      \ used in specific UEs and exploits might be viable for specific models of UEs\
      \ or the class of UE utilizing a specific version of firmware, e.g. [T1592.003](\
      \ https://attack.mitre.org/techniques/T1592/003/). Vulnerabilities may be discovered\
      \ in multiple ways and exploiting the vulnerability may require previous use\
      \ of techniques to obtain an operator RAN position or deploy a false base station,\
      \ such as in [FGT1583.501]( https://fight.mitre.org/techniques/FGT1583.501),\
      \ to which the UE would connect.\r\n\r\n "
    platforms:
    - UE Platform
    preconditions:
    - description: Adversary may need to deploy their own base station (and possibly
        core network) in a lab environment for exploit development and testing.
      name: Lab test environment
    procedureexamples:
    - description: Researchers [1] analyzed firmware for vulnerabilities and identified
        stack overflow vulnerability in an XML parser inside the baseband that parses
        IMS messages.
      name: Stack Overflow
    references:
    - '<a name="1"> \[1\] </a> [M.Grassi and X. Chen, "Over The Air Baseband Exploit:
      Gaining RemoteCode Execution on 5G Smartphones, Retrieved May 16, 2023](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
    - '<a name="2"> \[2\] </a> [I.Karim, F.Cicala, et.al.,"ATFuzzer: Dynamic Analysis
      Framework of AT Interfacefor Android Smartphones," Retrieved May 16, 2023](https://dl.acm.org/doi/pdf/10.1145/3416125)'
    software: []
  architecture-segment: UE
  bluf: Adversaries may develop exploits that can be used during targeting.
  campaigns: []
  criticalassets:
  - description: User device is running malware.
    name: User Device
  description: 'Adversaries may develop exploits that can be used during targeting.
    An exploit takes advantage of a bug or vulnerability in order to cause unintended
    or unanticipated behavior to occur on computer hardware or software. Rather than
    finding/modifying exploits from online or purchasing them from exploit vendors,
    an adversary may develop their own exploits.(Citation: NYTStuxnet) Adversaries
    may use information acquired via [Vulnerabilities](https://attack.mitre.org/techniques/T1588/006)
    to focus exploit development efforts. As part of the exploit development process,
    adversaries may uncover exploitable vulnerabilities through methods such as fuzzing
    and patch analysis.(Citation: Irongeek Sims BSides 2017) As with legitimate development
    efforts, different skill sets may be required for developing exploits. The skills
    needed may be located in-house, or may need to be contracted out. Use of a contractor
    may be considered an extension of that adversary''s exploit development capabilities,
    provided the adversary plays a role in shaping requirements and maintains an initial
    degree of exclusivity to the exploit. Adversaries may use exploits during various
    phases of the adversary lifecycle (i.e. [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190),
    [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203),
    [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068),
    [Exploitation for Defense Evasion](https://attack.mitre.org/techniques/T1211),
    [Exploitation for Credential Access](https://attack.mitre.org/techniques/T1212),
    [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210),
    and [Application or System Exploitation](https://attack.mitre.org/techniques/T1499/004)).[To
    read more, please see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1587/004)'
  detections: []
  groups: []
  id: FGT1587.004
  mitigations:
  - fgmid: FGM1001
    mitigates: Install security updates for known vulnerabilities.  Timely updates
      by the baseband vendor may make finding exploits harder.by an adversary.
    name: Security Updates
  name: Exploits
  object-type: technique
  postconditions: []
  preconditions:
  - description: Adversary may need to deploy their own base station (and possibly
      core network) in a lab environment for exploit development and testing.
    name: Lab test environment
  procedureexamples:
  - description: Researchers [1] analyzed firmware for vulnerabilities and identified
      stack overflow vulnerability in an XML parser inside the baseband that parses
      IMS messages.
    name: Stack Overflow
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi and X. Chen, "Over The Air Baseband Exploit:
    Gaining RemoteCode Execution on 5G Smartphones, Retrieved May 16, 2023](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
  - '<a name="2"> \[2\] </a> [I.Karim, F.Cicala, et.al.,"ATFuzzer: Dynamic Analysis
    Framework of AT Interfacefor Android Smartphones," Retrieved May 16, 2023](https://dl.acm.org/doi/pdf/10.1145/3416125)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1587
  tactics:
  - TA0042
  typecode: attack_subtechnique_addendum
- access-required: N/A
  architecture-segment: RAN, Control Plane, User Plane
  bluf: An adversary may create an operator network to facilitate applying techniques
    to a victim UE.
  campaigns: []
  criticalassets: []
  description: "An adversary may create an operator network to facilitate applying\
    \ techniques to a victim UE.\r\n\r\nAn adversary may create a fully functional\
    \ operator network such as a 5G core and false base station to exploit the user\
    \ and/or UE. Creation of a false base station may not be sufficient in a 5G network\
    \ to further the adversary's objectives due to security improvements from earlier\
    \ generations. The availability of open 5G core and RAN software and services\
    \ make this viable for an adversary. The adversary, controlling the 5G network\
    \ the UE attaches, via additional techniques, such as [FGT1583.501](https://fight.mitre.org/techniques/FGT1583.501/),\
    \ may redirect the UE or use [FGT1562.501](https://fight.mitre.org/techniques/FGT1562.501)\
    \ to perform a downgrade attack to weaken end-to-end security. Techniques such\
    \ as [FGT5009]( https://fight.mitre.org/techniques/FGT5009/) may also be utilized\
    \ by the adversary to evade defenses."
  detections: []
  groups: []
  id: FGT1587.501
  mitigations:
  - fgmid: FGM1056
    mitigates: The development aspect is not visible to the UE or Operator and is
      therefore not easily or possible to mitigate.
    name: Pre-compromise
  name: Operator Network
  object-type: technique
  platforms: 5G Core Platform, 5G RAN Platform
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi and X. Chen, "Over The Air Baseband Exploit:
    Gaining Remote Code Execution on 5G Smartphones", Retrieved May 16, 2023.](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1587
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations: []
    name: "## Addendum Name: Silent Paging Tool\r\n### Architecture Segments: RAN,\
      \ UE\r\n An adversary may buy or steal a silent SMS tool in order to send SMSes\
      \ to nearby phones in a target area.\r\n\r\nA silent SMS is described in the\
      \ specification GSM 03.40 as a Short Message of type 0, which indicates that\
      \ the UE must acknowledge receipt of the short message but may discard its contents.\r\
      \n\r\nA simple mobile phone running a program to send silent SMSes is such an\
      \ SMS tool. What is needed is cellular connectivity, and the phone number of\
      \ the victim. "
    platforms:
    - RAN
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [SMS Deliverer, "PING/Silent SMS".](https://www.smsdeliverer.com/onlinehelp/interface/pingsms/)
    - <a name="2"> \[2\] </a> [Information Security Newspaper, "How to hack and track
      anybody's  phone location via silent SMS messages".](https://www.securitynewspaper.com/2023/06/20/how-to-hack-track-anybodys-phone-location-via-silent-sms-messages/)
    software: []
  - access-required: N/A
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations:
    - fgmid: FGM1056
      mitigates: This technique cannot be easily mitigated with preventive controls
        since it is based on behaviors performed outside of the scope of the mobile
        network operator.
      name: Pre-compromise
    name: "## Addendum Name: IMSI Catcher\r\n### Architecture Segments: RAN, UE\r\n\
      \ An adversary may buy or steal an International Mobile Subscriber Identity\
      \ (IMSI) catcher to capture IMSI data from nearby UEs in a target area.\r\n\r\
      \nIMSI catchers are very similar to fake base stations but may not have full\
      \ capabilities of the base station. IMSI Catcher terms has been traditionally\
      \ associated with UE identity discovery or location identification. Adversary\
      \ may buy an IMSI Catcher from legitimate vendors selling products."
    platforms:
    - RAN
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [Adrian Dabrowski, Nicola Pianta, Thomas Klepp, Martin
      Mulazzani, and Edgar Weippl. "IMSI-catch me if you can: IMSI-catcher-catchers".
      Proceedings of the 30th annual computer security applications Conference, pages
      246-255, 2014.](https://its-wiki.no/images/f/fb/Dabrowski_ISMI_Catch_me_Catchers.pdf)'
    - <a name="2"> \[2\] </a> [Ravishankar Borgaonkar, Altaf Shaik, "5G IMSI Catchers
      Mirage", Blackhat USA Conference 2021.](https://blackhat.com/us-21/briefings/schedule/#g-imsi-catchers-mirage-23538)
    - <a name="3"> \[3\] </a> ["HOW COPS CAN SECRETLY TRACK YOUR PHONE", The Intercept,
      online article, July 31, 2021. Accessed 6/22/2022.](https://theintercept.com/2020/07/31/protests-surveillance-stingrays-dirtboxes-phone-tracking/)
    - '<a name="4"> \[4\] </a> [A Knight, Brier & Thorn, "Hacking GSM: Building a
      Rogue Base Station to Hack Cellular Devices," Online Article.  Accessed 6/22/2022.](https://www.brierandthorn.com/post/hacking-gsm-building-a-rogue-base-station-to-hack-cellular-devices)'
    software: []
  architecture-segment: RAN, UE
  bluf: Adversaries may buy and/or steal capabilities that can be used during targeting.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may buy and/or steal capabilities that can be used during
    targeting. Rather than developing their own capabilities in-house, adversaries
    may purchase, freely download, or steal them. Activities may include the acquisition
    of malware, software (including licenses), exploits, certificates, and information
    relating to vulnerabilities. Adversaries may obtain capabilities to support their
    operations throughout numerous phases of the adversary lifecycle. In addition
    to downloading free malware, software, and exploits from the internet, adversaries
    may purchase these capabilities from third-party entities. Third-party entities
    can include technology companies that specialize in malware and exploits, criminal
    marketplaces, or from individuals.(Citation: NationsBuying)(Citation: PegasusCitizenLab)
    In addition to purchasing capabilities, adversaries may steal capabilities from
    third-party entities (including other adversaries). This can include stealing
    software licenses, malware, SSL/TLS and code-signing certificates, or raiding
    closed databases of vulnerabilities or exploits.(Citation: DiginotarCompromise)[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1588)'
  detections: []
  groups: []
  id: FGT1588
  mitigations: []
  name: Obtain Capabilities
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [SMS Deliverer, "PING/Silent SMS".](https://www.smsdeliverer.com/onlinehelp/interface/pingsms/)
  - <a name="2"> \[2\] </a> [Information Security Newspaper, "How to hack and track
    anybody's  phone location via silent SMS messages".](https://www.securitynewspaper.com/2023/06/20/how-to-hack-track-anybodys-phone-location-via-silent-sms-messages/)
  software: []
  status: Observed
  tactics:
  - TA0042
  typecode: attack_technique_addendum
- addendums:
  - access-required: None
    campaigns: []
    criticalassets:
    - description: Radio communication service between UE and base station.
      name: RAN Service
    - description: UE and subscriber identity as well as communication.
      name: UE identity, and communication
    - description: MNO partner network operations.
      name: Network operations
    detections:
    - component: Malware Metadata
      detects: "Monitor repositories for metadata that could provide contextual data\
        \ about unexpected tools, such as compilation times, file hashes, as well\
        \ as watermarks or other identifiable configuration information. In some cases,\
        \ malware repositories can also be used to identify features of tool use associated\
        \ with an adversary. \n\nDetection efforts should be focused on post-compromise\
        \ phases of the adversary lifecycle as much of this activity will take place\
        \ outside the visibility of the target organization, making detection of this\
        \ behavior difficult."
      fgdsid: FGDS0004.002
      name: Malware Repository
    groups:
    - description: Liminal Panda obtained and used SIGTRANslator tool to establish
        a C2 channel from the compromised host of a partner network to a remote server
        controlled by them. [3]
      fggid: FGG5001
      name: Liminal Panda
    mitigations:
    - fgmid: FGM1056
      mitigates: This technique cannot be easily mitigated with preventive controls
        since it is based on behaviors performed outside of the scope of enterprise
        defenses and controls.
      name: Pre-compromise
    name: "## Addendum Name: Telecom\r\n### Architecture Segments: RAN, O-RAN, User\
      \ Plane\r\n An adversary may buy, steal or download capabilities needed to target\
      \ network elements and User Equipment.\r\n\r\nAdversary needs to obtain tools\
      \ (HW/SW) to carry out planned attacks against victim UEs and hosts of partner\
      \ networks. This may include buying stingrays or buying radio cards, laptops\
      \ and integrating into a working base station. Adversary may need specific tools\
      \ such as SIM Cloning, network traffic analyzer, certificates, or code needed\
      \ to be executed on a compromised 5G Network Function to achieve its goals.\r\
      \n\r\nIn some cases, adversaries may purchase from third party specific software\
      \ to do development and integration work to provide specific behavior capabilities.\
      \ \r\n\r\nAdversary may also obtain the SIGTRANslator Linux binary and install\
      \ it in a compromised host of MNO partner network. Then they use SIGTRANslator\
      \ to establish a Command and Control (C2) channel from the compromised host\
      \ to a server controlled by them. SIGTRANslator uses SIGTRAN protocol for underlying\
      \ transport and SIGTRAN uses IP network to transport SS7 protocol messages.\
      \ All data transferred over the C2 channel is encrypted to avoid detection.\
      \ As a follow-on behavior, the adversary opened a port on the compromised host\
      \ and the port was used for exfiltration of data from the host to the remote\
      \ server."
    platforms:
    - 5G RAN
    - 5G Core
    preconditions: []
    procedureexamples:
    - description: There are many tools developed to test 5G systems, same tools can
        be used for adversarial objective on a system.
      name: Use of Open-source software & Testing tools
    references:
    - <a name="1"> \[1\] </a> [Open Source tools](https://github.com/ravens/awesome-telco)
    - <a name="2"> \[2\] </a> [Building a Cellphone IMSI Catcher (Stingray)](https://www.hackers-arise.com/post/software-defined-radio-part-6-building-a-imsi-catcher-stingray)
    - <a name="3"> \[3\] </a> [Crowdstrike blog on Lightbasin threats](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
    software:
    - description: SIGTRANslator software tool was used by Liminal Panda to connect
        to remote server. [3]
      fgsid: FGS5005
      name: SIGTRANslator
  architecture-segment: RAN, O-RAN, User Plane
  bluf: Adversaries may buy, steal, or download software tools that can be used during
    targeting.
  campaigns: []
  criticalassets:
  - description: Radio communication service between UE and base station.
    name: RAN Service
  - description: UE and subscriber identity as well as communication.
    name: UE identity, and communication
  - description: MNO partner network operations.
    name: Network operations
  description: 'Adversaries may buy, steal, or download software tools that can be
    used during targeting. Tools can be open or closed source, free or commercial.
    A tool can be used for malicious purposes by an adversary, but (unlike malware)
    were not intended to be used for those purposes (ex: [PsExec](https://attack.mitre.org/software/S0029)).
    Tool acquisition can involve the procurement of commercial software licenses,
    including for red teaming tools such as [Cobalt Strike](https://attack.mitre.org/software/S0154).
    Commercial software may be obtained through purchase, stealing licenses (or licensed
    copies of the software), or cracking trial versions.(Citation: Recorded Future
    Beacon 2019) Adversaries may obtain tools to support their operations, including
    to support execution of post-compromise behaviors. In addition to freely downloading
    or purchasing software, adversaries may steal software and/or software licenses
    from third-party entities (including other adversaries).[To read more, please
    see the MITRE ATT&CK page for this subtechnique](https://attack.mitre.org/techniques/T1588/002)'
  detections:
  - component: Malware Metadata
    detects: "Monitor repositories for metadata that could provide contextual data\
      \ about unexpected tools, such as compilation times, file hashes, as well as\
      \ watermarks or other identifiable configuration information. In some cases,\
      \ malware repositories can also be used to identify features of tool use associated\
      \ with an adversary. \n\nDetection efforts should be focused on post-compromise\
      \ phases of the adversary lifecycle as much of this activity will take place\
      \ outside the visibility of the target organization, making detection of this\
      \ behavior difficult."
    fgdsid: FGDS0004.002
    name: Malware Repository
  groups:
  - description: Liminal Panda obtained and used SIGTRANslator tool to establish a
      C2 channel from the compromised host of a partner network to a remote server
      controlled by them. [3]
    fggid: FGG5001
    name: Liminal Panda
  id: FGT1588.002
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of enterprise
      defenses and controls.
    name: Pre-compromise
  name: Tool
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: There are many tools developed to test 5G systems, same tools can
      be used for adversarial objective on a system.
    name: Use of Open-source software & Testing tools
  references:
  - <a name="1"> \[1\] </a> [Open Source tools](https://github.com/ravens/awesome-telco)
  - <a name="2"> \[2\] </a> [Building a Cellphone IMSI Catcher (Stingray)](https://www.hackers-arise.com/post/software-defined-radio-part-6-building-a-imsi-catcher-stingray)
  - <a name="3"> \[3\] </a> [Crowdstrike blog on Lightbasin threats](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
  software:
  - description: SIGTRANslator software tool was used by Liminal Panda to connect
      to remote server. [3]
    fgsid: FGS5005
    name: SIGTRANslator
  status: Observed
  subtechnique-of: FGT1588
  tactics:
  - TA0042
  typecode: attack_subtechnique_addendum
- access-required: None
  architecture-segment: RAN, O-RAN
  bluf: An adversary may obtain radio network function needed to attack target victim
    UEs.
  campaigns: []
  criticalassets:
  - description: Radio Communication service between UE and basestation.
    name: Data and voice services/service availability
  - description: 'User identifier, permanent: SUCI and SUPI. Temporary: 5G-GUTI, TEID,
      IP address'
    name: UE identifiers - permanent or temporary
  - description: Includes coarse or fine location
    name: UE location
  description: "An adversary may obtain radio network function needed to attack target\
    \ victim UEs.\r\n\r\nAdversary provides an alternate radio access network (gNB\
    \ or open-RAN gNB components such as Distributed Unit (DU) or Centralized Unit\
    \ (CU)) to target victim UEs without victim (user or UE) discovering that they\
    \ are not attached to a legitimate MNO network. This can be achieved by the adversary\
    \ obtaining false base station network functionality and any connections to core\
    \ network functions required to carry out their mission. Opensource radio and\
    \ base station software combined with radio cards can be easily obtained to create\
    \ a base station to launch attacks against network or UE."
  detections: []
  groups: []
  id: FGT1588.501
  mitigations:
  - fgmid: FGM1056
    mitigates: This technique cannot be easily mitigated with preventive controls
      since it is based on behaviors performed outside of the scope of enterprise
      defenses and controls.
    name: Pre-compromise
  name: Radio Network Functions
  object-type: technique
  platforms: 5G RAN
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Many software defined source code are available that can be used
      to build a base station with radio transceiver hardware on Linux and or windows
      PC.  There are also opensource 5G core software available on opensource project
      websites.
    name: Use of opensource SW
  - description: With the proliferation of private 5G deployments, almost anyone can
      now purchase software for the RAN components such as gNB, DU, CU.
    name: Purchase of Commercial equipment
  references:
  - <a name="1"> \[1\] </a> [Open Source RAN project](https://www.srslte.com)
  - '<a name="2"> \[2\] </a> [Over The Air Baseband Exploit: Gaining Remote Code Execution
    on 5G Smartphones](https://keenlab.tencent.com/zh/whitepapers/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-on-5G-Smartphones-wp.pdf)'
  - <a name="3"> \[3\] </a> [Open5GS](https://open5gs.org)
  - '<a name="4"> \[4\] </a> [Over The Air Baseband Exploit: Gaining Remote Code Execution
    on 5G Smartphones](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Over-The-Air-Baseband-Exploit-Gaining-Remote-Code-Execution-On-5G-Smartphones.pdf)'
  - <a name="5"> \[5\] </a> [Open Source tools](https://github.com/ravens/awesome-telco)
  - <a name="6"> \[6\] </a> [Building a Cellphone IMSI Catcher (Stingray)](https://www.hackers-arise.com/post/software-defined-radio-part-6-building-a-imsi-catcher-stingray)
  - <a name="7"> \[7\] </a> [5G NR equipment suppliers](https://www.rfwireless-world.com/Vendors/5G-NR-Network-Equipment-Manufacturers.html)
  software: []
  status: Theoretical
  subtechnique-of: FGT1588
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may gather information about the victim's hosts that can be used
    during targeting.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may gather information about the victim''s hosts that
    can be used during targeting. Information about hosts may include a variety of
    details, including administrative data (ex: name, assigned IP, functionality,
    etc.) as well as specifics regarding its configuration (ex: operating system,
    language, etc.). Adversaries may gather this information in various ways, such
    as direct collection actions via [Active Scanning](https://attack.mitre.org/techniques/T1595)
    or [Phishing for Information](https://attack.mitre.org/techniques/T1598). Adversaries
    may also compromise sites then include malicious content designed to collect host
    information from visitors.(Citation: ATT ScanBox) Information about hosts may
    also be exposed to adversaries via online or other accessible data sets (ex: [Social
    Media](https://attack.mitre.org/techniques/T1593/001) or [Search Victim-Owned
    Websites](https://attack.mitre.org/techniques/T1594)). Gathering this information
    may reveal opportunities for other forms of reconnaissance (ex: [Search Open Websites/Domains](https://attack.mitre.org/techniques/T1593)
    or [Search Open Technical Databases](https://attack.mitre.org/techniques/T1596)),
    establishing operational resources (ex: [Develop Capabilities](https://attack.mitre.org/techniques/T1587)
    or [Obtain Capabilities](https://attack.mitre.org/techniques/T1588)), and/or initial
    access (ex: [Supply Chain Compromise](https://attack.mitre.org/techniques/T1195)
    or [External Remote Services](https://attack.mitre.org/techniques/T1133)).[To
    read more, please see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1592)'
  detections: []
  groups: []
  id: FGT1592
  mitigations: []
  name: Gather Victim Host Information
  object-type: technique
  platforms: PRE
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0043
  typecode: attack_technique_with_fight_subs
- access-required: User Or Admin Of GSMA
  architecture-segment: OA&M
  bluf: An adversary may gain access to an operator's roaming database (IR.21), which
    can reveal the critical network assets of both the operator and its roaming partners.
  campaigns: []
  criticalassets:
  - description: Information on the IP addresses of the core network functions like
      subscriber databases and functions involved in roaming exchanges (e.g. Access
      and Mobility Function (AMF)).
    name: Network function IP address
  - description: Network information of roaming partner (MNO) network including the
      IP addresses of the network nodes, the subscriber information etc.
    name: Roaming partner network function IP addresses
  description: "An adversary may gain access to an operator's roaming database (IR.21),\
    \ which can reveal the critical network assets of both the operator and its roaming\
    \ partners.\r\n\r\nInternational Mobile Network Operators (MNOs) maintain information\
    \ about their network infrastructure, roaming/interconnection configuration, and\
    \ MNO partner billing agreements. This sensitive data is in a standardized format,\
    \ under the name \"IR.21\". GSMA (an operator forum) administers databases of\
    \ IR.21 for all international MNO and allowing all MNOs access to it. This type\
    \ of sensitive information is intended to be closely held and not be publicly\
    \ accessible; however, data leaks and insider attacks have occurred, and thus\
    \ this information can be and has been used by adversaries in their discovery\
    \ tactics."
  detections:
  - component: MNO database access logs  content in core
    detects: Access to IR.21 database should be logged.
    fgdsid: FGDS5009.001
    name: MNO database access logs
  groups: []
  id: FGT1592.501
  mitigations:
  - fgmid: FGM5500
    mitigates: Control access to IR.21 files in GSMA. Host/application hosting this
      file should guard against such leaks.
    name: Restrict Access To Operator OA&M Resources
  name: Internal Resource Search
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: IP addresses of core network functions known to adversary.
    name: Discovered IP addresses of core NFs
  preconditions:
  - description: Adversary needs to access the operator databases or GSMA repositories.
    name: Access to GSMA account; in some cases, none.
  procedureexamples:
  - description: Claro Americas, and Vivo telecom, had their IR.21 database accessible
      from an internet in 2016 (reference no longer available). [1]
    name: IR.21 accessible from the Internet
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
  software: []
  status: Observed
  subtechnique-of: FGT1592
  tactics:
  - TA0043
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: User/NPE/Administrative Access
    campaigns: []
    criticalassets:
    - description: Devices enforcing network segmentation and creating perimeter for
        applications may include firewalls, SDN controllers, or Proxies.
      name: Devices enforcing segmentation controls
    detections:
    - component: Network Traffic Content
      detects: Network Traffic should be monitored for messaging contents to determine
        abnormal activity.
      fgdsid: FGDS0029.002
      name: Network Traffic
    - component: Network Traffic Flow
      detects: Network Traffic should be monitored for traffic flows to determine
        abnormal activity.
      fgdsid: FGDS0029.003
      name: Network Traffic
    groups: []
    mitigations:
    - fgmid: FGM1043
      mitigates: Protect credentials of management entities
      name: Credential Access Protection
    - fgmid: FGM1037
      mitigates: Filter Network Traffic, per protocol
      name: Filter Network Traffic
    - fgmid: FGM1026
      mitigates: Manage accounts for privileged users for the security zones in the
        5G network.
      name: Privileged Account Management
    - fgmid: FGM1032
      mitigates: Enable Multi-factor Authentication for privileged users
      name: Multi-factor Authentication
    - fgmid: FGM1027
      mitigates: Password Policies - follow NIST Guidelines.  This may also include
        token policies if security tokens are used.
      name: Password Policies
    name: "## Addendum Name: Compromise Network Isolation\r\n### Architecture Segments:\
      \ OA&M, Virtualization, Network Slice\r\n An adversary may compromise network\
      \ separation controls to gain access to one or more of the 5G security zones\
      \ or networks.\r\n\r\n5G is a system of systems and may be composed of several\
      \ network and security zones, as well as slices. A compromise of controls placed\
      \ to maintain security zones or network segmentation based on IP networks, application\
      \ groups or slices may allow an adversary to gain unauthorized access to networks\
      \ or services. This may occur at a Core, RAN, Cloud or Slice boundary.\r\n\r\
      \nOnce the adversary has infiltrated the internals of the network, it has ample\
      \ opportunities and a much broader attack surface to explore. The adversary\
      \ can, e.g., conduct privilege escalation and process injection for gaining\
      \ administrative rights, attempt password cracking of valid user accounts on\
      \ the nodes, exploit vulnerabilities in databases and file systems, and take\
      \ advantage of improper configurations of routers and switches.\r\n\r\nThe boundaries\
      \ of a network and its security zones can exist between various technologies,\
      \ such as 4G and 5G, or between different partners, such as private networks,\
      \ mobile operators, or Mobile Virtual Network Operators (MVNOs). These boundaries\
      \ can also exist between different network components, such as radio access,\
      \ core, edge, and cloud, as well as between national or international links\
      \ and operator cores, and service providers or operator cores.\r\n\r\nIn some\
      \ cases, firewalls may be used to separate these zones, such as SS7 protocol,\
      \ Diameter protocol, 5G APIs, enhanced SCP (Service Communication Proxy), IP\
      \ (Internet Protocol), SIP (Session Initiation Protocol), and GTP (GPRS Tunneling\
      \ Protocols) firewalls. Alternatively, an interworking function may be used\
      \ to translate one protocol into another. However, it's important to note that\
      \ privileged access is not always necessary to bypass a firewall or exploit\
      \ an interworking function. Often, insufficient filtering may be the cause,\
      \ or the filtering may not be sufficiently deep."
    platforms:
    - OA&M
    preconditions:
    - description: Privileged access to device implementing the network separation
        controls
      name: Privileged access
    procedureexamples:
    - description: An adversary may impersonate a trusted source (roaming partner
        or VAS) to avoid filtering by firewall, and to transport data in and out of
        the targeted operator's network. ([1])
      name: Impersonate roaming partner/VAS (Value Added Service) provider
    - description: An adversary may abuse the remote service offered for network MANO
        tools, to make configuration changes to SDN flow tables and cause packet filtering
        to not detect flow across boundaries. ([2])
      name: MANO abuse to change SDN (Software Defined Networking) configuration
    references:
    - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling
      framework for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
    - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",  October
      2021](https://arxiv.org/abs/2108.11206)
    software: []
  architecture-segment: OA&M, Virtualization, Network Slice
  bluf: Adversaries may bridge network boundaries by compromising perimeter network
    devices or internal devices responsible for network segmentation.
  campaigns: []
  criticalassets:
  - description: Devices enforcing network segmentation and creating perimeter for
      applications may include firewalls, SDN controllers, or Proxies.
    name: Devices enforcing segmentation controls
  description: 'Adversaries may bridge network boundaries by compromising perimeter
    network devices or internal devices responsible for network segmentation. Breaching
    these devices may enable an adversary to bypass restrictions on traffic routing
    that otherwise separate trusted and untrusted networks. Devices such as routers
    and firewalls can be used to create boundaries between trusted and untrusted networks.
    They achieve this by restricting traffic types to enforce organizational policy
    in an attempt to reduce the risk inherent in such connections. Restriction of
    traffic can be achieved by prohibiting IP addresses, layer 4 protocol ports, or
    through deep packet inspection to identify applications. To participate with the
    rest of the network, these devices can be directly addressable or transparent,
    but their mode of operation has no bearing on how the adversary can bypass them
    when compromised. When an adversary takes control of such a boundary device, they
    can bypass its policy enforcement to pass normally prohibited traffic across the
    trust boundary between the two separated networks without hinderance. By achieving
    sufficient rights on the device, an adversary can reconfigure the device to allow
    the traffic they want, allowing them to then further achieve goals such as command
    and control via [Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003)
    or exfiltration of data via [Traffic Duplication](https://attack.mitre.org/techniques/T1020/001).
    Adversaries may also target internal devices responsible for network segmentation
    and abuse these in conjunction with [Internal Proxy](https://attack.mitre.org/techniques/T1090/001)
    to achieve the same goals.(Citation: Kaspersky ThreatNeedle Feb 2021) In the cases
    where a border device separates two separate organizations, the adversary can
    also facilitate lateral movement into new victim environments.[To read more, please
    see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1599)'
  detections:
  - component: Network Traffic Content
    detects: Network Traffic should be monitored for messaging contents to determine
      abnormal activity.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Network Traffic should be monitored for traffic flows to determine abnormal
      activity.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1599
  mitigations:
  - fgmid: FGM1043
    mitigates: Protect credentials of management entities
    name: Credential Access Protection
  - fgmid: FGM1037
    mitigates: Filter Network Traffic, per protocol
    name: Filter Network Traffic
  - fgmid: FGM1026
    mitigates: Manage accounts for privileged users for the security zones in the
      5G network.
    name: Privileged Account Management
  - fgmid: FGM1032
    mitigates: Enable Multi-factor Authentication for privileged users
    name: Multi-factor Authentication
  - fgmid: FGM1027
    mitigates: Password Policies - follow NIST Guidelines.  This may also include
      token policies if security tokens are used.
    name: Password Policies
  name: Network Boundary Bridging
  object-type: technique
  postconditions:
  - description: If network boundaries are breached, monitoring system may detect
      unusual network flow
    name: Unusual network traffic flows
  - description: Adversary may attempt to discover networks and live hosts on the
      networks
    name: Network mapping activity
  - description: Adversary may attempt connect to hosts in the target network after
      profiling hosts and network mapping.
    name: Connection attempts from unusual hosts
  preconditions:
  - description: Privileged access to device implementing the network separation controls
    name: Privileged access
  procedureexamples:
  - description: An adversary may impersonate a trusted source (roaming partner or
      VAS) to avoid filtering by firewall, and to transport data in and out of the
      targeted operator's network. ([1])
    name: Impersonate roaming partner/VAS (Value Added Service) provider
  - description: An adversary may abuse the remote service offered for network MANO
      tools, to make configuration changes to SDN flow tables and cause packet filtering
      to not detect flow across boundaries. ([2])
    name: MANO abuse to change SDN (Software Defined Networking) configuration
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",  October
    2021](https://arxiv.org/abs/2108.11206)
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_addendum
- access-required: User/NPE/Administrative Access
  architecture-segment: Network Slice, Cloud Service Provider
  bluf: Adversaries may gain unauthorized access to information via a Virtual Network
    Function (VNF) shared for service designed for two different slices.
  campaigns: []
  criticalassets:
  - description: NFVI includes orchestrators, network managers, and network elements.
    name: NFVI
  - description: 5G Core, RAN and NON-SBI functions, virtual resources supporting
      VNF.
    name: VNFs
  - description: Network slice SLA data, some information may be exposed if application
      functions are shared.
    name: Slice Control and User Plane data
  - description: The application related data and sensitive parameters associated
      with a VNF.
    name: VNF application data and sensitive parameters
  description: "Adversaries may gain unauthorized access to information via a Virtual\
    \ Network Function (VNF) shared for service designed for two different slices.\r\
    \n\r\n5G functions deployment and slice creation is supported by NFVI resources.\
    \ Network Function Virtualization Infrastructure (NFVI) can be exploited by compromise\
    \ or abuse of trust on a VNF Orchestrator (VNFO) or VNF Manager (VNFM). An adversary\
    \ may be able to create a network slice (NS) using the VNF (Common VNF) of a target\
    \ Slice or create slice resources that share the NFVI resources of the target\
    \ slice. Malicious co-tenancy activities can lead to unauthorized access to data,\
    \ misuse of resources, or management actions. "
  detections:
  - component: User and resource policy configuration logs in core network
    detects: Audit Policy Violations - Automated user and resource policy compliance
      checks and instrumentation to alert on violation attempts.
    fgdsid: FGDS5023.001
    name: User and resource policy configuration
  - component: Application Log Content
    detects: Audit logs - Auditing logs for security, authentication and authorization
      activity, host access, hosts, virtualization orchestrator and managers can reveal
      behavioral anomalies.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Host Status
    detects: Monitor systems performance.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: Network Traffic Flow
    detects: Monitor network flows.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1599.501
  mitigations:
  - fgmid: FGM1026
    mitigates: Least Privilege Access Control Policy - Access control policies should
      be granular to allow for optimal access to service requirements.
    name: Privileged Account Management
  - fgmid: FGM1035
    mitigates: Resource Policy enforcement -Create and enforce resource policy; policy
      can include SLA, quotas, QOS etc.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Security and Trust zones - Security and trust zones can help isolate
      resources and can be mapped to business needs.Micro and Nano segmentation- Implementing
      segmentation policy at granular level, network and compute resources can prevent
      some co-residency threats when mapped to SLAs, Users, and Resource policies.Physical
      separation - Hardware, network, and point of presence can be separated to provide
      additional isolation.
    name: Network Segmentation
  - fgmid: FGM5505
    mitigates: Hardware Mediated Execution Environment -Employ secure, hardware- based
      execution integrity as part of host/server design.
    name: Hardware Mediated Execution Environment
  - fgmid: FGM1041
    mitigates: Encryption can be used to protect data at rest and in transit.
    name: Encrypt Sensitive Information
  - fgmid: FGM5506
    mitigates: Use of Network Slice Templates - Use of templates for network slicing
      can enforce baseline security and isolation requirements. These templates can
      be created for networks, compute and 5G slice functions deployments.
    name: Network Slice Templates
  name: Malicious Co-Tenancy Exploit Of NFVI (Network Slice)
  object-type: technique
  platforms: OA&M, Virtualization, Slice
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: A legitimate tenant 1 uses the Os-ma-nfvo interface to read the NS
      information of another tenant 2 sharing the NFVO. The tenant 1 may get sensitive
      information on the NS topology for a NS of a competitor (tenant 2).
    name: Create Malicious Co-Tenancy
  - description: A malicious tenant on-boards unused NS/VNF just to consume on-boarding
      resources (e.g. fill the NS and VNF registries or software image repository)
      to limit the space available for other tenant.
    name: Consume on-boarding resources
  - description: A malicious tenant uses the Os-ma-nfvo interface to manage the NSs
      of another tenant. For example, this malicious tenant may scale down the NS
      of a competitor to get more resources for his own NS or scale up to increase
      resource cost of another tenant.
    name: Manipulate network slices of another tenant
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC026: "Isolation and trust domain specification".](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC026_Isolation_and_trust_domain)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1599
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: Network Slice, Cloud Service Provider
  bluf: Adversaries may use a less secure slice to gain access to information in a
    more secure slice that uses the VNF (Common VNF) built on common infrastructure
    to misuse resources allocated to target VNFs or slice.
  campaigns: []
  criticalassets:
  - description: NFVI includes orchestrators, network managers, and network elements
    name: NFVI
  - description: 5G Core, RAN and NON-SBI functions, virtual resources supporting
      VNF
    name: VNFs
  - description: Network slice SLA data, some information may be exposed if application
      functions are shared
    name: Slice Control and User Plane data
  - description: The application related data and sensitive parameters associated
      with a VNF
    name: VNF application data and sensitive parameters
  - description: LI application server manages user activity monitoring requests and
      monitoring set up of the user voice calls, SMS and data
    name: VNF Lawful Interception (LI) data
  description: "Adversaries may use a less secure slice to gain access to information\
    \ in a more secure slice that uses the VNF (Common VNF) built on common infrastructure\
    \ to misuse resources allocated to target VNFs or slice.\r\n\r\nA compromised\
    \ (intentionally or simply misconfigured) VNF instantiated in one slice subnet\
    \ may access resources of another slice subnet. A common Network function Virtualization\
    \ Orchestrator (NFVO) or Virtualized Infrastructure Manager (VIM) without proper\
    \ safeguards may allow an adversary to starve a target slice or VNFs of the resources\
    \ it needs to meet the SLA and to create opportunities information exposure."
  detections:
  - component: Logon Session Metadata
    detects: Audit Policy Violations - Automated user and resource policy compliance
      checks and instrumentation to alert on violation attempts
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Audit logs - Auditing logs for security, authentication and authorization
      activity, host access, hosts, virtualization orchestrator and managers can reveal
      behavioral anomalies
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Host Status
    detects: Monitor systems performance
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: Network Traffic Flow
    detects: Monitor network flows
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT1599.502
  mitigations:
  - fgmid: FGM1026
    mitigates: Least Privilege Access Control Policy - Access control policies should
      be granular to allow for optimal access to service requirements.
    name: Privileged Account Management
  - fgmid: FGM1035
    mitigates: Resource Policy enforcement -Create and enforce resource policy; policy
      can include SLA, quotas, QOS etc.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Security and Trust zones -Security and trust zones can help isolate
      resources and can be mapped to business needs.Micro and Nano segmentation- Implementing
      segmentation policy at granular level, network and compute resources can prevent
      some co-residency threats when mapped to SLAs, Users, and Resource policies.Physical
      separation- Hardware, network, and point of presence can be separated to provide
      additional isolation.
    name: Network Segmentation
  - fgmid: FGM5505
    mitigates: Hardware Mediated Execution Environment -Employ secure, hardware- based
      execution integrity as part of host/server design
    name: Hardware Mediated Execution Environment
  - fgmid: FGM1041
    mitigates: Encryption can be used to protect data at rest and in transit
    name: Encrypt Sensitive Information
  - fgmid: FGM5506
    mitigates: Use of Network Slice Templates -Use of templates for network slicing
      can enforce baseline security and isolation requirements.  These templates can
      be created for networks, compute and 5G slice functions deployments.
    name: Network Slice Templates
  name: Network Slice Infrastructure Resource Hijacking
  object-type: technique
  platforms: Slice, CSP
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: If a service provider uses network slicing and creates two slice
      subnets by creating network service instances on the same NFV environment (i.e.
      the same NFVO and functional blocks) and thus being built with resources of
      the same NFVI-PoP(s), this may lead to unauthorized access to resources/data
      of another slice.
    name: Use of common virtual orchestrators and infrastructure managers
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC026 Isolation and trust domain specification,
    section 4.2.3](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC026_Isolation_and_trust_domain)
  software: []
  status: Theoretical
  subtechnique-of: FGT1599
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: User Plane
  bluf: An adversary-controlled UE may be used to send a GTP-U packet to UPF/PGW-U
    with a malicious payload in order to evade UPF/PGW-U routing controls to establish
    communications with a core NF.
  campaigns: []
  criticalassets:
  - description: Core control plane NF is illegitimately accessed from the UE via
      user plane function UPF/PGW-U.
    name: Core network functions
  description: "An adversary-controlled UE may be used to send a GTP-U packet to UPF/PGW-U\
    \ with a malicious payload in order to evade UPF/PGW-U routing controls to establish\
    \ communications with a core NF.\r\n\r\nThe UPF/PGW-U is the core network function\
    \ supporting the user plane. It tunnels user data packets from the radio access\
    \ networks (gNB/eNB) towards data networks (such as the Internet). Other core\
    \ network functions (NFs) - such as the Session Management Function (SMF) - support\
    \ the control plane. In this threat, a user plane packet crosses over to the control\
    \ plane. \r\n\r\nThe UPF/PGW-U normally processes GTP-U packets to and from the\
    \ radio access network (gNB/eNB). A GTP-U packet, after the header is stripped,\
    \ should contain a regular user data IP packet, with UE's address as the source\
    \ IP address, and an external (Internet) address as the destination IP address.\
    \ However, in this case, it contains a control packet with the destination address\
    \ of a core network function for instance the SMF. The UPF/PGW-U should then drop\
    \ this packet, but in some implementations it was found that the UPF/PGW-U may\
    \ instead route it as indicated.\r\n\r\nThus, if UPF/PGW-U does not do proper\
    \ parameter checks, it may route the packet to an improper destination such as\
    \ a core network function in the control plane e.g. AMF or SMF, it can cause the\
    \ NF to go to an undefined state and the NF may crash."
  detections:
  - component: Network Traffic Content
    detects: Examine all header fields and encapsulated payload of user plane packets
      received by UPF/PGW-U in the uplink direction from UE.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1599.505
  mitigations:
  - fgmid: FGM5509
    mitigates: Do not allow any packets received from UE which has destination address
      set to a core NF's IP address.
    name: Screen Signaling And User Plane Messages
  name: GTP-U Abuse
  object-type: technique
  platforms: Core
  postconditions:
  - description: Core control plane network function is DoS'ed by adversary-controlled
      UE from the user plane.
    name: Core network functions impacted
  preconditions:
  - description: A COTS UE or SDR UE running open-source software can be used to prepare
      specially crafted GTP-U packets to be sent towards UPF/PGW-U.
    name: Compromise a UE
  procedureexamples:
  - description: This is a UP to CP cross-over or network boundary bridging behavior.
      A specially crafted GTP-U packet containing a control plane packet is sent by
      the adversary controlled UE to the UPF/PGW-U, e.g. a tunneled GTP-U packet can
      be sent to trick the UPF/PGW-U. The payload packet contains the AMF address
      as the destination IP and an invalid NGAP message.Without proper parameter validation,
      UPF/PGW-U may send the GTP-U payload to the destination address in the control
      plane i.e. AMF in this case. AMF parses the NGAP message and it crashes the
      AMF. [1]
    name: Core NF is targeted from UE using tunneled GTP-U packets via UPF/PGW-U
  references:
  - '<a name="1"> \[1\] </a> [Trendmicro article: "Attacks on 5G Infrastructure From
    User Devices: ASN.1 Vulnerabilities in 5G Cores".](https://www.trendmicro.com/en_us/research/23/j/asn1-vulnerabilities-in-5g-cores.html)'
  software: []
  status: Observed
  subtechnique-of: FGT1599
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may compromise a network device's encryption capability in order
    to bypass encryption that would otherwise protect data communications.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may compromise a network device''s encryption capability
    in order to bypass encryption that would otherwise protect data communications.
    (Citation: Cisco Synful Knock Evolution) Encryption can be used to protect transmitted
    network traffic to maintain its confidentiality (protect against unauthorized
    disclosure) and integrity (protect against unauthorized changes). Encryption ciphers
    are used to convert a plaintext message to ciphertext and can be computationally
    intensive to decipher without the associated decryption key. Typically, longer
    keys increase the cost of cryptanalysis, or decryption without the key. Adversaries
    can compromise and manipulate devices that perform encryption of network traffic.
    For example, through behaviors such as [Modify System Image](https://attack.mitre.org/techniques/T1601),
    [Reduce Key Space](https://attack.mitre.org/techniques/T1600/001), and [Disable
    Crypto Hardware](https://attack.mitre.org/techniques/T1600/002), an adversary
    can negatively effect and/or eliminate a device''s ability to securely encrypt
    network traffic. This poses a greater risk of unauthorized disclosure and may
    help facilitate data manipulation, Credential Access, or Collection efforts. (Citation:
    Cisco Blog Legacy Device Attacks)[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1600)'
  detections: []
  groups: []
  id: FGT1600
  mitigations: []
  name: Weaken Encryption
  object-type: technique
  platforms: Network
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: attack_technique_with_fight_subs
- access-required: None
  architecture-segment: RAN, O-RAN, Control Plane, User Plane
  bluf: An adversary may alter network signaling or configuration so as to disable
    encryption over the radio interface, thus allowing for eavesdropping of user data
    or signaling on that interface.
  campaigns: []
  criticalassets:
  - description: UE user plane data privacy.
    name: UE data
  - description: UE signaling plane data privacy.
    name: UE signaling
  description: "An adversary may alter network signaling or configuration so as to\
    \ disable encryption over the radio interface, thus allowing for eavesdropping\
    \ of user data or signaling on that interface.\r\n\r\nThe protection of the radio\
    \ interface link is chosen by the network when the User Equipment (UE) first registers\
    \ to the network. Normally, all data and signaling are encrypted. However, under\
    \ some circumstances (e.g. emergency calls, when the UE is not registered in the\
    \ serving network), no encryption keys can be derived and so no encryption is\
    \ applied-in this case the algorithm is called NULL. \r\n\r\nSeveral procedures\
    \ and interfaces can be implemented incorrectly or misused and may result in use\
    \ of the NULL encryption algorithm to protect user signaling -- Non-Access Stratum\
    \ (NAS) or Access Stratum (AS) Control Plane (CP) -- ; or user data -- AS User\
    \ Pane (UP) -- over the radio interface. These can be followed by another adversarial\
    \ behavior whereby eavesdropping can be done over the air interface for data and\
    \ signaling."
  detections:
  - component: Network Traffic Content
    detects: Inspect traffic on radio interface and watch for unauthorized changes
      as the packets move through the interface.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Application Log Content
    detects: Audit configuration changes in gNB, SMF, AMF by OSS/BSS.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: gNB log content for NULL encryption use
    detects: Monitor gNB logs when NULL scheme is enabled/used for SUCI protection.
    fgdsid: FGDS5017.001
    name: gNB or 5G core logs
  - component: Core network log content for NULL encryption use
    detects: Monitor core network logs when NULL scheme is enabled/used for SUCI protection.
    fgdsid: FGDS5017.002
    name: gNB or 5G core logs
  - component: Provisioning logs in core
    detects: Monitor provisioning logs for changes in home network public key configuration,
      e.g. allowing NULL encryption of the SUPI.
    fgdsid: FGDS5017.007
    name: gNB or 5G core logs
  - component: UE operations logs in core
    detects: Monitor network-side operations logs for UE making an emergency call.
    fgdsid: FGDS5019.001
    name: UE operations logs in core
  groups: []
  id: FGT1600.501
  mitigations:
  - fgmid: FGM1041
    mitigates: Ensure gNB implementation and SMF implementations are both checking
      the UE CP and UP security policy against the most trustworthy source (SMF in
      case of the gNB, and UDM in case of the SMF), and taking action to not enable
      NULL encryption except for emergency calls.
    name: Encrypt Sensitive Information
  - fgmid: FGM1018
    mitigates: Network element security safeguards for gNBs, AMFs and SMFs. Include
      measures in clause 5.3.4 of [2] for gNBs e.g. OA&M user access security.
    name: User Account Management
  - fgmid: FGM1051
    mitigates: Network element security safeguards for gNBs, AMFs and SMFs. Include
      measures in clause 5.3.4 of [2] for gNBs e.g. software updates.
    name: Update Software
  - fgmid: FGM1046
    mitigates: Network element security safeguards for gNBs, AMFs and SMFs. Include
      measures in clause 5.3.4 of [2] for gNBs e.g. secure boot.
    name: Boot Integrity
  - fgmid: FGM1031
    mitigates: Implement network intrusion prevention methods.
    name: Network Intrusion Prevention
  - fgmid: FGM1043
    mitigates: Implement credential access protection methods. Guarding access to
      the credentials of administrators who are allowed to make configuration changes
      to the gNB reduces the risk of compromise of the gNB component(s) due to an
      adversary gaining control of valid credentials. If an adversary takes over a
      gNB, then they could change the configuration of the gNB to allow for NULL encryption
      as default on the radio interface.
    name: Credential Access Protection
  - fgmid: FGM1032
    mitigates: Requiring MFA for administrators who are allowed to make configuration
      changes to the gNB reduces the risk of compromise of the gNB component(s) due
      to an adversary gaining control of valid credentials. If an adversary takes
      over a gNB, then they could change the configuration of the gNB to allow for
      NULL encryption as default on the radio interface.
    name: Multi-factor Authentication
  name: Radio Interface
  object-type: technique
  platforms: RAN
  postconditions:
  - description: 'Control Plane: All UE signaling data may be revealed if both NAS
      and AS CP (RRC) security algorithms are weakened.User Plane: Subscriber (user
      plane) data may be revealed if AS UP security algorithms are weakened.'
    name: UE data unprotected on air interface
  preconditions:
  - description: A rogue gNB may be required to change the UE's CP and UP supported
      algorithms to NULL. It's easier to achieve control over a gNB than over the
      AMF or SMF itself. But then if the AMF and SMF are not rogue, just not configured
      to do these additional checks, then control over a rogue gNB is sufficient.This
      behavior is possible with only control over the AMF, in which case the algorithm
      for CP and UP protection is changed to NULL.
    name: Rogue or misconfigured AMF or SMF or gNB
  procedureexamples:
  - description: Adversary (e.g. with false gNB) intentionally configures NULL encryption
      algorithm to have highest priority in gNB. These algorithms are sent to the
      UE in the (Access Stratum) AS Security Mode Command. Normally the activation
      of algorithms for the AS is done by the gNB based on that policy received from
      the SMF, but a false gNB can ignore the SMF. Clauses 6.7.3 & D.1 of [2].Adversary
      with control over a legitimate gNB, and who currently serves the UE, tells the
      SMF that the UE Control Plane (CP) and User Plane (UP) policy is NULL encryption,
      and the (legitimate but not correctly implemented) SMF doesn't check that against
      the locally-stored UE UP policy and lets the CP and UP data be transmitted with
      NULL encryption. Clause 6.6.1 of [2].
    name: False or misconfigured base station
  - description: Adversary makes the unauthorized change in the SMF CP and UP local
      policy to enable NULL encryption for CP & UP traffic.Alternatively, adversary
      exploits an SMF that is not implemented to check (for every UE it serves) that
      the algorithm received from gNB (which may be compromised or false) matches
      the (more trusted) local policy. That local policy in turn should be checked
      that it is the same as the UE policy stored in the UDM, which has the higher
      trust. Any of these failures can result in the SMF enabling the CP and UP traffic
      over the radio interface to use NULL encryption.
    name: Rogue or misconfigured Session Management Function (SMF)
  - description: Adversary with control over AMF (or by misconfiguration of AMF) can
      affect UE procedures such as NAS Security Mode Command, such that the UE's NAS
      data is not protected, i.e. prioritize NULL algorithm for either NAS encryption
      or integrity. This can be followed by another behavior whereby eavesdropping
      can be done over the air interface for data and signaling. Clauses 5.3.2 and
      5.5.1 of [2].
    name: Rogue or misconfigured Access and Mobility Management Function (AMF) non-roaming
  - description: Compromised source AMF sends incorrect UE context information to
      legitimate target AMF during either (a) Initial registration and roaming or
      (b) Handover (N2 based). The source AMF sends NULL encryption algorithm information
      as part of the "UEContextTransfer" (initial registration and roaming) or "CreateUEContext"
      (N2 handover) service request messages. All UE data will be sent in clear text
      after registration or handover is completed. Clauses 4.2.2.2, 4.9.1.3.1 and
      5.2.2.1 of [3]. The rogue AMF sets CP and UP security algorithms in UE security
      capabilities to NULL only.
    name: Rogue or misconfigured AMF during roaming/handover
  - description: Compromised source MME sends incorrect UE context information to
      legitimate target AMF during EPS to 5GS handover and roaming with and without
      N26 interface.Source MME sends NULL encryption algorithm information as part
      of the EPS security context to target AMF. All UE data will be sent in clear
      text after roaming or handover is completed. Clauses 4.11.1.2.2.2, 4.11.1.3.3,
      4.11.2.3 and 5.2.2.1 of [3], 8.4 of [2]. The rogue MME sets CP and UP security
      algorithms in UE security capabilities to NULL only.
    name: Rogue or misconfigured MME during EPS to 5GS roaming/handover
  references:
  - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes".](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System".](https://www.3gpp.org/DynaReport/33501.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TS 23.502: "Procedures for the 5G System (5GS)".](https://www.3gpp.org/DynaReport/23502.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1600
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: Control Plane, User Plane
  bluf: An adversary may weaken or disable encryption on Non-SBI, SBI, and roaming
    interfaces, enabling eavesdropping on user data or signaling.
  campaigns: []
  criticalassets:
  - description: Any of the subscriber data sourced or destined to the UE.
    name: UE data
  - description: Any of the signaling traffic between UE and network.
    name: UE signaling
  description: "An adversary may weaken or disable encryption on Non-SBI, SBI, and\
    \ roaming interfaces, enabling eavesdropping on user data or signaling.\r\n\r\n\
    The following Network interfaces are in the scope of this document.\r\n\r\n1.\
    \ \"Non-SBI\" network interfaces are within 5G core network and the Radio Access\
    \ Network (RAN), and between the RAN and the 5G Core (e.g. N2, N3, N4, Xn). \r\
    \n\r\n2. SBI network interfaces are between core Network Functions (NFs) within\
    \ an operator network; they use REST APIs.\r\n\r\n3. Roaming and interconnect\
    \ interfaces, including IPX, are between network operators (between Security Edge\
    \ Protection Proxies (SEPPs) (N32), or other interworking functions like Access\
    \ and Mobility Management (AMF/MME) (N26) and between User Plane Functions (UPFs)\
    \ owned by different network operators (N9)).\r\n\r\nAn adversary with control\
    \ over gNB, AMF, UPF or SMF may disable IPSec on non-SBI interfaces (Xn, N2, N3,\
    \ N4). IPSec is expected to be used to protect all non-SBI links, however, unlike\
    \ radio communications, operator RAN to core communications are not mandated to\
    \ actually run encryption protection. \r\n\r\nAn adversary with access to the\
    \ SBI links, with control over one or more core network functions (NFs) or a middlebox\
    \ (including the Service Communication Proxy (SCP) if deployed), may disable use\
    \ of TLS or use older TLS version such as v1.1. TLS is required by 3GPP standards\
    \ to be used to protect all SBI links within the operator core network. \r\n\r\
    \nAn adversary with control over roaming nodes or interfaces- namely SEPP or IPX\
    \ network-- may disable or cause to use a weak encryption algorithm for TLS or\
    \ JWE encryption on the N32 interface. An adversary with control over visited\
    \ network UPF may disable IPSec on the N9 interface or a compromised MME or AMF\
    \ may disable IPSec on N26 interface."
  detections:
  - component: Application Log Content
    detects: Check configuration changes in gNB and all core NFs; Configuration audits
      by OSS/BSS.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Content
    detects: Inspect network traffic and watch for unauthorized changes.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT1600.502
  mitigations:
  - fgmid: FGM1041
    mitigates: Ensure strong encryption is used in all non-SBI, SBI and roaming/interconnect
      interfaces. That is, TLS (not version 1.1) should be used in all SBI, N32-c
      and N32-f ; in addition, PRINS should be used on N32-f when TLS is not used.
    name: Encrypt Sensitive Information
  - fgmid: FGM1018
    mitigates: Network element security safeguards for gNB and all core NFs.
    name: User Account Management
  - fgmid: FGM1051
    mitigates: Update software for gNB and all core NFs.
    name: Update Software
  - fgmid: FGM1046
    mitigates: Secure boot safeguards for gNB and all core NFs.
    name: Boot Integrity
  - fgmid: FGM1031
    mitigates: Implement network intrusion prevention methods.
    name: Network Intrusion Prevention
  - fgmid: FGM1043
    mitigates: Implement strong credential access protection methods.
    name: Credential Access Protection
  name: Network Interfaces
  object-type: technique
  platforms: 5G RAN, 5G Core, Interconnect
  postconditions:
  - description: 'Control Plane: All UE signaling data may be revealed if IPSec and
      TLS are disabled.User Plane: Subscriber (user plane) data may be revealed if
      IPSec is disabled. UE CP & UP data can be sniffed.See [FGT1040 - Network Sniffing](/techniques/FGT1040/)'
    name: UE data unprotected on network interfaces
  preconditions:
  - description: Adversary must have access to the network components to cause the
      attacks.
    name: Rogue or misconfigured AMF/MME, SMF, gNB or UPF, or SEPP or any other core
      NF
  procedureexamples:
  - description: A rogue or misconfigured gNB can disable IPSec encryption or use
      a weak IPSec encryption algorithm on backhaul interfaces such as N2, N3 and
      Xn. This can be used to launch other attacks. Clause D.2.2 of [1], clause 5.3.2
      of [2].
    name: Compromised or misconfigured gNB
  - description: A rogue or misconfigured AMF can disable IPSec encryption or use
      a weak IPSec encryption algorithm on N2 and N26 interfaces. This can be used
      to launch other attacks. Clause K.2.1 of [1], clause 5.5.1 of [2].
    name: Compromised or misconfigured AMF
  - description: A rogue or misconfigured UPF can disable IPSec encryption or use
      a weak IPSec encryption algorithm on N3, N4 and N9 interfaces. This can be used
      to launch other attacks. Clause L.2.1 of [1], clauses 9.3 and 9.9 of [2].
    name: Compromised or misconfigured UPF
  - description: A rogue or misconfigured SMF can disable IPSec encryption or use
      a weak IPSec encryption algorithm on N4 interface. This can be used to launch
      other attacks. Clause 9.9 of [2].
    name: Compromised or misconfigured SMF
  - description: A rogue or misconfigured NF can disable the TLS encryption or use
      a weak TLS encryption algorithm to another NF including the SCP. Then it can
      launch other attacks to gain unauthorized access to network services. Clause
      13.1 of [2].If SCP is rogue or misconfigured, it can force TLS connections to
      all NFs to be unencrypted or use weak encryptions for all. Clause 5.9.2.4 of
      [2].
    name: Compromised or misconfigured NF
  - description: A rogue or misconfigured SEPP can disable TLS encryption or use a
      weak TLS encryption algorithm on N32-c interface or N32-f interface or both.A
      rogue or misconfigured SEPP can disable JWE encryption or use a weak encryption
      algorithm when the PRINS algorithm is used on N32-f. Then it can launch other
      attacks. Clauses 9.9, 13.1 and 13.2 of [2].
    name: Compromised or misconfigured SEPP or IPX component
  - description: A rogue or misconfigured AMF/MME can disable IPSec encryption or
      use a weak IPSec encryption algorithm on N26 interface. Then it can launch other
      attacks. Clause K.2.1 of [1], 8.4 of [2].
    name: Compromised or misconfigured MME/AMF
  references:
  - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes".](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System".](https://www.3gpp.org/DynaReport/33501.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1600
  tactics:
  - TA0005
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: None
    campaigns: []
    criticalassets: []
    detections: []
    groups: []
    mitigations: []
    name: "## Addendum Name: Rogue Operator Network\r\n### Architecture Segments:\
      \ RAN, Control Plane\r\n An adversary may install or set up a customized core\
      \ mobile network in a target environment to enable follow-on behaviors.\r\n\r\
      \nAn adversary may install, or otherwise set up a 5G core network capability\
      \ that can be used during targeting. To support their operations, an adversary\
      \ will likely obtain this capability (e.g. from open source software), and then\
      \ proceed to stage it on a server (COTS) under their control. For a complete\
      \ mobile network set-up, a radio access network (e.g. fake base station) would\
      \ also be used, connected to this core network."
    platforms:
    - 5G Core
    preconditions: []
    procedureexamples: []
    references:
    - '<a name="1"> \[1\] </a> [M.Grassi & X. Chen, "Over The Air Baseband Exploit:
      Gaining Remote Code Execution on 5G Smartphones," retrieved May 16, 2023](https://dl.acm.org/doi/abs/10.1145/3395351.3399360)'
    software: []
  architecture-segment: Control Plane, RAN
  bluf: Adversaries may upload, install, or otherwise set up capabilities that can
    be used during targeting.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may upload, install, or otherwise set up capabilities
    that can be used during targeting. To support their operations, an adversary may
    need to take capabilities they developed ([Develop Capabilities](https://attack.mitre.org/techniques/T1587))
    or obtained ([Obtain Capabilities](https://attack.mitre.org/techniques/T1588))
    and stage them on infrastructure under their control. These capabilities may be
    staged on infrastructure that was previously purchased/rented by the adversary
    ([Acquire Infrastructure](https://attack.mitre.org/techniques/T1583)) or was otherwise
    compromised by them ([Compromise Infrastructure](https://attack.mitre.org/techniques/T1584)).
    Capabilities may also be staged on web services, such as GitHub or Pastebin, or
    on Platform-as-a-Service (PaaS) offerings that enable users to easily provision
    applications.(Citation: Volexity Ocean Lotus November 2020)(Citation: Dragos Heroku
    Watering Hole)(Citation: Malwarebytes Heroku Skimmers)(Citation: Netskope GCP
    Redirection)(Citation: Netskope Cloud Phishing) Staging of capabilities can aid
    the adversary in a number of initial access and post-compromise behaviors, including
    (but not limited to): * Staging web resources necessary to conduct [Drive-by Compromise](https://attack.mitre.org/techniques/T1189)
    when a user browses to a site.(Citation: FireEye CFR Watering Hole 2012)(Citation:
    Gallagher 2015)(Citation: ATT ScanBox) * Staging web resources for a link target
    to be used with spearphishing.(Citation: Malwarebytes Silent Librarian October
    2020)(Citation: Proofpoint TA407 September 2019) * Uploading malware or tools
    to a location accessible to a victim network to enable [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105).(Citation:
    Volexity Ocean Lotus November 2020) * Installing a previously acquired SSL/TLS
    certificate to use to encrypt command and control traffic (ex: [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002)
    with [Web Protocols](https://attack.mitre.org/techniques/T1071/001)).(Citation:
    DigiCert Install SSL Cert)[To read more, please see the MITRE ATT&CK page for
    this technique](https://attack.mitre.org/techniques/T1608)'
  detections: []
  groups: []
  id: FGT1608
  mitigations: []
  name: Stage Capabilities
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi & X. Chen, "Over The Air Baseband Exploit:
    Gaining Remote Code Execution on 5G Smartphones," retrieved May 16, 2023](https://dl.acm.org/doi/abs/10.1145/3395351.3399360)'
  software: []
  status: Theoretical
  tactics:
  - TA0042
  typecode: attack_technique_addendum
- access-required: None
  architecture-segment: RAN
  bluf: An adversary may obtain software to configure a false base station (gNB or
    gNB emulator) or WiFi access point in order to enable other Radio Access Network
    (RAN) follow-on behaviors against UEs such as adversary in the middle or denial
    of service.
  campaigns: []
  criticalassets:
  - description: The UE is the primary target in this scenario, as it is vulnerable
      to being misled into connecting to a false base station.
    name: UE
  description: "An adversary may obtain software to configure a false base station\
    \ (gNB or gNB emulator) or WiFi access point in order to enable other Radio Access\
    \ Network (RAN) follow-on behaviors against UEs such as adversary in the middle\
    \ or denial of service.\r\n\r\nAn adversary enables the programmability of a false\
    \ base station, for example its broadcast configuration is adjustable so that\
    \ it can broadcast the local PLMN Identifier, a particular cell ID, etc. In addition,\
    \ the transmit power of the base station \r\n\r\nis adjustable so that it will\
    \ be higher than the legitimate base stations nearby, so as to succeed in luring\
    \ UEs to connect to it."
  detections:
  - component: Signals sent by UEs
    detects: UE measurements of received power levels from all base stations nearby,
      and their identifiers. Refer to clause 6.24 of [2].
    fgdsid: FGDS5002.001
    name: Radio interface
  groups: []
  id: FGT1608.501
  mitigations:
  - fgmid: FGM0947
    mitigates: Implement robust mutual authentication, secure broadcast configurations,
      periodic integrity checks, and anomaly detection mechanisms to prevent unauthorized
      connections to false base stations. Regular audits, geolocation verification,
      and tamper-resistant hardware can further enhance security against adversary
      manipulation of RAN components.
    name: Audit
  - fgmid: FGM5002
    mitigates: Implement User Equipment (UE) rejection policy e.g. RRC signaling such
      as RRC Release with Redirect info, if not integrity protected.
    name: Discard RAN Signaling Received Without Integrity Protection
  name: Configurability Of False Base Station Or Access Point
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: User Equipment (UE) is successfully lured into connecting to the
      false base station, enabling follow-on behaviors.
    name: Lured UE
  preconditions:
  - description: The adversary has access to software or tools capable of configuring
      a false base station or WiFi access point with adjustable broadcast settings
      and transmit power.
    name: False Base station
  procedureexamples:
  - description: 'Adversary obtains software capability such as: modified custom code,
      scripts, configuration parameters.'
    name: Obtain capability for configuration of gNB, gNB emulator, or WiFi access
      point.
  - description: Adversary installs an illegitimate complete gNB and configures the
      power so as to appear strongest to a given UE in a particular location, see
      [2].
    name: Configure false gNB to appear strongest
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TR 33.809:
    "Study on 5G security enhancements against False Base Stations (FBS)", Technical
    Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1608
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- access-required: None
  architecture-segment: Control Plane
  bluf: An adversary may operationalize a customized mobile network in a target environment
    to enable other follow-on behaviors against UEs.
  campaigns: []
  criticalassets:
  - description: UEs that are lured to connect to a fake network may lose functionality.
      The registration signaling will likely fail in the end.
    name: UE functionality
  description: "An adversary may operationalize a customized mobile network in a target\
    \ environment to enable other follow-on behaviors against UEs.\r\n\r\nAn adversary\
    \ enables the programmability of a rogue mobile network, in order to be able to\
    \ connect a victim UE to a hostile/fake operator network. This is software that\
    \ can run on a single piece of hardware. To configure it, the configuration files\
    \ would need to be updated: configure PLMN identifiers, radio frequency spectrum,\
    \ IP addresses for core components. Configuration for connecting to one or more\
    \ radio access nodes (e.g. base station) may also be done.\r\n\r\nThis technique\
    \ is to be used in conjunction with the equivalent technique for fake base station\
    \ FGT1608.501. "
  detections: []
  groups: []
  id: FGT1608.502
  mitigations: []
  name: Configure Operator Core Network
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: 'Adversary obtains software capability such as: open source software
      (e.g Open5GS, free5GC) to set up a rogue operator network, with sufficient capability
      to achieve follow-on behavior.'
    name: Obtain capability for configuration of a rogue mobile network core
  references:
  - '<a name="1"> \[1\] </a> [M.Grassi & X. Chen, "Over The Air Baseband Exploit:
    Gaining RemoteCode Execution on 5G Smartphones," retrieved May 16, 2023](https://dl.acm.org/doi/abs/10.1145/3395351.3399360)'
  software: []
  status: Theoretical
  subtechnique-of: FGT1608
  tactics:
  - TA0042
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may abuse a container administration service to execute commands
    within a container.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may abuse a container administration service to execute
    commands within a container. A container administration service such as the Docker
    daemon, the Kubernetes API server, or the kubelet may allow remote management
    of containers within an environment.(Citation: Docker Daemon CLI)(Citation: Kubernetes
    API)(Citation: Kubernetes Kubelet) In Docker, adversaries may specify an entrypoint
    during container deployment that executes a script or command, or they may use
    a command such as <code>docker exec</code> to execute a command within a running
    container.(Citation: Docker Entrypoint)(Citation: Docker Exec) In Kubernetes,
    if an adversary has sufficient permissions, they may gain remote execution in
    a container in the cluster via interaction with the Kubernetes API server, the
    kubelet, or by running a command such as <code>kubectl exec</code>.(Citation:
    Kubectl Exec Get Shell)[To read more, please see the MITRE ATT&CK page for this
    technique](https://attack.mitre.org/techniques/T1609)'
  detections: []
  groups: []
  id: FGT1609
  mitigations: []
  name: Container Administration Command
  object-type: technique
  platforms: Containers
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0006
  - TA0007
  typecode: attack_technique_with_fight_subs
- access-required: User/NPE/Administrative Access, Compromised Keys/tokens
  architecture-segment: OA&M, Virtualization
  bluf: An adversary may use an NFVI controller to gain access to data from a suspended
    or stopped VNF to extract sensitive information.
  campaigns: []
  criticalassets:
  - description: Container and container engine may expose privileged information
      to adversary directly from process or thru container engine.
    name: Container, Container engine
  - description: In Container management architecture (Kubernetes for example) adversary
      may use Kublet commands or API proxy to gain access to information and control
      of the container.
    name: Container Management Controller system
  - description: VNF application data including credentials, including 5G VNFs and
      SDN VNFs.
    name: VNF application data
  description: "An adversary may use an NFVI controller to gain access to data from\
    \ a suspended or stopped VNF to extract sensitive information.\r\n\r\nA container\
    \ administration service such as the Docker daemon, the Kubernetes API server,\
    \ or the kubelet may allow remote management of containers within an environment.\
    \ An unauthorized access to terminated/suspended VNF in NFVI can expose data not\
    \ erased from a state change process. This may include virtual resources released\
    \ from a terminated VNF or from a VNF that has released resources after a move\
    \ or a scaling process. This may also enable inclusion of concealed software in\
    \ NFVI to prevent the deletion/erasure of data and states of the VNF that has\
    \ been terminated. Data may include application data, cryptographic keys (service\
    \ accounts)."
  detections:
  - component: Kernel Module Load
    detects: Kernel executing unknow processes or unauthorized processes not typical
      of the host.
    fgdsid: FGDS0008.001
    name: Kernel
  - component: OS API Execution
    detects: Active processes or process log may reveal unauthorized activity due
      to rootkits
    fgdsid: FGDS0009.001
    name: Process
  - component: Host Status
    detects: Degraded performance; system may have reboots, or unexpected performance
      degradation, may be slow to respond to inputs.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: Service Creation
    detects: Background services not typically associated with the host
    fgdsid: FGDS0019.001
    name: Service
  - component: File Modification
    detects: File changes of any sort that cannot be traced back to authorized change.
    fgdsid: FGDS0022.005
    name: File
  - component: Container Start
    detects: 'Activation or invocation of a container (ex: docker start'
    fgdsid: FGDS0032.003
    name: Container
  groups: []
  id: FGT1609.501
  mitigations:
  - fgmid: FGM1038
    mitigates: Use read-only containers, read-only file systems, and minimal images
      when possible to prevent the execution of commands.
    name: Execution Prevention
  - fgmid: FGM1035
    mitigates: Limit communications with the container service to local Unix sockets
      or remote access via SSH. Require secure port access to communicate with the
      APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes
      API Server
    name: Limit Access To Resource Over Network
  - fgmid: FGM1026
    mitigates: In Kubernetes environments, consider defining a Pod Security Policy
      that prevents pods from running privileged containers
    name: Privileged Account Management
  - fgmid: FGM1018
    mitigates: Enforce authentication and role-based access control on the container
      service to restrict users to the least privileges required.
    name: User Account Management
  name: Accessing Terminated VNF
  object-type: technique
  platforms: CI/CD, OA&M, Virtual infrastructure orchestrator
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Peirates can use kubectl or the Kubernetes API to run commands.
    name: Kubectl
  - description: Siloscape can send kubectl commands to victim clusters through an
      IRC channel and can run kubectl locally to spread once within a victim cluster.
    name: Kubectl via IRC channels
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC025, Secure End-to-End VNF and NS management
    specificationRelease 4, section 4.4.6, accessed 6/28/2022](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC025_Secure_E2E_VNF_&_NS_management/NFV-SEC025v0012.zip)
  software: []
  status: Theoretical
  subtechnique-of: FGT1609
  tactics:
  - TA0006
  - TA0007
  typecode: fight_subtechnique_to_attack_technique
- addendums:
  - access-required: User, Administrator
    campaigns: []
    criticalassets:
    - description: Any capabilities deployed as VNF or CNF
      name: VNF, CNF
    - description: Host OS, VM host server becomes a bridging device between tenant
        VMs and Containers if compromised
      name: VM, Container host
    - description: In addition to application data exposure, credential exposure is
        usually a key target for adversary to open the doors for many other exploits.
      name: Credentials
    detections:
    - component: Process Creation
      detects: Monitor process creation and OS API execution activity. Monitor for
        process activity (such as unexpected processes spawning outside a container
        and/or on a host) that might indicate an attempt to escape from a privileged
        container to host.
      fgdsid: FGDS0009.003
      name: Process
    - component: Container Creation
      detects: Monitor for the deployment of suspicious or unknown container images
        and pods in your environment, particularly containers running as root.
      fgdsid: FGDS0032.001
      name: Container
    - component: Volume Creation
      detects: 'Initial construction of a cloud volume (ex: AWS'
      fgdsid: FGDS0034.001
      name: Volume
    - component: Volume Deletion
      detects: 'Removal of a cloud volume (ex: AWS delete-volume)'
      fgdsid: FGDS0034.002
      name: Volume
    - component: Volume Enumeration
      detects: An extracted list of available volumes within
      fgdsid: FGDS0034.003
      name: Volume
    - component: Volume Metdata
      detects: Contextual data about a cloud volume and activity around it, such as
        id, type, state, and size
      fgdsid: FGDS0034.004
      name: Volume
    - component: Volume Modification
      detects: 'Changes made to a cloud volume, including its settings and control
        data (ex: AWS modify-volume)'
      fgdsid: FGDS0034.005
      name: Volume
    groups:
    - description: TeamTNT has deployed privileged containers that mount the filesystem
        of victim machine
      fggid: G0139
      name: TeamTNT
    mitigations:
    - fgmid: FGM1048
      mitigates: Consider utilizing seccomp, seccomp-bpf, or a similar solution that
        restricts certain system calls such as mount. In Kubernetes environments,
        consider defining a Pod Security Policy that limits container access to host
        process namespaces, the host network, and the host file system
      name: Application Isolation And Sandboxing
    - fgmid: FGM1038
      mitigates: Use read-only containers, read-only file systems, and minimal images
        when possible, to prevent the running of commands.
      name: Execution Prevention
    - fgmid: FGM1026
      mitigates: 'Rootless containers: Ensure containers are not running as root by
        default. In Kubernetes environments, consider defining a Pod Security Policy
        that prevents pods from running privileged containers.'
      name: Privileged Account Management
    name: "## Addendum Name: VM And Container Breakout\r\n### Architecture Segments:\
      \ Virtualization, OA&M\r\n Adversary may be able to break out of VM/Container\
      \ to host to compromise co-resident tenant VM/Container for discovery and exfiltration\
      \ and host-based privilege escalation.\r\n\r\nVM guest OS may escape from its\
      \ VM encapsulation to interact directly with the hypervisor. This gives the\
      \ adversary access to all VMs and, if guest privileges are high enough, the\
      \ host machine as well. Although a few instances are known, experts consider\
      \ VM escape to be the most serious threat to VM security.\r\n\r\nSimilarly,\
      \ a container may also create privileged access to Host file system or execution\
      \ environment.\r\n\r\n5G deployments may include PNFs as well as VNFs. VNFs\
      \ may be deployed over Type1 or Type2 VMs or as Containers over guest OS, or\
      \ over a VM. Examples of 5G functions deployed as CNF due to scaling requirements\
      \ may include 5G Core capabilities of AMF, SMF, UPF and RAN Capabilities of\
      \ CU, DU, RIC, x-Apps, r-Apps. A container or VM escape can expose control and\
      \ user plane traffic as well as credentials to allow adversary to further carry\
      \ out attacks on the network."
    platforms:
    - Windows
    - Linux
    - MacOS
    preconditions: []
    procedureexamples: []
    references:
    - <a name="1"> \[1\] </a> [ETSI NFV SEC023, Container security spec (WIP) v004.](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC023_Container_Security_Spec)
    - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
      "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
      October 2021.](https://arxiv.org/abs/2108.11206)
    - <a name="3"> \[3\] </a> [Github, "Awesome VM exploit".](https://github.com/WinMin/awesome-vm-exploit)
    - <a name="4"> \[4\] </a> [Project Zero.](https://googleprojectzero.blogspot.com/2021/06/an-epyc-escape-case-study-of-kvm.html)
    software:
    - description: Container was configured to bind to the host root directory
      fgsid: S0600
      name: Doki
    - description: Hildegard used the BOtB tool that can break out of Container
      fgsid: S0601
      name: Hildegard
    - description: "Peirates\_can gain a reverse shell on a host node by mounting\
        \ the Kubernetes hostPath."
      fgsid: S0683
      name: Peirates
    - description: Siliscape maps the hosts's C drive to the contianer by creating
        a global symbolic link of NtSetInformationSymbolicLink
      fgsid: S0623
      name: Siloscape
  architecture-segment: Virtualization, OA&M
  bluf: Adversaries may break out of a container to gain access to the underlying
    host.
  campaigns: []
  criticalassets:
  - description: Any capabilities deployed as VNF or CNF
    name: VNF, CNF
  - description: Host OS, VM host server becomes a bridging device between tenant
      VMs and Containers if compromised
    name: VM, Container host
  - description: In addition to application data exposure, credential exposure is
      usually a key target for adversary to open the doors for many other exploits.
    name: Credentials
  description: 'Adversaries may break out of a container to gain access to the underlying
    host. This can allow an adversary access to other containerized resources from
    the host level or to the host itself. In principle, containerized resources should
    provide a clear separation of application functionality and be isolated from the
    host environment.(Citation: Docker Overview) There are multiple ways an adversary
    may escape to a host environment. Examples include creating a container configured
    to mount the host''s filesystem using the bind parameter, which allows the adversary
    to drop payloads and execute control utilities such as cron on the host; utilizing
    a privileged container to run commands or load a malicious kernel module on the
    underlying host; or abusing system calls such as `unshare` and `keyctl` to escalate
    privileges and steal secrets.(Citation: Docker Bind Mounts)(Citation: Trend Micro
    Privileged Container)(Citation: Intezer Doki July 20)(Citation: Container Escape)(Citation:
    Crowdstrike Kubernetes Container Escape)(Citation: Keyctl-unmask) Additionally,
    an adversary may be able to exploit a compromised container with a mounted container
    management socket, such as `docker.sock`, to break out of the container via a
    [Container Administration Command](https://attack.mitre.org/techniques/T1609).(Citation:
    Container Escape) Adversaries may also escape via [Exploitation for Privilege
    Escalation](https://attack.mitre.org/techniques/T1068), such as exploiting vulnerabilities
    in global symbolic links in order to access the root directory of a host machine.(Citation:
    Windows Server Containers Are Open) Gaining access to the host may provide the
    adversary with the opportunity to achieve follow-on objectives, such as establishing
    persistence, moving laterally within the environment, or setting up a command
    and control channel on the host.[To read more, please see the MITRE ATT&CK page
    for this technique](https://attack.mitre.org/techniques/T1611)'
  detections:
  - component: Process Creation
    detects: Monitor process creation and OS API execution activity. Monitor for process
      activity (such as unexpected processes spawning outside a container and/or on
      a host) that might indicate an attempt to escape from a privileged container
      to host.
    fgdsid: FGDS0009.003
    name: Process
  - component: Container Creation
    detects: Monitor for the deployment of suspicious or unknown container images
      and pods in your environment, particularly containers running as root.
    fgdsid: FGDS0032.001
    name: Container
  - component: Volume Creation
    detects: 'Initial construction of a cloud volume (ex: AWS'
    fgdsid: FGDS0034.001
    name: Volume
  - component: Volume Deletion
    detects: 'Removal of a cloud volume (ex: AWS delete-volume)'
    fgdsid: FGDS0034.002
    name: Volume
  - component: Volume Enumeration
    detects: An extracted list of available volumes within
    fgdsid: FGDS0034.003
    name: Volume
  - component: Volume Metdata
    detects: Contextual data about a cloud volume and activity around it, such as
      id, type, state, and size
    fgdsid: FGDS0034.004
    name: Volume
  - component: Volume Modification
    detects: 'Changes made to a cloud volume, including its settings and control data
      (ex: AWS modify-volume)'
    fgdsid: FGDS0034.005
    name: Volume
  groups:
  - description: TeamTNT has deployed privileged containers that mount the filesystem
      of victim machine
    fggid: G0139
    name: TeamTNT
  id: FGT1611
  mitigations:
  - fgmid: FGM1048
    mitigates: Consider utilizing seccomp, seccomp-bpf, or a similar solution that
      restricts certain system calls such as mount. In Kubernetes environments, consider
      defining a Pod Security Policy that limits container access to host process
      namespaces, the host network, and the host file system
    name: Application Isolation And Sandboxing
  - fgmid: FGM1038
    mitigates: Use read-only containers, read-only file systems, and minimal images
      when possible, to prevent the running of commands.
    name: Execution Prevention
  - fgmid: FGM1026
    mitigates: 'Rootless containers: Ensure containers are not running as root by
      default. In Kubernetes environments, consider defining a Pod Security Policy
      that prevents pods from running privileged containers.'
    name: Privileged Account Management
  name: Escape to Host
  object-type: technique
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [ETSI NFV SEC023, Container security spec (WIP) v004.](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC023_Container_Security_Spec)
  - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021.](https://arxiv.org/abs/2108.11206)
  - <a name="3"> \[3\] </a> [Github, "Awesome VM exploit".](https://github.com/WinMin/awesome-vm-exploit)
  - <a name="4"> \[4\] </a> [Project Zero.](https://googleprojectzero.blogspot.com/2021/06/an-epyc-escape-case-study-of-kvm.html)
  software:
  - description: Container was configured to bind to the host root directory
    fgsid: S0600
    name: Doki
  - description: Hildegard used the BOtB tool that can break out of Container
    fgsid: S0601
    name: Hildegard
  - description: "Peirates\_can gain a reverse shell on a host node by mounting the\
      \ Kubernetes hostPath."
    fgsid: S0683
    name: Peirates
  - description: Siliscape maps the hosts's C drive to the contianer by creating a
      global symbolic link of NtSetInformationSymbolicLink
    fgsid: S0623
    name: Siloscape
  status: Observed In Enterprise
  tactics:
  - TA0008
  - TA0004
  typecode: attack_technique_addendum
- access-required: User/NPE/Administrative Access
  architecture-segment: OA&M, Virtualization
  bluf: An adversary may compromise a target Virtual Network Function (VNF) to gain
    unauthorized access to the data from the underlying resources shared with other
    VNFs.
  campaigns: []
  criticalassets:
  - description: Adversary may identify high value 5G network functions targets for
      its exploits
    name: VNF and VNF Data
  description: "An adversary may compromise a target Virtual Network Function (VNF)\
    \ to gain unauthorized access to the data from the underlying resources shared\
    \ with other VNFs.\r\n\r\nA malicious VNF instantiated in the VNF infrastructure\
    \ may be able to access the resources reserved for another tenant VNF, if root\
    \ or escalated privilege is gained due to misconfiguration of host or container.\
    \ This exploitation can lead to unauthorized data access in shared resources.\
    \ Multiple techniques can be used to isolate VNF or VNFc (container) where sharing\
    \ virtualization resources is a business requirement to ensure a co-resident compromised\
    \ or malicious VNF/VNFc cannot access shared resources or read data therein."
  detections:
  - component: Application Log Content
    detects: Audit application logs (NFVO, VIM).  Configuration management databases
      (CMDB) and other asset management systems may help with the detection of computer
      systems or network devices that should not exist on a network.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Container Creation
    detects: Monitor container creation, container start events
    fgdsid: FGDS0032.001
    name: Container
  - component: Process Metadata
    detects: Monitor process activity on node, hosts and VNFs.
    fgdsid: FGDS0009.004
    name: Process
  - component: Volume Modification
    detects: Monitor volume or storage modifications, attachment or read actions.
    fgdsid: FGDS0034.005
    name: Volume
  groups: []
  id: FGT1611.501
  mitigations:
  - fgmid: FGM1047
    mitigates: Scan images before deployment, and block those that are not in compliance
      with security policies. In Kubernetes environments, the admission controller
      can be used to validate images after a container deployment request is authenticated
      but before the container is deployed.
    name: Audit
  - fgmid: FGM1035
    mitigates: Limit communications with the container service to local Unix sockets
      or remote access via SSH. Require secure port access to communicate with the
      APIs over TLS by disabling unauthenticated access to the Docker API, Kubernetes
      API Server, and container orchestration web applications.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Deny direct remote access to internal systems through the use of network
      proxies, gateways, and firewalls.  Segment execution environment with node and
      network.
    name: Network Segmentation
  - fgmid: FGM1018
    mitigates: Enforce the principle of least privilege by limiting container dashboard
      access to only the necessary users.
    name: User Account Management
  name: Malicious Privileged container-VNF Shared Resource Access
  object-type: technique
  platforms: CI/CD, OA&M Tools
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Network Functions Virtualisation (NFV) Release 4;Security;
    Isolation and trust domain specificationRelease 4, section 4.2.1, Accessed 4/12/2022](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC026_Isolation_and_trust_domain)
  software: []
  status: Theoretical
  subtechnique-of: FGT1611
  tactics:
  - TA0004
  - TA0008
  typecode: fight_subtechnique_to_attack_technique
- bluf: Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade
    or block the availability of services to users.
  campaigns: []
  criticalassets: []
  description: 'Adversaries may perform Endpoint Denial of Service (DoS) attacks to
    degrade or block the availability of services to users. On Android versions prior
    to 7, apps can abuse Device Administrator access to reset the device lock passcode,
    preventing the user from unlocking the device. After Android 7, only device or
    profile owners (e.g. MDMs) can reset the device''s passcode.(Citation: Android
    resetPassword) On iOS devices, this technique does not work because mobile device
    management servers can only remove the screen lock passcode; they cannot set a
    new passcode. However, on jailbroken devices, malware has been discovered that
    can lock the user out of the device.(Citation: Xiao-KeyRaider)[To read more, please
    see the MITRE ATT&CK page for this technique](https://attack.mitre.org/techniques/T1642)'
  detections: []
  groups: []
  id: FGT1642
  mitigations: []
  name: Endpoint Denial of Service
  object-type: technique
  platforms: Android, iOS
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: attack_technique_with_fight_subs
- access-required: None
  architecture-segment: RAN, O-RAN
  bluf: Adversary controlled false base station transmits crafted broadcast messages
    to prevent legitimate UEs to connect to network.
  campaigns: []
  criticalassets:
  - description: Legitimate UEs do not get network access in the area where false
      base station is deployed.
    name: 5G network access
  description: "Adversary controlled false base station transmits crafted broadcast\
    \ messages to prevent legitimate UEs to connect to network.\r\n\r\nLTE sub-frames\
    \ are sent by adversary from a false base station which mimics legitimate eNB.\
    \ It sends fake System Information Block Type 1 (SIB1) messages which are aligned\
    \ in time-frequency domain with the messages sent by the legitimate eNB, but with\
    \ stronger transmit power. The adversary does not send primary synchronization\
    \ signal (PSS) and secondary synchronization signal (SSS) for this behavior which\
    \ makes it harder to detect. This is known as sigover behavior. [1]\r\n\r\nAdversary\
    \ may transmit crafted broadcast messages by manipulating cell barring in Master\
    \ Information Block (MIB) and access barring feature in SIB1 broadcast messages.\
    \ UEs in the vicinity will stop camping on to legitimate network for 300 seconds\
    \ and they get a DoS. The same behaviors are possible in 5G network as MIB and\
    \ SIB1 messages in 5G are similar to 4G and those are not integrity protected\
    \ in 5G."
  detections:
  - component: Signals sent by UEs
    detects: Monitor gNB logs of UE measurements of received power levels from all
      base stations nearby, and their identifiers. Parsing the logs may reveal the
      presence of false base station in the area. Clause 6.24 of [3].
    fgdsid: FGDS5002.001
    name: Radio interface
  groups: []
  id: FGT1642.501
  mitigations:
  - fgmid: FGM5024
    mitigates: Use integrity protection for all broadcast messages sent by gNB. This
      will have performance impact on the network and UE due to additional processing
      of integrity protection algorithm.
    name: Integrity Protection Of Data Communication
  name: Transmit Spoofed Broadcast Message
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: No UE in the area where false base station is present can get connection
      to the network.
    name: Network access denied
  preconditions:
  - description: Adversary gets hold of a false base station which is capable of broadcasting
      fraudulent messages.
    name: Obtain a false base station to send fake broadcast messages
  - description: False base station must be deployed in the area where target UEs
      are located.
    name: Adversary must be in the same vicinity of target UEs
  procedureexamples:
  - description: 'Adversary broadcasts fake MIB and SIB1 messages with cell barring
      and access barring features turned on. The cellbarred field in the MIB can be
      set to "barred", in SIB1 the cellReservedForOperatorUse field can be set to
      "reserved" and the cellReservedforOtherUse field can be set to "true". All UEs
      in the area which process the fake MIB and SIB1 messages will not connect to
      legitimate base stations for 300 seconds. [1, 4], clauses 6.2.2 & 6.3.2 of [2].The
      same behavior is possible in 5G as MIB and SIB1 messages are sent without integrity
      protection and the format of the messages are similar to 4G.Note: This behavior
      is not persistent as the UE''s will try to connect to the legitimate network
      after about 300 seconds.'
    name: Send cell barring and access barring information to target UEs
  references:
  - '<a name="1"> \[1\] </a> [ACM article, Chuan Yu et al: "Improving 4G/5G air interface
    security: A survey of existing attacks on different LTE layers".](https://dl.acm.org/doi/abs/10.1016/j.comnet.2021.108532)'
  - '<a name="2"> \[2\] </a> [3GPP TS 38.331: "Radio Resource Control (RRC); Protocol
    specification" Release 16.](https://www.3gpp.org/DynaReport/38331.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TR 33.809: "Study on 5G security enhancements against
    False Base Stations (FBS)", Technical Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  - '<a name="4"> \[4\] </a> [Ericsson paper, Jingya Li et al: "An Overview of 5G
    System Accessibility Differentiation and Control".](https://arxiv.org/ftp/arxiv/papers/2012/2012.05520.pdf)'
  software: []
  status: Observed In 4G; Possible In 5G
  subtechnique-of: FGT1642
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: RAN, O-RAN
  bluf: An adversary may send a crafted signaling message to the UE to cause it to
    fail its attach procedure.
  campaigns: []
  criticalassets:
  - description: UEs receives an attach rejection from the base station.
    name: 5G network access
  description: "An adversary may send a crafted signaling message to the UE to cause\
    \ it to fail its attach procedure.\r\n\r\nAdversary must first achieve AITM, e.g.\
    \ using a laptop and SDR which sits between the victim UE and core network. They\
    \ send crafted NAS signaling messages in uplink and downlink directions.\r\n\r\
    \nIn UL direction, adversary modifies the UE identifier (IMSI/SUPI) of the registration\
    \ request message with an invalid identifier. AMF rejects the registration request\
    \ message.\r\n\r\nIn DL direction, adversary sends NAS connection reject message\
    \ to the UE at the same time when the UE is awaiting response from AMF for the\
    \ registration request message. Similar method is used in DL direction to DoS\
    \ service request message from UE. \r\n\r\nWhen processed by UE, it denies connection\
    \ requests and network services to the victim UE(s)."
  detections:
  - component: Host Status
    detects: 'Detection of Network DoS can sometimes be achieved before the traffic
      volume is sufficient to cause impact to the availability of the service, but
      such response time typically requires very aggressive monitoring and responsiveness,
      or services provided by an upstream network service provider. Monitor for logging,
      messaging, and other artifacts highlighting the health of host sensors (ex:
      metrics, errors, and/or exceptions from logging applications)'
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: gNB broadcast messages
    detects: Investigate gNB signals and messages broadcast for all UEs to hear- e.g.
      Authentication message, Registration message, etc.
    fgdsid: FGDS5002.002
    name: Radio interface
  groups: []
  id: FGT1642.502
  mitigations:
  - fgmid: FGM1037
    mitigates: "Leverage services provided by Content Delivery Networks (CDN) or providers\
      \ specializing in DoS mitigations to filter traffic upstream from services.[4]\_\
      Filter boundary traffic by blocking source addresses sourcing the attack, blocking\
      \ ports that are being targeted, or blocking protocols being used for transport."
    name: Filter Network Traffic
  - fgmid: FGM5024
    mitigates: The UE may need to reattach more frequently, employ integrity protection
      or make the use of the Subscriber Concealed Identifier (SUCI) mandatory.
    name: Integrity Protection Of Data Communication
  name: UE
  object-type: technique
  platforms: O-RAN nodes
  postconditions:
  - description: UE has no service and is unable to connect to the network.
    name: UE is unavailable
  preconditions:
  - description: The UE's identity is sent in plain text and unconcealed.
    name: IMSI/SUPI not concealed
  procedureexamples:
  - description: Adversary sits between the victim UE and core network and sends crafted
      NAS signaling messages in uplink and downlink directions.In DL direction, adversary
      sends NAS connection reject message to the UE at the same time when the UE is
      awaiting response from AMF for the registration request message. Similar method
      is used in DL direction to DoS service request message from UE.
    name: An adversary sends crafted NAS signaling messages
  references:
  - "<a name=\"1\"> \\[1\\] </a> [S.Erni, M. Kotuliak, P. Leu, M. Roeschlin, & S.\
    \ Capkun,\_\"AdoptOver: Adaptive Overshadowing Attacks in Cellular Networks\"\
    , 2022.](https://dl.acm.org/doi/pdf/10.1145/3495243.3560525)"
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1642
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- access-required: N/A
  architecture-segment: RAN, O-RAN
  bluf: An adversary may send a crafted signaling message to the AMF to cause it to
    fail its service or attach request.
  campaigns: []
  criticalassets:
  - description: UE's receives an attach rejection from the base station.
    name: AMF
  description: An adversary may send a crafted signaling message to the AMF to cause
    it to fail its service or attach request.
  detections:
  - component: Application Log Content
    detects: Check 5G air interface log detailed records and data generated during
      the communication between UE and the AMF. These logs capture various aspects
      of the air interface, such as signal strength, connection attempts, handovers,
      and error messages.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT1642.503
  mitigations:
  - fgmid: FGM5024
    mitigates: The UE may need to reattach more frequently, employ integrity protection
      or make the use of the Subscriber Concealed Identifier (SUCI) mandatory.
    name: Integrity Protection Of Data Communication
  name: AMF
  object-type: technique
  platforms: O-RAN Nodes, 5G RAN
  postconditions:
  - description: AMF consistently rejects UE's attach request.
    name: Network is unavailable
  preconditions:
  - description: The UE's identity is sent in plain text and unconcealed.
    name: IMSI/SUPI not concealed
  procedureexamples:
  - description: Adversary between the victim UE and core network. They send crafted
      NAS signaling messages in uplink and downlink directions. In UL direction, adversary
      modifies the UE identifier (IMSI/SUPI) of the registration request message with
      an invalid identifier. AMF rejects the registration request message.
    name: An adversary sends crafted NAS signaling messages
  references:
  - "<a name=\"1\"> \\[1\\] </a> [S.Erni,M. Kotuliak, P. Leu, M. Roeschlin, & S. Capkun,\_\
    \"AdoptOver: Adaptive Overshadowing Attacks in Cellular Networks\", 2022.](https://dl.acm.org/doi/pdf/10.1145/3495243.3560525)"
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT1642
  tactics:
  - TA0040
  typecode: fight_subtechnique_to_attack_technique
- architecture-segment: User Plane
  bluf: An adversary may compromise the operator's SMS Center (SMSC) to collect SMS
    messages to/from the UEs.
  campaigns: []
  criticalassets:
  - description: User data from SMS.
    name: User data
  description: "An adversary may compromise the operator's SMS Center (SMSC) to collect\
    \ SMS messages to/from the UEs.\r\n\r\nThe SMSC is a server in 3G, 4G, and 5G\
    \ networks, and it communicates in 5G with the SMS Function (SMSF) and IMS function\
    \ IP-SM-GW, using MAP protocol.\r\n\r\nAn adversary can eavesdrop the SMS data\
    \ to/from certain subscribers (identified by IMSI or MSISDN), by compromising\
    \ the operator's SMSC. Similar techniques can be applied to other operator functions\
    \ such as IP-SM-GW or STF, SMSF, towards the same goal."
  detections:
  - component: Security logs in core
    detects: Audit logs for suspicious activities in core and raise alarms.
    fgdsid: FGDS5012.001
    name: Security logs in network
  groups: []
  id: FGT5001
  mitigations:
  - fgmid: FGM1049
    mitigates: Check telecom servers for malware or use endpoint security solution.
      Implement the latest patches in Linux systems and use strong anti-virus software
      to detect malware.
    name: Anti-virus & Anti-malware
  name: Network-side SMS Collection
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: The adversary compromises the operator's SMSC or similar functions
      (e.g., IP-SM-GW, STF, SMSF), enabling unauthorized access to SMS messages and
      eavesdropping on communications for specific subscribers identified by IMSI
      or MSISDN.
    name: Compromised SMSC
  preconditions:
  - description: Adversary must first develop the malware to achieve the procedures
      herein.
    name: Malware developed
  procedureexamples:
  - description: 'A data miner program may be loaded by an installation script. The
      script targets and saves SMS messages (the contents, the IMSI and the source
      and destination phone numbers). This is highly targeted to given IMSI numbers
      (e.g., proponents of movements against the Chinese gov''t). (note: Call Data
      Records (CDRs) were also targeted for certain IMSIs, the info therein is called
      metadata, i.e. time, duration, phone numbers). [1], [2].'
    name: Malware loaded into a Linux running SMSC server
  references:
  - '<a name="1"> \[1\] </a> [Dynamic Ciso.com: "New Malware Discovered by FireEye
    APT41, Infects SMS Servers Within Telecoms", Nov 1, 2019, retrieved March 4, 2022.](https://dynamicciso.com/new-malware-discovered-by-fireeye-apt41infects-sms-servers-within-telecoms)'
  - '<a name="2"> \[2\] </a> [Leong, Raymond, Perez, Dan & Dean, Tyler: "MESSAGETAP:
    Who''s Reading Your Text Messages" FireEye. 31 Oct 2019.](https://www.mandiant.com/resources/messagetap-who-is-reading-your-text-messages)'
  software: []
  status: Observed
  tactics:
  - TA0009
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Control Plane, Roaming
  bluf: An adversary positioned in an operator network may send an SMS delivery location
    query that will bypass the SMS home router of another operator, allowing the adversary
    to get the location of the user device.
  campaigns: []
  criticalassets:
  - description: 'Coarse location: In the form of routing info (MSC address).'
    name: UE location
  description: "An adversary positioned in an operator network may send an SMS delivery\
    \ location query that will bypass the SMS home router of another operator, allowing\
    \ the adversary to get the location of the user device.\r\n\r\nSMS home routing\
    \ bypassing is a technique that exploits incorrect implementation or configuration.\
    \ An adversary sends an SMS delivery location query that does not get intercepted\
    \ by the SMS home router, so it receives a response by providing the location\
    \ of the adversary's target UE. \r\n\r\n \r\n\r\nThis technique is applicable\
    \ to 3G, 4G, and 5G, since 5G systems still need to interconnect with SS7 networks.\
    \ 5G supports both SMS over IP and SMS over NAS. The routes for SMS are still\
    \ from SMSC (Short Message Service Center) to STP (Signaling Transfer Point) to\
    \ either IP-SM-GW (IP Short Message Gateway) for SMS over IP or SMSF (SMS Function)\
    \ for SMS over NAS. Refer to section 7.2 of [3]."
  detections:
  - component: Application Log Content
    detects: Logs of externally received messages requesting location of subscriber
      or, logs of outgoing responses to such messages can detect anomalies. Logs are
      on the NF or functions which interface SMS home router such as MAP IWF or SMSC.
      See Figure 27 of [3].
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5002
  mitigations:
  - fgmid: FGM5004
    mitigates: Correctly configure SMS firewall in home network. [4]
    name: Correctly Configure SMS Firewall
  name: Bypass Home Routing
  object-type: technique
  platforms: Core
  postconditions: []
  preconditions:
  - description: Access to a host that could pass as belonging to a different operator
      (roaming partner).
    name: Compromised SMS Center or STP
  - description: Access to the MSISDN of the victim user device.
    name: Get target user's phone number
  procedureexamples:
  - description: Incorrect implementation/configuration or compromised home SMS router
      may allow bypass of the SMS location query messages received from adversary
      located in a visited network. Deployed SMS router as in Section 7.2.2 of [3].
    name: Send SMS location query via SS7 or Diameter
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
  - <a name="2"> \[2\] </a> [European Union Agency for Cybersecurity (ENISA), "Signaling
    security in telecom SS7/Diameter/5G", March 2018.](https://www.enisa.europa.eu/publications/signalling-security-in-telecom-ss7-diameter-5g)
  - <a name="3"> \[3\] </a> [GSM Association, "Official Document NG.111 - SMS Evolution",
    v2.0, Nov. 2020.](https://www.gsma.com/newsroom/wp-content/uploads//NG.111-v2.0.pdf)
  - '<a name="4"> \[4\] </a> [Kirill Puzankov: "Hidden Agendas: bypassing GSMA recommendations
    on SS7 networks," accessed on May 25, 2023.](https://docplayer.net/136483279-Hidden-agendas-bypassing-gsma-recommendations-on-ss7-networks-kirill-puzankov.html)'
  software: []
  status: Observed
  tactics:
  - TA0005
  typecode: fight_technique
- access-required: Token
  architecture-segment: Control Plane, Network Slice
  bluf: An adversary may query the Network Repository Function (NRF) to discover restricted
    Network Function (NF) services to further target that NF.
  campaigns: []
  criticalassets:
  - description: It is possible for example to find out whether an operator provides
      services to a certain customer. Or whether a user is also part of a private
      slice e.g. DoD. There is slice isolation assurance loss with this threat.
    name: Operator network components and services
  description: "An adversary may query the Network Repository Function (NRF) to discover\
    \ restricted Network Function (NF) services to further target that NF.\r\n\r\n\
    In an operator network, all active Network Functions (NFs) must be securely registered\
    \ with the Network Repository Function (NRF). This registration includes key details\
    \ such as the NF type, services provided, IP addresses, and more. Consumer NFs\
    \ rely on the NRF to locate Producer NFs they need to interact with. However,\
    \ the NRF must ensure that the Consumer NF is authorized to discover specific\
    \ Producer NFs to prevent unauthorized access.\r\n\r\nThis discovery process can\
    \ be exploited if misconfigured, allowing malicious actors to identify and target\
    \ sensitive NFs. The NRF is responsible for validating discovery requests against\
    \ the sender's profile, but errors in configuration may fail to protect restricted\
    \ NF services.\r\n\r\nIn network slicing, NRF principles remain the same, with\
    \ service discovery restricted to specific slices. However, legitimate communication\
    \ between NFs in different slices may be necessary. If the NRF lacks proper authorization\
    \ controls, an NF in one slice could discover NFs in other slices without valid\
    \ justification, potentially breaching slice isolation. For example, an NF should\
    \ only query NFs in other slices if it has a legitimate need to communicate with\
    \ them."
  detections: []
  groups: []
  id: FGT5003
  mitigations:
  - fgmid: FGM5003
    mitigates: Ensure cross-layer checks at the NRF, between the certificate presented
      to it at the TLS connection setup stage and the identity and authorization requested
      presented to it at the OAuth Token request stage.Ensure the consumer is authorized
      to ask about this service.Authorization follows need-to-know rules, such as:1.
      an NF cannot query for NFs in other network slices2. an NF can only query for
      NFs that it needs to communicate with.
    name: Cross Check Between Application Layer And Transport Layer
  - fgmid: FGM1020
    mitigates: Inspect proxy servers such as SCP (if deployed) for any suspicious
      use of access tokens such as unauthorized re-direct or replay of tokens
    name: SSL/TLS Inspection
  name: Network Function Service Discovery
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Details about the additional services offered by a specific Mobile
      Network Operator (MNO).
    name: Unauthorized probing of network services
  preconditions:
  - description: NRF is by design open to connections from other network functions.
      Control of another NF in the operator domain may be required.
    name: Access to NRF
  - description: SCP is compromised to hijack tokens.
    name: Access to SCP
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021](https://arxiv.org/abs/2108.11206)
  - <a name="2"> \[2\] </a> [3GPP Technical Report 33.926, "Security Assurance Specification
    (SCAS) threats and critical assets in 3GPP network product classes", Release 17.](https://www.3gpp.org/DynaReport/33926.htm)
  - <a name="3"> \[3\] </a> [Internet Engineering Task Force (IETF) "OAuth 2.0 Security
    Best Current Practice", draft-ietf-oauth-security-topics-05, June 2022.](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-19)
  software: []
  status: Theoretical
  tactics:
  - TA0007
  typecode: fight_technique
- access-required: User Or Administrative Access To Repository
  architecture-segment: Virtualization
  bluf: An adversary may discover Software Defined Network (SDN) flow information,
    which could then be used for lateral movement and unauthorized changes in the
    network.
  campaigns: []
  criticalassets:
  - description: Adversary may target a particular network controller, network element,
      CI/CD, security, and operations tools to manipulate SDN network flows.
    name: SDN Controller and Network Elements, operations, and security tools
  - description: Adversary may target configuration or network flow data.
    name: SDN Configurations file, Network flow tables
  description: "An adversary may discover Software Defined Network (SDN) flow information,\
    \ which could then be used for lateral movement and unauthorized changes in the\
    \ network.\r\n\r\nTo achieve this, an adversary must compromise an SDN element\
    \ (e.g., controller, router, switch) to forge network data and launch other activities,\
    \ such as denial of service. While data forging could relate to data held by any\
    \ component of an SDN (e.g., network switches, controllers and/or SDN applications),\
    \ a threat specific to SDN consists of forging requests from accessible low level\
    \ SDN controllers to upper-level ones. This could then drive the upper level controllers'\
    \ decisions on how to redefine large parts of the network. In the literature,\
    \ this scenario has been identified as a threat related to components in the data\
    \ plane and the controller plane of any SDN network (IP-WAN, IP-LAN, RAN, Transport)."
  detections:
  - component: User Account Authentication
    detects: User Account Authentication events for Users and APIs.
    fgdsid: FGDS0002.001
    name: User Account
  - component: SDN Access Logs in SDN elements
    detects: SDN Application logs detect unauthorized activity impacting configuration.
    fgdsid: FGDS5014.001
    name: SDN Access Logs in SDN elements
  - component: Application Log Content
    detects: SDN and Network element logs discover configuration changes.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Network flows. Audit network flow tables to detect unauthorized changes
      to flow data, particularly from network traffic originating from unknown or
      unexpected devices.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT5004
  mitigations:
  - fgmid: FGM1022
    mitigates: Restricted Permissions to add images to SDN Controller and Network
      Elements for person and non-person accounts.Restrict permissions for person
      and non-person accounts to prevent flow rule insertion or modification.
    name: Restrict File And Directory Permissions
  - fgmid: FGM5091
    mitigates: Mutual authentication between the SDN controller and network elements.  The
      SDN controller and SDN application can be used to prevent unauthorized access.
    name: Mutual Authentication
  - fgmid: FGM5024
    mitigates: Strong integrity protection method should be employed on APIs carrying
      control plane traffic between Controller and network element as well as controller
      and SDN application to avoid adversary in the middle threats.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1041
    mitigates: Strong encryption should be used on APIs carrying control plane traffic
      between Controller and network element as well as controller and SDN application
      to avoid adversary in the middle threats.
    name: Encrypt Sensitive Information
  - fgmid: FGM1053
    mitigates: All SDN Configurations should be backed up and periodically audited
      to see differences between running configuration and back up configurations.
    name: Data Backup
  - fgmid: FGM1054
    mitigates: Keep baseline configurations up to date to avoid loopholes due to stale
      configuration or configuration drift.
    name: Software Configuration
  - fgmid: FGM1030
    mitigates: Physical and logical segmentation can prevent lateral movements.
    name: Network Segmentation
  name: Network Flow Manipulation
  object-type: technique
  platforms: SDN Controller, SDN Network Element
  postconditions:
  - description: Network flow compromise can lead to DOS, or change the traffic pattern
      and paths. Adversary may change the path for network sniffing or for AiTM activity.
    name: Network flow compromise
  preconditions:
  - description: Privileged Access to SDN controller and Network elements.
    name: Credential and Access to SDN Controller and network elements
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0009
  - TA0007
  typecode: fight_technique
- access-required: User, Administrative
  architecture-segment: Virtualization
  bluf: An adversary may use the compromised SDN controller or Control plane API to
    modify network flow rules, or traffic management policies.
  campaigns: []
  criticalassets:
  - description: Adversary may target a particular network controller, network element,
      CI/CD, security, and operations tools to manipulate SDN network flows.
    name: SDN Controller and Network Elements, operations, and security tools
  - description: Adversary may target configuration to manipulate controller and network
      element behavior
    name: SDN controller Configuration file
  description: "An adversary may use the compromised SDN controller or Control plane\
    \ API to modify network flow rules, or traffic management policies.\r\n\r\nAn\
    \ SDN controller is a centralized control application for policy, device configuration,\
    \ and traffic flow management. SDN controller compromise can allow an adversary\
    \ to change the traffic path for offensive or defensive evasion purposes as well\
    \ as cause denial of service to certain networks or end points. SDN Controller\
    \ application is typically installed on a physical over virtual server and communicate\
    \ northbound to other OAM applications as well as southbound to network switches.\
    \ SDN controller acts as an Operating System for the Network in SDN architecture\
    \ and is widely deployed in data centers and wide area network connections (SD-WAN)."
  detections:
  - component: SDN Access Logs in SDN elements
    detects: Analyze logs to detect activity and look for suspicious, abnormal, or
      unauthorized activity.
    fgdsid: FGDS5014.001
    name: SDN Access Logs in SDN elements
  - component: Application Log Content
    detects: Periodically audit SDN and Network element configuration to detect unauthorized
      changes
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Detects network flows. Monitor network data for uncommon data flows,
      particularly, devices that do not normally have communication.
    fgdsid: FGDS0029.003
    name: Network Traffic
  groups: []
  id: FGT5004.001
  mitigations:
  - fgmid: FGM1022
    mitigates: Restricted Permissions to add application images and configurations
      to SDN Controller for person and non-person accounts.
    name: Restrict File And Directory Permissions
  - fgmid: FGM5091
    mitigates: Mutual authentication between SDN controller and network elements,
      SDN controller and SDN application can prevent unauthorized access
    name: Mutual Authentication
  - fgmid: FGM5024
    mitigates: Strong integrity protection method should be employed on APIs carrying
      control plane traffic between Controller and network element as well as controller
      and SDN application to avoid adversary in the middle threats
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1041
    mitigates: Strong encryption should be used on APIs carrying control plane traffic
      between Controller and network element as well as controller and SDN application
      to avoid adversary in the middle threats
    name: Encrypt Sensitive Information
  - fgmid: FGM1053
    mitigates: SDN controller configurations should be backed up and periodically
      audited to see differences between running configuration and back up configurations
    name: Data Backup
  - fgmid: FGM1054
    mitigates: Keep baseline configuration up to date to avoid loopholes due to stale
      configuration or configuration drift.
    name: Software Configuration
  - fgmid: FGM1030
    mitigates: Physical and logical segmentation can prevent lateral movements. Segmentation
      techniques in the hosts and network will reduce the chances of lateral movement
      to the control.
    name: Network Segmentation
  name: Controller
  object-type: technique
  platforms: SDN Controller
  postconditions:
  - description: Network flow compromise can lead to DOS, or change the traffic pattern
      and paths.  Adversary may change the path for network sniffing or for MiTM activity.
    name: Network flow compromise
  preconditions:
  - description: Privileged Access to SDN controller via direct login or through SDN
      control plane APIs
    name: Credential and Access to SDN Controller
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [ENISA, "Threat Landscape and Good Practice Guide for
    Software Defined Networks/5G", Jan. 2016](https://www.enisa.europa.eu/publications/sdn-threat-landscape)
  - '<a name="2"> \[2\] </a> [Scott-Hayward, S., O''Callaghan, G., & Sezer, S. "SDN
    Security: A Survey". 2013 IEEE SDN for Future. Networks and Services (SDN4FNS)
    (pp. 1-7)](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6702553&tag=1)'
  - <a name="3"> \[3\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021](https://arxiv.org/abs/2108.11206)
  software: []
  status: Theoretical
  subtechnique-of: FGT5004
  tactics:
  - TA0009
  - TA0007
  typecode: fight_subtechnique
- access-required: User Or Administrative Access To Repository
  architecture-segment: Virtualization
  bluf: An SDN vSwitch is like a layer 2 switch that connects devices to the network
    and performs packet forwarding between the switch ports.
  campaigns: []
  criticalassets:
  - description: Adversary may target a network controller, network element, CI/CD,
      security, and operations tools to manipulate SDN network flows in a vSwitch.
    name: SDN Controller, Network Elements, operations, and security tools
  - description: Adversary may target configuration to manipulate vSwitch and network
      behavior.
    name: SDN Configurations file
  - description: Network flows are stored in Network Flow tables, usually refer to
      as route or switch tables that vSwitch uses to decide which packet forwarding
      port to use for incoming packets.
    name: SDN Network flow tables
  description: "An adversary may compromise a vSwitch in an SDN network to manipulate\
    \ the network traffic or cause denial of service\r\n\r\nAn SDN vSwitch is like\
    \ a layer 2 switch that connects devices to the network and performs packet forwarding\
    \ between the switch ports. This threat involves compromising an SDN vSwitch (an\
    \ SDN device responsible for packet/data switching between different ingress and\
    \ egress ports) to forge network data and launch other attacks (e.g., DoS). Adversary\
    \ may target vSwitch configuration or directly manipulate network flow tables\
    \ in memory to drive their decisions on how to redefine large parts of the network. "
  detections:
  - component: SDN Access Logs in SDN elements
    detects: Analyze logs to detect unauthorized activity.
    fgdsid: FGDS5014.001
    name: SDN Access Logs in SDN elements
  - component: Application Log Content
    detects: Periodically audit SDN and Network element configuration and compare
      with baseline configuration to detect unauthorized changes.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Flow
    detects: Periodically audit network flow to detect unauthorized changes to flow
      data.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: System Settings
    detects: Periodically audit network flow tables to detect unauthorized changes
      to flow data.
    fgdsid: FGDS0042.003
    name: User Interface
  groups: []
  id: FGT5004.002
  mitigations:
  - fgmid: FGM1022
    mitigates: Restricted Permissions to add application images to SDN vSwitch for
      person and non-person accounts.Restricted permissions for person and non-person
      accounts to prevent flow rule insertion or modification directly on the vSwitch.
    name: Restrict File And Directory Permissions
  - fgmid: FGM5091
    mitigates: Mutual authentication between SDN controller and vSwitch can prevent
      unauthorized access.
    name: Mutual Authentication
  - fgmid: FGM5024
    mitigates: Strong integrity protection method should be employed on APIs carrying
      control plane traffic between Controller and network element as well as controller
      and vSwitch to avoid adversary in the middle threats.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1041
    mitigates: Strong encryption should be used on APIs carrying control plane traffic
      between Controller and network element as well as controller and vSwitch to
      avoid adversary in the middle threats.
    name: Encrypt Sensitive Information
  - fgmid: FGM1053
    mitigates: SDN vSwitch configurations should be backed up and periodically audited
      to see differences between running configuration and back up configurations.
    name: Data Backup
  - fgmid: FGM1054
    mitigates: Keep baseline configuration up to date to avoid loopholes due to stale
      configuration or configuration drift.
    name: Software Configuration
  - fgmid: FGM1030
    mitigates: Physical and logical segmentation can prevent lateral movements. Segmentation
      techniques in the hosts and network will reduce the chances of lateral movement
      to the control.
    name: Network Segmentation
  name: vSwitch
  object-type: technique
  platforms: SDN vSwitch, Network Element
  postconditions:
  - description: Network flow compromise can lead to DOS or change the traffic pattern
      and paths.  Adversary may change the path for network sniffing or for AiTM activity.
    name: Network flow compromise
  preconditions:
  - description: Privileged Access to SDN vSwitch via direct login or through SDN
      control plane APIs.
    name: Credential and Access to SDN vSwitch
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [ENISA: "Threat Landscape and Good Practice Guide for
    Software Defined Networks/5G", Jan. 2016.](https://www.enisa.europa.eu/publications/sdn-threat-landscape)'
  - '<a name="2"> \[2\] </a> [Scott-Hayward, S., O''Callaghan, G., & Sezer, S.: "SDN
    Security: A Survey". 2013 IEEE SDN for Future. Networks and Services (SDN4FNS)
    (pp. 1-7).](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=6702553&tag=1)'
  - '<a name="3"> \[3\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021.](https://arxiv.org/abs/2108.11206)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5004
  tactics:
  - TA0009
  - TA0007
  typecode: fight_subtechnique
- access-required: Administrative Access, Access To Install Scraper Malware
  architecture-segment: Virtualization
  bluf: An adversary can achieve this by scanning the physical memory used by a given
    software program.
  campaigns: []
  criticalassets:
  - description: Adversary may target a particular network controller, network element,
      CI/CD, security, and operations tools to collect data.
    name: SDN controller and network elements (or any target host)
  - description: Adversary may target configuration or network flow data.
    name: SDN configurations file, Network flow tables
  description: "An adversary may be able to read memory registers to discover privileged\
    \ information such as local password comparison, encryption key etc.\r\n\r\nAn\
    \ adversary can achieve this by scanning the physical memory used by a given software\
    \ program. This will give the adversary access to any information that the program\
    \ has access to, which could be sensitive. While memory scraping can affect components\
    \ of any layer of the network, this type of threat has been primarily a focus\
    \ of SDN application servers where the adversary can have greater advantage, if\
    \ successful, in discovering sensitive information (credentials such as token\
    \ and keys). \r\n\r\nAdversaries may use memory scraping to target different components\
    \ of the core network, a core dump of an SDN controller (e.g. as the result of\
    \ malicious software) can be used to exploit private data. Once successfully performed,\
    \ memory scraping can be used to extract sensitive SDN data (e.g. flow rules at\
    \ the northbound API). [2]"
  detections:
  - component: Application Log Content
    detects: Analyze logs to detect unauthorized activity.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Connection Creation
    detects: All inbound and outbound connections should be audited for unauthorized
      activity.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Network Traffic Flow
    detects: Network patterns may reveal C2 or malware transfer to target host.
    fgdsid: FGDS0029.003
    name: Network Traffic
  - component: OS API Execution
    detects: Monitor for API calls, remote access tools with built-in features may
      interact directly with APIs to gather information.
    fgdsid: FGDS0009.001
    name: Process
  - component: Kernel Module Load
    detects: Kernel executing unknown processes or unauthorized processes not typical
      of the host.
    fgdsid: FGDS0008.001
    name: Kernel
  groups: []
  id: FGT5005
  mitigations:
  - fgmid: FGM1033
    mitigates: Restrict permissions to add software to SDN controller and network
      elements for person and non-person accounts.
    name: Limit Software Installation
  - fgmid: FGM1047
    mitigates: SDN controllers and network elements scanned for file changes and processes.
    name: Audit
  name: Memory Scraping
  object-type: technique
  platforms: SDN, Hosts
  postconditions: []
  preconditions:
  - description: Privileged access to SDN controller and network elements to transfer
      and install malware to the target host.
    name: Credential and access to SDN controller and network elements
  procedureexamples:
  - description: Many memory scrapers exist on the dark web with varying features,
      including camouflage, self-destruction and C2 connections.  Malware delivery
      by adversary scans network for right target for SDN controller or target host.  A
      few Malware examples include Dexter, Soraya, ChewBacca and BlackPOS.
    name: Target breach
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, section 6.2, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [ENISA: "Threat Landscape and Good Practice Guide for
    Software Defined Networks/5G", Jan. 2016.](https://www.enisa.europa.eu/publications/sdn-threat-landscape)'
  - '<a name="3"> \[3\] </a> [ETSI GS NFV-SEC 009 V1.1.1: "NFV Security:Report on
    use cases and technical approaches for multi-layer host administration", December
    2015.](https://www.etsi.org/deliver/etsi_gs/nfv-sec/001_099/009/01.01.01_60/gs_nfv-sec009v010101p.pdf)'
  - '<a name="4"> \[4\] </a> [N. Huq: "PoS RAM Scraper Malware: Past, Present, and
    Future," Trend Micro, accessed May 25, 2023.](https://www.wired.com/wp-content/uploads/2014/09/wp-pos-ram-scraper-malware.pdf)'
  - '<a name="5"> \[5\] </a> [J. Hizver: "Taxonomic Modeling of Security Threats in
    Software Defined Networking", Blackhat Conference, Aug. 2015.](https://www.blackhat.com/docs/us-15/materials/us-15-Hizver-Taxonomic-Modeling-Of-Security-Threats-In-Software-Defined-Networking-wp.pdf)'
  - '<a name="6"> \[6\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield:
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021.](https://arxiv.org/abs/2108.11206)'
  software: []
  status: Observed
  tactics:
  - TA0009
  typecode: fight_technique
- access-required: Admin
  architecture-segment: Control Plane
  bluf: An adversary, such as an insider to the MNO or vendor, may install a malicious
    NF into the core network, in order to launch other attacks or get access to information.
  campaigns: []
  criticalassets:
  - description: Network services provided to UEs e.g. eMBB, URLLC, mMTC etc.
    name: Data services
  description: "An adversary, such as an insider to the MNO or vendor, may install\
    \ a malicious NF into the core network, in order to launch other attacks or get\
    \ access to information.\r\n\r\nAn adversary could introduce an unauthorized network\
    \ function (NF) or function embedding trojan malware in the service based architecture\
    \ (SBA) by registering it in the NRF, in order to exploit other APIs. A clone\
    \ of a legitimate NF can also be used to register itself in the NRF. The new NF\
    \ can be deployed as a PNF, cloud VNF or containerized NF. This adversary could\
    \ be an insider (to the MNO) or a vendor or service provider. By having an unauthorized\
    \ network function installed or activated, an adversary may gain access to resources\
    \ in the network to perform other type of attacks such as Denial of Service, the\
    \ distribution of malicious software, or obtaining sensitive information."
  detections:
  - component: Application Log Content
    detects: Monitor application logs of core NFs for unauthorized registration of
      unknown NFs in NRF.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Container Creation
    detects: Monitor for newly constructed containers that may deploy a container
      into an environment to facilitate execution or evade defenses.
    fgdsid: FGDS0032.001
    name: Container
  groups: []
  id: FGT5007
  mitigations:
  - fgmid: FGM5023
    mitigates: Cross check newly registered NFs. Out of band mechanism for cross checking
      new NFs that are registered in NRF are as expected by network administrator.
      NRF may use additional OAuth2.0 token information.
    name: Periodic Authentication & Authorization Of NFs
  - fgmid: FGM1018
    mitigates: Enforce the principle of least privilege by limiting container dashboard
      access to only the necessary users.
    name: User Account Management
  - fgmid: FGM1030
    mitigates: Deny direct remote access to internal systems through the use of network
      proxies, gateways, and firewalls.
    name: Network Segmentation
  name: Registration Of Malicious Network Functions
  object-type: technique
  platforms: 5G core
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: 'Rogue or cloned NF calls Nnrf_NF Management API to register one
      of these functions: AMF, SMF, UDM, AUSF, NEF, PCF, SMSF, NSSF, UPF, etc. Clause
      5.2.7 of [3].'
    name: Unauthorized use of API
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, November 2019.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-for-5g-networks)'
  - <a name="3"> \[3\] </a> [3rd Generation Partnership Project (3GPP) TS 23.502,
    "Procedures for the 5G System (5GS); Stage 2 (Release 17)", Technical Specification,
    v17.4.0, March 2022.](https://www.3gpp.org/DynaReport/23502.htm)
  software: []
  status: Theoretical
  tactics:
  - TA0002
  typecode: fight_technique
- access-required: N/A
  architecture-segment: User Plane
  bluf: An adversary may divert user plane traffic for one or more UEs via a user-plane
    function, to monitor user data.
  campaigns: []
  criticalassets:
  - description: All user plane subscriber data
    name: Subscriber data
  description: "An adversary may divert user plane traffic for one or more UEs via\
    \ a user-plane function, to monitor user data.\r\n\r\nTraffic diversion is a threat\
    \ relating to network elements of the user plane. A compromised or misconfigured\
    \ NF (as documented in the procedures below: UPF, SMF, ...) is used to send or\
    \ cause to send a command to a user plane (routing) function that results in altering\
    \ the traffic flow. This threat involves compromising a network element to divert\
    \ traffic flows and allow a malicious actor to eavesdrop on user traffic. \r\n\
    \r\nRedirection attacks on the core network do not only result in communication\
    \ interception, but also in billing discrepancies."
  detections:
  - component: Application Log Content
    detects: Monitor AF to NEF APIs for illegitimate traffic redirection requests.
      Monitor Nnef_TrafficInfluence_Update API calls from AF to NEF for traffic redirection
      requests to unauthorized DNN & S-NSSAI.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5008
  mitigations:
  - fgmid: FGM1040
    mitigates: Monitor internal API calls between NFs for suspicious activities
    name: Behavior Prevention On Endpoint
  - fgmid: FGM1047
    mitigates: Audit insecure NF configurations
    name: Audit
  - fgmid: FGM5019
    mitigates: Authorize all API calls by external AFs to NEF
    name: Authorize External API Calls
  name: Redirection Of Traffic Via User Plane Network Function
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: If an adversary redirects to their own server, they can access the  subscriber
      data, who will not be aware that the traffic is being intercepted.
    name: Subscriber data intercept
  preconditions:
  - description: An adversary must have control of the UPF IP address or a UPF
    name: Acquire UPF IP address/control
  - description: An adversary must first control the SMF or NEF, or AF
    name: Control SMF/NEF/AF
  procedureexamples:
  - description: 'An adversary controlling the SMF may redirect existing UE traffic
      by sending to UPF a N4 Session Modification Request (or: selecting another UPF-
      or, by sending to UPF another "Redirect server" [which the adversary controls]
      in the FAR in the N4 session ("The UPF reports to the SMF whether it supports
      traffic redirection enforcement in the UPF through the ''UP-Function Features''
      IE." [6]) Clause 5.8.2.3.3 of [5]Similarly, the SMF can send a session modification
      request to the UPF and redirect UE traffic. See clauses 4.4.1.2 & 4.4.1.3 of
      [4].'
    name: Rogue or misconfigured SMF
  - description: The "Application Function influence on traffic routing" service is
      designed for MEC applications for local processing of data traffic in order
      to reduce latency. However, this capability can be misused by rogue AF or rogue/misconfigured
      NEF. The traffic redirection occurs after the NEF takes action that affects
      the UPF behavior. Clause 5.6.7 Table 5.6.7-1 first row "Traffic Description"
      of [5], clause 4.3.6 of [4].
    name: Rogue AF or rogue/misconfigured NEF
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="2"> \[2\] </a> [ENISA "Threat Landscape for 5G Networks Report", Nov
    2019.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-for-5g-networks)
  - '<a name="3"> \[3\] </a> ["Bhadra framework": S.P. Rao, S. Holtmanns, T. Aura,
    "Threat modeling framework for mobile communication systems"](https://arxiv.org/abs/2005.05110v1)'
  - <a name="4"> \[4\] </a> [3GPP TS 23.502 "Technical Specification Group Services
    and System Aspects; Procedures for the 5G System (5GS)".](https://www.3gpp.org/DynaReport/23502.htm)
  - <a name="5"> \[5\] </a> [3GPP TS 23.501 "Technical Specification Group Services
    and System Aspects; System architecture for the 5G System (5GS)".](https://www.3gpp.org/DynaReport/23501.htm)
  - <a name="6"> \[6\] </a> ["Ultra Cloud Core 5G User Plane Function, Release 2020.02
    - Configuration and Administration Guide", Cisco Systems, Accessed May 25, 2023](https://www.cisco.com/c/en/us/td/docs/wireless/ucc/upf/Ultra-Cloud-Core-5G-UPF-Config-Guide.html)
  software: []
  status: Theoretical
  tactics:
  - TA0009
  - TA0040
  typecode: fight_technique
- access-required: None
  architecture-segment: RAN, User Plane, Control Plane
  bluf: An adversary may compromise a network device's integrity capability or configuration
    in order to exploit the non-integrity protected data communication.
  campaigns: []
  criticalassets:
  - description: Subscriber signaling and user plane data.
    name: Subscriber data
  description: "An adversary may compromise a network device's integrity capability\
    \ or configuration in order to exploit the non-integrity protected data communication.\r\
    \n\r\nIntegrity can be used to protect transmitted data traffic against unauthorized\
    \ changes. Algorithms for user data and signaling communication take a plaintext\
    \ or encrypted message and compute, using a symmetric secret key, a keyed MIC\
    \ (message integrity check) or MAC (Message Authentication Code). A recipient\
    \ in possession of that symmetric integrity key can verify that the message was\
    \ not modified in transit. \r\n\r\nAn adversary may alter network signaling or\
    \ compromise a core NF, proxy or gNB that controls the choice of integrity algorithm,\
    \ so as to enable the weak or no integrity algorithm, thus allowing for manipulation\
    \ or spoofing of user data or signaling (over the radio interface or within the\
    \ core network, e.g. Non-SBI, or SBI, or roaming interfaces). "
  detections:
  - component: Network Traffic Content
    detects: Data sent over the network or radio interface can be analyzed to check
      what type of integrity algorithm is being used.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT5009
  mitigations:
  - fgmid: FGM1047
    mitigates: Monitor periodically if integrity protection algorithm is enabled.
    name: Audit
  name: Weaken Integrity
  object-type: technique
  platforms: RAN, core
  postconditions:
  - description: Subscriber data session does not get setup (DoS) or gets interrupted,
      spoofed or redirected during an active session.
    name: Subscriber data session impact
  preconditions:
  - description: Adversary gets hold of an end point such as gNB to manipulate signaling.
    name: Adversary controlling end point
  procedureexamples:
  - description: An adversary may manipulate gNB signaling to enable NULL integrity
      over the radio interface (Uu).
    name: Weaken integrity over radio interface
  - description: An adversary may change network configuration so that IPSec is not
      enabled between gNB and UPF (N3) or between gNB and AMF (N2).
    name: Weaken integrity on the RAN to core connections
  - description: An adversary may change network configuration so that IPSec is not
      enabled between two gNBs (Xn).
    name: Weaken integrity within RAN
  - description: An adversary may disable TLS between two core NFs or between one
      or more core NFs and the Service Communication Proxy (SCP) if deployed by MNO.
    name: Weaken integrity within SBI
  - description: An adversary may disable or weaken integrity protection of the communications
      between SEPPs (N32 which uses JWS for example) or between visited PLMN UPF and
      home PLMN UPF (N9).An adversary may weaken integrity protection on N26 interface
      between MME and AMF.
    name: Weaken integrity on the roaming/interconnect
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: fight_technique
- access-required: None
  architecture-segment: RAN, O-RAN
  bluf: An adversary may alter or spoof network signaling so as to enable the NULL
    integrity algorithm thus allowing for manipulation of user data or signaling over
    the radio interface, for example to redirect traffic.
  campaigns: []
  criticalassets:
  - description: UE signaling data integrity.
    name: UE control plane data
  - description: UE user plane data integrity.
    name: UE user plane data
  description: "An adversary may alter or spoof network signaling so as to enable\
    \ the NULL integrity algorithm thus allowing for manipulation of user data or\
    \ signaling over the radio interface, for example to redirect traffic.\r\n\r\n\
    Several procedures and interfaces can be implemented incorrectly or misused by\
    \ an adversary in control over a gNB or core NF and may result in a configuration\
    \ that calls for the NULL integrity algorithm to protect data sent over the radio\
    \ interface. The data sent is user signaling -- Non-Access Stratum (NAS) or Access\
    \ Stratum (AS) Control Plane (CP) -- or subscriber data -- AS User Plane (UP).\
    \ These actions can be followed by another adversarial behavior whereby data and\
    \ signaling sent over the radio interface is manipulated or tampered with. "
  detections:
  - component: Network Traffic Content
    detects: Inspect radio/airlink traffic and watch for unauthorized changes as the
      packets move through the interfaces.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Application Log Content
    detects: Check for unusual changes in gNB, SMF, AMF user profile, policy, and
      configuration data. Configuration audits by OSS/BSS to detect for example, user
      session redirects.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5009.001
  mitigations:
  - fgmid: FGM5024
    mitigates: Ensure gNB implementation and SMF implementations are both checking
      the UE CP and UP security policy against the most trustworthy source and taking
      action to not enable NULL integrity except for emergency calls.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM5006
    mitigates: UE should refuse to set up radio bearer and PDU session without integrity
      protection.
    name: Restrictive User Profile
  - fgmid: FGM1018
    mitigates: Network element security safeguards for gNBs, AMFs and SMFs. Includes
      measures in clause 5.3.4 of [2] (e.g. software updates, OA&M access security,
      secure boot).
    name: User Account Management
  - fgmid: FGM1031
    mitigates: Implement network intrusion prevention methods.
    name: Network Intrusion Prevention
  - fgmid: FGM1043
    mitigates: Implement credential access protection methods.
    name: Credential Access Protection
  name: Radio Interface
  object-type: technique
  platforms: RAN
  postconditions:
  - description: 'Control Plane (CP): All UE signaling data may be tampered with if
      both NAS and AS CP (i.e., RRC) algorithms are weakened. User Plane (UP): Subscriber
      (user) data may be tampered with if AS UP algorithms are weakened.As a result,
      subscriber data session does not get setup (DoS) or gets interrupted during
      an active session.'
    name: UE data not integrity protected on air interface
  preconditions:
  - description: A rogue gNB may be required to change the UE's CP & UP supported
      algorithms to NULL. It's easier to achieve control over a gNB than over the
      AMF or SMF itself. But then if the AMF and SMF are not rogue just not configured
      to do these additional checks, then control over a rogue gNB is sufficient.This
      behavior is possible with only control over the AMF, in which case the algorithm
      for CP and UP protection may be changed to NULL.
    name: Rogue or misconfigured AMF or SMF or gNB or MME
  procedureexamples:
  - description: Adversary (e.g. with false gNB) intentionally configures NULL integrity
      algorithm to have highest priority in gNB. These algorithms are sent to the
      UE in the Access Stratum (AS) Security Mode Command (SMC). Normally the activation
      of algorithms for the AS is done by the gNB based on that policy received from
      the SMF, but a false gNB can ignore the SMF. Clauses 6.7.3 & D.1 of [2].Adversary
      with control over a legitimate gNB, and who currently serves the UE, tells the
      SMF that the UE Control Plane (CP) and User Plane (UP) policy is NULL integrity,
      and the (legit but not correctly implemented) SMF doesn't check that against
      the locally configured UE CP & UP policy and lets the CP and UP data use NULL
      integrity. Clause 6.6.1 of [2].
    name: False or misconfigured base station
  - description: Adversary makes the unauthorized change in the SMF CP & UP local
      policy to enable NULL integrity for CP & UP traffic.Alternatively, adversary
      exploits an SMF that is not implemented to check (for every UE it serves) that
      the algorithm received from gNB - (which may be compromised or false) matches
      the local policy. That local policy in turn should be checked that it is the
      same as the UE policy stored in the UDM. Any of these failures can result in
      the SMF enabling the CP and UP traffic over the radio interface to use NULL
      integrity.
    name: Rogue or misconfigured SMF
  - description: Adversary with control over AMF (or by misconfiguration of AMF) can
      affect UE procedures such as NAS Security Mode Command, such that the UE's NAS
      data is not protected, i.e. prioritize NULL algorithm for either NAS encryption
      or integrity. Clause K.2.3.3. of [1]. This can be followed by another behavior
      whereby data manipulation can be done over the air interface for signaling data.
      Clauses 5.3.2, 5.3.3, 5.5.1 and 5.5.2 of [2].
    name: Rogue or misconfigured AMF non-roaming
  - description: Compromised source AMF sends incorrect UE context information to
      legitimate target AMF during either (a) Initial registration & roaming or (b)
      Handover (N2 based).Source AMF sends null integrity algorithm information as
      part of the "UEContextTransfer" (initial registration & roaming) or "CreateUEContext"
      (N2 handover) service request messages. All UE data will be sent without integrity
      protection after registration or handover is completed. Clauses 4.2.2.2.2, 4.9.1.3.1
      & 5.2.2.1 of [3]. The rogue AMF sets CP and UP security algorithms in UE security
      capabilities to NULL only.
    name: Rogue or misconfigured AMF during roaming/handover
  - description: Compromised source MME sends incorrect UE context information to
      legitimate target AMF during EPS to 5GS handover and roaming with and without
      N26 interface.Source MME sends NULL integrity algorithm information as part
      of the EPS security context to target AMF. All UE data will be sent without
      integrity protection after roaming or handover is completed. Clauses 4.11.1.2.2.2,
      4.11.1.3.3, 4.11.2.3 & 5.2.2.1 of [3], 8.4 of [2]. The rogue MME sets CP and
      UP security algorithms in UE security capabilities to NULL only.
    name: Rogue or misconfigured MME during EPS to 5GS roaming/handover
  references:
  - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes", v17.4.0, June 2022.](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System", v 17.6.0, June 2022.](https://www.3gpp.org/DynaReport/33501.htm)'
  - '<a name="3"> \[3\] </a> [3GPP TS 23.502: "Procedures for the 5G System (5GS)",
    v17.5.0, June 2022.](https://www.3gpp.org/DynaReport/23502.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5009
  tactics:
  - TA0005
  typecode: fight_subtechnique
- access-required: N/A
  architecture-segment: RAN, O-RAN, Control Plane, User Plane, Roaming
  bluf: An adversary may change the configuration of network nodes so as to disable
    or weaken integrity protection on the network interfaces Non-SBI, SBI and Roaming,
    thus allowing for transmitted data manipulation.
  campaigns: []
  criticalassets:
  - description: Any of the subscriber user plane data sourced or destined to the
      UE.
    name: UE user plane data
  - description: Any of the subscriber signaling traffic between UE and network.
    name: UE signaling data
  - description: Any of the signaling traffic between 5G core NFs, between 5G core
      and RAN, within RAN and between 5G and 4G core networks.
    name: Network signaling
  description: "An adversary may change the configuration of network nodes so as to\
    \ disable or weaken integrity protection on the network interfaces Non-SBI, SBI\
    \ and Roaming, thus allowing for transmitted data manipulation.\r\n\r\nThe following\
    \ network interfaces are in the scope of this document.\r\n\r\n1. \"Non-SBI\"\
    \ (non-Service Based Interface) network interfaces are within 5G core (e.g. N4)\
    \ and RAN (e.g. Xn, F1, E1, E2), and between the RAN and the 5G Core (e.g. N2,\
    \ N3). \r\n\r\n2. SBI network interfaces are between core NFs within an operator\
    \ network; they use REST APIs.\r\n\r\n3. Roaming and interconnect interfaces,\
    \ including IPX/GRX, are between network operators (between SEPPs (N32), or other\
    \ interworking functions like AMF/MME (N26) and between the UPFs owned by different\
    \ network operators (N9)).\r\n\r\nAn adversary with control over gNB or AMF or\
    \ UPF or SMF may disable IPSec on non-SBI interfaces (Xn, F1, E1, E2, N2, N3,\
    \ N4). IPSec is expected to be used to protect all non-SBI links, however, unlike\
    \ radio communications, operator RAN to core communications do not mandate integrity\
    \ protection.\r\n\r\nAn adversary with access to the SBI links, for example, with\
    \ control over one or more core network NFs or a middlebox (including the Service\
    \ Communication Proxy (SCP) if deployed), may disable use of TLS or use older\
    \ TLS version such as v1.1. TLS is expected (by 3GPP standards) to be used to\
    \ protect all SBI links within the operator core network. \r\n\r\nAn adversary\
    \ with control over roaming nodes or interfaces - namely SEPP or IPX network --\
    \ may disable or cause to use a weak integrity algorithm for TLS or JWS signatures\
    \ on the N32 interface. An adversary with control over visited network UPF may\
    \ disable IPSec on N9 interface or a compromised MME or AMF may disable IPSec\
    \ on N26 interface. "
  detections:
  - component: Network Traffic Content
    detects: Inspect network traffic and watch for unauthorized changes as the packets
      move through the interfaces.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Application Log Content
    detects: Check configuration changes in gNB, core NFs, SEPP and MME.Run configuration
      audits by OSS/BSS.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5009.002
  mitigations:
  - fgmid: FGM5024
    mitigates: Use strong integrity protection on all non-SBI, SBI and roaming/interconnect
      interfaces. That is, TLS should be used in all SBI, N32-c and N32-f and PRINS
      in N32-f when TLS is not used. IPSec should be used in all non-SBI interfaces.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1018
    mitigates: Network element security safeguards for gNB and all core NFs using
      strong user access management.
    name: User Account Management
  - fgmid: FGM1051
    mitigates: Network element security safeguards for gNB and all core NFs by doing
      regular software updates for using the latest security patches.
    name: Update Software
  - fgmid: FGM1046
    mitigates: Network element security safeguards for gNB and all core NFs by using
      secure booting methods for all servers.
    name: Boot Integrity
  - fgmid: FGM1031
    mitigates: Implement network intrusion prevention methods to filter traffic at
      the network perimeter.
    name: Network Intrusion Prevention
  - fgmid: FGM1043
    mitigates: Implement credential access protection methods to block unauthorized
      network access attempts.
    name: Credential Access Protection
  name: Network Interfaces
  object-type: technique
  platforms: RAN, core
  postconditions:
  - description: UE signaling with network and user plane data may be impacted. This
      can be used to cause DoS.
    name: UE at risk of data manipulation
  - description: Network communication within core network or on the non-SBI interfaces
      or on roaming interface may be impacted.
    name: Network signaling at risk of data manipulation
  preconditions:
  - description: Adversary must have access to the network components to cause the
      behaviors.
    name: Rogue or misconfigured AMF or SMF or gNB or UPF or SEPP or MME or any other
      core NF.
  procedureexamples:
  - description: A rogue or misconfigured gNB can disable IPSec integrity or use a
      weak IPSec integrity algorithm on N2, N3, F1, E1, E2 and Xn interfaces. Then
      it can launch other behaviors. Clause D.2.2 of [1].
    name: Compromised or misconfigured gNB
  - description: A rogue or misconfigured AMF can disable integrity protection or
      use a weak integrity algorithm on N2 and N26 interfaces. Then it can launch
      other behaviors. Clause K.2.1 of [1], clause 5.5.2 of [2].
    name: Compromised or misconfigured AMF
  - description: A rogue or misconfigured UPF can disable IPSec integrity or use a
      weak IPSec integrity algorithm on N3, N4 and N9 interfaces. Then it can launch
      other behaviors. Clause L.2.1 of [1], clauses 9.3 & 9.9 of [2].
    name: Compromised or misconfigured UPF
  - description: A rogue or misconfigured SMF can disable IPSec integrity or use a
      weak IPSec integrity algorithm on N4 interface. Then it can launch other behaviors.
      Clause 9.9 of [2].
    name: Compromised or misconfigured SMF
  - description: A rogue or misconfigured NF can disable the TLS integrity or use
      a weak TLS integrity algorithm to another NF including the SCP (if deployed).
      Then it can launch other behaviors to gain unauthorized access to network services.
      Clause 13.1 of [2].If SCP is rogue or misconfigured, it can force TLS connections
      to all NFs to be unencrypted or use weak integrity for all connections. Clause
      5.9.2.4 of [2].
    name: Compromised or misconfigured NF
  - description: A rogue or misconfigured SEPP can disable TLS integrity or use a
      weak TLS integrity algorithm on N32-c interface or N32-f interface or both.A
      rogue or misconfigured IPX component can disable JWS integrity or use a weak
      integrity algorithm when PRINS is used on N32-f. Then it can launch other behaviors.
      Clauses 9.9, 13.1 and 13.2 of [2].
    name: Compromised or misconfigured SEPP or IPX component
  - description: A rogue or misconfigured AMF/MME can disable IPSec integrity or use
      a weak IPSec integrity algorithm on N26 interface. Then it can launch other
      behaviors. Clause K.2.1 of [1], 8.4 of [2].
    name: Compromised or misconfigured MME/AMF
  references:
  - '<a name="1"> \[1\] </a> [3GPP TR 33.926: "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes."](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [3GPP TS 33.501: "Security architecture and procedures
    for 5G System."](https://www.3gpp.org/DynaReport/33501.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5009
  tactics:
  - TA0005
  typecode: fight_subtechnique
- access-required: Admin
  architecture-segment: Control Plane
  bluf: An adversary-controlled AMF may register itself in the UDM as the serving
    network for a victim's UE, enabling further attacks like fraud or the retrieval
    of the UE's subscription data.
  campaigns: []
  criticalassets:
  - description: Functionality of this core network function
    name: UDM functionality
  - description: Data (user plane or signaling) belonging to the UE
    name: UE data
  - description: Physical geo-location (coarse or fine) of the UE
    name: UE location
  description: "An adversary-controlled AMF may register itself in the UDM as the\
    \ serving network for a victim's UE, enabling further attacks like fraud or the\
    \ retrieval of the UE's subscription data.\r\n\r\nA User Equipment (UE) can be\
    \ legitimately de-registered or forced to de-register. The Unified Data Management\
    \ (UDM) is the core network function responsible for maintaining the UE's registration\
    \ status and data. UEs register with an Access and Mobility Management Function\
    \ (AMF), which then becomes their serving AMF.\r\n\r\nAn adversary may exploit\
    \ a flawed UDM implementation that fails to update a UE's authentication status\
    \ after a de-registration event or allows the authentication status to remain\
    \ incorrect. This vulnerability enables a malicious AMF to register itself in\
    \ the UDM using the\_Nudm_UECM_Registration Request\_API call. In this scenario,\
    \ the adversary-controlled AMF can falsely associate itself as the serving AMF\
    \ for the UE.\r\n\r\nThis exploit also applies to other network functions, such\
    \ as the Session Management Function (SMF) and the Short Message Service Function\
    \ (SMSF), using the same API to interact with the UDM.\r\n\r\nFor this attack\
    \ to succeed, the UDM must be improperly implemented. Specifically, the UDM must\
    \ fail to mark a UE as de-registered when the UE powers off, enters airplane mode,\
    \ or is legitimately or illegitimately de-registered by the network."
  detections:
  - component: Host Status
    detects: Audit UDM host UE status, errors, or other notable functional activity
      at least twice during its life cycle.
    fgdsid: FGDS0013.001
    name: Sensor Health
  groups: []
  id: FGT5010
  mitigations:
  - fgmid: FGM5013
    mitigates: Implement security as per clause 6.1.9 of [4], namely OAuth2.0
    name: Timely Updates To UE Status
  - fgmid: FGM5014
    mitigates: Cross check whether the requesting AMF is likely to be the one serving
      that UE now. Validate the expected geography of where UE actually may be, in
      comparison to the area that the requester AMF is supposed to serve.
    name: UE Location Plausibility
  - fgmid: FGM5023
    mitigates: Periodic authentication / authorization of NF consumer e.g. AMF by
      NRF will help detect rogue AMFs. Not currently in 3GPP/GSMA (TBC) specs, but
      it can be enhanced. It's process management (OA&M)
    name: Periodic Authentication & Authorization Of NFs
  name: Fraudulent AMF Registration For UE In UDM
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: A rogue AMF could launch other attacks on the victim UE, but the
      UE is not currently registered on the network. For example, the AMF can ask
      the LMF for the location of that UE; this may work if the UE is actually registered
      to this network, otherwise, it will return the last known location.
    name: Follow on attacks by rogue AMF
  preconditions:
  - description: If the UDM does not store the authentication status of a UE, or the
      authentication status is incorrect.
    name: Faulty UDM implementation
  procedureexamples:
  - description: An adversary in control of an AMF registers that AMF in UDM (via
      Nudm_UECM_Registration Request) as serving a given UE that de-registered. If
      the UDM implementation does not update the authentication status of UEs as de-registered,
      it will accept that AMF. The adversary-controlled AMF can then potentially perform
      additional hostile actions such as fraud, claiming to have provided services
      for the UE, or obtaining other UE information from the UDM such as subscriber
      data, or asking for the UE location from the LMF (Location Management Function).
    name: Adversary registers an AMF it controls as the one serving a given UE that
      just de-registered
  references:
  - '<a name="1"> \[1\] </a> [3rd Generation Partnership Project (3GPP) TR 33.926:
    "Security Assurance Specification (SCAS) threats and critical assets in 3GPP network
    product classes", Technical Report, v17.3.0, Dec. 2021, clause E.2.2.3](https://www.3gpp.org/DynaReport/33926.htm)'
  - <a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TR 33.846,"
    Study on authentication enhancements in the 5G System (5GS)", Technical Report,
    v17.0.0, December 2021, clause 5.3.1.2](https://www.3gpp.org/DynaReport/33846.htm)
  - '<a name="3"> \[3\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="4"> \[4\] </a> [3GPP TS 29.503: "5G System; Unified Data Management
    Services; Stage 3"](https://www.3gpp.org/DynaReport/29503.htm)'
  software: []
  status: Theoretical
  tactics:
  - TA0009
  typecode: fight_technique
- access-required: Admin
  architecture-segment: ICAM, Control Plane
  bluf: An adversary controlling an (external) Application Function (AF) may present
    a fraudulent OAuth access token to access Network Exposure Function (NEF) services.
  campaigns: []
  criticalassets:
  - description: Network services exposed by the NEF.
    name: Operator services
  description: "An adversary controlling an (external) Application Function (AF) may\
    \ present a fraudulent OAuth access token to access Network Exposure Function\
    \ (NEF) services.\r\n\r\nA mobile network operator has access to a variety of\
    \ user and network data by virtue of the services it provides to subscribers.\
    \ As a business extension, some of these capabilities, events and data can be\
    \ offered to other partner business entities. The Network Exposure Function securely\
    \ exposes such cellular network services to authorized third-party applications.\
    \ The standard mandates TLS between NEF and AF and authorization via OAuth 2.0.\r\
    \n\r\nExamples of the data that can be shared are device analytics, user traffic\
    \ routing, device location and mobility events: for example, notifications are\
    \ sent whenever a user (which is e.g. part of a group subscribed to a third party\
    \ service) enters a certain geographical perimeter (e.g. a mall or campus), since\
    \ the operator keeps track of the base stations to which devices are connected.\r\
    \n\r\nA malicious AF with a fraudulent (stolen, altered, or constructed) access\
    \ token may invoke the NEF services arbitrarily. "
  detections:
  - component: Application Log Content
    detects: Logs of connection attempts and API transactions to NEF.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5011
  mitigations:
  - fgmid: FGM1040
    mitigates: Prevent suspicious API calls to NEF by using API gateway e.g. GSMA
      Open Gateway. [3]
    name: Behavior Prevention On Endpoint
  - fgmid: FGM5003
    mitigates: Ensure NEF checks AF credentials across layers (TLS, OAuth2.0), and
      has a list (provided out of band) with all the allowed AF by unique identifier
      (or type of AF), and to which service they are allowed access (this access may
      be general, not per UE).
    name: Cross Check Between Application Layer And Transport Layer
  - fgmid: FGM5019
    mitigates: NEF should authorize API calls from external AFs for all service accesses,
      via OAuth token verification.
    name: Authorize External API Calls
  name: Unauthorized Access To Network Exposure Function (NEF) Via Token Fraud
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: Adversary has access to network services exposed by NEF.
    name: Network services exposed by NEF
  preconditions:
  - description: Access to some MNO services to gain knowledge about tokens to access
      the NEF
    name: MNO service access
  procedureexamples:
  - description: An adversary may conduct OAuth2.0 attacks that are applicable to
      machine-to-machine communication (not email phishing type attacks). Fraudulent
      token is mentioned in section I.2.2.2 of [1]. Other threats are listed in [2].
    name: OAuth 2.0 token attacks
  references:
  - <a name="1"> \[1\] </a> [3GPP TR 33.926 Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes.](https://www.3gpp.org/DynaReport/33926.htm)
  - <a name="2"> \[2\] </a> [Internet Engineering Task Force, IETF RFC 6819 "OAuth
    2.0 Threat Model and Security Considerations", Jan. 2013.](https://datatracker.ietf.org/doc/html/rfc6819)
  - <a name="3"> \[3\] </a> [GSMA Open Gateway](https://www.gsma.com/solutions-and-impact/gsma-open-gateway/)
  software: []
  status: Theoretical
  tactics:
  - TA0008
  - TA0001
  typecode: fight_technique
- architecture-segment: RAN, Control Plane, Roaming, UE
  bluf: An adversary may obtain the UE location using radio access or core network
    or the roaming fabric.
  campaigns: []
  criticalassets:
  - description: UE/User geographical location, coarse or fine-grained
    name: UE location
  description: "An adversary may obtain the UE location using radio access or core\
    \ network or the roaming fabric.\r\n\r\nAdversary may employ various means to\
    \ obtain UE location (coarse, fine) using radio access or core network or the\
    \ roaming network between operators. The UE consists of Mobile Equipment (ME),\
    \ that is, the device, and the Universal Subscriber Identity Module (USIM) card."
  detections: []
  groups: []
  id: FGT5012
  mitigations: []
  name: Locate UE
  object-type: technique
  platforms: 5G Core, 5G RAN
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Adversary may use the radio access network to determine that a particular
      UE is in the area, or where exactly the UE is located
    name: Use radio access to locate UE
  - description: Adversary may use the core network signaling to trigger the procedure
      of locating a particular UE via RAN
    name: Use core network signaling to locate UE
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  - <a name="3"> \[3\] </a> [S. Tomasin, Stefano & Centenaro, Marco & Seco-Granados,
    Gonzalo & Roth, Stefan & Sezgin, Aydin. (2021). Location-Privacy Leakage and Integrated
    Solutions for 5G Cellular Networks and Beyond. Sensors. 21. 5176. 10.3390/s21155176.](https://www.researchgate.net/publication/353641837_Location-Privacy_Leakage_and_Integrated_Solutions_for_5G_Cellular_Networks_and_Beyond)
  - <a name="4"> \[4\] </a> [S. Holtmanns, S. P. Rao, I. Oliver, "User location tracking
    attacks for LTE networks using the interworking functionality", 2016 IFIP Networking
    Conference.](https://ieeexplore.ieee.org/document/7497239)
  software: []
  status: Observed
  tactics:
  - TA0007
  - TA0009
  typecode: fight_technique
- access-required: Radio Interface
  architecture-segment: RAN
  bluf: An adversary may non-cooperatively geolocate a UE from UE radio signal externals.
  campaigns: []
  criticalassets:
  - description: UE/subscriber geographical location
    name: User location
  description: "An adversary may non-cooperatively geolocate a UE from UE radio signal\
    \ externals.\r\n\r\nAn adversary may geolocate an UE by using radio access technology\
    \ or \"RF externals\", such as Direction of Arrival, Time of Arrival, Frequency\
    \ of Arrival, Time Difference of Arrival, and Frequency Difference of Arrival\
    \ of UE signals, or the 5G New Radio (5G NR) multi RTT (round trip time) and angle-based\
    \ methods, or non-3GPP access data (e.g. WiFi access points/IP addresses).\r\n\
    \r\nThe UE does its own geolocation from base station transmissions, but an adversary\
    \ with multiple receivers can geolocate a UE from the differential time of arrival\
    \ of UE transmitted signal events completely independently of the process the\
    \ UE is doing to geo-locate itself. "
  detections: []
  groups: []
  id: FGT5012.001
  mitigations:
  - fgmid: FGM5099
    mitigates: Move UE closer to base station and/or reduce height of UE above terrain
      and/or move indoors or into multipath environment.
    name: Move UE Close To gNB
  - fgmid: FGM5098
    mitigates: Reduce usage. Use UE only when needed, turn UE off if not needed for
      period of time.
    name: Reduce UE Usage
  name: Passive Radio Signals Observation
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Geolocation can make electronic attack for degradation of service
      more effective, bidding down to defeat ID and traffic confidentiality more effective,
      and can expose subscriber to physical attack.
    name: Subsequent adversarial behaviors possible
  preconditions:
  - description: Adversary must have radio line-of-sight to target for most accurate
      geolocation.
    name: Line-of-sight
  procedureexamples:
  - description: Adversary geolocates unknown UE using some combination of Direction
      of Arrival, Time-of-Arrival, and/or Frequency-of-Arrival of UE signal externals.
    name: Externals geolocation
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="2"> \[2\] </a> [X. Hu et.al. "A Systematic Analysis Method for 5G Non-Access
    Stratum Signaling Security", IEEE Access, August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: Radio Interface
  architecture-segment: RAN
  bluf: An adversary may elicit location reports from a UE that is bid down to a less
    secure protocol or may passively observe location reports from UE whose air interface
    traffic is not encrypted.
  campaigns: []
  criticalassets:
  - description: UE/Subscriber geographical location.
    name: User location
  description: "An adversary may elicit location reports from a UE that is bid down\
    \ to a less secure protocol or may passively observe location reports from UE\
    \ whose air interface traffic is not encrypted.\r\n\r\nAn adversary may eavesdrop\
    \ messages exchanged between the UE and the network, if encryption for the radio\
    \ interface is not employed. The messages of interest contain location reports\
    \ that the UE sends to the network upon (legitimate) request from the network.\
    \ The adversary may be able to derive one or more UE's coarse location from the\
    \ intercepted measurement reports and cell site geographical data. \r\n\r\nThere\
    \ is no detection of the passive observation. "
  detections: []
  groups: []
  id: FGT5012.002
  mitigations:
  - fgmid: FGM5006
    mitigates: Prevent insecure user profile configuration in network or UE. Do not
      use unencrypted systems. Set subscriber security profile to prohibit bidding
      down to less secure service.
    name: Restrictive User Profile
  - fgmid: FGM5096
    mitigates: Disable location on UE device for all applications which use UE's physical
      location. This is only a partial mitigation because location measurements will
      be sent by the UE to gNB.
    name: Disable UE Location Use
  - fgmid: FGM1041
    mitigates: Avoid systems that employ null encryption. De-register when only NULL
      encryption is offered
    name: Encrypt Sensitive Information
  name: UE Measurement Reports
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Geolocation can make electronic behavior for degradation of service
      more effective, bidding down to defeat ID and traffic confidentiality more effective,
      and can expose subscriber to physical attacks.
    name: Subsequent adversarial behaviors possible
  preconditions:
  - description: Subscriber security profile must allow bidding down to less secure
      format OR system does not employ over-the-air encryption.When a subscriber transitions
      to less secure service, the logs in the UE will indicate RAT transition events.
      The logs in the operator network (e.g. UE context data in the UDR/UDM) will
      indicate that UE has transitioned to a less secure network.
    name: Permissive subscriber security profile OR system does not employ over-the-air
      encryption.
  - description: Adversary must be present in the same area where the UE is located.
    name: Adversary present in the vicinity of victim UE
  procedureexamples:
  - description: Victim UE is using a 5G system with NULL encryption or is bid down
      to a less secure protocol. UE geolocation or geolocation measurement data is
      passively observed or, if bid down, actively ordered through illegitimate signaling.
    name: Self-location measurement
  - description: Adversary eavesdrops on unencrypted measurement reports sent by UE
      to gNB which contain Reference Signal Received Power (RSRP) from serving cell
      and neighbor cells. By using cell site location data (Latitude, Longitude) and
      RSRPs, coarse location of a UE can be calculated. [2] Note that this behavior
      does not identify a specific UE's location (with known IMSI/SUPI). It only identifies
      the location of one or more UEs if those are present in the area.
    name: Eavesdropping on measurement reports
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [Zaenab Shakir et al: "Position Location Based on Measurement
    Reports in LTE Cellular Networks".](https://ieeexplore.ieee.org/document/8363501)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: Air Interface
  architecture-segment: ICAM, Control Plane, RAN
  bluf: An adversary can track a device (get cell-level location) by listening for
    the same temporary identifier being sent to the network.
  campaigns: []
  criticalassets:
  - description: Location is accurate to a cell area, since the sniffer device has
      to be close enough to hear the UE send its 5G GUTI
    name: User location
  description: "An adversary can track a device (get cell-level location) by listening\
    \ for the same temporary identifier being sent to the network.\r\n\r\nThe AMF\
    \ handles UE registration every time the UE connects to the network anew. As part\
    \ of this registration, a 5G Globally Unique Temporary Identifier (5G-GUTI) is\
    \ assigned to the UE, so as to avoid using the sensitive UE permanent identifier.\
    \ The UE sends the 5G-GUTI in the clear to the network as part of service procedures\
    \ it initiates, and so this identifier can be eavesdropped by any duly-equipped\
    \ UE or wireless sniffer nearby.\r\n\r\nFor 4G or 5G NSA, the GUTI is used. Note\
    \ that GUTI and 5G-GUTI contain the UE temporary identifier M-TMSI and respectively\
    \ 5G TMSI.\r\n\r\nThis is a passive attack. If AMF doesn't allocate a new 5G-GUTI\
    \ in certain registration scenarios, an adversary could keep on tracking the user\
    \ using the old 5G-GUTI after these registration procedures. This attack has been\
    \ observed in 4G where the UE was allocated the same GUTI. "
  detections:
  - component: Paging channel
    detects: Audit the Paging channel after the broadcast of at least the third (3rd)
      unique Page to the device or service request from the device. Flag GUTI reuse
      if it persists after this audit
    fgdsid: FGDS5002.003
    name: Radio interface
  groups: []
  id: FGT5012.003
  mitigations:
  - fgmid: FGM5094
    mitigates: Ensure AMF implementation allocates new 5G-GUTI to a given UE, every
      time possible.
    name: Allocate New 5G Identifiers Judiciously
  name: 5G-GUTI Reuse
  object-type: technique
  platforms: 5G RAN
  postconditions: []
  preconditions:
  - description: Adversary must be present in the same area where the UE is located.
    name: Adversary present in the vicinity of victim UE
  procedureexamples:
  - description: Reportedly several operators do not re-allocate GUTI with every UE
      registration, or they do not re-allocate often enough or they use predictable
      pattern, as in [1], [2]. Exact 5G-GUTI refresh mechanism is left to implementation.
      Mandatory refresh of 5G-GUTI is to be done by AMF for initial registration,
      mobility registration update and network-initiated service request message due
      to paging, see clause 6.12.3 of [3].It is not necessary for the adversary to
      have a UE to listen, a simpler listening device suffices.
    name: Listen in for re-used 5G-GUTIs to determine UE presence in that area.
  references:
  - '<a name="1"> \[1\] </a> [B. Hong, S. Bae, Y. Kim, "GUTI Reallocation Demystified:
    Cellular Location Tracking with Changing Temporary Identifier", NDSS Symposium,
    2018.](https://www.ndss-symposium.org/wp-content/uploads/2018/02/ndss2018_02A-4_Hong_paper.pdf)'
  - '<a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TR 33.926:
    "Security Assurance Specification (SCAS) threats and critical assets in 3GPP network
    product classes", Technical Report, v17.3.0, December. 2021, clause K.2.7.1](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="3"> \[3\] </a> [3rd Generation Partnership Project (3GPP) TR 33.501:
    "Security architecture and procedures for 5G system", Technical Specification,
    v17.5.0, March 2022](https://www.3gpp.org/DynaReport/33501.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: Admin/User
  architecture-segment: Control Plane
  bluf: An adversary in the core network exploits signaling protocols to obtain the
    location of the UE.
  campaigns: []
  criticalassets:
  - description: NEF, AMF, SMF, UPF, NWDAF, GMLC, LMF
    name: Operator network components
  - description: UE/Subscriber geographical location, various degrees of accuracy
    name: User location
  description: "An adversary in the core network exploits signaling protocols to obtain\
    \ the location of the UE.\r\n\r\nUser location tracking is part of normal cellular\
    \ operation. Adversaries with access to core network or a core network function\
    \ (NF) can misuse signaling protocols (e.g., GTP or the SBI API calls), or exploit\
    \ vulnerabilities in the signaling plane, in order to obtain location information\
    \ for a given UE.\r\n\r\nNote: In case of 3G/4G core networks using SS7/Diameter,\
    \ this technique is covered by [ATT&CK Mobile T1430.002 Location Tracking: Impersonate\
    \ SS7 nodes](https://attack.mitre.org/techniques/T1430/002/) and by FiGHT technique\
    \ [Locate UE: Diameter or SS7 Signaling](https://fight.mitre.org/techniques/FGT5012.008).\
    \ \r\n\r\n "
  detections:
  - component: Network Traffic Content
    detects: It is difficult to distinguish legitimate from illegitimate traffic.
      Monitor all communications on the SBA and to/from core network, looking for
      context (e.g. is the REST API coming from a suspected NF?). Use signaling firewalls,
      Intrusion Detection/Prevention Systems (IDS/IPS) to detect and/or block unexpected/fraudulent
      API calls between NFs.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Application Log Content
    detects: Look at logs at affected NF e.g. AMF, watch for any indications of illegitimate
      location API requests.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5012.004
  mitigations:
  - fgmid: FGM1037
    mitigates: Filter out request messages that come from external (to the operator)
      sources to guard against SS7 attacks.
    name: Filter Network Traffic
  - fgmid: FGM5019
    mitigates: NEF authorizes 3rd party AFs for location service using policy. Nnef_Location
      API called by AF should be authorized properly. AF uses GPSI as UE identity.
    name: Authorize External API Calls
  - fgmid: FGM5023
    mitigates: Periodic authentication / authorization of NF consumer e.g. AMF by
      NRF will help detect rogue AMFs. Not currently in 3GPP specs, but it can be
      enhanced.
    name: Periodic Authentication & Authorization Of NFs
  name: Core Network Function Signaling
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions:
  - description: Adversary has to gain control of one core NF.
    name: Access to operator's network function
  - description: UE identifier required for all Core network function abuse.
    name: Knowledge of the UE SUPI or GPSI, 5G-GUTI of target UE
  procedureexamples:
  - description: The AMF gets UE location legitimately from LMF (Nlmf-loc API), as
      in clause 8.3 of [4]. In addition, an adversary can modify AMF behavior so that
      it doesn't allocate a new 5G-GUTI to a given UE, so that that UE can be tracked
      via listening devices in the area, see [FGT5012.003](/techniques/FGT5012.003).
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      AMF case'
  - description: Incorrect implementation/configuration in NEF can allow a rogue application
      function (AF) to access UE location information using LMF services. Clause 6.1.2
      of [4].
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      AF case'
  - description: 'Opportunistic procedure: The SMF can obtain a UE''s location whenever
      the AMF sends it a PDU update request:  Nsmf_PDUSession_UpdateSMContextRequest
      (which contains UE location info, which can be: E-UTRA or NR cell id, location
      timestamp, "geographicalInformation" in hex format as in TS 23.032, only ellipsoid
      point with uncertainty circle.). Clause 5.2.8.2.6 of [3].'
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      SMF case'
  - description: The UDM can legitimately ask the AMF for the location of a UE using
      Namf_Location service. Clause 5.2.2.1 of [3].
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      UDM case'
  - description: The UPF has access to serving cell ID for UEs that are actively sending
      data (RRC connected).
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      UPF case'
  - description: 'The NEF can legitimately ask AMF Namf_EventExposure or ask GMLC
      directly - then GMLC gives the NEF a location report (Note: NEFs serve as location
      proxies to internal and external AFs in the same way GMLCs serve as proxies
      to external LCS clients). Clause 5.2.2.1 of [3].'
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      NEF case'
  - description: The NWDAF can get coarse UE location by subscribing to events from
      AMF. Clause 5.2.2.1 of [3].
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      NWDAF case'
  - description: The GMLC can legitimately ask the AMF for the location of a given
      UE using Namf_Location service. Clause 5.2.2.1 of [3].
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      GMLC case'
  - description: The LMF can initiate location procedure with the UE. Clauses 6.11.1,
      6.11.2, 6.11.3 of [4].
    name: 'Adversary gains control of a core NF to get location info for a given UE:
      LMF case'
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  - "<a name=\"2\"> \\[2\\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,\
    \ \"Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK\"\
    ,\_ October 2021](https://arxiv.org/abs/2108.11206)"
  - <a name="3"> \[3\] </a> [3GPP TS 23.502 "Procedures for the 5G System (5GS)"](https://www.3gpp.org/DynaReport/23502.htm)
  - <a name="4"> \[4\] </a> [3GPP TS 23.273 "5G System (5GS) Location Services (LCS)"](https://www.3gpp.org/DynaReport/23273.htm)
  software: []
  status: Theoretical
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: User/Admin Of Slice
  architecture-segment: Control Plane, Network Slice
  bluf: An adversary may use a legitimate access token for a shared Network Function
    (NF) to get location info of a user of a different network slice.
  campaigns: []
  criticalassets:
  - description: UE/Subscriber geographical location, coarse or fine-grained
    name: User location
  description: "An adversary may use a legitimate access token for a shared Network\
    \ Function (NF) to get location info of a user of a different network slice.\r\
    \n\r\nAn adversary controlling a slice or a NF in a slice obtains an access token\
    \ for a shared 5G core NF (e.g., AMF) and uses it to get location info for a UE\
    \ belonging to a different slice but still served by same shared NF."
  detections:
  - component: Application Log Content
    detects: Regularly audit applications and interface messaging logs. Check logs
      of requests/responses at the shared NF. E.g., each entry should contain SUPI,
      NF consumer that requested it, slice IDs of both.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5012.005
  mitigations:
  - fgmid: FGM5012
    mitigates: Cross check requested SUPI is served by (belongs to) the slice ID (NSSAI)
      of the consumer NF, i.e., the adversary NF (slice ID is present in the authorization
      Token). That is, this adversarial behavior could be mitigated if the shared
      network function (service producer) checks that the SUPI in the service request
      and the requesting NF (service consumer) are being served by the same slice.
    name: Slice ID Check
  name: Shared Network Function In Slice
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Target slice information is leaked, slice confidentiality is breached
      due to sharing the NF between slices.
    name: UE's location is tracked by rogue NF
  preconditions:
  - description: 'Two slices share one common NF that is legitimately allowed to obtain
      UE location info. Adversary has control of one slice or at least a NF in that
      slice -- where said NF is allowed to talk to the AMF.The following core NFs
      can legitimately ask for or obtain directly the location of a UE (some granularity):
      AMF, UDM, NEF, NWDAF, GMLC, LMF. The following core NFs can only get limited/coarse
      location: SMF, UPF, PCF.'
    name: Access shared NF in a different slice
  procedureexamples:
  - description: Malicious NF of a compromised slice gets access token for a shared
      AMF, but then asks AMF for the location of a UE in the target slice. The AMF
      checks that the authorization (OAuth) token is ok, which it is, but does not
      check that the UE ID is served by target slice, while the requester NF is from
      compromised slice. Section 3.1.5 of [1].
    name: Malicious NF belonging to compromised Network slice uses its token for its
      slice to get the location of a user in a different slice.
  references:
  - '<a name="1"> \[1\] </a> [AdaptiveMobile Security, "A Slice in Time: Slicing Security
    in 5G Core Networks", 17032021-v1.00, March 2021.](https://info.adaptivemobile.com/network-slicing-security)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: physical/gNB
  architecture-segment: RAN, Control Plane
  bluf: An adversary may geolocate a UE using modified Non-Access Stratum (NAS) signaling,
    for example via a false base station.
  campaigns: []
  criticalassets:
  - description: UE/Subscriber geographical location, coarse or fine-grained.
    name: User location
  description: "An adversary may geolocate a UE using modified Non-Access Stratum\
    \ (NAS) signaling, for example via a false base station.\r\n\r\nThe NAS carries\
    \ signaling that is exchanged for registration and authentication between the\
    \ UE and the Access and Mobility Function (AMF), via the gNB as a pass-through.\
    \ Adversary uses a false gNB to intercept, modify and/or replay NAS messages to\
    \ probe for UE presence in a that cell, which leads to coarse location discovery.\
    \ The victim UE tried to connect to a nearby gNB, and adversary then lured UEs\
    \ to connect to the false gNB (e.g., by increasing the transmit power of the false\
    \ gNB). "
  detections:
  - component: Signals sent by UEs
    detects: Operator standard means to detect presence of false gNBs. gNB radio signals
      (sent to all UEs to enable them to select gNB and connect) are received and
      reported by UEs to the operator, who can then run cross checks with the signals
      that the UEs should have received if all gNBs nearby were legitimate. Clause
      6.24 of [2].
    fgdsid: FGDS5002.001
    name: Radio interface
  - component: NAS messages between UE and AMF
    detects: Listen for error response messages being transmitted by UEs, as NAS authentication
      response or SMC response, if there is no air interface signaling encryption.
      Seeing these error messages may mean a false base station is used to probe for
      presence of one or more UEs
    fgdsid: FGDS5002.004
    name: Radio interface
  groups: []
  id: FGT5012.006
  mitigations:
  - fgmid: FGM1041
    mitigates: Use non-NULL encryption of radio interface (NAS, AS, RRC).
    name: Encrypt Sensitive Information
  - fgmid: FGM5024
    mitigates: Use non-NULL integrity protection of NAS messages starting with the
      SMC. If the NAS SMC is sent not integrity protected, then it can be replayed
      without detection.
    name: Integrity Protection Of Data Communication
  name: NAS Exploit
  object-type: technique
  platforms: 5G RAN, 5G Core
  postconditions: []
  preconditions:
  - description: Adversary must install a false gNB that it can control what messages
      it sends to UEs.
    name: Control of false gNB in the area where the victim UE may be located.
  - description: Adversary must acquire a fake UE to achieve the NAS SMC attack.
    name: Control of fake UE in the NAS SMC attack.
  procedureexamples:
  - description: Adversary eavesdrops one NAS message from the legitimate network
      (the Auth_Req (R, AUTN), or the NAS Security Mode Command (SMC)), then replays
      that NAS message whenever it wants to check whether the victim UE is nearby,
      since the type of error (or response, in the case of SMC) received from the
      responder indicates whether it's the victim UE or not. Thus, adversary can probe
      for UE's presence in that cell, which leads to coarse location data. See [1].
    name: Replay of NAS message
  references:
  - <a name="1"> \[1\] </a> [X. Hu et.al. "A Systematic Analysis Method for 5G Non-Access
    Stratum Signalling Security", IEEE Access, August 2019.](https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=8817957)
  - '<a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TR 33.809:
    "Study on 5G security enhancements against False Base Stations (FBS)", Technical
    Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: None
  architecture-segment: RAN, UE
  bluf: Adversary sends spoofed or silent paging messages to a UE and deduces the
    UE's location from the responses of that UE.
  campaigns: []
  criticalassets:
  - description: UEs rough location is known to the adversary which can be used for
      further attacks such as bidding down, IMSI cracking and physical attack.
    name: UE location
  - description: UE semi-permanent 5G-GUTI may be discovered.
    name: User identifier
  description: "Adversary sends spoofed or silent paging messages to a UE and deduces\
    \ the UE's location from the responses of that UE.\r\n\r\nAdversary in a particular\
    \ cellular coverage area broadcasts spoofed paging message from a false base station\
    \ or manipulates a legitimate one using a Software-defined-radio tool; alternatively,\
    \ the adversary uses a silent SMS message tool to cause the legitimate base station\
    \ to send a paging message. These paging messages can be heard by all UEs in the\
    \ area. The paging message broadcast time/frequency is calculated by the base\
    \ station based on the temporary identifier 5G-GUTI or 4G-GUTI of the target UE,\
    \ or the IMSI. It is assumed that the adversary can guess the UE's GUTI.\r\n\r\
    \nAn adversary sends multiple paging messages and then sniffs the radio interface\
    \ looking for UEs' responses to paging messages. Paging is successful if the target\
    \ UE responds. If such a set of multiple paging responses corresponding to the\
    \ paging calculated from the one given GUTI is noticed, then it can be concluded\
    \ that that UE is present in the cell area. This leads to discovery of the coarse\
    \ location of a UE. As a side benefit, a valid GUTI (or several GUTIs) is also\
    \ now discovered. \r\n\r\nBackground info: Silent SMS message is a type of SMS\
    \ that are used legitimately by mobile operators and governments to track a smartphone\
    \ subscriber's geographical location. "
  detections:
  - component: Signals sent by UEs
    detects: UE measurements of received power levels from all base stations nearby,
      and their identifiers. Clause 6.24 of [2].
    fgdsid: FGDS5002.001
    name: Radio interface
  - component: Silent SMS detector at UE side
    detects: Run at the UE side a tool to detect silent SMS messages (can be OS monitoring
      app as in [4])
    fgdsid: FGDS5024.001
    name: Silent SMS detector
  groups: []
  id: FGT5012.007
  mitigations:
  - fgmid: FGM5024
    mitigates: Run at the UE side a tool to detect and not respond to multiple silent
      SMS messages received in a short time (can be OS monitoring app as in [4])
    name: Integrity Protection Of Data Communication
  - fgmid: FGM5004
    mitigates: The operator may run a network-side SMS firewall that permits legitimate
      silent SMSs (e.g. from law enforcement) but blocks the ones from suspicious
      sources
    name: Correctly Configure SMS Firewall
  name: Silent Or Spoofed Paging
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Adversary knows the cellular base station area where the UE is located.
      Further attacks are possible such as eavesdropping on target UE's communication
      to network if UE coarse location is known to adversary.
    name: UE coarse location is known to adversary
  preconditions:
  - description: Adversary gets hold of a false base station which is capable of sending
      fraudulent paging messages.
    name: Obtain a false base station to send fake broadcast messages, or a SDR tool
      to manipulate legitimate signaling on the radio interface
  - description: Adversary develops or obtains a tool to send silent SMS (e.g. mobile
      phone with special application running)
    name: Obtain a silent SMS tool
  - description: Adversary may have already identified valid 5G-GUTIs from passive
      listening, possibly also being able to associate it with a given subscriber.
    name: Figure out a UE's 5G-GUTI (optional)
  procedureexamples:
  - description: Adversary sends fake paging message with UEs temporary identifier
      from a false base station. Sigover attack method is used to overshadow the paging
      message from legitimate base station. If the victim UE is in the area, it responds
      with a service request message. UE's presence in the cell area is then known
      to the adversary [1].
    name: Send fake paging message to target UE
  - description: Adversary sends a series of silent SMS messages or makes a series
      of silent calls to a target UE, that would cause the base station to send a
      series of corresponding paging messages. The adversary then monitors the paging
      channel to watch for these set of multiple paging messages, and thus determines
      the paging slots ("paging occasion") assigned to the target UE. In addition,
      if the target UE responds, adversary concludes the target is in the area of
      that base station. If not, the target is not there [3]
    name: Send silent SMS to target UE
  - description: Adversary sends multiple silent SMS to the UE, and then watches the
      paging channel. If multiple instances of the same GUTI is seen, or if a given
      Paging Frame Index (determined by the IMSI) (PFI) seems to be "busy" then the
      adversary can conclude that the target UE is in that cell area (coarse location
      retrieval) [3]
    name: Watch for same paging occasion to be used by base station
  references:
  - '<a name="1"> \[1\] </a> [Chuan Yu et al, "Improving 4G/5G air interface security:
    A survey of existing attacks on different LTE layers", ACM digital library](https://dl.acm.org/doi/abs/10.1016/j.comnet.2021.108532)'
  - <a name="2"> \[2\] </a> [3GPP TR 33.809 "Study on 5G security enhancements against
    False Base Stations (FBS)", Technical Report, v0.18.0, February 2022.](https://www.3gpp.org/DynaReport/33809.htm)
  - <a name="3"> \[3\] </a> [S.R. Hussain et.al., "Privacy Attacks to the 4G and 5G
    Cellular Paging Protocols Using Side Channel Information". Retrieved Sept 11,
    2023](https://homepage.divms.uiowa.edu/~comarhaider/publications/LTE-torpedo-NDSS19.pdf)
  - <a name="4"> \[4\] </a> [H. Wen et al., "Thwarting Smartphone SMS Attacks at theRadio
    Interface Layer". Retrieved Sept 14, 2023.](https://www.ndss-symposium.org/ndss-paper/thwarting-smartphone-sms-attacks-at-the-radio-interface-layer/)
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT5012
  tactics:
  - TA0009
  - TA0007
  typecode: fight_subtechnique
- access-required: N/A
  architecture-segment: Control Plane, Roaming
  bluf: An adversary may send an unsolicited SS7/Diameter message to the core network
    of a UE that will cause the core network to provide coarse location of the UE.
  campaigns: []
  criticalassets:
  - description: Subscriber's coarse location is revealed to the adversary.
    name: UE location
  description: "An adversary may send an unsolicited SS7/Diameter message to the core\
    \ network of a UE that will cause the core network to provide coarse location\
    \ of the UE.\r\n\r\nSS7 and its IP counterpart SIGTRAN was designed many years\
    \ ago and has no built in security. To date, to support roaming between operators,\
    \ SS7 is still the most widely used protocol. When a UE roams, the visited network\
    \ node sends SS7 messages towards the home network, in order to let the home network\
    \ know that their UE is roaming, and also to provide services locally.\r\n\r\n\
    An operator's network consists of a 5G Core and also auxiliary systems such as\
    \ the IP Multimedia System (IMS). The IMS is used to provide voice and SMS services;\
    \ this is accomplished via traditional protocols SS7 and Diameter between the\
    \ IMS and 5G core functions. This subtechnique covers the abuse of such legitimate\
    \ signaling to obtain the location of a UE.\r\n\r\nBackground info:\r\n\r\n5G\
    \ SA core has interfaces to IMS core to support voice and SMS services. In the\
    \ signaling plane, the voice service uses Diameter based Rx interface between\
    \ PCF and P-CSCF in IMS, Diameter based Sh interface between HSS/UDM and TAS in\
    \ IMS, Diameter based Cx interface between HSS/UDM and I/S-CSCF. It also uses\
    \ SIP/SDP based Gm interface between UPF and P-CSCF in the user plane. SMS over\
    \ NAS service uses SS7 (MAP) based interface and S6c Diameter based interface\
    \ from UDM to SMSC. It also uses MAP and SGd (Diameter) interfaces from SMSF to\
    \ SMSC.\r\n\r\nThe location can be coarse- meaning the MME/AMF function serving\
    \ that UE-or it can be fine-grained- namely the cell identifier (from which the\
    \ geographical coordinates can be deduced assuming possession of a cell location\
    \ database). "
  detections:
  - component: Network Traffic Content
    detects: Monitor all communications over Diameter and SS7/MAP based interfaces
      to/from core network. Use plausibility checks of that UE having roamed into
      the visited network from which these Diameter/SS7 is received.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: HiddenArt retrieved of UE location via using the SS7 -sending SS7
      messages from the GRX/IPX or a compromised operator to the home PLMN of a user
      being targeted ([5]).
    fggid: FGG5003
    name: HIddenArt
  id: FGT5012.008
  mitigations:
  - fgmid: FGM5513
    mitigates: Use Diameter End-to-end Signaling Security (DESS). Section 6.5.3 of
      [3].
    name: Use DESS Security
  - fgmid: FGM5004
    mitigates: Use SMS router or firewall
    name: Correctly Configure SMS Firewall
  - fgmid: FGM1014
    mitigates: On the interconnect, use SS7/MAP and Diameter firewalls. Block messages
      with AVPs that do not verify or are not plausible. Use signaling firewalls,
      Intrusion Detection/Prevention Systems (IDS/IPS) to detect and/or block SS7
      and Diameter malicious traffic
    name: Interconnection Filtering
  name: SS7 Or Diameter Signaling
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Further attacks such as physical attack and eavesdropping on subscriber
      private data are possible once their coarse location is known to the adversary.
    name: Further attacks on subscriber are possible
  preconditions:
  - description: Adversary collects victim UE's phone number from subscriber's physical
      address using internet based services such as numlooker.com.
    name: MSISDN or phone number of victim UE is known to adversary
  procedureexamples:
  - description: Adversary sets up a fake SMSC and then sends a specially crafted
      MAP SRI_SM Send Routing Info for Short Message Request (SRR) with victim UE's
      MSISDN to HSS/UDM. If SMS router/firewall is not set up or if it is set up incorrectly,
      HSS/UDM will return the IMSI/SUPI of the UE and the ID of AMF/MME's currently
      serving the UE in response Send Routing Info for SM Answer (SRA) message. Thus,
      adversary will know the coarse location of the UE e.g. the town where the victim
      UE is present [1]
    name: Retrieval of subscriber's coarse location via SS7/MAP signaling
  - description: Adversary sets up a fake IP-SM-GW or SMS-GMSC and then sends a specially
      crafted Send Routing Info for Short Message Request (SRR) with victim UE's MSISDN
      to HSS/UDM. If SMS router/firewall is not setup or if it is setup incorrectly,
      HSS/UDM will return the ID of AMF/MME's currently serving the UE in response
      Send Routing Info for SM Answer (SRA) message. Thus, adversary will know the
      coarse location of the UE e.g. part of the town where the victim UE is present.
    name: Retrieval of subscriber's coarse location is retrieved via Diameter signaling
  - description: 'Adversary impersonates an HSS and sends a specially crafted Diameter
      Insert-Subscriber-Data-Request (IDR) request towards a target operator AMF/MME
      nodes, waiting for one to respond serving the target subscriber. These requests
      contain the SUPI/IMSI of a target subscriber. Out of the four IDR-Flags AVP
      (Attribute-Value-Pair), at least the EPS Location Information Request is set,
      and the Local time zone can be set as well. As a result, often the AMF/MME serving
      the target subscriber responds with Insert-Subscriber-Data-Answer, which contains
      the location information: i.e. EPS-Location-Information AVP contains the cell
      identifier. Possibly using the local time zone info as well, the fine-grained
      user location is determined [2].Other Diameter signaling that can be used similarly
      by an attacker posing as an external roaming partner MME, external GMLC or Application
      server are: Provide-Location-Request, LCS-Routing-Info-Request, Update-Location-Request,
      and User-Data-Request with Location Info as attribute [2].'
    name: Retrieval of subscriber's fine-grained (cell-level location) via Diameter
      signaling
  references:
  - '<a name="1"> \[1\] </a> [International Conference on Cyber Conflict 2016: "We
    know where you are".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7529440)'
  - <a name="2"> \[2\] </a> [B.T. Kotte, "Analysis and Experimental Verification of
    Diameter Attacks in Long Term Evolution Networks", KTH Royal Institute of Technology,
    2016.](http://www.diva-portal.org/smash/get/diva2:951619/FULLTEXT01.pdf)
  - <a name="3"> \[3\] </a> [GSMA IR.88 "EPS Roaming Guidelines".](https://www.gsma.com/newsroom/wp-content/uploads/IR.88-v22.0.pdf)
  - <a name="4"> \[4\] </a> [S. Holtmanns, S. P. Rao, I. Oliver, "User location tracking
    attacks for LTE networks using the interworking functionality", 2016 IFIP Networking
    Conference.](https://ieeexplore.ieee.org/document/7497239)
  - <a name="5"> \[5\] </a> [Enea (2022). HiddenArt - A Russian-linked SS7 Threat
    Actor](https://www.enea.com/insights/the-hunt-for-hiddenart/)
  software: []
  status: Observed
  subtechnique-of: FGT5012
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: User/NPE/Administrative Access, Compromised Keys/tokens
  architecture-segment: OA&M, Virtualization
  bluf: An adversary may use a fake or compromised container management controller
    to deploy fake VNFs to collect information from the network.
  campaigns: []
  criticalassets:
  - description: Container and container engine may expose privileged information
      to adversary directly from process or through container engine.
    name: Container engines
  - description: In Container management architecture (Kubernetes for example) adversary
      may use Kublet commands or API proxy to gain access to information and control
      of the container.
    name: NFVO
  - description: Virtual Infrastructure Manager.
    name: VIM
  description: "An adversary may use a fake or compromised container management controller\
    \ to deploy fake VNFs to collect information from the network.\r\n\r\nInstantiation\
    \ of malicious Virtual Network Functions (VNF) can also be achieved by compromised\
    \ VIM by inclusion of concealed software within legitimate (Virtual Infrastructure\
    \ Manager) VIM, or allocating virtual resources for fake instances, or using malicious\
    \ or compromised identity provider (reuses the same identity for several VNFs\
    \ with same key pair without knowledge of MANO). Adversary may use malicious attestation\
    \ server attacks, etc. VNF instantiation may allow adversary to register VNF with\
    \ 5G core to launch further attacks. "
  detections:
  - component: Application Log Content
    detects: Audit application logs (NFVO, VIM).  Configuration management databases
      (CMDB) and other asset management systems may help with the detection of computer
      systems or network devices that should not exist on a network.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Pod Creation
    detects: Monitor POD creation events.
    fgdsid: FGDS0014.001
    name: Pod
  - component: Pod Enumeration
    detects: Monitor POD enumeration events.
    fgdsid: FGDS0014.002
    name: Pod
  - component: Pod Modification
    detects: Monitor POD modification events.
    fgdsid: FGDS0014.003
    name: Pod
  - component: Container Creation
    detects: Monitor Container Creation events.
    fgdsid: FGDS0032.001
    name: Container
  - component: Container Enumeration
    detects: Monitor Container Enumeration events.
    fgdsid: FGDS0032.002
    name: Container
  - component: Container Start
    detects: Monitor Container Start events.
    fgdsid: FGDS0032.003
    name: Container
  groups:
  - description: TeamTNT has deployed different types of containers into victim environments
      to facilitate execution. [2]
    fggid: G0139
    name: TeamTNT
  id: FGT5013
  mitigations:
  - fgmid: FGM1047
    mitigates: Scan images before deployment, and block those that are not in compliance
      with security policies. In Kubernetes environments, the admission controller
      can be used to validate images after a container deployment request is authenticated
      but before the container is deployed.
    name: Audit
  - fgmid: FGM1035
    mitigates: Limit communications with the container service to local Unix sockets
      or remote access via SSH. Require secure port access to communicate with the
      APIs over TLS by disabling unauthenticated access to the Docker API, Kubernetes
      API Server, and container orchestration web applications.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Deny direct remote access to internal systems through the use of network
      proxies, gateways, and firewalls.
    name: Network Segmentation
  - fgmid: FGM1018
    mitigates: Enforce the principle of least privilege by limiting container dashboard
      access to only the necessary users.
    name: User Account Management
  name: Malicious VNF Instantiation
  object-type: technique
  platforms: ICAM, CI/CD, OA&M Tools
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [ETSI NFV SEC025: "Secure End-to-End VNF and NS management
    specification", Release 4, section 4.4.3, accessed 6/28/2022.](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC025_Secure_E2E_VNF_&_NS_management/NFV-SEC025v0012.zip)'
  - '<a name="2"> \[2\] </a> [Quist, N. (2020, October 5): "Black-T: New Cryptojacking
    Variant from TeamTNT." Retrieved September 22, 2021.](https://unit42.paloaltonetworks.com/black-t-cryptojacking-variant/)'
  - '<a name="3"> \[3\] </a> [InGuardians. (2022, January 5): "Peirates GitHub." Retrieved
    February 8, 2022.](https://github.com/inguardians/peirates)'
  - '<a name="4"> \[4\] </a> [Fishbein, N., Kajiloti, M.. (2020, July 28): "Watch
    Your Containers: Doki Infecting Docker Servers in the Cloud." Retrieved March
    30, 2021.](https://www.intezer.com/blog/cloud-security/watch-your-containers-doki-infecting-docker-servers-in-the-cloud/)'
  software:
  - description: Peirates can deploy a pod that mounts its node's root file system,
      then execute a command to create a reverse shell on the node. [3]
    fgsid: S0683
    name: Peirates
  - description: Doki was run through a deployed container. [4]
    fgsid: S0600
    name: Doki
  status: Observed
  tactics:
  - TA0007
  - TA0009
  typecode: fight_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: Virtualization, OA&M
  bluf: An adversary running a malicious Virtual Network Function (VNF) may identify
    network resources co-resident on the same physical host.
  campaigns: []
  criticalassets:
  - description: Adversary may identify high value 5G network functions targets for
      its exploits
    name: VNF identity
  - description: Adversary may identify RAN, Core or slice VNFs for further exploits.
    name: Network identity
  description: "An adversary running a malicious Virtual Network Function (VNF) may\
    \ identify network resources co-resident on the same physical host.\r\n\r\nAn\
    \ adversary may identify a VNF in shared resource by observing protocols or standard\
    \ ports in use on the node. A hardware and network resource separation is required\
    \ to provide isolation and protection from an adversary's mapping capabilities\
    \ in the network for certain VNF/VNFc (container)."
  detections:
  - component: Pod Creation
    detects: Pod and host logs.  Monitor logs for actions that could be taken to gather
      information about pods, including the use of discovery API calls by new or unexpected
      users.
    fgdsid: FGDS0014.001
    name: Pod
  - component: Application Log Content
    detects: Application logs (NFVO, VIM, worker nodes).  Configuration management
      databases (CMDB) and other asset management systems may help with the detection
      of computer systems or network devices that should not exist on a network.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Command Execution
    detects: Monitor command execution history on CNF, VNFs and hosts, particularly
      for actions that could be taken to gather information about accounts, including
      the use of calls to cloud APIs that perform account, system, and network discovery
      techniques.
    fgdsid: FGDS0017.001
    name: Command
  - component: Container Creation
    detects: 'Initial construction of a new container (ex: docker create)'
    fgdsid: FGDS0032.001
    name: Container
  - component: Container Enumeration
    detects: 'An extracted list of containers (ex: docker ps)'
    fgdsid: FGDS0032.002
    name: Container
  - component: Container Start
    detects: 'Activation or invocation of a container (ex: docker start or docker
      restart)'
    fgdsid: FGDS0032.003
    name: Container
  groups:
  - description: TeamTNT has deployed different types of containers into victim environments
      to facilitate execution.
    fggid: G0139
    name: TeamTNT
  id: FGT5014
  mitigations:
  - fgmid: FGM1047
    mitigates: Scan images before deployment, and block those that are not in compliance
      with security policies. In Kubernetes environments, the admission controller
      can be used to validate images after a container deployment request is authenticated
      but before the container is deployed.
    name: Audit
  - fgmid: FGM1035
    mitigates: Limit communications with the container service to local Unix sockets
      or remote access via SSH. Require secure port access to communicate with the
      APIs over TLS by disabling unauthenticated access to the Docker API, Kubernetes
      API Server, and container orchestration web applications.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Deny direct remote access to internal systems through the use of network
      proxies, gateways, and firewalls.  Segment execution environment with node and
      network.
    name: Network Segmentation
  - fgmid: FGM1018
    mitigates: Enforce the principle of least privilege by limiting container dashboard
      access to only the necessary users.
    name: User Account Management
  name: Shared Resource Discovery
  object-type: technique
  platforms: Slice platform, Container, OS platforms
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Network Functions Virtualisation (NFV) Release 4;Security;Isolation
    and trust domain specificationRelease 4, section 4.2.1, Accessed 4/12/2022](https://docbox.etsi.org/ISG/NFV/Open/Drafts/SEC026_Isolation_and_trust_domain)
  software:
  - description: Doki was run through a deployed container
    fgsid: S0600
    name: Doki
  - description: Peirates can deploy a pod that mounts its node's root file system,
      then execute a command to create a reverse shell on the node
    fgsid: S0683
    name: Peirates
  status: Observed
  tactics:
  - TA0007
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Control Plane, ICAM
  bluf: "An adversary may compromise\_the Equipment Identity Register (EIR) function\
    \ and\_add new equipment, modify status (ok vs. stolen or prohibited) of mobile\
    \ device."
  campaigns: []
  criticalassets:
  - description: Device databases should be protected from tampering.
    name: Integrity of device database
  - description: UE status should be kept accurate.
    name: User equipment status integrity
  description: "An adversary may compromise\_the Equipment Identity Register (EIR)\
    \ function and\_add new equipment, modify status (ok vs. stolen or prohibited)\
    \ of mobile device.\r\n\r\nAdversary compromises the EIR and then manipulates\
    \ the database that tracks device IMEI statuses, enabling unauthorized actions\
    \ such as adding new devices, modifying device statuses (e.g., changing stolen\
    \ or prohibited devices to \"allowed\"), or deleting records.\_\r\n\r\nEIR is\
    \ an optional component (applicable to 3G, 4G, 5G) storing the status of a mobile\
    \ equipment and optionally which Permanent Equipment Identifier (PEI) it is allowed\
    \ to use. Compromising it can allow an adversary to modify status of devices (e.g.\
    \ \"stolen\", \"prohibited'). \r\n\r\nNote: Modifying the EIR does not affect\
    \ the subscription data such as access to network slice, customer data, or allow\
    \ fraudulent use of service. "
  detections:
  - component: MNO database access logs  content in core
    detects: Difficult to detect unauthorized changes. Inspect logs of what changes
      were made and by whom in the EIR.
    fgdsid: FGDS5009.001
    name: MNO database access logs
  groups: []
  id: FGT5015
  mitigations:
  - fgmid: FGM5020
    mitigates: Secure EIR
    name: Secure Subscriber Repositories
  name: Device Database Manipulation
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Fraudulent use of EIR services.
    name: Compromised EIR
  preconditions:
  - description: Adversary adds new equipment, modifies status (ok vs. stolen or prohibited)
      of mobile device.
    name: "Compromise\_the EIR"
  procedureexamples:
  - description: 'Reference [1], DC-003, calls for the MNOs to employ an EIR. The
      rest of the attack is theoretical: an adversary may modify some of the entries
      in the EIR database, e.g. device status (stolen, etc.)The AMF is the only function
      that checks the EIR based on PEI, upon UE registration (using the API N5g-eir_EquipmentIdentityCheck_Get).'
    name: EIR database compromise
  references:
  - <a name="1"> \[1\] </a> [GSM Association, "GSM Association Official Document FS.31,
    Baseline Security Controls.", v3.0, Sep. 2023.](https://www.gsma.com/security/resources/fs-31-gsma-baseline-security-controls)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Roaming
  bluf: An adversary exploits interconnection/interworking between MNOs to obtain
    information about roaming user sessions or commit fraud.
  campaigns: []
  criticalassets:
  - description: Adversaries may need to compromise a vSEPP to perform certain activities
      to ensure they look legitimate.
    name: SEPP
  - description: Adversaries may need to compromise a vPLMN NF to perform certain
      activities to ensure they look legitimate
    name: NFs in the vPLMN
  - description: Adversary will need to compromise keys used to sign IE modifications
      at IPX
    name: IPX signing keys
  description: "An adversary exploits interconnection/interworking between MNOs to\
    \ obtain information about roaming user sessions or commit fraud.\r\n\r\nThe adversary\
    \ with a position on a trusted partners environment, see [FGT1199.501](/techniques/FGT1199.501),\
    \ is in a position to send legitimate looking messages to a PLMN interfaces and\
    \ network functions and modify, in some circumstances, legitimate messages. Through\
    \ these messages, the adversary may obtain sensitive information about the PLMN's\
    \ subscribers. With the ability to send messages seen by the PLMN as legitimate,\
    \ the trusted partner may also commit fraud."
  detections:
  - component: Application Log Content
    detects: Monitor for use of IE modification by IPX and respond when unexpected
      IE modifications are seen.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Connection Creation
    detects: Monitor the initial construction of network connections between mobile
      network operators by capturing socket information, including source/destination
      IP addresses and port(s).
    fgdsid: FGDS0029.001
    name: Network Traffic
  groups: []
  id: FGT5016
  mitigations:
  - fgmid: FGM1041
    mitigates: Protect sensitive NF interface information with strong encryption.
    name: Encrypt Sensitive Information
  - fgmid: FGM5024
    mitigates: Block unauthorized IE modifications by IPX. Allow only communication
      where authorized IpxId is not NULL
    name: Integrity Protection Of Data Communication
  - fgmid: FGM1009
    mitigates: Avoid using PRINS and use direct SEPP-SEPP with HTTP/s.  Use of the
      SEPP to SEPP solution instead of allowing an IPX to potentially observe and
      manipulate information avoids the problem. A future SEPP hub solution may also
      mitigate this risk by providing a more scalable SEPP to SEPP solution.
    name: Encrypt Network Traffic
  name: Abuse Of Inter-operator Interfaces
  object-type: technique
  platforms: Interconnect
  postconditions:
  - description: The adversary exploits interconnection between MNOs to access sensitive
      subscriber information or commit fraud using legitimate-looking messages.
    name: Inter-connect Exploitation
  preconditions:
  - description: Adversary will need to compromise keys used to sign IE modifications
      at IPX
    name: IPX key compromise
  - description: Compromise of the initiating SEPP, typically the VPLMN SEPP, would
      permit an adversary to establish a protection policy that would allow IPX modification.
    name: Compromise of initiating SEPP
  procedureexamples:
  - description: In one approach, the adversary, in a position on an IPX, could modify
      the messages between the vPLMN (visited PLMN) and hPLMN (home PLMN) if PRINS
      is used, resulting in possible information modification and/or disclosure.  Modification
      of an Information element (IE) could enable possible denial of service and/or
      information disclosure and this is addressed in [FGT5029](/techniques/FGT5029).
    name: Manipulate data between two PLMNs
  - description: If the adversary controls a vPLMN SEPP they may modify signaling
      on N32 and/or generate requests to hPLMN NFs. The adversary controlled vSEPP
      could terminate TLS connections to hPLMN NFs and proxy requests as an adversary-in-the-middle,
      see [FGT1557.502](/techniques/FGT1557.502). Legitimate looking requests that
      could result in information disclosure or fraud may involve Value Added Service
      (VAS), e.g., VAS providing SEPP to the VPLMN
    name: Compromise SEPP and modify signaling it sends
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  - <a name="2"> \[2\] </a> ["Security Assurance Specification (SCAS) threats and
    critical assets in 3GPP network product classes," 3rd Generation Partnership Project
    (3GPP), TR 33.926 ver.17.3.0, Dec. 2021, sec. G.2.4.1-G.2.4.2](https://www.3gpp.org/DynaReport/33926.htm)
  - <a name="3"> \[3\] </a> [G. Green, "5G Security when Roaming - Part 2," Mpirical,
    Lancaster, UK, May 21, 2021](https://www.mpirical.com/blog/5g-security-when-roaming-part-2)
  - <a name="4"> \[4\] </a> ["Security architecture and procedures for 5G System,"
    3GPP, TS 33.501 ver. 16.3.0, July 2020, Sec. 13.1.2,13.2](https://www.3gpp.org/DynaReport/33501.htm)
  - <a name="5"> \[5\] </a> ["5G System; Public Land Mobile Network (PLMN) Interconnection;
    Stage 3," 3GPP, TS 29.573 ver.16.9.0, March 2022](https://www.3gpp.org/DynaReport/29573.htm)
  - <a name="6"> \[6\] </a> [P.Tommassen, "5G Security When Roaming," iBasis, October
    6, 2020](https://ibasis.com/5g-security-when-roaming/)
  software: []
  status: Theoretical
  tactics:
  - TA0009
  - TA5001
  typecode: fight_technique
- architecture-segment: Control Plane
  bluf: Adversary may compromise the 5G Charging Function (CHF) in order to steal
    sensitive subscriber call related data/CDRs.
  campaigns: []
  criticalassets:
  - description: Confidentiality of sensitive subscriber metadata of calls/data/SMSes.
    name: Subscriber data
  description: "Adversary may compromise the 5G Charging Function (CHF) in order to\
    \ steal sensitive subscriber call related data/CDRs.\r\n\r\nAdversary may compromise\
    \ 5G CHF by either cloning a legitimate CHF or by implanting malware inside a\
    \ legitimate 5G CHF in order to steal subscriber's call and SMS related metadata.\
    \ The information may be used to enable follow-on privacy attacks such as tracking\
    \ internet usage and call/SMS activities of certain subscribers.\r\n\r\nIn earlier\
    \ generations of 3GPP networks, CDRs are generated on switches, and then moved\
    \ to billing servers. In 5G, Converged Charging System (CCS) is responsible for\
    \ generating CDRs for subscribers based on their data usage. CHF is part of the\
    \ CCS. CHF communicates to other core NFs via Service Based Interface (SBI). It\
    \ receives data usage information from core NFs such as SMF. The CDRs are processed\
    \ by charging data processing functions external to the 5G network - that is,\
    \ by the Offline Charging System (OFCS) for postpaid customers and by the Online\
    \ Charging System (OCS) for prepaid customers."
  detections:
  - component: 5G network host software and configurations
    detects: 'Log and raise alarms for any suspicious deployment activities in core:
      image update, cloning an existing NF etc.'
    fgdsid: FGDS5029.001
    name: Host system software and configurations
  groups: []
  id: FGT5017
  mitigations:
  - fgmid: FGM0947
    mitigates: Verify image hash of every core NF by periodic checks.
    name: Audit
  - fgmid: FGM5101
    mitigates: Isolate CDR database in the billing domain from the rest of the IT
      systems/NOC resources.
    name: Isolate CDR Database
  name: Charging Data Record (CDR) Collection
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: Exposure of subscriber sensitive information such as call/data/text
      metadata.
    name: Leakage of subscriber data
  preconditions:
  - description: Adversary either clones a legitimate CHF or implants malware in a
      legitimate CHF.
    name: Adversary compromises a legitimate CHF
  procedureexamples:
  - description: Adversary may use a compromised CHF to collect CDR's belonging to
      a target subscriber, or a group of subscribers based on their Subscriber Permanent
      Identifier (SUPI) or Generic Public Subscription Identifier (GPSI) or phone
      number. The collected CDRs may be used to track internet usage and call/SMS
      activities of target subscriber(s). [1]
    name: Compromised CHF steals CDRs
  references:
  - '<a name="1"> \[1\] </a> [3GPP TS 32.291: "Charging management; 5G system, charging
    service; Stage 3".](https://www.3gpp.org/DynaReport/32291.htm)'
  software: []
  status: Theoretical
  tactics:
  - TA0009
  - TA0007
  typecode: fight_technique
- access-required: Physical
  architecture-segment: Physical & Environmental
  bluf: An adversary aims to destroy, expose, alter, disable, steal, or gain access
    to physical assets such as infrastructure, hardware, or interconnection, affecting
    Quality of Service (QoS) or service availability.
  campaigns: []
  criticalassets:
  - description: Radio access units, information and communications technology equipment,
      optical interconnection facilities, cloud data center, edge computing facilities
    name: Physical infrastructure
  description: "An adversary aims to destroy, expose, alter, disable, steal, or gain\
    \ access to physical assets such as infrastructure, hardware, or interconnection,\
    \ affecting Quality of Service (QoS) or service availability.\r\n\r\nActions taken\
    \ by actors aimed at destroying, disabling, or stealing physical assets supporting\
    \ the 5G network. A physical attack to 5G critical assets may disrupt, interfere,\
    \ and ultimately cause unavailability of the network services. Despite the existence\
    \ of physical protection mechanisms (e.g., physical surveillance cameras, security\
    \ locks, security guards), physical breaches and insider threat attacks may still\
    \ occur."
  detections:
  - component: Asset inventory
    detects: Maintain a detailed inventory of all current and expected network-connected
      devices, including manufacturer, model, IP, and hardware addresses. Extend this
      to physical premises by tracking device locations and ensuring only authorized
      hardware is present. This helps detect unauthorized access and protect both
      the network and physical infrastructure.
    fgdsid: FGDS0039.001
    name: Asset
  - component: Device Alarm
    detects: Asset tracking tools. Security Management and Detection, alarms, etc.
    fgdsid: FGDS0040.001
    name: Operational Databases
  groups: []
  id: FGT5018
  mitigations:
  - fgmid: FGM5005
    mitigates: Communications Centers.Communication centers should provide a full
      set of physical and environmental controls aimed to assure access control, monitoring,
      continuity of operations and protection against environmental disasters.
    name: Physical And Environmental Protection
  - fgmid: FGM5005
    mitigates: Telecommunications equipment room Telecom equipment rooms should provide
      a risk-calibrated set of physical and environmental controls aimed to assure
      access control, monitoring, continuity of operations and protection against
      environmental disasters.
    name: Physical And Environmental Protection
  - fgmid: FGM5005
    mitigates: Physically isolated operation areas Remote equipment facilities should
      provide a set of physical and environmental controls aimed to assure access
      control, monitoring, continuity of operations and protection against environmental
      disasters, taking into account its remoteness and lack of human presence.
    name: Physical And Environmental Protection
  - fgmid: FGM5005
    mitigates: Equipment sited in other carrier's or partner's premises. Equipment
      located in third party facilities rooms should be protected using a risk-calibrated
      set of physical and environmental controls aimed to assure access control, monitoring,
      continuity of operations and protection against environmental disasters
    name: Physical And Environmental Protection
  name: Vandalism Of Network Infrastructure
  object-type: technique
  platforms: Physical
  postconditions:
  - description: Destruction or damage of these assets may cause information destruction.
    name: Information destruction
  preconditions:
  - description: Improper physical security of Data Centers / Telecommunication equipment
      room. Improper isolation of physical security perimeter between tenants.Improper
      environmental protection controls.Inadequate / defective security devices.
    name: Improper physical security of 5G core component infrastructure
  - description: Improper physical security of telecommunications equipment rooms
      and equipment sited in partners' or users' premises.Improper physical security
      of physically isolated operation areas.Inadequate / defective security devices.
    name: gNB component infrastructure
  - description: Improper physical security of telecommunications equipment rooms.Improper
      physical security of physically isolated operations areas.Inadequate / defective
      security devices.
    name: NFVI
  - description: Unprotected data center interconnection channels.Improper physical
      security perimeter or isolation between tenants.
    name: SDN
  - description: Improper physical and environmental security of edge computing facilitiesImproper
      security monitoring of edge computing facilitiesInsecure service environment.
    name: MEC host
  procedureexamples:
  - description: Unauthorized access, destruction of assets and impairment of operations
    name: Communication center
  - description: Unauthorized access, destruction of assets and impairment of operations
    name: Telecommunications equipment room
  - description: Unauthorized access, destruction of assets and impairment of operations
    name: Physically isolated operation areas
  - description: unauthorized access, destruction of assets and impairment of operations
    name: Equipment sited in other carrier's or partner's premises
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, November 2019.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-for-5g-networks)'
  software: []
  status: Proof Of Concept
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: Physical Access
  architecture-segment: Physical & Environmental
  bluf: An adversary targets unprotected cables and junction boxes in order to disrupt
    service.
  campaigns: []
  criticalassets:
  - description: Data cables used in the operator network infrastructure.
    name: Data cables
  - description: Power cables used in the operator network infrastructure.
    name: Power cables
  description: "An adversary targets unprotected cables and junction boxes in order\
    \ to disrupt service.\r\n\r\n \r\n\r\nFibers routed between pieces of equipment\
    \ without proper physical protection are susceptible to damage, which can critically\
    \ affect network reliability."
  detections:
  - component: Security logs in core
    detects: 'Security Incident and event monitoring:Event logs recording user activities,
      exceptions, faults and information security events should be produced, kept
      and regularly reviewed. Additional considerations: development of use-case specific
      alert rules, integration and correlation of data at all levels (network, application),
      integration and correlation with service provider-level monitoring mechanisms.'
    fgdsid: FGDS5012.001
    name: Security logs in network
  - component: Facility sensors
    detects: Facility intrusion sensor detect and alert facility intrusions.
    fgdsid: FGDS5028.001
    name: Physical Sensors
  - component: Cabinet and cage sensors
    detects: Cabinet intrusion sensors detect and alert cabinet and cage intrusions.
    fgdsid: FGDS5028.002
    name: Physical Sensors
  - component: Device sensors
    detects: Device intrusion sensors detect and alert when device chassis or enclosure
      is opened.
    fgdsid: FGDS5028.003
    name: Physical Sensors
  groups: []
  id: FGT5018.001
  mitigations:
  - fgmid: FGM5005
    mitigates: Compliance with cable standards.Raceway / conduit is one of the easiest
      ways to protect any cable, fiber optic included. These hollow pieces of plastic
      act like a protective outer shell.
    name: Physical And Environmental Protection
  - fgmid: FGM5005
    mitigates: Secure junction boxes.Optical fiber junction boxes / splice closures
      should only be accessible to maintenance personnel and maintenance vehicles.
      A closure should be located away from high traffic or conditions that could
      cause damage to the closure or injury to personnel. [2] 11.2.3 advocates for
      cabling security.
    name: Physical And Environmental Protection
  - fgmid: FGM5540
    mitigates: Power supply facilities in the isolated area such as mobile base stations
      should preferably provide an uninterruptible power supply with capacity for
      all loading and capable of withstanding primary power supply failures for the
      duration of likely outages. If that is impossible, a mechanism to provide uninterruptible
      power to critical equipment should be installed. Batteries may need to be augmented
      with a private electric generator, especially in isolated areas.
    name: Power Supplies
  name: Cabling And Junction Boxes
  object-type: technique
  platforms: Data transmission infrastructure, power infrastructure
  postconditions:
  - description: Destruction or damage of these assets may cause an unavailability
      of resources.
    name: Service unavailability
  - description: Destruction or damage of these assets may cause information destruction.
    name: Information destruction
  preconditions:
  - description: Fibers routed between pieces of equipment without proper protection
      are susceptible to damage, which can critically affect network reliability.
      The fiber cable management system should therefore ensure that every fiber is
      protected from physical damage.
    name: Unprotected cables
  - description: Lack of protection of junction boxes / splice closures. Improper
      cable routing also causes increased congestion in the termination panel and
      the cableways, increasing the possibility of bend radius violations and long-term
      failure.
    name: Unprotected junction boxes
  procedureexamples:
  - description: An adversary may damage cabling and junction boxes.
    name: Disrupt service via physical damage
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, page 210, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [ISO/IEC 27011 (2016): "Information technology - Security
    techniques - Code of practice for Information security controls based on ISO/IEC
    27002 for telecommunications organizations".](https://www.iso.org/obp/ui/#iso:std:iso-iec:27011:ed-2:v1:en)'
  software: []
  status: Observed
  subtechnique-of: FGT5018
  tactics:
  - TA0040
  typecode: fight_subtechnique
- access-required: Physical
  architecture-segment: RAN, O-RAN
  bluf: An adversary uses unrestricted access to exploit, damage, or destroy Radio
    Access hardware that lack adequate security.
  campaigns: []
  criticalassets:
  - description: All RAN components - CU, DU, RU, C-RAN MEC and mmWave equipment.
    name: gNB
  - description: O-RAN Radio Unit.
    name: O-RU
  description: "An adversary uses unrestricted access to exploit, damage, or destroy\
    \ Radio Access hardware that lack adequate security.\r\n\r\nThe use of small-cell\
    \ antennas requires hardware to be placed in highly accessible locations, such\
    \ as, commercial and residential buildings, ground-level structures, and existing\
    \ street furniture (bus stops, info kiosks, and billboards). These solutions count\
    \ on sharing site spaces in existing infrastructure to reduce costs due to the\
    \ increased amount of hardware required to maintain Quality of Service (QoS)."
  detections:
  - component: Process History/Live Data
    detects: 'Event logs recording user activities, exceptions, faults and information
      security events should be produced, kept and regularly reviewed. Additional
      considerations: development of use-case specific alert rules, integration and
      correlation of data at all levels (network, application), integration and correlation
      with service provider-level monitoring mechanisms.'
    fgdsid: FGDS0040.002
    name: Operational Databases
  groups: []
  id: FGT5018.002
  mitigations:
  - fgmid: FGM5005
    mitigates: Sites should be provided with a full set of physical and environmental
      controls aimed to assure access control, monitoring, continuity of operations
      and protection against vandalism.
    name: Physical And Environmental Protection
  name: Radio Access Hardware
  object-type: technique
  platforms: 5G RAN, O-RU
  postconditions:
  - description: Destruction or damage of these assets may cause unavailability of
      resources.
    name: Service unavailability
  - description: Destruction or damage of these assets may cause information destruction.
    name: Information destruction
  preconditions:
  - description: Despite the virtualized structure of the 5G network and all involved
      network functions, there will be a strong dependency on the physical infrastructure,
      especially in the initial migration/hybrid 5G deployments.
    name: Improper physical security of radio access hardware
  procedureexamples:
  - description: Classified as a deliberate physical attack, this threat relates to
      actions taken by actors aimed at destroying, disabling or stealing physical
      assets supporting the 5G Network. A physical attack to 5G critical assets may
      disrupt, interfere and ultimately cause unavailability of the network service.
      Despite the existence of physical protection mechanisms (e.g., physical surveillance
      and surveillance cameras, security locks, security guards), physical breaches
      and insider threat attacks may still occur.
    name: Physical sabotage/vandalism of the network infrastructure
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, page 202, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="2"> \[2\] </a> [El-Shorbagy, A.-moniem. "5G Technology and the Future
    of Architecture". Procedia Computer Science, (2021), volume 182, p121-131.](https://doi.org/10.1016/j.procs.2021.02.017)
  software: []
  status: Theoretical
  subtechnique-of: FGT5018
  tactics:
  - TA0040
  typecode: fight_subtechnique
- access-required: Physical Access
  architecture-segment: Physical & Environmental
  bluf: An adversary may seek physical access to isolated/remote edge servers using
    covert methods of entry with the intent to damage or destroy edge computing facilities,
    gaining unauthorized access at system level as an entry point to all hosted resources,
    theft of data on local storage, vandalism, and sabotage.
  campaigns: []
  criticalassets:
  - description: Destruction of edge computing facilities, unauthorized access at
      system level as an entry point to all hosted resources, theft of data on local
      storage, vandalism and/or sabotage of equipment.
    name: Edge facility equipment
  description: "An adversary may seek physical access to isolated/remote edge servers\
    \ using covert methods of entry with the intent to damage or destroy edge computing\
    \ facilities, gaining unauthorized access at system level as an entry point to\
    \ all hosted resources, theft of data on local storage, vandalism, and sabotage.\r\
    \n\r\nEdge computing facilities are, by their nature, seated in geographically\
    \ distributed locations. Normally, the first choice will be communications shelters\
    \ already operated by MNO. While communications shelters have physical security\
    \ controls in place, these are calibrated to risks associated with communication\
    \ equipment value. An additional risk assessment is needed to assess suitability\
    \ in the context of additional risks incurred by presence of computing facilities\
    \ and data."
  detections:
  - component: Security logs in core
    detects: 'Event logs recording user activities, exceptions, faults and information
      security events should be produced, kept and regularly reviewed. Additional
      considerations: development of use-case specific alert rules, integration and
      correlation of data at all levels (network, application), integration and correlation
      with service provider-level monitoring mechanisms.'
    fgdsid: FGDS5012.001
    name: Security logs in network
  - component: Facility sensors
    detects: Facility intrusion sensor detects and alert facility intrusions.
    fgdsid: FGDS5028.001
    name: Physical Sensors
  - component: Cabinet and cage sensors
    detects: Cabinet intrusion sensors detect and alert cabinet and cage intrusions.
    fgdsid: FGDS5028.002
    name: Physical Sensors
  - component: Device sensors
    detects: Device intrusion sensors detect and alert when device chassis or enclosure
      is opened.
    fgdsid: FGDS5028.003
    name: Physical Sensors
  groups: []
  id: FGT5018.003
  mitigations:
  - fgmid: FGM5005
    mitigates: Edge sites should be provided with a full set of physical and environmental
      controls aimed to assure access control, monitoring, continuity of operations
      and protection against environmental disasters. Failure to do so may lead to
      unauthorized access, destruction of assets and impairment of operations.
    name: Physical And Environmental Protection
  name: Edge Servers
  object-type: technique
  platforms: Edge server
  postconditions:
  - description: Destruction of assets, unauthorized access, theft of data on local
      storage, vandalism, sabotage.
    name: Service unavailability
  - description: Destruction or damage of these assets may cause information destruction.
    name: Information destruction
  preconditions:
  - description: 'Mobile-edge computing have to be integrated in the network-wide
      Security Incident and Monitoring System, but with additional considerations:
      development of use-case specific alert rules, integration and correlation of
      data at all levels (network, application), integration and correlation with
      service provider -level monitoring mechanisms. Failure to do so may leave advanced
      or sustained threats undetected, as well as technical failures or malfunctions
      of local resources.'
    name: Inadequate security monitoring of edge computing facilities
  procedureexamples:
  - description: Adversary may obtain physical access to remote edge servers and cause
      damage to them.
    name: Damage edge servers
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, page 202, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [ISO/IEC 27011 (2016): "Information technology - Security
    techniques - Code of practice for Information security controls based on ISO/IEC
    27002 for telecommunications organizations".](https://www.iso.org/obp/ui/#iso:std:iso-iec:27011:ed-2:v1:en)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5018
  tactics:
  - TA0040
  typecode: fight_subtechnique
- access-required: Physical Access
  architecture-segment: Physical & Environmental
  bluf: An adversary accesses a shared site, or remote location, with intent to steal
    valuable materials (such as copper, batteries, and fuel) for resale.
  campaigns: []
  criticalassets:
  - description: Physical assets and commodities used by mobile network operators
      in their infrastructure.
    name: Physical assets and commodities
  description: "An adversary accesses a shared site, or remote location, with intent\
    \ to steal valuable materials (such as copper, batteries, and fuel) for resale.\r\
    \n\r\nAs towers are often located in remote locations, base stations are prime\
    \ marks for thieves and vandals in search of an easy target. These sites contain\
    \ a wealth of valuable copper wire, high-performance batteries, and fuel. Thieves\
    \ and vandals take advantage of remote locations of cell sites by trespassing\
    \ freely, without the fear of being identified. Copper wires and battery theft\
    \ exploit the second-hand market fueled by the worldwide demand for these goods."
  detections:
  - component: Security logs in core
    detects: 'Security Incident and event monitoring:Event logs recording user activities,
      exceptions, faults and information security events should be produced, kept
      and regularly reviewed. Additional considerations: development of use-case specific
      alert rules, integration and correlation of data at all levels (network, application),
      integration and correlation with service provider-level monitoring mechanisms.'
    fgdsid: FGDS5012.001
    name: Security logs in network
  - component: Facility sensors
    detects: Facility intrusion sensor detects and alert facility intrusions.
    fgdsid: FGDS5028.001
    name: Physical Sensors
  - component: Cabinet and cage sensors
    detects: Cabinet intrusion sensors detect and alert cabinet and cage intrusions.
    fgdsid: FGDS5028.002
    name: Physical Sensors
  - component: Device sensors
    detects: Device intrusion sensors detect and alert when device chassis or enclosure
      is opened.
    fgdsid: FGDS5028.003
    name: Physical Sensors
  groups: []
  id: FGT5018.004
  mitigations:
  - fgmid: FGM5005
    mitigates: Implement physical and environmental controlsShared/Remote sites should
      be provided with a full set of physical and environmental controls aimed to
      assure access control, monitoring, continuity of operations and protection against
      environmental disasters. Failure to do so may lead to unauthorized access, destruction
      of assets and impairment of operations.
    name: Physical And Environmental Protection
  name: Theft Of Assets
  object-type: technique
  platforms: Physical Assets
  postconditions:
  - description: Theft of these assets may cause an unavailability of resources.
    name: Service unavailability
  - description: Theft of these assets may cause an increase in maintenance costs
      for the operator.
    name: Increased maintenance costs
  preconditions:
  - description: 'Remote/shared sites have to be integrated in the network-wide Security
      Incident and Monitoring System, but with additional considerations: development
      of use-case specific alert rules, integration and correlation of data at all
      levels (network, application), integration and correlation with service provider
      -level monitoring mechanisms. Failure to do so may leave advanced or sustained
      threats undetected, as well as technical failures or malfunctions of local resources.'
    name: Improper security monitoring of remote/shared facilities
  procedureexamples:
  - description: Copper's value transforms remote cellular base stations into prime
      targets for thieves. The costs for telecom and tower operators to replace the
      cost of the cable and damage to the site can be thousands of dollars per incident.
      This is not taking into consideration the additional costs of loss of network
      service. Even the theft of a small amount of copper can cause extensive damage
      to site equipment, costing cell towers owners thousands of dollars in repairs,
      replacement, and network downtime. There are several expensive copper items
      at cell sites that are very attractive to thieves, such as the ground wires,
      copper grounding busbars, and waveguides.
    name: Cable/Copper Theft
  - description: Battery theft can easily become the root cause of cell services outage.
      Similarly, to the case of cable theft, telecom towers are increasingly affected
      by the rise of battery theft and vandalism incidents.
    name: Battery Theft
  - description: Fuel is a major asset at telecom sites that can easily and directly
      be sold by thieves. The threat of diesel theft is widespread in many emerging
      markets and even in the rural areas of the developed markets.
    name: Fuel Theft
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, page 202, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [Baars, J.: "White Paper - Telecom Sites Physical Security",
    December 2019, Asentria.](https://www.asentria.com/blog/telecom-sites-physical-security-white-paper/.)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5018
  tactics:
  - TA0040
  typecode: fight_subtechnique
- architecture-segment: RAN, Control Plane, Roaming, UE
  bluf: An adversary may obtain a UE permanent identifier via various means.
  campaigns: []
  criticalassets:
  - description: UE/User IMSI, SUPI
    name: User identifiers - permanent or temporary
  description: "An adversary may obtain a UE permanent identifier via various means.\r\
    \n\r\nAn adversary may obtain UE identifying information from 5G UEs after the\
    \ UE has been bid down (downgraded) to a lower security protocol e.g. 4G, since\
    \ in 4G and 3G it is possible for the network to ask the UE to send its IMSI (International\
    \ Subscriber Identifier) in the clear over the radio interface. The UE identity\
    \ can also be obtained by the adversary if NULL scheme is used for Subscriber\
    \ Permanent Identifier (SUPI) concealment, or by fraudulent use of legitimate\
    \ 5G core network APIs.\r\n\r\nThe 5G UE sends an encrypted identifier (called\
    \ Subscriber Concealed Identifier (SUCI)) over the radio interface as part of\
    \ the initial registration to the 5G network. Some non-UE specific information\
    \ is part of the Subscriber Permanent Identifier or SUPI and is not encrypted\
    \ (e.g., home network name)."
  detections: []
  groups: []
  id: FGT5019
  mitigations: []
  name: Subscriber Profile Identifier Discovery
  object-type: technique
  platforms: 5G Core, 5G RAN
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Adversary may use the radio access network to determine the IMSI
      of a particular UE is in the area.
    name: Use radio access to obtain UE permanent identifier
  - description: Adversary may use the core network signaling find the IMSI of a particular
      UE, given e.g., MSISDN
    name: Use core network signaling to obtain UE permanent identifier
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="2"> \[2\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  software: []
  status: Observed
  tactics:
  - TA0007
  - TA0009
  typecode: fight_technique
- access-required: None
  architecture-segment: RAN
  bluf: An adversary may intercept unencrypted radio transmissions of a UE's SUCI
    to identify the home network of the UE.
  campaigns: []
  criticalassets:
  - description: Home network identifier is sent unconcealed by UE over the air per
      standard. UE privacy such as its home network location is revealed to the adversary
      when UE is roaming in another country or region.
    name: User identifiers - permanent or temporary
  description: "An adversary may intercept unencrypted radio transmissions of a UE's\
    \ SUCI to identify the home network of the UE.\r\n\r\nAdversary can tell what\
    \ the home network of UE is from the unencrypted portion of the Subscriber Concealed\
    \ Identity (SUCI), which is normally sent over the radio interface by a UE seeking\
    \ to connect. This can be of value to an adversary when the home location is unusual.\
    \ \r\n\r\nBackground information: In 5G, the UE's permanent identity, SUPI (Subscriber\
    \ Permanent Identifier), includes a home network identifier and a user-specific\
    \ identifier, and is never sent unencrypted over the radio interface. Instead,\
    \ a SUCI is sent when the UE goes through initial registration to the serving\
    \ network procedures; this de-concealment operation can only be done by the UE's\
    \ home network. However, the Home Network identifier part of the SUCI is sent\
    \ unencrypted, so that the serving network (while UE is roaming in another country\
    \ or region) knows how to route the registration message to UE's home network\
    \ for authentication. The home network may constitute sensitive information in\
    \ some special cases. There is no standards-based mitigation for this technique."
  detections: []
  groups: []
  id: FGT5019.001
  mitigations:
  - fgmid: FGM5022
    mitigates: When the subscriber affiliation is reflected in the home network identifier
      (part of subscriber identifier) and would benefit from not being sent in the
      clear, the subscriber's provider (home network) should be a proxy mobile network
      operator - whose identifier does not reveal the true affiliation of the subscriber.
    name: Proxy Home Network
  name: Intercept Home Network Via SUCI
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: When home network is unusual (e.g., US home network in Afghanistan),
      allows attacker to identify UE as target of interest for geolocation, degradation
      of service, loss of traffic confidentiality, or physical attack.
    name: Target association
  preconditions:
  - description: Adversary requires sufficient signal to noise and interference ratio
      and must be present in the same area as the UE.
    name: Ability to receive SUCI over the air
  procedureexamples:
  - description: Receive SUCI and extract the field "home network identifier", which
      is never concealed.
    name: Intercept home network over the radio interface
  references:
  - '<a name="1"> \[1\] </a> [3GPP TS 23.003: "Numbering, Addressing and Identification",
    Version 17.6.0, Section 2.2B](https://www.3gpp.org/DynaReport/23003.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5019
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: None
  architecture-segment: RAN
  bluf: An adversary may intercept the UE permanent identifier (SUPI) from a UE that
    is bid down to a less secure protocol.
  campaigns: []
  criticalassets:
  - description: Unique and non-transient user identity
    name: User identifiers
  description: "An adversary may intercept the UE permanent identifier (SUPI) from\
    \ a UE that is bid down to a less secure protocol.\r\n\r\nThe UE SUPI constitutes\
    \ key data that identifies UE as target of interest for other follow-on behaviors\
    \ such as geolocation, degradation of service, loss of traffic confidentiality,\
    \ or physical attack. From the network side, the SUPI can be used to obtain other\
    \ sensitive information about this UE.\r\n\r\nBackground information: In 5G, the\
    \ UE's permanent identity, SUPI (Subscriber Permanent Identifier), is required\
    \ by standards to never be sent unencrypted (unconcealed) over the radio interface.\
    \ In other Radio Access Technologies (RATs) such as WiFi, 3G and 4G however, the\
    \ UE's permanent identity IMSI may be sent unencrypted over the radio interface\
    \ (e.g. in cases where the serving network is not able to identify the UE via\
    \ a temporary identifier). In 5G, SUPI can be either IMSI or Network Access Identifier\
    \ (NAI) (See clause 2.2A of [3]).\r\n\r\nWhen a 5G UE's Radio Capability profile\
    \ allows the bidding down of the cellular protocol from 5G to 4G or 3G or WiFi\
    \ an adversary can take advantage of this. The adversary first denies service\
    \ to 5G and bids down victim UE to less secure protocol, for example by using\
    \ a false base station. Then, the adversary actively interrogates or passively\
    \ intercepts unencrypted International Mobile Subscriber Identifier (IMSI) for\
    \ 2G/3G/4G or Media Access Control (MAC) for WiFi."
  detections:
  - component: UE logs for radio network transition events
    detects: UE logs show RAT transitions to less secure service
    fgdsid: FGDS5010.001
    name: UE  logs
  groups: []
  id: FGT5019.002
  mitigations:
  - fgmid: FGM5006
    mitigates: Restrictive user security profile can direct the UE to refuse to connect
      to networks that are not 5G. The prevention of bidding-down is achieved via
      user security profile/configuration stored in the UE
    name: Restrictive User Profile
  name: Intercept Bid-Down SUPI
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Allows an adversary to identify UE as target of interest for geolocation,
      degradation of service, loss of traffic confidentiality, or physical attack.
    name: Target association
  preconditions:
  - description: User security profile must allow bidding down.
    name: Permissive user security profile
  - description: Denying service to 5G and bidding down (e.g. from a false or compromised
      base station) must have occurred for this 5G UE. Adversary must be present in
      the same area as the UE.
    name: Bid down operation successful
  procedureexamples:
  - description: Adversary with false or compromised base station sends an Identity
      Request NAS message to the UE to get back the SUPI. This occurs after the UE
      has been bid down from 5G. Clause 5.4.4 of [2]
    name: Obtain permanent UE identifier SUPI from bid-down UE
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="2"> \[2\] </a> [3GPP TS 24.301 "Non-Access-Stratum (NAS) protocol for
    Evolved Packet System (EPS)"; Stage 3](https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=1072)
  - '<a name="3"> \[3\] </a> [3GPP TS 23.003: "Numbering, Addressing and Identification",
    Version 17.6.0, Section 2.2B](https://www.3gpp.org/DynaReport/23003.htm)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5019
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: N/A
  architecture-segment: Control Plane
  bluf: An adversary in control of an Application Function (AF) or a rogue Network
    Function (NF) can make an API call to obtain the Subscriber Permanent Identifier
    (SUPI) or other sensitive UE information.
  campaigns: []
  criticalassets:
  - description: If SUPI is discovered, many other subsequent attacks are possible
      such as subscriber identity spoofing and location tracking.
    name: User identity
  description: "An adversary in control of an Application Function (AF) or a rogue\
    \ Network Function (NF) can make an API call to obtain the Subscriber Permanent\
    \ Identifier (SUPI) or other sensitive UE information.\r\n\r\nBesides control\
    \ of a NF, the adversary needs knowledge of the UE's phone number (MSISDN) or\
    \ Generic Public Subscription Identifier (GPSI), which are easier to discover\
    \ compared to the SUPI, which is a tightly held UE identifier. There is a legitimate\
    \ API to the operator's Network Exposure Function (NEF) to return a UE SUPI given\
    \ a UE GPSI. \r\n\r\nAfter acquiring the SUPI, an adversary can use it in other\
    \ follow-on behaviors against that UE, such as obtain location information or\
    \ slice subscription data."
  detections:
  - component: Application Log Content
    detects: Logging at the NEF of inquiries for UEs that the requester NF does not
      actually serve. Post process the logs to detect fraudulent API calls by rogue
      AF or NF
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5019.003
  mitigations:
  - fgmid: FGM5019
    mitigates: NEF should check that UE in question is subscribed to services of the
      AF making the API call. This way, the risk of unauthorized access by external
      rogue AFs is reduced.
    name: Authorize External API Calls
  name: Obtain Subscriber Identifier Via NF
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: If SUPI is obtained, many other subsequent attacks are possible such
      as subscriber identity spoofing and location tracking.
    name: SUPI is available to the adversary
  preconditions:
  - description: Adversary has knowledge of UE phone number/GPSI and has control over
      an AF or NEF or AMF.
    name: UE phone number and control of AF/NF
  procedureexamples:
  - description: The NEF stores the UE data - including SUPI-- in UDR and responds
      to API requests from various AFs. An adversary in control of an (external) AF
      uses legitimate SBA API to retrieve subscriber identifier of victim UE (SUPI)
      from their phone number. The API that the AF calls is Nnef_ApplyPolicy_Create
      API, it is sent to NEF with UE's GPSI/phone number. NEF retrieves the SUPI from
      UDM by using Nudm_SDM_Get API. See clause 4.15.6.8 of [1].Alternatively, Rogue
      NEF retrieves SUPI from GPSI/phone number using Nudm_SDM_Get API towards the
      UDM, See clause 4.13.2.2 of [1].
    name: Retrieve UE SUPI via API to NEF or from NEF
  - description: 'The AMF can obtain some sensitive information about a UE it serves
      (or claims to serve). An example for roaming scenarios is that a rogue AMF in
      visited PLMN retrieves UE''s sensitive information from the home PLMN by calling
      an API when UE roams from 5GS to EPC.AMF asks the SMF for UE Session Management
      context, and thus can obtain the following sensitive information: Permanent
      identifier (SUPI), the names of the slices the UE is subscribed to (S-NSSAIs),
      the name of the data network the UE is connected to, and the IP address of the
      UE. (The AMF API call to SMF is Nsmf_PDUSession_ContextRequest API, see clause
      4.11.1.2.1 & Table 5.2.8.2.10-1 of [1])The same attack can happen in non-roaming
      scenario by a compromised AMF.'
    name: Retrieve UE's sensitive information via rogue core NF
  references:
  - <a name="1"> \[1\] </a> [3rd Generation Partnership Project (3GPP) TS 23.502,
    "Procedures for the 5G System (5GS); Stage 2 (Release 17)", v17.4.0, March 2022.](https://www.3gpp.org/DynaReport/23502.htm)
  software: []
  status: Theoretical
  subtechnique-of: FGT5019
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: None
  architecture-segment: UE, RAN
  bluf: An adversary may intercept unencrypted radio transmissions of a UE's SUCI
    to identify the IMSI/SUPI of the UE.
  campaigns: []
  criticalassets:
  - description: UE's identity is obtained for subsequent attacks.
    name: User identifiers - permanent or temporary
  description: "An adversary may intercept unencrypted radio transmissions of a UE's\
    \ SUCI to identify the IMSI/SUPI of the UE.\r\n\r\nAn adversary can retrieve the\
    \ IMSI/SUPI of UE if SUCI is sent unencrypted over the air. The adversary can\
    \ then proceed to other techniques targeting the subscriber with that IMSI/SUPI.\
    \ \r\n\r\nWhen 5G UE is connected to a 4G core in 5G non-stand alone (NSA) mode,\
    \ adversary uses an airlink signal analyzer to retrieve UE's permanent identity\
    \ (IMSI/SUPI). All threats present in 4G network including IMSI/SUPI catching\
    \ can materialize when UE is connected to network via 4G eNB.\r\n\r\nBackground\
    \ information: The UE's permanent identity, SUPI (SUbscriber Permanent Identifier),\
    \ includes a home network identifier and a user-specific identifier, and is required\
    \ by standards to not be sent unencrypted over the radio interface. Instead, a\
    \ SUCI (SUbscriber Concealed Identifier) is sent when the UE goes through initial\
    \ registration to the serving network procedures; this de-concealment operation\
    \ can only be done by the UE's home network. However, SUCI can be sent unencrypted\
    \ over the air by UE in any of the following scenarios: \r\n\r\n1. When UE makes\
    \ an emergency call and it does not have a 5G-GUTI\r\n\r\n \r\n\r\n2. If the home\
    \ PLMN has configured \"NULL\" SUCI-protection algorithm to be used\r\n\r\n3.\
    \ If the home PLMN has not provisioned the public key needed to generate a SUCI\
    \ \r\n\r\nRefer clause 6.12.2 of [1]."
  detections: []
  groups: []
  id: FGT5019.004
  mitigations:
  - fgmid: FGM1041
    mitigates: Always configure home PLMN public key in the UE to enable SUPI encryption.
      Do not use NULL scheme for SUCI encryption both in network configuration and
      in UE configuration.
    name: Encrypt Sensitive Information
  - fgmid: FGM5514
    mitigates: Minimize the number of connections to eNB when using NSA mode, use
      eNB only when 5G coverage is not available or 5G network is overloaded.
    name: Minmize eNB Connections
  name: Intercept Unencrypted SUPI
  object-type: technique
  platforms: 5G RAN
  postconditions:
  - description: Now the adversary can proceed with other follow-on behaviors towards
      the victim subscriber whose IMSI/SUPI has been discovered, such as geolocation,
      DOS/degradation of service, or retrieval of sensitive information or user data.
    name: IMSI of subscriber is discovered
  preconditions:
  - description: Adversary requires sufficient signal to capture and decode all airlink
      messages (with low interference and high SNR).
    name: Ability to receive SUCI over the air
  - description: In NSA mode, 5G UE is directed to connect to eNB due to lack of 5G
      coverage in the area or network load situations.
    name: 5G UE is directed to connect to 4G base station in NSA mode
  procedureexamples:
  - description: Adversary reads the SUCI from airlink messages using signal analyzer
      when it is sent in clear mode and extracts the IMSI/SUPI.This is possible in
      the following scenarios:a. When UE makes an emergency call and it does not have
      a 5G-GUTI.b. If the home PLMN has configured "NULL" SUCI-protection algorithm
      to be used. This is observed in practice ([2]), some operators do not use SUCIs
      and instead allow SUPIs to be sent unencrypted. c. If the home PLMN has not
      provisioned the public key needed to generate a SUCI. d. UE is moved from a
      gNB to an eNB in 5G NSA mode.
    name: Intercept IMSI/SUPI over the radio interface
  references:
  - <a name="1"> \[1\] </a> [3GPP TS 33.501 " Security architecture and procedures
    for 5G system"](https://www.3gpp.org/DynaReport/33501.htm)
  - '<a name="2"> \[2\] </a> [O. Lasierra et. al, "European 5G Security in the Wild:
    Reality versus Expectations"](https://arxiv.org/pdf/2305.08635)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5019
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: IPX, Network
  architecture-segment: Control Plane, Roaming
  bluf: An adversary may send an unsolicited SS7/Diameter message to the core network
    of a UE that will cause the core network to provide IMSI/SUPI of the UE.
  campaigns: []
  criticalassets:
  - description: IMSI/SUPI of the subscriber may be discovered.
    name: User identifier
  description: "An adversary may send an unsolicited SS7/Diameter message to the core\
    \ network of a UE that will cause the core network to provide IMSI/SUPI of the\
    \ UE.\r\n\r\nAn operator's network consists of a 5G Core and also auxiliary systems\
    \ such as the IP Multimedia System (IMS). The IMS is used to provide voice and\
    \ SMS services; this is accomplished via traditional protocols SS7 and Diameter\
    \ between the IMS and 5G core functions. This subtechnique covers the abuse of\
    \ such legitimate signaling to obtain the permanent identifier of a UE. \r\n\r\
    \nOnce the IMSI/SUPI is obtained, adversary may proceed to other follow-on behaviors\
    \ such as retrieving location of the UE, the identifier of the network slice and\
    \ data network that are being used by the UE etc.\r\n\r\n \r\n\r\nBackground info:\r\
    \n\r\n5G SA core has interfaces to IMS core to support voice and SMS services.\
    \ Diameter/SS7 attacks. In signaling plane, voice service uses Diameter based\
    \ Rx interface between PCF and P-CSCF in IMS, Diameter based Sh interface between\
    \ HSS/UDM and TAS in IMS, Diameter based Cx interface between HSS/UDM and I/S-CSCF.\
    \ It also uses SIP/SDP based Gm interface between UPF and P-CSCF in the user plane.\
    \ SMS over NAS service uses SS7 (MAP) based interface and S6c Diameter based interface\
    \ from UDM to SMSC. It also uses MAP and SGd (Diameter) interfaces from SMSF to\
    \ SMSC."
  detections:
  - component: Network Traffic Content
    detects: Monitor all communications over Diameter and SS7/MAP based interfaces
      to/from core network.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups:
  - description: HiddenArt retrieved of UE location via using the SS7 -sending SS7
      messages from the GRX/IPX or a compromised operator to the home PLMN of a user
      being targeted ([4]).
    fggid: FGG5003
    name: HIddenArt
  id: FGT5019.005
  mitigations:
  - fgmid: FGM5513
    mitigates: Use Diameter End-to-end Signaling Security (DESS). Section 6.5.3 of
      [4].
    name: Use DESS Security
  - fgmid: FGM5004
    mitigates: Use SMS router or firewall
    name: Correctly Configure SMS Firewall
  - fgmid: FGM1014
    mitigates: Use SS7/MAP and Diameter firewalls depending on signaling method used.
      [3]
    name: Interconnection Filtering
  name: SS7 Or Diameter Signaling
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Now the adversary can proceed with other follow-on behaviors towards
      the victim subscriber whose IMSI/SUPI has been discovered, such as geolocation,
      DOS/degradation of service, or retrieval of sensitive information or user data.
    name: IMSI of subscriber is discovered
  preconditions:
  - description: Adversary collects victim UE's phone number from subscriber's physical
      address using internet based services such as numlooker.com.
    name: MSISDN or phone number of victim UE is known to adversary
  procedureexamples:
  - description: Diameter protocol:Adversary sets up a fake SMSC and then sends a
      specially crafted Send Routing Info for Short Message Request (SRR) with victim
      UE's MSISDN to HSS/UDM. If SMS router/firewall is not setup or if it is setup
      incorrectly, HSS/UDM will return the IMSI/SUPI of the UE and the ID of AMF/MME's
      ID currently serving the UE in response Send Routing Info for SM Answer (SRA)
      message.SS7 protocol:Adversary sets up a fake SMSC and then sends a specially
      crafted MAP SRI_SM Send Routing Info for Short Message Request (SRR) with victim
      UE's MSISDN to HSS/UDM. If SMS router/firewall is not setup or if it is setup
      incorrectly, HSS/UDM will return the IMSI/SUPI of the UE and the ID of AMF/MME's
      ID currently serving the UE in response Send Routing Info for SM Answer (SRA)
      message. [1, 2]
    name: UE's IMSI/SUPI is retrieved using SRR message
  - description: 'Diameter protocol: Adversary sets up an application server and sends
      a specially crafted User Data Request (UDR) message with victim UE''s MSISDN
      to HSS/UDM. If HSS/UDM is not configured properly, HSS/UDM will return the IMSI/SUPI
      of the UE in User Data Answer (UDA) response message. [2]'
    name: UE's IMSI/SUPI is retrieved using Diameter UDR message
  references:
  - '<a name="1"> \[1\] </a> [International Conference on Cyber Conflict 2016: "We
    know where you are".](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7529440)'
  - <a name="2"> \[2\] </a> [B.T. Kotte, "Analysis and Experimental Verification of
    Diameter Attacks in Long Term Evolution Networks", KTH Royal Institute of Technology,
    2016.](http://www.diva-portal.org/smash/get/diva2:951619/FULLTEXT01.pdf)
  - <a name="3"> \[3\] </a> [Broadforward's SS7/MAP Firewall.](https://www.broadforward.com/ss7-firewall-ss7fw/)
  - <a name="4"> \[4\] </a> [GSMA IR.88 "EPS Roaming Guidelines".](https://www.gsma.com/newsroom/wp-content/uploads/IR.88-v22.0.pdf)
  - <a name="5"> \[5\] </a> [Enea (2022). HiddenArt - A Russian-linked SS7 Threat
    Actor](https://www.enea.com/insights/the-hunt-for-hiddenart/)
  software: []
  status: Observed In Earlier 3GPP Generations And Expected In 5G
  subtechnique-of: FGT5019
  tactics:
  - TA0007
  - TA0009
  typecode: fight_subtechnique
- access-required: N/A
  architecture-segment: UE, RAN
  bluf: Adversary sends a spoofed or silent SMS to trigger paging of UE, to retrieve
    the subscriber profile identifier.
  campaigns: []
  criticalassets:
  - description: IMSI/SUPI of the subscriber may be discovered.
    name: User identifier
  description: "Adversary sends a spoofed or silent SMS to trigger paging of UE, to\
    \ retrieve the subscriber profile identifier.\r\n\r\nA silent SMS is not shown\
    \ to the user of the device. Silent SMSs are a legitimate type of SMS allowed\
    \ by operator for various purposes such as user tracking and monitoring (law enforcement,\
    \ intelligence services, and operator services).\r\n\r\nA UE has a permanent identifier\
    \ (IMSI or SUPI), but also a temporary one (\"Temporary Mobile Subscriber Identity\"\
    ) assigned by the network (TMSI, with their version for 4G and 5G). Adversaries\
    \ can take advantage of cellular networks where the IMSI is used when computing\
    \ how to page a UE, rather than TMSI, or when the TMSI is used but not changed\
    \ frequently. This is a choice of the mobile network operator. \r\n\r\nAn adversary\
    \ can send silent SMS messages to that target phone number, and listen for the\
    \ paging messages that the base station in that area sends in response (assumes\
    \ the target UE is in inactive mode and is located in the area of a base station\
    \ where the adversary has installed a radio interface sniffer). From the sniffed\
    \ paging messages, and adversary learns the \"paging occasion\" for that UE. From\
    \ the paging occasion, several bits (7) of the IMSI can be deduced. The rest of\
    \ the IMSI (24 bits) can be tried out by brute force by sending many paging messages\
    \ (e.g. via a false base station) corresponding to the IMSIs being tried out,\
    \ and if one gets a response that is valid, it means that the guess is correct.\
    \ \r\n\r\nSeveral UEs may end up sharing the same paging occasion. With knowledge\
    \ of the victim's phone number, an adversary can cause the victim UE to be paged\
    \ in a certain fashion (e.g. by sending a given number of silent SMS and watching\
    \ for a similar number of paging messages), the adversary can determine the paging\
    \ occasion for that UE. If the UE is not located in that cell area, then no such\
    \ paging messages will be noticed. An adversary needs to install sniffers in all\
    \ of the cell areas of interest, i.e. where they desire to determine the presence\
    \ or absence of a target UE at a given time, and/or to determine the UE identifiers\
    \ (IMSI or SUPI or TMSI).\r\n\r\nBackground information: the IMSI in the US is\
    \ ~49 bits, but the IMSI's leading 18-bits (i.e., the mobile country code and\
    \ the mobile network code) can be obtained from the phone number using paid, Internet-based\
    \ home location register lookup services. The \"paging occasion\" - the precise\
    \ time/frequency slot when the paging indication is sent-is calculated in a known\
    \ way based on a UE identifier- either IMSI or TMSI."
  detections:
  - component: Silent SMS detector at UE side
    detects: Run at the UE side a tool to detect silent SMS messages (can be OS monitoring
      app as in [2])
    fgdsid: FGDS5024.001
    name: Silent SMS detector
  groups: []
  id: FGT5019.006
  mitigations:
  - fgmid: FGM5102
    mitigates: Run at the UE side a tool to detect and not respond to multiple silent
      SMS messages received in a short time (can be OS monitoring app as in [2])
    name: Silent SMS Blocker
  - fgmid: FGM5004
    mitigates: The operator may run a network side SMS firewall that permits legitimate
      silent SMSs (e.g. from law enforcement) but blocks the ones from suspicious
      sources
    name: Correctly Configure SMS Firewall
  name: Silent SMS
  object-type: technique
  platforms: 5G OS
  postconditions:
  - description: Now the adversary can proceed with other follow-on behaviors towards
      the victim subscriber whose IMSI/SUPI has been discovered, such as geolocation,
      DOS/degradation of service, or retrieval of sensitive information or user data.
    name: IMSI of subscriber is discovered
  preconditions:
  - description: Adversary deployed a sniffer in the coverage area where the target
      UE may be located
    name: Radio interface sniffer
  procedureexamples:
  - description: By sending several (about 8) silent SMS messages to a UE, (or make
      8 silent calls), and watching the responses on the radio interface- if the UE
      is present, the paging occasion of the UE can be determined [1].
    name: Paging occasion guessing
  - description: If the operator uses IMSI to page UEs, then if some bits of the IMSI
      are already guessed (e.g. via a location/paging occasion guessing discovery
      technique), it is possible to infer the actual IMSI. The adversary sends multiple
      silent SMS messages corresponding to guessed IMSIs, and watches the radio interface
      for responses. [1]
    name: IMSI-cracking
  references:
  - <a name="1"> \[1\] </a> [S.R. Hussain et.al., "Privacy Attacks to the 4G and 5G
    Cellular Paging Protocols Using Side Channel Information"](https://homepage.divms.uiowa.edu/~comarhaider/publications/LTE-torpedo-NDSS19.pdf)
  - <a name="2"> \[2\] </a> [H. Wen et al., "Thwarting Smartphone SMS Attacks at theRadio
    Interface Layer". Retrieved Sept 14, 2023.](https://www.ndss-symposium.org/ndss-paper/thwarting-smartphone-sms-attacks-at-the-radio-interface-layer/)
  software: []
  status: Theoretical
  subtechnique-of: FGT5019
  tactics:
  - TA0009
  - TA0007
  typecode: fight_subtechnique
- access-required: Admin
  architecture-segment: Control Plane
  bluf: Adversary controlling a control plane network function (NF) may manipulate
    signaling to retrieve UE subscription information.
  campaigns: []
  criticalassets:
  - description: Subscriber data can be permanent (not updateable) or updateable (like
      the current serving PLMN, AMF etc)
    name: UDM and subscriber/UE data
  description: "Adversary controlling a control plane network function (NF) may manipulate\
    \ signaling to retrieve UE subscription information.\r\n\r\nThe AMF, SMF, NEF,\
    \ SMSF and the UDM itself can use legitimate signaling to retrieve the subscription\
    \ data of a given UE, assuming its SUPI is known. The subscription data is stored\
    \ in the UDM or UDR. \r\n\r\nThe UE data in the UDM is referred to as the \"Session\
    \ Data Management Subscription data\", and it includes access and mobility subscription\
    \ data, SMS subscription data, slice information (the UE's NSSAIs), \"supported\
    \ features\", serving PLMN ID. This threat consists of a compromised NF to ask\
    \ the UDM for the data for a given SUPI or Generic Public Subscription Identifier\
    \ (GPSI). "
  detections:
  - component: Application Log Content
    detects: Monitor logs of UDM, from control plane NFs, checking they originate
      from authorized and uncompromised entities.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5020
  mitigations:
  - fgmid: FGM5033
    mitigates: Standard 5G enterprise/core network security functionalityE.g. Zero
      trust principles for OA&M.
    name: Zero Trust
  - fgmid: FGM5509
    mitigates: Implement filtering and rate-limiting mechanisms for control plane
      signaling messages to block or restrict requests with malicious or anomalous
      content targeting UE subscription data.
    name: Screen Signaling And User Plane Messages
  name: Retrieve UE Subscription Data
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Subscription data successfully retrieved from the UDM, compromising
      sensitive information such as mobility, SMS, slice details, and serving PLMN
      ID, etc.
    name: Subscription Data
  preconditions:
  - description: Adversary must know the SUPI or GPSI of victim UE
    name: SUPI or GPSI
  procedureexamples:
  - description: An AMF can extract subscription data (including NSSAIs) for any given
      UE SUPI by asking the UDM (uses Nudm_SDM_Get service  (SDM=SubscriberDataManagement)).
      The UDM does not check that that AMF is the one serving the UE, i.e. the AMF
      does not need to register itself first as serving the UE, via the Nudm_UECM_Registration
      Request. Table 5.2.3.1-1 of [1].
    name: AMF retrieves subscription data from UDM
  - description: 'A rogue AMF in visited PLMN can retrieve the UE''s sensitive information
      during 5GS to EPC roaming. AMF calls Nsmf_PDUSession_ContextRequest API to v/hSMF.
      SMF sends the UE SM context in response which can reveal the following UE information:
      SUPI, S-NSSAI, DNN, UE IP address etc. Clause 4.11.1.2.1 & Table 5.2.8.2.10-1
      of [1].'
    name: AMF in visited PLMN retrieves UE information during 5GS to EPC roaming
  - description: The SMF can send to UDM a Nudm-sdm message and retrieve "Session
      mgmt subscription data", i.e. DNN configuration for all network slices.
    name: SMF retrieves subscription data from UDM
  - description: The UDM can legitimately get UE subscription data from UDR.
    name: UDM can look up any UE (in UDR if one is employed)
  - description: The SMSF can get the UE subscription data via Nudm_sdm API.
    name: SMSF retrieves UE subscription data from UDM
  - description: The NEF can get the UE subscription data via Nudm_sdm API.
    name: NEF retrieves some of the UE subscription data from UDM
  references:
  - <a name="1"> \[1\] </a> [3rd Generation Partnership Project (3GPP) 23.502 "Procedures
    for the 5G System (5GS)", March 2022.](https://www.3gpp.org/DynaReport/23502.htm)
  software: []
  status: Theoretical
  tactics:
  - TA0009
  typecode: fight_technique
- access-required: None.
  architecture-segment: User Plane
  bluf: An adversary controlling a user-plane function (gNB or UPF) may disrupt user
    traffic by assigning the new traffic a TEID already in use.
  campaigns: []
  criticalassets:
  - description: Billing data of legitimate UE gets corrupted.
    name: Charging Data Record (CDR)
  - description: UE's user plane traffic is disrupted.
    name: UE user plane data
  description: "An adversary controlling a user-plane function (gNB or UPF) may disrupt\
    \ user traffic by assigning the new traffic a TEID already in use.\r\n\r\nThe\
    \ Tunnel Identifier, TEID, is part of the Core Network Tunnel information and\
    \ is assigned locally by the UPF and also by the gNB/ng-eNB for user plane routing\
    \ for each UE served. The failure to guarantee the uniqueness of the TEID for\
    \ a PDU session results in interruption of the routing of the user traffic. It\
    \ also creates charging errors. If multiple PDU sessions were to share the same\
    \ TEID at the same time, the counts for the network usage of a single PDU session\
    \ will be in fact the counts for the network usage of multiple sessions, creating\
    \ charging errors.\r\n\r\nRogue or erroneous configuration/implementation in gNB\
    \ or UPF can cause an existing TEID to be assigned to a new PDU session. This\
    \ can also happen during EPS to 5GS handover or roaming."
  detections:
  - component: Network Connection Creation
    detects: Packet inspection over the N3 interface. If two packets are seen to have
      the same TEID on the RAN to UPF interface, then it can be verified that they
      indeed belong to the same UE. It may be difficult to detect as it is per UE
      and per PDU session.
    fgdsid: FGDS0029.001
    name: Network Traffic
  - component: Charging data records content
    detects: Periodic CDR audits can detect anomaly.
    fgdsid: FGDS5003.001
    name: Charging data records
  groups: []
  id: FGT5021
  mitigations:
  - fgmid: FGM5094
    mitigates: Ensure UPF and gNB/NG-eNB check for uniqueness for every new TEID they
      allocate locally. The newly assigned TEID must not have been in use in the past
      given certain amount of time (which should be set to the reasonable maximum
      tunnel lifetimes observed).
    name: Allocate New 5G Identifiers Judiciously
  - fgmid: FGM1035
    mitigates: Limiting Access to RAN or core network functions from external networks
      would reduce the chance of a gNB or UPF being compromised. Barring faulty implementation,
      this should ensure that the tunnel IDs are allocated correctly.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1047
    mitigates: The UPF and g/eNB must keep a log of the TEIDs currently in use (which
      they assigned), and purge TEIDs once the tunnel is torn down. This log must
      be checked every time a new TEID is allocated.
    name: Audit
  name: Tunnel ID Uniqueness Failure
  object-type: technique
  platforms: 5G core, 5G RAN
  postconditions:
  - description: UE user plane data gets disrupted.
    name: UE data disruption
  - description: Incorrect subscribers' charging records are generated.
    name: Incorrect charging
  preconditions:
  - description: Faulty implementation at gNB or UPF; or, control over gNB, and UPF.
    name: Control or misconfiguration of gNB or UPF
  procedureexamples:
  - description: Rogue or wrong configuration/implementation in gNB or UPF can cause
      existing TEID to be assigned to a new N3 reference point or PDU session. Clause
      J.2.2.2 of [1].Duplicate TEID allocation can happen during EPS to 5GS handover
      or roaming.Duplicate TEID can cause traffic disruption, charging issues and
      eavesdropping of legitimate subscriber data by adversary. Clause 5.8.2.3 of
      [2], clause 4.11.1.2.2 of [3].
    name: Rogue or misconfigured gNB or UPF
  references:
  - <a name="1"> \[1\] </a> [3GPP TR 33.926 "Security Assurance Specification (SCAS)
    threats and critical assets in 3GPP network product classes".](https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3002)
  - <a name="2"> \[2\] </a> [3GPP TS 23.501 "System architecture for the 5G System
    (5GS)".](https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3144)
  - <a name="3"> \[3\] </a> [3GPP TS 23.502, "Procedures for the 5G System (5GS);
    Stage 2 (Release 17)", Technical Specification, v17.4.0, March 2022.](https://www.3gpp.org/DynaReport/23502.htm)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- architecture-segment: Control Plane, OA&M
  bluf: An adversary may alter the subscriber profile to achieve fraud, via SBI (Service
    Based Interfaces) or OA&M interfaces.
  campaigns: []
  criticalassets:
  - description: UE voice and data records accuracy.
    name: UE data accuracy
  - description: UE's static profile data.
    name: UE related configuration
  - description: UE user plane data session continuity.
    name: UE data services
  description: "An adversary may alter the subscriber profile to achieve fraud, via\
    \ SBI (Service Based Interfaces) or OA&M interfaces.\r\n\r\nThe subscriber profile\
    \ is a mostly static set of data relating to a device, such as: phone number,\
    \ group membership, data access configuration, and others. The dynamic data is\
    \ the serving AMF (which is associated with a very coarse geographical location).\
    \ This profile resides in the UDM. If the UDM is compromised, it can make any\
    \ change to the user profile. The AMF serving the UE can get a fresh copy of the\
    \ subscriber profile. \r\n\r\nAnother type of profile is the \"UE context\", and\
    \ is also held at the UDM; it is a dynamic (valid for a session) set of data relating\
    \ to the current state of the UE. The UE context can be modified in the UDM legitimately\
    \ by certain NFs such as AMF and SMF.\r\n\r\nAn adversary in the core network\
    \ (e.g. in control of a core NF such as AMF, UDM or PCF) can retrieve subscriber\
    \ profile from the repository UDM/UDR, and may be able to alter at least part\
    \ of it, e.g., AMF can update the serving AMF entry. The UDM can naturally alter\
    \ any portion of the profile.\r\n\r\nAn OA&M based attack (adversary has access\
    \ to the provisioning interface) on the UDM/UDR would allow all changes to the\
    \ UE profile (e.g., change from post-paid to pre-paid or vice-versa)."
  detections:
  - component: MNO logs for service issues in core
    detects: Subscriber contacts customer service to complain about degraded service
      (in some limited cases).
    fgdsid: FGDS5011.001
    name: MNO logs in core for subscriber service complaints
  - component: Application Log Content
    detects: Audit UDM/UDR API access logs for any abnormal data modification requests.
      API accesses from core NFs and OAM should be checked.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5022
  mitigations:
  - fgmid: FGM5020
    mitigates: Secure subscriber data repositories in the UDM.
    name: Secure Subscriber Repositories
  name: Alter Subscriber Profile
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: 'Compromised AMF/SMF can use Nudm_UECM_Update to modify UE context
      in the UDM. AMF or SMF can change some parameters in the UE context (which is
      like a subscriber profile, but valid only for a session; Clause 5.2.3.2.5 of
      [3]. The parameters are: PEI (Permanent Equipment Identifier), analyticsID (for
      NWDAF), UE capabilities, Intersystem continuity context, SMF FQDN. This can
      cause DoS attack on legitimate UEs.'
    name: AMF or SMF modifies UE context.
  - description: 'Rogue AF/NEF via UDM can modify UE''s configuration for a given
      external service (e.g. pay for video for a game today). When the victim UE changes
      state from idle mode to connected mode, it will receive the modified services
      which may be inferior to the services originally provisioned. Example: NEF can
      use Nudm_ParameterProvision update service to update UE subscription data. Clause
      5.6.2.2 of [4] & clauses 4.15.6.2, 4.15.6.3, 4.15.6.3a of [3].'
    name: Rogue AF/NEF modifies UE's configuration for a given external service.
  - description: Compromised OA&M GUI or CLI client may access subscriber database
      in UDR and may modify its contents to adversely impact UE data connections.
    name: Compromised OA&M can modify subscriber profile data in UDR
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020.](https://arxiv.org/abs/2005.05110v1)'
  - '<a name="2"> \[2\] </a> [S. Holtmanns, I. Oliver and Y. Miche: "Mobile Subscriber
    Profile Data Privacy Breach via 4G Diameter Interconnection", 2017.](https://www.riverpublishers.com/journal_read_html_article.php?j=JICTS/6/3/4)'
  - '<a name="3"> \[3\] </a> [3GPP TS 23.502: "Procedures for the 5G System (5GS);
    Stage 2 (Release 17)", Technical Specification, v17.4.0, March 2022.](https://www.3gpp.org/DynaReport/23502.htm)'
  - '<a name="4"> \[4\] </a> [3GPP TS 29.503: "5G System; Unified Data Management
    Services; Stage 3".](https://www.3gpp.org/DynaReport/29503.htm)'
  software: []
  status: Theoretical
  tactics:
  - TA5001
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Control Plane
  bluf: An adversary controlling a control plane network function (NF) may manipulate
    signaling or parameters to achieve charging/billing fraud where victim is UE or
    operator itself.
  campaigns: []
  criticalassets:
  - description: Subscriber billing data integrity and privacy may be exposed to adversary.
    name: UE call/data records accuracy
  description: "An adversary controlling a control plane network function (NF) may\
    \ manipulate signaling or parameters to achieve charging/billing fraud where victim\
    \ is UE or operator itself.\r\n\r\nThere are multiple procedures to support this\
    \ adversarial behavior, and they depend on the NF that is compromised."
  detections:
  - component: Charging data records content
    detects: Management system (OSS/BSS) checks uniqueness of charging ID for all
      new PDU sessions in non-roaming scenario and existing PDU sessions in handover
      and roaming scenario.
    fgdsid: FGDS5003.001
    name: Charging data records
  groups: []
  id: FGT5023
  mitigations:
  - fgmid: FGM5024
    mitigates: Use strong data integrity protection algorithms.
    name: Integrity Protection Of Data Communication
  - fgmid: FGM5023
    mitigates: Periodic authentication / authorization of NF consumer e.g. SMF/PCF/CHF/NEF/AF
      by NRF will help detect rogue NFs.
    name: Periodic Authentication & Authorization Of NFs
  - fgmid: FGM0947
    mitigates: Rigorous checks of unique mapping of charging ID to PDU session (applicable
      to the SMF case). Management system (OSS/BSS) can generate alert for possible
      intervention.
    name: Audit
  name: Charging Fraud Via NF Control
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: Charging or billing fraud occurs due to adversary manipulation via
      a compromised network function.
    name: Fraud Charges
  preconditions:
  - description: Limited periodic authentication and integrity protection.
    name: Intermittent Safeguards
  procedureexamples:
  - description: An adversary may control the SMF and assign the same SMF Charging
      Identifier to a device data flow as that of an existing victim device, to cause
      charging errors. Clause 5.1.4 & annex A.1 of [3].The SMF can also pause charging
      for a given UE (even though not warranted), clause 4.4.4 of [4].The SMF can
      also misreport 5G data used by a given UE.
    name: SMF control
  - description: An adversary with control over the PCF can change policy so that
      UE is allowed to consume a service it was not subscribed to - but it will still
      be traceable to that UE. Clause 4.3.2 of [5].
    name: PCF control
  - description: An adversary with control over the CHF can ignore when PCF tells
      it that the spending limit for this subscriber has been reached or can ignore
      the SMS records from the SMSF (SMSF uses POST to put in data), or can ignore
      the 5G data the SMF reports ([3])
    name: CHF control
  - description: 'Adversary on AF can attack a weak NEF. Or, the NEF can be compromised
      and conduct this attack without even an AF. An AF can ask the NEF to change
      the "chargeable party" Clause 4.4.8 of [6], clause 4.4.4 of [7].This is meant
      to support the AF being the chargeable party, but it''s imaginable how the AF
      can put a different AF as chargeable: it has to send the AF identifier, UE IP
      address, Sponsor ID, ASP ID, etc. even AppID.'
    name: NEF control or Application Function (AF) control exploiting weak NEF
  references:
  - '<a name="1"> \[1\] </a> [3rd Generation Partnership Project (3GPP) TR 33.926:
    "Security Assurance Specification (SCAS) threats and critical assets in 3GPP network
    product classes", Technical Report, v17.3.0, December. 2021](https://www.3gpp.org/DynaReport/33926.htm)'
  - '<a name="2"> \[2\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - <a name="3"> \[3\] </a> [3GPP TS 32.255 "Telecommunication management; Charging
    management; 5G data connectivity domain charging; Stage 2"](https://www.3gpp.org/DynaReport/32255.htm)
  - <a name="4"> \[4\] </a> [3GPP TS 23.502 "Procedures for the 5G System (5GS)"](https://www.3gpp.org/DynaReport/23502.htm)
  - <a name="5"> \[5\] </a> [3GPP TS 23.503 "Policy and charging control framework
    for the 5G System (5GS); Stage 2"](https://www.3gpp.org/DynaReport/23503.htm)
  - <a name="6"> \[6\] </a> [3GPP TS 29.522 "5G System; Network Exposure Function
    Northbound APIs; Stage 3"](https://www.3gpp.org/DynaReport/29522.htm)
  - <a name="7"> \[7\] </a> [3GPP TS 29.122 "T8 reference point for Northbound APIs"](https://www.3gpp.org/DynaReport/29122.htm)
  software: []
  status: Theoretical
  tactics:
  - TA5001
  typecode: fight_technique
- access-required: None
  architecture-segment: RAN, O-RAN
  bluf: Adversary may jam the wireless backhaul facility to disrupt the ability to
    connect to the network for all UEs or Integrated Access and Backhaul (IAB) nodes.
  campaigns: []
  criticalassets:
  - description: 5G RAN services are disrupted during jamming.
    name: gNB
  description: "Adversary may jam the wireless backhaul facility to disrupt the ability\
    \ to connect to the network for all UEs or Integrated Access and Backhaul (IAB)\
    \ nodes.\r\n\r\nIf one or more Integrated Access and Backhaul (IAB) nodes or mobile\
    \ IAB (mIAB) or gNBs wireless backhaul connection is jammed in tactical or mobile\
    \ network deployment, the network connectivity will be disrupted. This will cause\
    \ temporary DoS for some users until an alternate connection is available.\r\n\
    \r\nMobile IAB nodes are small cell base stations which are typically deployed\
    \ on a vehicle placed in strategic areas. For example, mIAB node can be deployed\
    \ near a stadium for a game event. The backhaul traffic from the mIAB node is\
    \ carried over the air to the next hop base station. The next hop gNB can be another\
    \ IAB node or a fixed base station (aka donor IAB) which has a wired connection\
    \ to the 5G core network.\r\n\r\nAn IAB node may use the same or different RF\
    \ frequency bands for the backhaul traffic to the upstream IAB node and for providing\
    \ network access to the UEs connected to itself. If the same frequency band is\
    \ used for backhaul and access, it is known as in-band deployment and if different\
    \ frequency bands are used for backhaul and access, it is known as out-of-band\
    \ deployment. The adversary may choose to jam both frequency bands in case of\
    \ out-of-band deployment to disrupt both backhaul and access communications.\r\
    \n\r\nThe adversary may impact communications of the target IAB node, the IAB\
    \ nodes that are downstream from the target IAB node and all UEs that are connected\
    \ to the target IAB node and all UEs that are connected to downstream IAB nodes.\
    \ [2]"
  detections:
  - component: gNB log for service outage
    detects: Monitor gNB logs for abnormal service outage.
    fgdsid: FGDS5017.006
    name: gNB or 5G core logs
  groups: []
  id: FGT5024
  mitigations:
  - fgmid: FGM5515
    mitigates: Move the mIAB node to another location to avoid jamming and establish
      a new connection to the next hop base station.
    name: Move mIAB Node
  name: IAB Denial Of Service
  object-type: technique
  platforms: RAN
  postconditions:
  - description: Legitimate subscribers are not able to connect to 5G network.
    name: RAN operations are impacted
  preconditions:
  - description: Adversary must be positioned in the same area as the victim IAB node
      with a wireless sniffer device and a jamming device equipped with sufficient
      transmit power.
    name: Adversary in the same vicinity as victim IAB node
  - description: Adversary impacts all communications associated to the victim IAB
      node i.e. both access and backhaul.
    name: Adversary jams all communications of the victim IAB node
  procedureexamples:
  - description: Adversary monitors transmissions on the IAB node backhaul and access
      links with a wireless sniffer device. Then it starts transmitting bogus RF signal
      with enough transmit power to jam the backhaul and access link communications.
      This will disrupt connectivity to the network of the victim IAB node, all IAB
      nodes that are downstream from victim IAB node, all UEs which are connected
      to the victim IAB node and all UEs which are connected to downstream IAB nodes.
    name: IAB or mIAB node is jammed by adversary
  references:
  - '<a name="1"> \[1\] </a> [5G Americas White Paper: "Innovations in 5G Backhaul
    Technologies; IAB, HFC & FIBER", June 2020.](https://www.5gamericas.org/wp-content/uploads/2020/06/Innovations-in-5G-Backhaul-Technologies-WP-PDF.pdf)'
  - '<a name="2"> \[2\] </a> [3GPP TS 38.401: "NG-RAN; Architecture description".](https://portal.3gpp.org/desktopmodules/Specifications/SpecificationDetails.aspx?specificationId=3219)'
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- architecture-segment: Roaming
  bluf: An adversary in a roaming partner operator may send altered service usage
    for a given UE to the home operator of that UE.
  campaigns: []
  criticalassets:
  - description: Altered or falsified data compromises trust and financial integrity.
    name: Service Usage Data
  description: "An adversary in a roaming partner operator may send altered service\
    \ usage for a given UE to the home operator of that UE.\r\n\r\nService fraud involves\
    \ bypassing controls to gain access to services or resources which the adversary\
    \ is not entitled to or charged for. This applies to 3G, 4G and 5G.\r\n\r\nA dishonest\
    \ roaming partner could falsify a UE service usage or route traffic through several\
    \ partner networks inducing high termination fees to claim revenue in the form\
    \ of service charges."
  detections:
  - component: Charging data records content
    detects: Investigate the Content of Subscriber CDRs (Charging Data Records) (e.g.,
      in Charging Function (CHF) logs).
    fgdsid: FGDS5003.001
    name: Charging data records
  - component: MNO logs for service issues in core
    detects: Cross-check with subscriber services (if subscriber complains).
    fgdsid: FGDS5011.001
    name: MNO logs in core for subscriber service complaints
  groups: []
  id: FGT5025
  mitigations:
  - fgmid: FGM5503
    mitigates: Employ home-routing instead of local breakout for user traffic (but
      this means more delay and lower quality of service).
    name: Increase Control Of Home Network For User Plane
  name: Falsify Interconnect Invoice
  object-type: technique
  platforms: Interconnect
  postconditions:
  - description: Operator loses revenue. The home operator receives falsified service
      usage data from the roaming partner, potentially leading to incorrect billing,
      service fraud, or inflated termination fees.
    name: Operator Revenue
  preconditions:
  - description: The UE is roaming on a partner network, and the home operator depends
      on the partner for accurate service usage reporting.
    name: UE Roaming
  procedureexamples:
  - description: Signaling fraud may be undertaken by a partner operator, via false
      charging over international signaling interconnection. Clause 5.3 of [1]. Reference
      [2] mentions service fraud.
    name: False charging
  references:
  - '<a name="1"> \[1\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, November 2019.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-for-5g-networks)'
  - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",
    October 2021](https://arxiv.org/abs/2108.11206)
  software: []
  status: Observed
  tactics:
  - TA5001
  typecode: fight_technique
- access-required: N/A
  architecture-segment: UE
  bluf: Adversary may clone a SIM card (namely the SUPI, credential stored therein)
    and use it fraudulently to obtain telecom service at the expense of the user of
    the device with that legitimate SIM card.
  campaigns: []
  criticalassets:
  - description: SUPI, master secret key K etc.
    name: Subscriber sensitive data
  description: "Adversary may clone a SIM card (namely the SUPI, credential stored\
    \ therein) and use it fraudulently to obtain telecom service at the expense of\
    \ the user of the device with that legitimate SIM card.\r\n\r\nNote 1: This threat\
    \ is applicable to 3G, 4G and 5G. It may or may not be possible depending on how\
    \ secure the SIM/USIM card is. Some manufacturers of lower tier USIMs may leave\
    \ their devices vulnerable.\r\n\r\nNote 2: USIM card technology is independent\
    \ of 3GPP generations. Releases 15, 16 brought improvements to the USIM technology.\
    \ \r\n\r\nNote 3: If two devices (one legitimate, one cloned SIM) from two different\
    \ locations attempt to connect to that home operator at the same time, both will\
    \ be dropped as a precaution against the suspected SIM cloning. \r\n\r\nPIN-Based\
    \ Access Control: The current PIN-based system offers insufficient protection,\
    \ allowing adversaries to access sensitive in-SIM data. This vulnerability enables\
    \ attacks such as eavesdropping, man-in-the-middle, and impersonation.\r\n\r\n\
    Fast Reattach Vulnerabilities: The interaction between the SIM and the protocol\
    \ stack can lead to the leakage and reuse of the security context, facilitating\
    \ unauthorized access.\r\n\r\nUnencrypted Application Data Unit Communication\
    \ Channel: The lack of encryption in the communication channel allows for eavesdropping\
    \ and spoofing through malicious hardware."
  detections:
  - component: Core logs for SIM usage pattern
    detects: Investigate unusual USIM card patterns.
    fgdsid: FGDS5005.001
    name: Core network logs for SIM
  groups: []
  id: FGT5026
  mitigations:
  - fgmid: FGM1017
    mitigates: M(V)NO procures USIM cards from reputable manufacturers and oversees
      delivery process.
    name: User Training
  - fgmid: FGM1022
    mitigates: Restrict access to files exchanged between SIM vendor and MNO.
    name: Restrict File And Directory Permissions
  - fgmid: FGM1041
    mitigates: Protect the files where SIM data is stored by encryption.
    name: Encrypt Sensitive Information
  - fgmid: FGM5024
    mitigates: Protect the files where the SIM data is stored by integrity protection.
    name: Integrity Protection Of Data Communication
  name: SIM Cloning
  object-type: technique
  platforms: 5G UE
  postconditions:
  - description: With the cloned USIM card, adversary now has access to the victim's
      permanent identifier (SUPI), master secret key K and operator key (OPc). Those
      can be used for unauthorized access to 5G network.
    name: Access to user credentials
  preconditions:
  - description: Adversary needs physical access to USIM card during manufacturing
      of USIMs or during transport to MNOs and the cloned USIM card needs to be activated
      by the MNO.
    name: Access to USIM card
  procedureexamples:
  - description: Adversary gets physical access to the victim USIM card, extracts
      the USIM card contents (SUPI, K and OPc) and then provisions the contents in
      an empty and writeable USIM. This can be done via SIM cloning software.
    name: Duplicate captured USIM card
  references:
  - '<a name="1"> \[1\] </a> [Martin Brisfors, Sebastian Forsmark, Elena Dubrova:
    "How Deep Learning Helps Compromising USIM"](https://dl.acm.org/doi/abs/10.1007/978-3-030-68487-7_9)'
  - '<a name="2"> \[2\] </a> [Jinghao Zhao, Boyan Ding, Yunqi Guo, Zhaowei Tan, Songwu
    Lu, "SecureSIM: Rethinking Authentication and Access Control for SIM/eSIM"](https://dl.acm.org/doi/pdf/10.1145/3447993.3483254)'
  software: []
  status: Proof Of Concept
  tactics:
  - TA5001
  - TA0006
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Network Slice
  bluf: An adversary controlling a Network Function (NF) or slice may gain access
    to a different network slice data by interacting with other NFs.
  campaigns: []
  criticalassets:
  - description: UE (served by that slice) related information. Slice specific configuration
      - e.g. what NFs are part of it and SLAs of the slice.
    name: Confidentiality of slice-specific resources
  - description: The functionality of any core NF that is shared between slices (AMF,
      SMF, PCF,.. ).
    name: Core NFs
  description: "An adversary controlling a Network Function (NF) or slice may gain\
    \ access to a different network slice data by interacting with other NFs.\r\n\r\
    \nEvery network slice has an identifier, part of which is sensitive just like\
    \ a UE permanent identifier. If this Slice Differentiator (SD) is discovered,\
    \ then a malicious NF and/or malicious slice can use the guessed SD to gain unauthorized\
    \ information or resource access to that victim slice. This is done by tricking\
    \ the NRF to issue a token for a slice that the requestor NF is not authorized\
    \ to access, then using that token to get information from the shared NF. It is\
    \ assumed that the shared NF is serving both own slice and the victim slice."
  detections:
  - component: Application Log Content
    detects: Check logs of requests/responses at the shared NF. E.g., each entry should
      contain UE ID (SUPI), NF consumer that requested it, slice IDs of both.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Security logs in core
    detects: Audit logs for suspicious activities in core and raise alarms.
    fgdsid: FGDS5012.001
    name: Security logs in network
  groups: []
  id: FGT5027
  mitigations:
  - fgmid: FGM5003
    mitigates: The attack can be mitigated if the NRF performs additional checks.
      The NRF authorizes the NF service consumer to obtain tokens only for authorized
      slice(s). (3GPP SA3 investigating as of early 2022). A cross check with the
      TLS certificate of requester should be performed as well at the NRF.
    name: Cross Check Between Application Layer And Transport Layer
  - fgmid: FGM1020
    mitigates: Inspect payload by breaking TLS layer encryption.
    name: SSL/TLS Inspection
  - fgmid: FGM5094
    mitigates: Network (AMF) should allocate new identifiers S-NSSAI whenever possible;
      UPF and gNB should allocate unique Tunnel IDs. SMF should check newly allocated
      charging IDs.
    name: Allocate New 5G Identifiers Judiciously
  name: Spoof Network Slice Identifier
  object-type: technique
  platforms: 5G core
  postconditions:
  - description: All assets served, including the compromised slice, become vulnerable.
    name: Compromised network slice and UE
  preconditions:
  - description: See [FGT5028 - Discover Network Slice Identifier](/techniques/FGT5028/).
    name: Slice identifier was discovered
  - description: This is common in practice.
    name: Two slices share one common NF
  - description: This is implicit in the standards that do not mandate this check.
    name: NRF does not check requester slice identifier and the target (consumer)
      slice identifier.
  procedureexamples:
  - description: A malicious NF and/or malicious slice can use the guessed identifier
      Slice Differentiator (SD) to gain unauthorized information or resource access
      to a different slice. The NF asks the NRF for an OAuth token for an NF in that
      other slice. The reason is the requested SD (actually, the entire NSSAI) is
      included in the OAuth token without verification whether requester is allowed
      access to it. The NRF issues that OAuth token because it is for a producer NF
      that serves both the requester's slice and the targeted (victim) slice. This
      seems to be a poor approach to access control- one that relies on knowing an
      identifier, and so access is given if that identifier-presumably kept secret-is
      found out. See section 3.1.3.1 of [1].
    name: Adversary NF in one slice uses guessed slice identifier of another slice
      to gain unauthorized access to resources in that slice.
  references:
  - '<a name="1"> \[1\] </a> [AdaptiveMobile Security: "A Slice in Time: Slicing Security
    in 5G Core Networks", 17032021-v1.00.](https://info.adaptivemobile.com/network-slicing-security)'
  software: []
  status: Theoretical
  tactics:
  - TA0005
  - TA0009
  typecode: fight_technique
- architecture-segment: Network Slice
  bluf: An adversary may guess the identifier of a network slice, which allows for
    follow-on behaviors against that slice that require that identifier.
  campaigns: []
  criticalassets:
  - description: Confidentiality of slice specific resources.
    name: Slice-specific resources
  - description: AMF and UDM have NSSAI information. AMF requests and UDM responds.
    name: Operator network functions
  description: "An adversary may guess the identifier of a network slice, which allows\
    \ for follow-on behaviors against that slice that require that identifier.\r\n\
    \r\nThe network slice selection assistance information (NSSAI) is a slice identifier.\
    \ It contains two elements: a Slice Service Type (SST) (several 3GPP defined values)\
    \ and a Slice Differentiator (SD), which should be unique within that type. Consumer\
    \ Network Functions (NFs) may need to access services of Producer NFs belonging\
    \ to a different slice. Any consumer NF can ask the Network Repository Function\
    \ (NRF) for an OAuth token towards this goal, but it must include the Slice identity--\
    \ which contains a SD - in the request.\r\n\r\nIn 3GPP Release 16 or earlier,\
    \ the SD was not mandatory and random. Hence \"brute forcing\" or \"enumeration\"\
    \ can be used to guess the SD. Thus if the consumer NF is compromised and wants\
    \ to discover other slice IDs, it can ask the NRF for OAuth tokens but with guessed\
    \ slice identities, until a valid one is returned."
  detections:
  - component: Application Log Content
    detects: Logs at the NRF of failed NSSAI lookups. Monitor for repeated events
      where an NF asks for NSSAIs that do not exist.AMF can ask the UDM about NSSAIs
      legitimately. Monitor AMF and UDM logs of transactions involving asks about
      NSSAIs.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5028
  mitigations:
  - fgmid: FGM5509
    mitigates: NRF should screen repeated signaling from the same NF to protect against
      this type of brute-force guessing. NRF should not respond to requests after
      a given number of failed NSSAI lookups (See detections).
    name: Screen Signaling And User Plane Messages
  name: Discover Network Slice Identifier
  object-type: technique
  platforms: 5G Slice
  postconditions:
  - description: Now the adversary knows the SD of a given slice it is not authorized
      to contact.
    name: Unauthorized disclosure of SD/NSSAI
  preconditions:
  - description: 'For NF discovery service, clause 5.2.7.1 of [3] lists the following
      service consumers: AMF, SMF, PCF, NEF, NSSF, SMSF, AUSF, CHF, NRF, NWDAF, I-CSCF,
      SCSCF, IMS-AS, SCP, UDM, AF, DCCF, MBSF, 5G DDNMF, TSCTSF.'
    name: Compromise of core consumer NF
  procedureexamples:
  - description: 'An adversary-controller "consumer NF" can ask the NRF for an access
      token for a slice with a guessed SD identifier, until a non-error response is
      returned. The NRF services that are candidates for this operation are ([2]):
      discovery and Access token (Nnrf_NFDiscovery and Nnrf_AccessToken). For the
      Discovery service, in the GET NF instances, the parameters can be included "plmn-specific-snssai-list",
      which contains the S-NSSAIs that are served by the NF supposedly being discovered.
      Then the 200OK result contains the NFProfile, which includes the S-NSSAIs. Section
      3.1.3 of [1].'
    name: NRF interrogation for guessing SD identifier
  references:
  - '<a name="1"> \[1\] </a> [AdaptiveMobile Security, "A Slice in Time: Slicing Security
    in 5G Core Networks", 17032021-v1.00.](https://info.adaptivemobile.com/network-slicing-security)'
  - <a name="2"> \[2\] </a> [3rd Generation Partnership Project (3GPP) TS 29.510,
    "; Network function repository services; Stage 3", v17.4.0, Dec 2021.](https://www.3gpp.org/DynaReport/29510.htm)
  - <a name="3"> \[3\] </a> [3GPP TS 23.502 "Procedures for the 5G System (5GS); Stage
    2"](https://www.3gpp.org/DynaReport/23502.htm)
  software: []
  status: Theoretical
  tactics:
  - TA0007
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Roaming
  bluf: Adversary sends specifically crafted messages from an interconnect/interworking
    partner against roaming interface to gain access to the service function, e.g.,
    SEPP, or to obtain information from the interworking facing service function.
  campaigns: []
  criticalassets:
  - description: The Security Edge Protection Proxy (SEPP) is the primary target for
      this technique and represent a key interface point between the operator and
      other service providers, via N32, for roaming.
    name: SEPP
  - description: The User Plane Function (UPF) in the home provider network exposes
      the N9 interface to other providers and can be targeted using this technique.
      If the Home Public Land Mobile Network (HPLMN) UPF is compromised, sensitive
      data may be sniffed or potentially dropped.
    name: UPF
  - description: The home Policy Control Function (h-PCF) is exposed to the visited
      PCF (v-PCF) via N24 in a home routed roaming scenario.
    name: PCF
  - description: The HPLMN Unified Data Management (UDM) function is exposed via N10
      to the Visited PLMN (VPLMN) Session Management Function + Packet Data Network
      Gateway Control (SMF+PGW-C) for local breakout roaming architecture.  The VPLMN
      Access and Mobility Management Function (AMF) can also reach the Home Subscriber
      Server UDM (HSS+UDM) via N8.  The VPLMN Mobility Management Entity (MME) can
      reach the HSS+UDM via S6a as well.
    name: HSS+UDM
  - description: The Non-3GPP Interworking Function (N3IWF) is exposed via the Y2
      and NWu interfaces.
    name: N3IWF
  description: "Adversary sends specifically crafted messages from an interconnect/interworking\
    \ partner against roaming interface to gain access to the service function, e.g.,\
    \ SEPP, or to obtain information from the interworking facing service function.\r\
    \n\r\nA semi-public application or service is one that is only reachable by an\
    \ adversary over an interworking network that is typically only exposed to mobile\
    \ network operators (MNO), internetwork packet exchange providers (IPX), Value\
    \ Added Services (VAS) providers. An adversary that has previously compromised,\
    \ through other techniques, another service on the interworking network may be\
    \ in a position to use this technique against an operator's interworking facing\
    \ service interfaces. The adversary does not necessarily need to compromise a\
    \ roaming partner but needs to be on a network which can reach the target interface.\r\
    \n\r\nThe technique uses specifically formatted signaling messages to cause unexpected\
    \ behavior that the adversary has previously determined to permit gaining access\
    \ to the roaming interface system or network functions reachable via SEPP (N32),\
    \ PCF (N24), HSS+UDM (N10, N8, S6a) or N3IWF interfaces. The specially crafted\
    \ messages may also permit the collection of information about the targeted operator\
    \ and its users. The adversary may target the SEPP itself or place specially crafted\
    \ messages within legitimately authenticated messages that the SEPP passes to\
    \ NFs that can result in compromise of the NF or information collection. N9 interfaces\
    \ and non-3GPP interfaces exposed to interworking partners may also be targeted\
    \ by adversaries. The technique [FGT1190](/techniques/FGT1190) covers internet\
    \ facing service interfaces."
  detections:
  - component: Application Log Content
    detects: Monitor application logs for evidence of unexpected access requests or
      potential pattern of errors logged that might indicate attempts to create unexpected
      behavior
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Logon Session Creation
    detects: Monitor login session logs for evidence an adversary has created accounts
      or setup access after compromise of the service via specially formed packets
      on the service API
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: Network Traffic Content
    detects: Observe unusual traffic to the SEPP and any evidence of unusual source
      or destinations from the SEPP that might indicate a source of specially formed
      packets.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT5029
  mitigations:
  - fgmid: FGM1050
    mitigates: Use of a Web Application Firewall may only allow properly formatted
      service communication.
    name: Exploit Protection
  - fgmid: FGM5010
    mitigates: Redeploy SEPP regularly to prevent dwell time aka use non-persistence
    name: Non-Persistent Services
  - fgmid: FGM1051
    mitigates: Aggressive patching may reduce window of vulnerability if a known vulnerability
    name: Update Software
  name: Exploit Semi-public Facing Application
  object-type: technique
  platforms: SEPP, UPF
  postconditions: []
  preconditions:
  - description: Adversary must have identified a vulnerability susceptible to the
      specially crafted message that results in an ability to use additional techniques.
    name: Vulnerability Identified
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> ["5G Security Assurance Specification (SCAS) for the Security
    Edge Protection Proxy (SEPP) network product class," TS 33.517 ver. 17.0.0, 3rd
    Generation Partnership Project (3GPP), Sec. 4.2.3.3-4.4, Jun. 2021](https://www.3gpp.org/DynaReport/33517.htm)
  - <a name="2"> \[2\] </a> [R. Pell, S. Moschoyiannis, E. Panaousis, R. Heartfield,
    "Towards dynamic threat modelling in 5G core networks based on MITRE ATT&CK",  October
    2021](https://arxiv.org/abs/2108.11206)
  - <a name="3"> \[3\] </a> ["Security Assurance Specification (SCAS) threats and
    critical assets in 3GPP network product classes," TR 33.926, 3GPP, Sec. 5.3.7.2.](https://www.3gpp.org/DynaReport/33926.htm)
  - <a name="4"> \[4\] </a> ["System architecture for the 5G System (5GS),"TS 23.501,
    3GPP, Sec. 4.2.8.2, 4.3.1, 4.3.2](https://www.3gpp.org/DynaReport/23501.htm)
  software: []
  status: Theoretical
  tactics:
  - TA0001
  - TA0009
  typecode: fight_technique
- access-required: None
  architecture-segment: User Plane
  bluf: An adversary may discover a valid GTP-U TEID in order to apply additional
    techniques.
  campaigns: []
  criticalassets:
  - description: UE's temporary identifiers such as its private IP address and GTP-U
      tunnel id (TEID) are revealed to adversary.
    name: UE temporary identifiers
  description: "An adversary may discover a valid GTP-U TEID in order to apply additional\
    \ techniques.\r\n\r\nThe GPRS Tunneling Protocol - User plane (GTP-U) is a protocol\
    \ that is used in both 4G and 5G. It tunnels user data packets between the radio\
    \ network (gNB/eNB) and the User Plane Function (UPF) in 5G, Serving Gateway (SGW-U)\
    \ in 4G. In 4G, there is another GTP-U tunnel between SGW-U and Packet Data Network\
    \ (PDN) Gateway (PGW-U). The GTP-U protocol header has a Tunnel Endpoint ID (TEID).\
    \ Each UE is assigned a unique TEID for the GTP-U tunnel and it is used to carry\
    \ data from multiple QoS flows. In order to apply additional techniques like hijacking\
    \ the tunnel, the adversary needs to discover a valid TEID.\r\n\r\nAdversary may\
    \ try to guess the TEID by sending a large number of encapsulated GTP-U packets\
    \ to the UPF/PGW-U from the internet with different TEIDs, until a valid one is\
    \ found. UPF/PGW-U forwards those packets to the UE through GTP-U tunnels. Following\
    \ GTP-U tunnels are used: In 5G, N3 GTP-U tunnel between UPF and gNB, in 4G, S1-U\
    \ GTP-U tunnel between SGW-U and eNB and S5 GTP-U tunnel between SGW-U and PGW-U.\
    \ When target IP address and TEID match, the adversary may receive a response\
    \ indicating success. Some core networks show affinity to certain ranges of TEIDs\
    \ under certain conditions, making brute forcing easier. Once TEID is known, further\
    \ behaviors can be used to slow down or crash the targeted UE."
  detections:
  - component: Network Traffic Content
    detects: Monitor incoming packets on N6 and SGi interfaces for any unauthorized
      data sessions.
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Core network packet captures (pcaps)
    detects: Inspect the payloads of all incoming packets to filter encapsulated GTP-U
      on internet facing interface of UPF and PGW-U.
    fgdsid: FGDS5016.001
    name: Packet capture for user plane packets
  groups: []
  id: FGT5031
  mitigations:
  - fgmid: FGM5507
    mitigates: Randomize TEID allocations.
    name: TEID Allocation
  - fgmid: FGM1041
    mitigates: 'Use IPSec in all internal user plane interfaces: between gNB and UPF,
      eNB and SGW-U, SGW-U and PGW-U. Use strong encryption algorithms to prevent
      eavesdropping on subscriber payload data and their private IP addresses.'
    name: Encrypt Sensitive Information
  - fgmid: FGM1031
    mitigates: Use Network Intrusion Prevention to block traffic at network perimeter.
    name: Network Intrusion Prevention
  - fgmid: FGM1037
    mitigates: Filter encapsulated GTP-U packets received on N6 interface from the
      internet.
    name: Filter Network Traffic
  name: Discover Tunnel Endpoint ID (TEID)
  object-type: technique
  platforms: Core
  postconditions: []
  preconditions:
  - description: Retrieve the target UE's private IP address using open-source search
      engines e.g. shodan.
    name: Obtain victim UE's private IP address
  procedureexamples:
  - description: Adversary sends large number of encapsulated GTP-U packets with different
      TEIDs to a particular UE whose IP address is known to the adversary. Encapsulated
      GTP-U packets are sent from the internet to UPF/PGW-U and UPF/PGW-U forwards
      those packets to the UE via gNB/eNB. If response is received for a GTP-U packet,
      UE's TEID will be known to the adversary. [1]Adversary may use further behaviors
      such as GTP-U tunnel hijack and DoS to the target UE.In 5G, the TEID of N3 GTP-U
      tunnel needs to be discovered by the adversary. In 4G, the adversary needs to
      discover the TEIDs of S1-U GTP-U tunnel and S5 GTP-U tunnel.
    name: Send large number of GTP-U packets via UPF/PGW-U/SGW-U to the target UE
  references:
  - '<a name="1"> \[1\] </a> [TrendMicro whitepaper: "A Deep Dive into the Packet
    Reflection Vulnerability Allowing Attackers to Plague Private 5G Networks - Security
    News."](https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/plague-private-5g-networks)'
  software: []
  status: Proof Of Concept
  tactics:
  - TA0007
  typecode: fight_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: RAN, O-RAN
  bluf: An adversary may compromise a component of gNodeB to affect radio network
    configuration.
  campaigns: []
  criticalassets:
  - description: Configuration and data related to gNodeB.
    name: RAN Service Management and Orchestration
  - description: RIC and configuration and data related to gNodeB.
    name: O-RAN RIC
  - description: xApp and configuration and data related to gNodeB, Realtime optimization
      data.
    name: xApps
  - description: rApp and configuration and data related to gNodeB, non-Realtime optimization
      data.
    name: rApps
  description: "An adversary may compromise a component of gNodeB to affect radio\
    \ network configuration.\r\n\r\nThe 3GPP standards assume that RAN functions are\
    \ securely deployed, properly implemented, and do not contain components with\
    \ malicious intent. If that assumption fails, malicious activity can take place.\r\
    \n\r\n \r\n\r\nThe gNB is the termination point for encryption and integrity protection\
    \ for communications over radio interface. If user plane or signaling plane traffic\
    \ is sent in clear, it can potentially be exposed to an adversary controlling\
    \ the gNodeB. \r\n\r\nO-RAN Architecture puts network intelligence and management\
    \ capability in Service Management and Orchestration (SMO) framework, with Near-Real-Time\
    \ Radio Intelligent Controller (Near-RT RIC) and Non-Real-Time RIC (Non-RT RIC)\
    \ that can change the network behavior. It further allows xApps and rApps with\
    \ standard interfaces to agents (if configured) outside the controlled network\
    \ that can also read data and send configuration changes. A compromise of any\
    \ of these components can potentially cause unintended changes to the network\
    \ and expose user information.\r\n\r\nUnauthorized access to and manipulation\
    \ of the gNB component can be carried out by a supply chain behavior or as a result\
    \ of malicious updates using operator's management and deployment tools. Adversaries\
    \ may also gain access by physically connecting to the device through an unsecured\
    \ USB, serial, or COM port on the base station (or device hosting virtual CU/DU/RU/RIC),\
    \ or by remotely logging in using SSH or Telnet if strong access control is not\
    \ implemented.\r\n\r\nIn distributed deployment architectures, APIs present additional\
    \ threat vectors that can be exploited by adversaries. In shared RAN scenarios,\
    \ the use of service configuration and management tools by multiple parties may\
    \ increase the risk vectors.\r\n\r\n3GPP does not dictate deployment models, so\
    \ it is possible that improper security hardening and separation of networks between\
    \ RAN VNF and Core VNF in the same Cloud or MEC may further allow lateral movements\
    \ of adversary if a gNodeB component is compromised."
  detections: []
  groups: []
  id: FGT5032
  mitigations: []
  name: gNodeB Component Manipulation
  object-type: technique
  platforms: 5G RAN
  postconditions: []
  preconditions: []
  procedureexamples: []
  references: []
  software: []
  status: Theoretical
  tactics:
  - TA0002
  typecode: fight_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: RAN, O-RAN
  bluf: An adversary may compromise a RAN Intelligent Controller (RIC) to affect radio
    network configuration.
  campaigns: []
  criticalassets:
  - description: SMO, configuration and data related to gNodeB.
    name: SMO
  - description: Near-RT RIC and non-RT RIC, configuration and data related to gNodeB.
    name: O-RAN RIC
  description: "\r\n\r\nAn adversary may compromise a RAN Intelligent Controller (RIC)\
    \ to affect radio network configuration.\r\n\r\nO-RAN architecture includes the\
    \ RAN Intelligence Controllers (RICs), which consists of the Non-Real-Time RAN\
    \ Intelligent Controller (Non-RT RIC) and the Near-Real-Time RAN Intelligent Controller\
    \ (Near-RT RIC), to optimize radio resource management of gNB components. The\
    \ Non-RT RIC is embedded in the Service and Management Orchestration (SMO) function\
    \ framework and hosts rApps to provide policy-based guidance, machine learning\
    \ model management and enrichment information to the Near-RT RIC function for\
    \ the purpose of RAN optimization. The Near-RT RIC is a logical function that\
    \ hosts xApps and enables near real-time control and optimization of the functions\
    \ and resources of gNB components O-CU-CP, O-CU-UP and O-DU, steered via the policies\
    \ and enrichment data provided from the Non-RT RIC.\r\n\r\nO-RAN RIC functions\
    \ integrate and interact with xApps and rApps, which can bring information and\
    \ instructions to the RIC from outside of the O-RAN architecture. A compromise\
    \ of the RIC components (by any means) can potentially lead to unauthorized changes\
    \ in O-CU or O-DU via E2 Interface."
  detections: []
  groups: []
  id: FGT5032.001
  mitigations: []
  name: RAN Intelligent Controller (RIC)
  object-type: technique
  platforms: RIC
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [Near-RT RIC Architecture: O-RAN.WG3.RICARCH-R004-v07.00](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="2"> \[2\] </a> [Non-RT RIC Architecture: O-RAN.WG2.Non-RT-RIC-ARCH-R004-v06.00](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [Non-RT RIC Functional Architecture: O-RAN.WG2.Non-RT-RIC-ARCH-TR-v01.01](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="4"> \[4\] </a> [Threat Modeling: O-RAN.WG11.Threat-Model.O-R004-v05.00](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="5"> \[5\] </a> [Federal Office of information Security: "Study - Open
    RAN Risk Analysis".](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/5G/5GRAN-Risk-Analysis.pdf?__blob=publicationFile&v=5)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5032
  tactics:
  - TA0002
  typecode: fight_subtechnique
- access-required: Privileged Access
  architecture-segment: RAN, O-RAN
  bluf: An adversary may compromise an xApp to affect the radio network configuration.
  campaigns: []
  criticalassets:
  - description: UE data includes UE's coarse location, temporary identifier and correlation
      of UE temporary identifier to other service-related data e.g., DNN, NSSAI etc.
      See clause 6.2.1 of [2].
    name: UE identifier and location data
  - description: Sensitive network data such as QoS policies of a slice.
    name: MNO network data
  - description: RAN configuration data such as configuration regarding radio resource
      management (RRM), QoS, and spectrum allocation.
    name: RAN configuration data
  - description: Unauthorized access to O-CU-CP & O-CU-UP data via E2 interface.
    name: O-CU-CP & O-CU-UP
  - description: Unauthorized access to O-DU data via E2 interface.
    name: O-DU
  description: "\r\n\r\nAn adversary may compromise an xApp to affect the radio network\
    \ configuration.\r\n\r\nThe O-RAN architecture includes the RAN Intelligence Controllers\
    \ (RIC), which consists of the Non-Real-Time RAN Intelligent Controller (Non-RT\
    \ RIC) and the Near-Real-Time RAN Intelligent Controller (Near-RT RIC), to optimize\
    \ radio resource management of gNB components. The Non-RT RIC is embedded in the\
    \ Service Management and Orchestration (SMO) framework and hosts rApps to provide\
    \ policy-based guidance, machine learning model management and enrichment information\
    \ to the Near-RT RIC function for the purpose of RAN optimization. \r\n\r\nThe\
    \ Near-RT RIC is a logical function that hosts xApps and enables near-real-time\
    \ control and optimization of the functions and resources of gNB components [O-RAN\
    \ Centralized Unit-Control Plane (O-CU-CP), O-RAN Centralized Unit-User Plane\
    \ (O-CU-UP) and O-RAN Distributed Unit (O-DU)], steered via the policies and enrichment\
    \ data provided from the Non-RT RIC. \r\n\r\nThe O-RAN platform can perform both\
    \ non-real-time optimization and near-real-time optimization of O-RAN elements\
    \ through the Non-RT RIC and Near-RT RIC. Non-real-time optimization may be used\
    \ for higher-level optimization and is facilitated by the Non-RT RIC. Use cases\
    \ such as policy-based guidance and AI/ML are examples of those appropriate for\
    \ non real-time-optimization. Near-real-time optimization enables certain capabilities\
    \ and is facilitated by the Near-RT RIC. Use cases such as radio resource management\
    \ and Quality of Service (QoS) optimization are examples of those appropriate\
    \ for near-real-time optimization. \r\n\r\nxApps are applications designed to\
    \ run on the Near-RT RIC to provide the desired RAN functionality. xApps are independent\
    \ of the Near-RT RIC and may be provided by any third party. \r\n\r\nxApps on\
    \ the Near-RT RIC can collect near-real-time information from gNB components (O-CU-CP,\
    \ O-CU-UP and O-DU) and influence behavior of those components, thereby impacting\
    \ 5G base station performance and delivery of services to a group of UEs or a\
    \ single UE.\r\n\r\nxApps may be compromised during the delivery to the service\
    \ provider, either through the external supply chain from vendor to service provider\
    \ or through the internal CI/CD pipeline. Malicious code may be inserted in the\
    \ xApp application package that could compromise the application. Adversary may\
    \ also obtain xApp credentials or compromise a 3rd party infrastructure the application\
    \ is hosted on.\r\n\r\nA compromise of an xApp (or through xApp Agent) can potentially\
    \ lead to unauthorized changes in O-CU-CP or O-CU-UP or O-DU via E2 Interface."
  detections:
  - component: File Modification
    detects: Monitor and alert on changes to xApp and cloud configuration files during
      runtime.
    fgdsid: FGDS0022.005
    name: File
  - component: Application Log Content
    detects: Monitor xApp lifecycle management events from logs regarding onboarding,
      authentication/authorization of xApps to Near-RT RIC. Audit logs and telemetry
      data for unauthorized activity.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Image hash
    detects: Verify xApp image hash.
    fgdsid: FGDS0007.005
    name: Image
  - component: Cloud Service Modification
    detects: Perform real-time audits and post-processing of logs. Detect which parts
      of the O-RAN are accessed by xApps.
    fgdsid: FGDS0025.004
    name: Cloud Service
  groups: []
  id: FGT5032.002
  mitigations:
  - fgmid: FGM1045
    mitigates: Verify digital signature of all xApps.
    name: Code Signing
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1035
    mitigates: Limit access to xApp instances over the network.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1043
    mitigates: Use capabilities to prevent successful credential access by adversaries.
    name: Credential Access Protection
  - fgmid: FGM1025
    mitigates: Enforce least privilege access for all cloud components.
    name: Privileged Process Integrity
  name: xApp
  object-type: technique
  platforms: Near real-time RIC
  postconditions:
  - description: Adversary affects the radio network configuration and performs other
      unauthorized activities.
    name: Affected Network Radio Configuration
  - description: Adversary degrades network operations or in the worst case, causes
      network outage.
    name: Network operations impacted
  - description: UE and subscriber's sensitive data is revealed to the adversary.
    name: Sensitive UE data exposed to adversary
  preconditions:
  - description: Adversary has access to xApp (e.g., application package, credentials).
    name: Adversary access to xApp
  - description: Adversary has access to xApp software supply chain. See [FGT1195.002](/techniques/FGT1195.002)
      for details.
    name: Adversary has access to software supply chain
  procedureexamples:
  - description: Adversary compromises external supply chain or internal CI/CD pipeline
      to implement backdoor into xApp.
    name: xApp access via backdoor
  - description: Adversary obtains xApp credentials through various means and compromises
      the xApp.
    name: xApp access via stolen credentials
  - description: Adversary may compromise the infrastructure the O-RAN platform is
      deployed on and gain access to xApp.
    name: xApp access via compromised 3rd party hosting infrastructure provider
  references:
  - '<a name="1"> \[1\] </a> [O-RAN WG11: "O-RAN Security Threat Modeling and Risk
    Assessment", O-R004-v05.00.](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="2"> \[2\] </a> [O-RAN WG3: "Near-RT RIC Architecture", R004-v07.00.](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [Federal Office of information Security: "Study - Open
    RAN Risk Analysis".](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/5G/5GRAN-Risk-Analysis.pdf?__blob=publicationFile&v=5)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5032
  tactics:
  - TA0002
  typecode: fight_subtechnique
- access-required: Privileged Access
  architecture-segment: O-RAN, RAN
  bluf: An adversary may compromise an rApp to affect the radio network configuration.
  campaigns: []
  criticalassets:
  - description: UE data includes UE's coarse location, temporary identifier and correlation
      of UE temporary identifier to other service-related data e.g., DNN, NSSAI etc.
      See clause 6.2.1 of [2].
    name: UE data
  - description: Sensitive network data such as QoS policies of a slice.
    name: MNO network data
  - description: Configuration data such as configuration regarding radio resource
      management (RRM), QoS, and spectrum allocation.
    name: RAN configuration data
  description: "\r\n\r\nAn adversary may compromise an rApp to affect the radio network\
    \ configuration.\r\n\r\nO-RAN architecture includes the RAN Intelligence Controllers\
    \ (RICs), which consists of the Non-Real-Time RAN Intelligent Controller (Non-RT\
    \ RIC) and the Near-Real-Time RAN Intelligent Controller (Near-RT RIC), to optimize\
    \ radio resource management of gNB components. The Non-RT RIC is embedded in the\
    \ Service Management and Orchestration (SMO) framework and hosts rApps to provide\
    \ policy-based guidance, machine learning model management and enrichment information\
    \ to the Near-RT RIC function for the purpose of RAN optimization. \r\n\r\nrApps\
    \ are applications that use the functionalities in the Non-RT RIC Framework to\
    \ provide value-added services related to RAN operation and optimization.\_rApps\
    \ are deployed on the Non-RT RIC. rApps can provide better efficiency and optimization\
    \ of the RAN and can access or produce various services and data, enabling achievements\
    \ of use case objectives.\r\n\r\nrApps may be compromised during the delivery\
    \ to the service provider, either through the external supply chain from vendor\
    \ to the service provider or through the internal CI/CD pipeline. Malicious code\
    \ may be inserted in the rApp application package that could compromise the application.\
    \ Adversary may also obtain rApp credentials or compromise a 3rd party infrastructure\
    \ the application is hosted on.\r\n\r\nA compromise of an rApp (or through rApp\
    \ Agent) can potentially lead to unauthorized changes in O-CU or O-DU via A1 interface."
  detections:
  - component: File Modification
    detects: Monitor and alert on changes to rApp and cloud configuration files during
      runtime.
    fgdsid: FGDS0022.005
    name: File
  - component: Application Log Content
    detects: Monitor rApp lifecycle management events in non-RT RIC logs regarding
      onboarding, authentication/authorization of rApps. Audit logs and telemetry
      data for unauthorized activity.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Image hash
    detects: Verify rApp image hash.
    fgdsid: FGDS0007.005
    name: Image
  - component: Cloud Service Modification
    detects: Perform real-time audits and post-processing of O-RAN NF logs to detect
      which parts of the O-RAN are accessed by rApps e.g. xApps, SMO services etc.
    fgdsid: FGDS0025.004
    name: Cloud Service
  groups: []
  id: FGT5032.003
  mitigations:
  - fgmid: FGM1045
    mitigates: Verify digital signature of rApp.
    name: Code Signing
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1035
    mitigates: Limit remote access to rApp instance.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1043
    mitigates: Use capabilities to prevent successful rApp credential access by adversaries.
    name: Credential Access Protection
  - fgmid: FGM1025
    mitigates: Enforce least privilege access for cloud components.
    name: Privileged Process Integrity
  name: rApp
  object-type: technique
  platforms: Non-real-time RIC
  postconditions:
  - description: Adversary affects the radio network configuration, accesses configuration
      data, and performs other unauthorized activities.
    name: Affected Network Radio Configuration
  - description: Adversary degrades network operation or in the worst case, causes
      network outage.
    name: Network operations impacted
  - description: UE and subscriber's sensitive data are revealed to adversary.
    name: Sensitive UE data exposed to adversary
  preconditions:
  - description: Adversary has access to rApp (e.g., application package, credential).
    name: Adversary access to rApp
  procedureexamples:
  - description: Adversary compromising external supply chain or internal CI/CD pipeline
      to implement backdoor into rApp.
    name: rApp access via backdoor
  - description: Adversary obtains rApp credentials through various means and compromises
      the rApp.
    name: rApp access via stolen credentials
  - description: Adversary may compromise the infrastructure the O-RAN platform is
      deployed on and gain access to rApp.
    name: rApp access via compromised 3rd party hosting infrastructure provider
  references:
  - '<a name="1"> \[1\] </a> [WG11: "Threat Modeling", O-R004-v05.00.](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="2"> \[2\] </a> [WG2: "Non-RT RIC Architecture", R004-v06.00.](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [WG2: "Non-RT RIC Functional Architecture" TR-v01.01.](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="4"> \[4\] </a> [Federal Office of information Security: "Study - Open
    RAN Risk Analysis".](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Studies/5G/5GRAN-Risk-Analysis.pdf?__blob=publicationFile&v=5)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5032
  tactics:
  - TA0002
  typecode: fight_subtechnique
- access-required: Token/login Credentials
  architecture-segment: O-RAN, RAN
  bluf: Malicious xApps may gain unauthorized access to near-RT RIC and E2 nodes,
    in order to affect Radio Access Network (RAN) behavior.
  campaigns: []
  criticalassets:
  - description: Adversary may impact normal RAN functions by altering near-RT RIC
      behavior.
    name: Near-RT RIC
  - description: E2 node functions in O-CU-CP and O-CU-UP may be impacted.
    name: O-CU-CP, O-CU-UP
  - description: E2 node functions in O-DU may be impacted.
    name: O-DU
  - description: Adversary may disrupt RAN operations by changing UE's slice priority
      and QoS parameters which results in denying new connections or dropping existing
      connections.
    name: RAN configuration data
  - description: UE data includes UE's coarse location, temporary identifier and correlation
      of UE temporary identifier to other service related data e.g. DNN, NSSAI etc.
      See clause 6.2.1 of [2].
    name: UE data
  - description: Adversary may have read/write access to MNO database containing sensitive
      network data such as QoS policies and slice priority.
    name: MNO network data
  description: "Malicious xApps may gain unauthorized access to near-RT RIC and E2\
    \ nodes, in order to affect Radio Access Network (RAN) behavior.\r\n\r\nxApps\
    \ are application software that may be developed by third party vendors. They\
    \ reside in the Near Real Time (near-RT) RAN Intelligent Controller (RIC) after\
    \ onboarding is done by O-RAN orchestration system. Near-RT RICs control and optimize\
    \ RAN functions for events ranging from 10 ms to 1 sec. xApps manage Radio Resource\
    \ Management (RRM) functions of RAN via E2 interface. The following components\
    \ are controlled by xApps by using APIs: E2 nodes such as O-DU, O-CU-CP and O-CU-UP.\
    \ Near-RT RIC and xApps are managed by non-RT RIC via A1 interface for RAN optimizations\
    \ and by SMO via O1 interface for lifecycle management.\r\n\r\nDuring onboarding\
    \ of xApps, malware may be installed by the adversary in xApps which can gain\
    \ unauthorized access to near-RT RIC by exploiting weak or misconfigured authentication\
    \ mechanism in near-RT RIC. A malicious xApp image may be crafted by the adversary\
    \ and then installed in near-RT RIC during onboarding. A legitimate xApp may be\
    \ cloned in near-RT RIC by an insider adversary.\r\n\r\nOnce installed in near-RT\
    \ RIC, the rogue xApp may indirectly access E2 nodes via APIs by penetrating traffic\
    \ separating firewalls within O-RAN. The rogue xApp may change behavior of near-RT\
    \ RIC which will impact RAN functions such as coverage, network slicing, QoS etc.\r\
    \n\r\n "
  detections:
  - component: 5G network host software and configurations
    detects: Monitor all xApps onboarding processes. Use host scanning tools to detect
      malware insertions.
    fgdsid: FGDS5029.001
    name: Host system software and configurations
  - component: Cloud Service Modification
    detects: Monitor logs for authentication/authorization of xApps to near-RT RIC
      and E2 nodes, logs for each transaction done by xApps to E2 nodes. Audit logs
      and telemetry data for unauthorized activities.
    fgdsid: FGDS0025.004
    name: Cloud Service
  - component: Cloud Storage Access
    detects: Perform real-time audits and post-processing of logs.Detect which parts
      of the RAN is accessed by each xApp e.g. O-DU, O-CU-CP, O-CU-UP etc.
    fgdsid: FGDS0010.001
    name: Cloud Storage
  - component: Web Credential Usage
    detects: Monitor access token usage by xApps.
    fgdsid: FGDS0006.002
    name: Web Credential
  - component: Certificate Registration
    detects: Verify and refresh frequently digital signatures used for authenticating
      xApps by near-RT RIC and E2 nodes.
    fgdsid: FGDS0037.001
    name: Certificate
  - component: Image hash
    detects: Verify xApp image hash.
    fgdsid: FGDS0007.005
    name: Image
  groups: []
  id: FGT5034
  mitigations:
  - fgmid: FGM5091
    mitigates: Use strong authentication and authorization for 3rd party xApps during
      onboarding and use strong mutual authentication between xApps and near-RT RIC
      and between xApps and E2 nodes. Clauses 6.2.2 and 6.2.8 of [2].
    name: Mutual Authentication
  - fgmid: FGM1043
    mitigates: Credential Access Protection - Use capabilities to prevent successful
      credential access by adversaries; including blocking forms of credential dumping.
    name: Credential Access Protection
  - fgmid: FGM1030
    mitigates: Use network segmentation and restrict software paths for some network
      components using standard protocols such as SSL, REST/HTTPS etc.
    name: Network Segmentation
  - fgmid: FGM5516
    mitigates: Make the tokens short lived to prevent replay of token behaviors (AiTM).
      The lifetime of xApp can be controlled by deleting the MOI for the xApp as soon
      as the services for xApp have been rendered. It can be done by the SMO by sending
      "DeleteMOIRequest" message to the near-RT RIC over O1 interface. Clause 9.4.6
      of [2].Alternately, OAuth2.0 Authorization server can be configured to grant
      reasonably short expiration timer when new tokens are issued to OAuth2.0 clients
      (e.g. xApp). Clause 4.7.2 of [4].
    name: Session Lifetime
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1045
    mitigates: Verify digital signature of all xApps.
    name: Code Signing
  - fgmid: FGM1047
    mitigates: Scan all software in the near-RT RIC for detecting and deleting unauthorized
      xApps.
    name: Audit
  name: Radio Control Manipulation Via Rogue xApps
  object-type: technique
  platforms: Near-RT RIC
  postconditions:
  - description: Adversary degrades network operation or in the worst case causes
      temporary network outage.
    name: Network operations impacted
  - description: Operator's network configurations and policies are known to the adversary.
    name: Sensitive network data exposed to adversary
  - description: UE and subscriber's sensitive data is revealed to the adversary.
    name: Sensitive UE data exposed to adversary
  preconditions:
  - description: Adversary installs rogue xApp in near-RT RIC via malware during onboarding
      and it finds out weak authentication mechanism in near-RT RIC to gain entry
      in the O-RAN systems.A legitimate xApp may be cloned by adversary to launch
      further behaviors.
    name: Adversary has access to near-RT RIC during onboarding or via insider behavior
  procedureexamples:
  - description: Adversary may exploit weakly configured authentication mechanism
      in near-RT RIC and E2 nodes for the xApps and may gain unauthorized access to
      near-RT RIC and thus affect E2 nodes.Adversary may access E2 nodes such as O-DU,
      O-CU-CP and O-CU-UP via E2 interface by using E2 related APIs. Clause 5.4.1.4
      of [1], clause 6A.2.3 of [2] and [3].
    name: Malicious xApp gets access to near-RT RIC and E2 nodes
  - description: Rogue xApp may change behavior of near-RT RIC by intercepting or
      modifying A1 messages to/from non-RT RIC or O1 messages to/from SMO. Some examples
      of behaviors are:DoS on network and UEs by changing slice priority and QoS parameters,
      steal network and UE information and track UE's location.
    name: Rogue xApp changes behavior of O-RAN system
  - description: When a new xApp is deployed, it is authenticated by near-RT RIC.
      If authentication is successful, near-RT RIC provides an ID to the xApp and
      it creates a Managed Object Instance (MOI) for the xApp. MOI is used by SMO
      to manage xApps. AiTM behavior may be launched by adversary by monitoring and
      replaying a stolen token or MOI of a legitimate xApp. This may change behavior
      of near-RT RIC and impact RAN functions such as coverage, network slicing and
      QoS. Clause 9.4.1 of [2].
    name: xApps stolen token/MOI
  references:
  - '<a name="1"> \[1\] </a> [O-RAN WG11 O-R004-v05.00: "O-RAN Security Threat Modeling
    and Risk Assessment".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="2"> \[2\] </a> [O-RAN WG3 R004-v07.00: "Near-RT RIC Architecture".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [Ericsson white paper: "Security considerations of Open
    RAN".](https://www.ericsson.com/en/security/security-considerations-of-open-ran)'
  - '<a name="4"> \[4\] </a> [O-RAN WG11 R004-v11.0: Security Protocols Specifications.](https://orandownloadsweb.azurewebsites.net/specifications)'
  software: []
  status: Theoretical
  tactics:
  - TA0001
  - TA0008
  - TA0040
  typecode: fight_technique
- architecture-segment: O-RAN, RAN
  bluf: Rogue xApps may bypass authentication and authorization by using unsecured
    APIs to cause degradation in the RAN.
  campaigns: []
  criticalassets:
  - description: Adversary may impact normal RAN operations.
    name: 'Near-RT RIC function: RAN optimization'
  - description: Adversary may disrupt RAN operations by changing UE's slice priority
      and QoS parameters which results in denying new connections or dropping existing
      connections.
    name: RAN configuration data
  - description: UE's coarse location, temporary identifier and correlation of UE
      temporary identifier to other service related data e.g. DNN, NSSAI etc.
    name: UE location and identifiers
  - description: Adversary has read/write access to database containing sensitive
      network data such as QoS policies and slice priority.
    name: Sensitive network data
  - description: Unauthorized API use by rogue xApp may impact O-CU-CP and O-CU-UP
      operations.
    name: O-CU-CP and O-CU-UP
  - description: Unauthorized API use by rogue xApp may impact O-DU operations.
    name: O-DU
  description: "Rogue xApps may bypass authentication and authorization by using unsecured\
    \ APIs to cause degradation in the RAN.\r\n\r\nAll xApps need to be authenticated\
    \ and authorized by the xApps subscription manager aka E2Mgr in near-RT RIC to\
    \ get access to E2 nodes (O-DU, O-CU-CP & O-CU-UP). Operator policies control\
    \ the subset of E2 nodes that each xApp can access. Once authenticated and authorized\
    \ by E2Mgr, an xApp can access the E2 nodes that are allowed by operator policy\
    \ via E2 Termination (E2Term) module. Refer requirement [REQ-API-Generic-009]\
    \ in clause 5.1.3 of [2] for operator policy control of xApp access to E2 nodes.\r\
    \n\r\nIf proper authentication and authorization are not done by E2Mgr, an insecure\
    \ API may be called by a rogue xApp. The API may shut down all active E2 services\
    \ in near-RT RIC which will cause temporary degradation in the RAN."
  detections:
  - component: Host Status
    detects: Monitor and audit onboarding and subscriptions of all xApps, e.g. through
      configuration logs.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: Execution
    detects: Monitor script executions to detect if any apps are going beyond its
      permitted functions. For example, if an xApp is supposed to subscribe to analytics
      service, it is also processing RAN optimization and control data.
    fgdsid: FGDS0012.001
    name: Script
  - component: Command Execution
    detects: Monitor command executions to detect if any xApps are going beyond its
      permitted functions. For example, if an xApp is supposed to subscribe to analytics
      service, it is also processing RAN optimization and control data.
    fgdsid: FGDS0017.001
    name: Command
  - component: Application Log Content
    detects: Monitor application logs in near-RT RIC for all API accesses by xApps.Monitor
      xApps logs in near-RT RIC for authentication and authorization bypass attempts.
      Clause 5.2 of [3].
    fgdsid: FGDS0015.001
    name: Application Log
  - component: 5G network host software and configurations
    detects: Scan all software in near real-time RIC to identify unauthorized xApps.
      Validate Sun Certified Network Administrator (SCNA) results with approved xApp
      versions and signatures in xApp repository.
    fgdsid: FGDS5029.001
    name: Host system software and configurations
  groups: []
  id: FGT5034.001
  mitigations:
  - fgmid: FGM5091
    mitigates: Use strong mutual authentication and authorization by E2Mgr for all
      API accesses from 3rd party xApps to near-RT RIC. Clauses 6.2.2 and 6.2.8 of
      [2].
    name: Mutual Authentication
  - fgmid: FGM1033
    mitigates: Use only trusted supply chain, rigorous scanning of software images.
      Limit Software Installations especially from 3rd party sources.
    name: Limit Software Installation
  - fgmid: FGM1047
    mitigates: Scan all software in the near-RT RIC for detecting and deleting unauthorized
      xApps.
    name: Audit
  name: O-RAN E2Mgr Unauthorized Access
  object-type: technique
  platforms: Near real-time RIC
  postconditions:
  - description: Adversary degrades network operation.
    name: Network operations impacted
  - description: Operator's network policies are known to the adversary.
    name: Sensitive network data exposed to adversary
  - description: UE and subscriber's sensitive data is revealed to the adversary.
    name: Sensitive UE data exposed to adversary
  preconditions:
  - description: Adversary installs rogue xApp in near-RT RIC via malware during onboarding
      and it finds out weak authentication mechanism in near-RT RIC to gain entry
      in the O-RAN systems.A legitimate xApp may be cloned by adversary for further
      actions.
    name: Adversary has access to near-RT RIC during onboarding or via insider behavior
  procedureexamples:
  - description: An adversary controlled xApp may call a near-RT RIC API which is
      not verified normally for authentication and authorization by E2Mgr. For example,
      they may use a maintenance or diagnostics API which is not widely known or documented.
      If that API is used for malicious purposes, E2Mgr may process the API and the
      adversary may be able to shutdown all E2 services. This may result in degraded
      services in the RAN as RAN optimization updates to E2 nodes and analytics services
      in the near-RT RIC will stop. [1]
    name: Malicious xApp uses unchecked API to E2Mgr
  references:
  - '<a name="1"> \[1\] </a> [TrendMicro whitepaper: "Open RAN: Attack of the xApps".](https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/open-ran-attack-of-the-xapps)'
  - '<a name="2"> \[2\] </a> [O-RAN Alliance WG3 R004-v07.00: "Near-RT RIC Architecture".](https://orandownloadsweb.azurewebsites.net/specifications)'
  - '<a name="3"> \[3\] </a> [O-RAN Alliance WG11 TR.0-R003-v04.00: "Study on Security
    Log Management".](https://orandownloadsweb.azurewebsites.net/specifications)'
  software: []
  status: Proof Of Concept
  subtechnique-of: FGT5034
  tactics:
  - TA0040
  - TA0001
  - TA0008
  typecode: fight_subtechnique
- architecture-segment: RAN, O-RAN
  bluf: An adversary transmits radio signals to degrade reception of transmissions
    to the UE or gNB.
  campaigns: []
  criticalassets:
  - description: gNB air interface may be impacted.
    name: gNB
  - description: O-RU air interface may be jammed.
    name: O-RU
  - description: UE air interface may be impacted.
    name: UE
  description: "An adversary transmits radio signals to degrade reception of transmissions\
    \ to the UE or gNB.\r\n\r\nConsists of numerous methods, including noise jamming,\
    \ generating false synchronization signals, and replaying modified portions of\
    \ legitimate signals to degrade demodulation. Jamming in 5G (NR) is different\
    \ from 3G and similar to 4G, but at high level the same principles are applied.\
    \ This technique is similar to the ATT&CK for Mobile technique T1464."
  detections:
  - component: System Notifications
    detects: UE's User Interface System Notifications may indicate sudden loss of
      connection.
    fgdsid: FGDS0042.002
    name: User Interface
  - component: Host Status
    detects: Monitor gNB/O-RU logs for degraded performance of air interface.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: gNB log for replayed messages
    detects: Monitor gNB log for reception of replayed messages sent to gNB in the
      uplink direction. gNB can keep a history of signaling messages on radio interface.
    fgdsid: FGDS5017.008
    name: gNB or 5G core logs
  groups: []
  id: FGT5035
  mitigations:
  - fgmid: FGM5099
    mitigates: Move user equipment closer to base station to overpower jamming signal.
    name: Move UE Close To gNB
  - fgmid: FGM5100
    mitigates: Increase height of User Equipment to avoid jamming signal.
    name: Raise Height Of UE
  - fgmid: FGM5001
    mitigates: Disable jamming source.
    name: Disable Malicious Transmitter
  name: Radio Reception Degradation
  object-type: technique
  platforms: 5G RAN, O-RU
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: Jammer device is used to perform noise jamming of the radio interface,
      See [1]. This may include jamming only portions of the synchronization or other
      signals.
    name: Noise jamming via jammer device
  - description: Rogue UE sends fake uplink reference signals to the gNB:Sounding
      Reference Signal (SRS)Phase Tracking Reference Signal (PTRS)Demodulation Reference
      Signal (DMRS)
    name: False synchronization signals
  - description: False base station replays modified portions of legitimate signals
      from gNB or towards gNB (selective over-writing of signals)
    name: Replay legitimate or modified signals or portions thereof
  references:
  - '<a name="1"> \[1\] </a> [Y. Arjoune and S. Faruque, "Smart Jamming Attacks in
    5G New Radio: A Review" (2020), 10th Annual Computing and Communication Workshop
    and Conference (CCWC)](https://ieeexplore.ieee.org/abstract/document/9031175/)'
  - '<a name="2"> \[2\] </a> [European Union Agency for Cybersecurity (ENISA): "ENISA
    Threat Landscape for 5G Networks" Report, December 2020.](https://www.enisa.europa.eu/publications/enisa-threat-landscape-report-for-5g-networks)'
  - '<a name="3"> \[3\] </a> [Lichtman, et al. "5G NR Jamming, Spoofing, and Sniffing:
    Threat Assessment and Mitigation" (2018), 2018 IEEE International Conference on
    Communications Workshops](https://arxiv.org/pdf/1803.03845.pdf)'
  software: []
  status: Observed
  tactics:
  - TA0040
  typecode: fight_technique
- architecture-segment: RAN, Virtualization, O-RAN
  bluf: Adversary may use AI/ML training data and prediction poisoning techniques
    to manipulate the outcomes of a machine learning model for malicious purposes,
    to disrupt service or change the behavior of network elements.
  campaigns: []
  criticalassets:
  - description: Configuration and session data for RAN as well as ML applications.
    name: AI Training Data
  - description: ML models and algorithms itself can be a lucrative asset to acquire
      in addition to understanding the behavior of the models for an adversary.
    name: Algorithm, AI models
  description: "Adversary may use AI/ML training data and prediction poisoning techniques\
    \ to manipulate the outcomes of a machine learning model for malicious purposes,\
    \ to disrupt service or change the behavior of network elements.\r\n\r\nIn the\
    \ context of AI/ML security threats, adversaries can employ various techniques\
    \ to compromise machine learning models at different stages. During training,\
    \ they can engage in data poisoning by injecting manipulated data (Data Injection),\
    \ mislabeling data points (Label Poisoning), or maliciously augmenting data with\
    \ adversarial samples (Data Augmentation Poisoning). Adversaries can also manipulate\
    \ the model itself during training, introducing hidden backdoor patterns (Backdoor\
    \ Attacks) or deducing sensitive information by observing model outputs (Model\
    \ Inversion Attacks). In the inference phase, they can create adversarial examples\
    \ to trick the model (Adversarial Examples) or subtly change data distributions\
    \ over time to cause incorrect predictions (Concept Drift). Additionally, adversaries\
    \ can engage in data pollution by manipulating live input data (Data Poisoning\
    \ in Live Systems) or compromise model integrity by stealing and manipulating\
    \ training data (Data Theft). Lastly, they can attempt to determine training data\
    \ membership via Membership Inference Attacks by querying the model with tailored\
    \ inputs. \r\n\r\nThe ORAN implementation outlines the inclusion of a RAN Intelligent\
    \ Controller (RIC) and its associated xApps/rApps within the RAN system, which\
    \ are designed for machine learning and optimization purposes. Machine learning\
    \ models might also be present within the Service Management and Orchestration\
    \ (SMO) framework to enhance network design, deployment, and operation. However,\
    \ any malicious alterations made to these ML models, or their associated data\
    \ could lead to unintended consequences, such as disruptions in the desired operational\
    \ state of network components, traffic management issues, and potentially even\
    \ network outages."
  detections:
  - component: Logon Session Creation
    detects: The successful establishment of a new user session following a successful
      authentication attempt. This typically signifies that a user has provided valid
      credentials or authentication tokens, and the system has initiated a session
      associated with that user account. This data is crucial for tracking authentication
      events and identifying potential unauthorized access.
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: Logon Session Metadata
    detects: Contextual data about a logon session, such as username, logon type,
      access tokens (security context, user SIDs, logon identifiers, and logon SID),
      and any activity associated within it.
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Application logs can provide information about change, read, update,
      and delete(CRUD) activity.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5036
  mitigations:
  - fgmid: FGM1026
    mitigates: Strict access control to infrastructure and application supporting
      AI/ML operations
    name: Privileged Account Management
  - fgmid: FGM1047
    mitigates: Monitoring of access logs, sensor data and changes proposed by algorithms
      and Human experts
    name: Audit
  - fgmid: FGM1018
    mitigates: Manage the creation, modification, use, and permissions associated
      to user accounts.
    name: User Account Management
  - fgmid: FGM1041
    mitigates: Model and data should be encrypted in the system
    name: Encrypt Sensitive Information
  - fgmid: FGM1009
    mitigates: APIs in the system should use secure access and data transport using
      TLS 1.3 or latest.
    name: Encrypt Network Traffic
  name: AI/ML Training Data And Prediction Poisoning
  object-type: technique
  platforms: ORAN, OA&M
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - "<a name=\"1\"> \\[1\\] </a> [O-RAN Security Threat Modeling and Remediation Analysis\
    \ 6.0, \_\nO-RAN.WG11.Threat-Model.O-R003-v06.00, T-ML-02](https://orandownloadsweb.azurewebsites.net/specifications)"
  - '<a name="2"> \[2\] </a> [Adversarial Machine Learning: Well-known techniques](https://viso.ai/deep-learning/adversarial-machine-learning/)'
  - <a name="3"> \[3\] </a> [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML03_2023-Model_Inversion_Attack.html)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: Privileged Access
  architecture-segment: RAN, Virtualization
  bluf: Adversary may gain unauthorized access to machine learning model or database
    and alters the data to disrupt service or change the behavior of network elements.
  campaigns: []
  criticalassets:
  - description: Configuration and session data for RAN as well as ML applications.
    name: AI Training Data
  - description: ML models and algorithms itself can be a lucrative asset to acquire
      in addition to understanding the behavior of the models for an adversary.
    name: Algorithm, AI models
  description: "Adversary may gain unauthorized access to machine learning model or\
    \ database and alters the data to disrupt service or change the behavior of network\
    \ elements.\r\n\r\nCurrently ORAN implementation specifies RAN Intelligent Controller\
    \ (RIC) and associated xApps/rApps as part of the RAN system for machine learning\
    \ and optimization. Machine learning models may also exist in Service Management\
    \ and Orchestration (SMO) to optimize network design, deployment and operation.\
    \ A nefarious change on ML models or data can cause drastic change in behavior\
    \ of O-RAN components including network outage. Altering a machine learning model\
    \ (System manipulation and compromise of ML data confidentiality and privacy),\
    \ adversary can change O-RAN behavior."
  detections:
  - component: Logon Session Creation
    detects: Access and authorization logs can reveal abnormal logging activity that
      precedes action taken on the system
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: Logon Session Metadata
    detects: Contextual data about logons, provide insights for security purposes
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Application logs can provide information about change, read, update,
      and delete(CRUD) activity.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5037
  mitigations:
  - fgmid: FGM1026
    mitigates: Strict access control to infrastructure and application supporting
      AI/ML operations
    name: Privileged Account Management
  - fgmid: FGM1047
    mitigates: Monitoring of access logs, sensor data and changes proposed by algorithms
      and Human experts
    name: Audit
  - fgmid: FGM1018
    mitigates: Manage the creation, modification, use, and permissions associated
      to user accounts.
    name: User Account Management
  - fgmid: FGM1041
    mitigates: Model and data should be encrypted in the system
    name: Encrypt Sensitive Information
  - fgmid: FGM1009
    mitigates: APIs in the system should use secure access and data transport using
      TLS 1.3 or latest.
    name: Encrypt Network Traffic
  name: Alter ML Model
  object-type: technique
  platforms: ORAN, OA&M
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - "<a name=\"1\"> \\[1\\] </a> [O-RAN Security Threat Modeling and Remediation Analysis\
    \ 6.0\_\nO-RAN.WG11.Threat-Model.O-R003-v06.00, T-ML-02](https://orandownloadsweb.azurewebsites.net/specifications)"
  - '<a name="2"> \[2\] </a> [Adversarial Machine Learning: Well-known techniques](https://viso.ai/deep-learning/adversarial-machine-learning/)'
  - <a name="3"> \[3\] </a> [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML03_2023-Model_Inversion_Attack.html)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: User/NPE/Administrative Access
  architecture-segment: Network Slice, OA&M, Virtualization
  bluf: An adversary may use compromised container management SW (or account) in MANO
    domain to gain access to target VNFs and its resources for unauthorized access
    to resources/data of another slice in NFVI or resource exhaustion of target application
    resulting in denial of service.
  campaigns: []
  criticalassets:
  - description: NFVI includes orchestrators, network managers, and network elements
    name: NFVI
  - description: 5G Core, RAN and Non-SBI functions, virtual resources supporting
      VNF
    name: VNF
  - description: Network slice SLA data, some information may be exposed if application
      functions are shared
    name: Operator network slicing mgmt
  - description: The application related data and sensitive parameters associated
      with a VNF
    name: VNF application data
  description: "An adversary may use compromised container management SW (or account)\
    \ in MANO domain to gain access to target VNFs and its resources for unauthorized\
    \ access to resources/data of another slice in NFVI or resource exhaustion of\
    \ target application resulting in denial of service.\r\n\r\nNetwork Slice has\
    \ a logical boundary, and within NS certain performance SLAs are guaranteed. A\
    \ malicious software or adversarial actions in the NFV-MANO, modifies the affinity\
    \ and anti-affinity rules for the constituents of VNFs/NSs in the catalogue or\
    \ during an instantiation operation requested to the VIM, modifying the virtual\
    \ resource isolation needs for these VNFs/NSs and enabling further attacks. This\
    \ can result in placing adversary's virtualized application on the same VM or\
    \ container engine as target NF and allow for further attacks of container or\
    \ VM escape or resource exhaustion."
  detections:
  - component: Logon Session Metadata
    detects: Audit Policy Violations - Automated user and resource policy compliance
      checks and instrumentation to alert on violation attempts.
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Audit logs - Auditing logs for security, authentication and authorization
      activity, host access, hosts, virtualization orchestrator and managers can reveal
      behavioral anomalies.
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Host Status
    detects: Monitor systems and host performance.
    fgdsid: FGDS0013.001
    name: Sensor Health
  - component: Network Traffic Content
    detects: Monitor network flows.
    fgdsid: FGDS0029.002
    name: Network Traffic
  groups: []
  id: FGT5038
  mitigations:
  - fgmid: FGM1026
    mitigates: Least Privilege Access Control Policy - Access control policies should
      be granular to allow for optimal access to service requirements.
    name: Privileged Account Management
  - fgmid: FGM1035
    mitigates: Resource Policy enforcement -Create and enforce resource policy; policy
      can include SLA, quotas, QOS etc.
    name: Limit Access To Resource Over Network
  - fgmid: FGM1030
    mitigates: Security and Trust zones -Security and trust zones can help isolate
      resources and can be mapped to business needs.Micro and Nano segmentation- Implementing
      segmentation policy at granular level, network and compute resources can prevent
      some co-residency threats when mapped to SLAs, Users, and Resource policies.Physical
      separation- Hardware, network, and point of presence can be separated to provide
      additional isolation.
    name: Network Segmentation
  - fgmid: FGM5505
    mitigates: Hardware Mediated Execution Environment -Employ secure, hardware- based
      execution integrity as part of host/server design (M1041).
    name: Hardware Mediated Execution Environment
  - fgmid: FGM1041
    mitigates: Encryption can be used to protect data at rest and in transit
    name: Encrypt Sensitive Information
  - fgmid: FGM5506
    mitigates: Use of Network Slice Templates -Use of templates for network slicing
      can enforce baseline security and isolation requirements.  These templates can
      be created for networks, compute and 5G slice functions deployments.
    name: Network Slice Templates
  name: Network Slice Application Resource Hijacking
  object-type: technique
  platforms: Slice platform
  postconditions: []
  preconditions: []
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Fraunhofer AISEC, "Threat Analysis of Container-as-a-Service
    for Network Function, accessed April 28, 2021](https://www.aisec.fraunhofer.de/content/dam/aisec/Dokumente/Publikationen/Studien_TechReports/englisch/caas_threat_analysis_wp.pdf)
  software: []
  status: Theoretical
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: User Or Administrative Access To Repository
  architecture-segment: Virtualization, OA&M
  bluf: Adversaries may bridge network boundaries by modifying a Virtual Network Function's
    Configuration.
  campaigns: []
  criticalassets:
  - description: Adversary may target a particular network controller, network element,
      CI/CD, security to manipulate VNF behavior
    name: Operator NFV MANO
  - description: Adversary may target particular operations tools to manipulate VNF
      behavior
    name: Operator OSS/BSS
  - description: Adversary may target particular security tools to manipulate VNF
      behavior
    name: SDN Controller and Network Elements, operations, and security tools
  - description: Adversary may target configuration in the VNF, stored in backups,
      or part of the code
    name: System Configuration
  description: "Adversaries may bridge network boundaries by modifying a Virtual Network\
    \ Function's Configuration.\r\n\r\nAny VNF that serves as a Middlebox or Proxy\
    \ can be targeted by adversary for configuration exploits (Network Address Translation\
    \ (NAT), Gateways, Security Edge Protection Proxies (SEPPs), IP Exchange (IPXs)\
    \ entities). Configuration stored on the device determines the device behavior\
    \ for middle boxes such as NAT or application GWs. Start up and run time configuration\
    \ data can be manipulated for nefarious purposes. SDN VNF unauthorized configuration\
    \ changes can lead modified 5G traffic flows and may bridge otherwise isolated\
    \ slices. "
  detections:
  - component: Logon Session Creation
    detects: Access Logs - Analyze access session logs to detect unauthorized activity
      to VNF and other tools used in lifecycle management and security of the VNF
    fgdsid: FGDS0028.001
    name: Logon Session
  - component: Logon Session Metadata
    detects: Analyze access session meta data logs to detect unauthorized activity
    fgdsid: FGDS0028.002
    name: Logon Session
  - component: Application Log Content
    detects: Audit configuration - Periodically audit VNF log contents and configuration
      to detect unauthorized changes
    fgdsid: FGDS0015.001
    name: Application Log
  - component: Network Traffic Content
    detects: Audit network flow - Audit network flows to VNF and other tools used
      in lifecycle management and security of the VNF
    fgdsid: FGDS0029.002
    name: Network Traffic
  - component: Image Modification
    detects: Image life cycle and runtime events
    fgdsid: FGDS0007.004
    name: Image
  - component: Process Modification
    detects: Monitor process modification supporting VNF
    fgdsid: FGDS0009.005
    name: Process
  groups: []
  id: FGT5039
  mitigations:
  - fgmid: FGM1033
    mitigates: VNF Access Rights -Restricted Permissions to add images to VNFs (Network
      Element) for person and non-person accounts
    name: Limit Software Installation
  - fgmid: FGM1047
    mitigates: Logs from VNFs must be corelated with other OA&M and Security monitoring
      tools to ensure unauthorize activity is reported. SEIM like system should be
      deployed to correlate events.
    name: Audit
  - fgmid: FGM1053
    mitigates: Configuration back ups -All VNF Configurations should be backed up
      and periodically audited to see differences between running configuration and
      back up configurations as well as comparison between configuration catalogue
      and running instance
    name: Data Backup
  name: Manipulate Virtual Network Function (VNF) Configuration
  object-type: technique
  platforms: SDN vSwitch, Network Element
  postconditions:
  - description: VNF compromise can lead to DOS or change in the traffic pattern and
      paths.
    name: Unexpected and unusual VNF behavior
  preconditions:
  - description: Privileged Access to VNF or VNF managers via direct login or through
      Control Plane APIs
    name: Credential and Access
  procedureexamples:
  - description: Active configuration changes can be made when direct access to VNF
      or its element managers is available
    name: Active configuration changes
  - description: Configuration as a code repository or back up configuration store
      can be manipulated to cause an NF to take compromised configuration upon reboot
      or re-instantiation
    name: Stored or Coded configuration
  references:
  - '<a name="1"> \[1\] </a> [S.P. Rao, S. Holtmanns, T. Aura: "Threat modeling framework
    for mobile communication systems", May 2020](https://arxiv.org/abs/2005.05110v1)'
  software: []
  status: Theoretical
  tactics:
  - TA0005
  typecode: fight_technique
- access-required: User/Subscriber
  architecture-segment: Control Plane
  bluf: Adversary sends many arbitrary but cryptographically weak SUCI values in registration
    requests in order to discover private key of MNO using information received from
    failure/success responses.
  campaigns: []
  criticalassets:
  - description: MNO private key used for SUCI de-concealment operations
    name: MNO crypto material
  description: "Adversary sends many arbitrary but cryptographically weak SUCI values\
    \ in registration requests in order to discover private key of MNO using information\
    \ received from failure/success responses.\r\n\r\nSUCI concealment and de-concealment\
    \ is based on a public/private key pair of the home Mobile Network Operator of\
    \ that user. The MNO makes known its public key to its subscribers so that they\
    \ can use it to conceal the SUPI and send the SUCI in the registration messages\
    \ sent to the visited network.\r\n\r\nThis adversarial behavior is also known\
    \ as the \"Invalid curve attack\". It is a type of brute-force private key guessing,\
    \ where the adversary (for example via a user device /UE) sends many arbitrary\
    \ SUCIs in registration messages to the AMF; then AMF then passes the SUCI to\
    \ the UDM function in the core network, which tries to decrypt them via both its\
    \ private key and the adversary's public key. If the public key of the adversary\
    \ uses a weaker \"Profile B\" (instead of \"Profile A\") for elliptic curves,\
    \ and if the public key validation is not first performed before SUCI deconcealment\
    \ is attempted, then it is possible to recover the private key of the MNO (used\
    \ for SUCI computation) via brute force. This is based on the response obtained\
    \ from the network on whether the decryption was successful or not. \r\n\r\nIn\
    \ the context of elliptic curve cryptography, by sending an invalid point (valid\
    \ point on an invalid curve) as an uncompressed public key to the network, it\
    \ is possible to eventually compute the shared secret. \r\n\r\nThis behavior can\
    \ be used for follow-on behaviors such as SUCI decryption."
  detections:
  - component: Slice performance counters and KPIs of core NFs in MANO
    detects: Inspect SUCI parameters from the UE registration call flow- the public
      key the UE sends should be on the expected elliptic curve.
    fgdsid: FGDS5026.001
    name: Slice performance counters, KPIs
  groups: []
  id: FGT5040
  mitigations:
  - fgmid: FGM5093
    mitigates: UDM should check that received public key from the UE for the SUCI
      is on the expected curve.
    name: SUCI Parameter Checks
  name: Discover Operator Private Key
  object-type: technique
  platforms: 5G Core
  postconditions: []
  preconditions: []
  procedureexamples:
  - description: The UE sends many such legitimate registration requests, each with
      a new SUCI, then notes the result - most of the time instead of "Authentication
      request", the result is a "MAC Failure". The authors call this a decryption
      oracle ([1]). Where the public key used for SUCI calculation at the UE side
      is an "invalid elliptic curve point", then after recording the result of many
      such attempts (e.g, 6000), it is possible to recover the MNO private key used
      for SUCI deconcealing at the network side. In [1], private key of MNO was recovered
      it in about 4 hours or 6000 registration requests.
    name: Adversary uses a UE to send multiple registration requests with different
      SUCIs.
  - description: An adversary does not have to use a UE, if already in the SBA, it
      can send multiple Nudm_UEAuthentication Get requests with different SUCIs and
      note the result- which is a SUPI if successful and an error if not. Similar
      of MNO private key recovery is possible as in the example where the SUCIs are
      delivered from a UE via registration messages.
    name: Adversary already in the 5G core network sends messages to the UDM directly
  references:
  - <a name="1"> \[1\] </a> [The name that will appear on the website](The fully functional
    URL that will be the hyperlink for the text in the left hand column.)
  - <a name="2"> \[2\] </a> [T. Funke, D. Rupprecht, "Invalid Curve Attack on the
    5G SUCI Privacy Feature", Oct 2023](https://www.gsma.com/solutions-and-impact/technologies/security/wp-content/uploads/2023/10/0073-invalid_curve.pdf)
  - <a name="3"> \[3\] </a> [CVE-2023-46324](https://nvd.nist.gov/vuln/detail/CVE-2023-46324)
  software: []
  status: Theoretical
  tactics:
  - TA0007
  typecode: fight_technique
- access-required: N/A
  architecture-segment: Control Plane
  bluf: Adversary sends fake SBI message to NRF to de-register a legitimate NF from
    5G network.
  campaigns: []
  criticalassets:
  - description: The fake SBI message compromises the NRF and other NFs.
    name: NRF and NFs
  description: "Adversary sends fake SBI message to NRF to de-register a legitimate\
    \ NF from 5G network.\r\n\r\nSending the Fake SBI Message: The adversary constructs\
    \ and sends a fake SBI message formatted as an HTTP request (using methods like\
    \ DELETE or POST) to the NRF. This message is crafted to appear as a legitimate\
    \ request to deregister an NF. \r\n\r\nManipulating the NRF and Impact: The fraudulent\
    \ message instructs the NRF to remove the target NF from the registry, disrupting\
    \ all communications and services dependent on that NF. This showcases the importance\
    \ of securing API interactions within the network to prevent such disruptions.\r\
    \n\r\nThe adversary first needs access to the 5G core network's SBI, which might\
    \ be achieved by exploiting API vulnerabilities or stealing credentials. Using\
    \ the NRF's discovery services, the adversary identifies the details of active\
    \ NFs within the network."
  detections:
  - component: Active Directory Object Creation
    detects: Monitor for creation of new objects in AD, such as user accounts, groups,
      organizational units (OUs), or trust relationships.
    fgdsid: FGDS0026.003
    name: Active Directory
  - component: Application Log Content
    detects: Monitor logs at NRF for REST API transactions invoked from other core
      NFs especially the De-registration ones.
    fgdsid: FGDS0015.001
    name: Application Log
  groups: []
  id: FGT5041
  mitigations:
  - fgmid: FGM1021
    mitigates: Administrators can block end-user consent to OAuth applications, disabling
      users from authorizing third-party apps through OAuth 2.0 and forcing administrative
      consent for all requests. They can also block end-user registration of applications
      by their users, to reduce risk. A Cloud Access Security Broker can also be used
      to ban applications.
    name: Restrict Web-Based Content
  - fgmid: FGM1018
    mitigates: 'Enforce role-based access control to limit accounts to the least privileges
      they require. A Cloud Access Security Broker (CASB) can be used to set usage
      policies and manage user permissions on cloud applications to prevent access
      to application access tokens. In Kubernetes applications, set "automountServiceAccountToken:
      false" in the YAML specification of pods that do not require access to service
      account tokens.'
    name: User Account Management
  name: DOS An NF Via Deregistration
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: An NF that was once available becomes unavailable because it is deregistered
      maliciously.
    name: NF is unavailable
  preconditions:
  - description: The lack of mutual TLS for all nodes.
    name: Lack of TLS Nodes
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [Intruding 5G SA core networks from outside and inside](https://penthertz.com/resources/Intruding%205G%20SA%20core%20networks%20from%20outside%20and%20inside.pdf)
  - <a name="2"> \[2\] </a> [API Wars in 5G Networks](https://powerofcommunity.net/poc2022/SinjoPark.pdf)
  - '<a name="3"> \[3\] </a> [Dr. Nestori Syynimaa. (2021, December 13): "AADInternals."
    Retrieved February 1, 2022.](https://github.com/Gerenios/AADInternals)'
  software:
  - description: "AADInternals\_can steal users' access tokens via phishing emails\
      \ containing malicious links. [3]"
    fgsid: S0677
    name: AADInternals
  status: Proof Of Concept
  tactics:
  - TA0040
  typecode: fight_technique
- access-required: IPX Access
  architecture-segment: User Plane
  bluf: Adversary uses GTP echo request message to bypass telecom signaling application-layer
    firewall and so obtain and maintain unauthorized access.
  campaigns: []
  criticalassets:
  - description: Short description of the assets that adversary wants to target or
      that are at risk such as data (system/user, access token, crypto key etc.),
      capability, service.
    name: User data
  description: "Adversary uses GTP echo request message to bypass telecom signaling\
    \ application-layer firewall and so obtain and maintain unauthorized access.\r\
    \n\r\nGTP-U carries user data and is used in the roaming network (IPX), and also\
    \ on the N9 interface for 5G roaming. An adversary may use the heartbeat protocol\
    \ for GTP-U to hide their traffic. GTP- Echo are used as the medium for transmitting\
    \ adversary data (command and control), taking advantage of the fact that GTP\
    \ Echo cannot be blocked or disabled by firewalls. As a pre-condition, this malware\
    \ is already running on the victim UPF (or another user plane function, for earlier\
    \ generations or a user plane function in the IP Multimedia Subsystem (IMS)) so\
    \ that it then responds with GTP-U Echo messages and Echo responses, communicating\
    \ through the IPX fabric with adversary C2 server.\r\n\r\nFor the malware GTPDOOR,\
    \ some key features include using raw sockets for UDP packets on port 2123, message\
    \ authentication with a hardcoded key, payload decryption, shell command execution,\
    \ and TCP probes for signaling. Their traffic is concealed within GPRS connections\
    \ via SSH. These requests are processed by the backdoor, which decrypts the payload\
    \ and executes the embedded shell commands. TCP probes are used for covert signaling,\
    \ allowing the adversary to maintain communication and control over the compromised\
    \ system."
  detections:
  - component: Firewall metadata
    detects: Inspect logs of application-layer firewalls that check GTP-U and other
      telecom signaling. Check for GTP-Echo packets that contain unexpected data.
    fgdsid: FGDS0018.003
    name: Firewall
  groups:
  - description: LightBasin used GTPDOOR for C2 data transfer outside of an operator
      network, bypassing signaling firewalls ([1],[2],[3],[4],[5])
    fggid: FGG5001
    name: Liminal Panda
  id: FGT5042
  mitigations:
  - fgmid: FGM1049
    mitigates: Anti-virus can be used to automatically detect and quarantine suspicious
      files running on the gNB or UPF or other IMS function
    name: Anti-virus & Anti-malware
  - fgmid: FGM1040
    mitigates: Prevent the running (on this NF "endpoint") of obfuscated or masquerading
      software; this malware can disguise itself as syslogd.
    name: Behavior Prevention On Endpoint
  name: Bypass Telecom Signaling Firewall
  object-type: technique
  platforms: 5G RAN, 5G Core
  postconditions:
  - description: Adversary has access to user data traffic communication metadata
    name: User data privacy compromised
  preconditions:
  - description: It is assumed that the malware was downloaded onto the UPF or the
      NF (for 3G/4G) that handles GTP-U.
    name: Malware running on UPF
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [GTPDOOR Linux Malware Threatens Telecoms, Exploits GPRS
    Roaming Networks](https://linuxsecurity.com/news/network-security/gtpdoor-linux-malware)
  - <a name="2"> \[2\] </a> ['LightBasin' hackers spent 5 years hiding on telco networks](https://www.techtarget.com/searchsecurity/news/252508413/LightBasin-hackers-spent-5-years-hiding-on-telco-networks)
  - <a name="3"> \[3\] </a> [GTPDOOR - A novel backdoor tailored for covert access
    over the roaming exchange](https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR#operational-detail)
  - <a name="4"> \[4\] </a> [GTPDOOR - A novel backdoor tailored for covert access
    over the roaming exchange](https://www.crowdstrike.com/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
  - <a name="5"> \[5\] </a> [Nokia "Threat Intelligence Report 2024"](https://onestore.nokia.com/asset/214202)
  software:
  - description: GTPDOOR is used to bypass telecom signaling firewall [1], [3], [4]
    fgsid: FGS5012
    name: GTPDOOR
  status: Observed
  tactics:
  - TA0005
  typecode: fight_technique
- access-required: None
  architecture-segment: Control Plane
  bluf: An adversary may use an OAuth2.0 token to gain unauthorized access to a network
    function via service based interfaces in the 5G core.
  campaigns: []
  criticalassets:
  - description: OAuth tokens belonging to the particular 5G core NF.
    name: NF credentials
  description: An adversary may use an OAuth2.0 token to gain unauthorized access
    to a network function via service based interfaces in the 5G core.
  detections:
  - component: Permission Request
    detects: System prompts triggered when an application requests new or additional
      permissions.
    fgdsid: FGDS0042.001
    name: User Interface
  groups: []
  id: FGT5043
  mitigations:
  - fgmid: FGM1047
    mitigates: Audit all NF registrations in the NRF to ensure they are having the
      appropriate access to resources
    name: Audit
  - fgmid: FGM1040
    mitigates: Prevent suspicious API calls.
    name: Behavior Prevention On Endpoint
  name: Unauthorized Access To Core Network Function Via Token Abuse
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Unauthorized access to network functions allows attackers to exploit
      APIs beyond their privilege level, leading to data leaks, service disruptions,
      and exposure of sensitive subscriber information such as location and authentication
      details. This can result in service disruption and denial-of-service attacks,
      as attackers may deregister network functions, disrupt authentication processes,
      or manipulate network policies. Furthermore, improperly scoped tokens can enable
      privilege escalation and API abuse, allowing attackers to perform actions meant
      for higher-privileged entities, thereby compromising network security. Such
      vulnerabilities undermine the network trust model, weakening service-to-service
      communication integrity and increasing the risk of lateral attacks.
    name: OAuth2.0 Scope Exploitation
  preconditions:
  - description: The adversary must first gain control of a Network Function (NF)
      that holds valid operator credentials. Once in control, the malicious NF needs
      to obtain valid access tokens from the Network Repository Function (NRF). This
      step is generally achievable if the NF is recognized as a legitimate entity
      within the system. Token exploitation can occur if the OAuth2.0 implementation
      treats the scope parameter in token issuance as optional. When this parameter
      is not properly restricted, it can lead to over-privileged access. Such a lack
      of granular access control typically arises when NF producers fail to specify
      detailed "additional scope" parameters.
    name: OAuth2.0 scope exploitation
  procedureexamples:
  - description: 'a) Man-in-the-Middle (MitM) Attack: An attacker could intercept
      the token request and response between the client and the authorization server,
      gaining access to the access token.b) Token Leakage: If the access token is
      stored insecurely on the client-side or transmitted over an unsecured channel,
      it could be exposed to attackers.c) Token Replay Attack: An attacker might attempt
      to reuse an intercepted access token to gain unauthorized access to the protected
      resources.'
    name: Eavesdropping the token during transmission
  - description: 'a) Stolen Client Credentials: If the client credentials (client
      ID and client secret) are not properly secured, an attacker could steal them
      through various means, such as through a compromised server, source code leak,
      or other security vulnerabilities.b) Brute Force Attack: An attacker could try
      to guess the client credentials through a brute force attack if the credentials
      are not strong enough.c) Eavesdropping the client credential during transmission:
      An attacker could eavesdrop on the transmission of client credentials between
      the client and server during the client registration process.'
    name: Disclosure of client credentials
  - description: Getting hold of the token through various injection attacks can be
      executed through an application or instance that doesn't fall directly under
      the control of the operators. One of the example would be API calls from 3rd
      party AF and MEC applications call via NEF. These are vulnerable to different
      types of inject attacks, i.e JSONi, SQLinJSON, CI in JSON.
    name: Theft of tokens through injection attacks
  references:
  - <a name="1"> \[1\] </a> [I. Saleem, "OAuth2.0 Security and Protocol Exploit Analysis
    in 5G Ecosystem", June 2023](https://www.researchgate.net/publication/371401470_OAuth20_Security_and_Protocol_Exploit_Analysis_in_5G_Ecosystems)
  software: []
  status: Theoretical
  tactics:
  - TA0008
  - TA0006
  typecode: fight_technique
- access-required: None
  architecture-segment: Control Plane
  bluf: Adversary exploits OAuth2.0 scope configuration using inadequate scope definitions
    during NF registration to gain unauthorized access to network functions in 5G
    networks.
  campaigns: []
  criticalassets:
  - description: OAuth tokens belonging to the 5G core NF.
    name: NF credentials
  description: "Adversary exploits OAuth2.0 scope configuration using inadequate scope\
    \ definitions during NF registration to gain unauthorized access to network functions\
    \ in 5G networks.\r\n\r\nThe attack exploits the OAuth2.0 protocol within the\
    \ 5G Service-Based Architecture (SBA) by focusing on the improper handling of\
    \ the \"scope\" parameter. A malicious Network Function (NF) with valid operator\
    \ credentials can obtain access tokens from the Network Repository Function (NRF).\
    \ The issue arises when the NF Service Producer registers with the NRF without\
    \ specifying detailed \"additional scope\" information, leading to an overprivileged\
    \ policy. This omission allows the NF Service Consumer to request access to resources\
    \ beyond its intended scope by including \"additional scope\" parameters in the\
    \ token access request. As a result, the NF Service Consumer can gain unauthorized\
    \ access to various API endpoints and services of the NF Service Producer. This\
    \ can lead to significant security risks, such as service disruptions, data exposure,\
    \ and unauthorized operations, including deleting registration statuses or accessing\
    \ sensitive subscription data. The attack underscores the necessity for strict\
    \ control over OAuth2.0 scope definitions and the implementation of least privilege\
    \ principles to mitigate such security issues in the 5G ecosystem"
  detections:
  - component: Permission Request
    detects: System prompts triggered when an application requests new or additional
      permissions.
    fgdsid: FGDS0042.001
    name: User Interface
  groups: []
  id: FGT5043.001
  mitigations:
  - fgmid: FGM1047
    mitigates: Audit all NF registrations in the NRF to ensure they are having the
      appropriate access to resources.
    name: Audit
  - fgmid: FGM1040
    mitigates: Prevent suspicious API calls.
    name: Behavior Prevention On Endpoint
  name: Exploit OAuth2 Scope
  object-type: technique
  platforms: 5G Core
  postconditions:
  - description: Unauthorized access to network functions allows attackers to exploit
      APIs beyond their privilege level, leading to data leaks, service disruptions,
      and exposure of sensitive subscriber information such as location and authentication
      details. This can result in service disruption and denial-of-service attacks,
      as attackers may deregister network functions, disrupt authentication processes,
      or manipulate network policies. Furthermore, improperly scoped tokens can enable
      privilege escalation and API abuse, allowing attackers to perform actions meant
      for higher-privileged entities, thereby compromising network security. Such
      vulnerabilities undermine the network trust model, weakening service-to-service
      communication integrity and increasing the risk of lateral attacks.
    name: OAuth2.0 Scope Exploitation
  preconditions:
  - description: The adversary must first gain control of a Network Function (NF)
      that holds valid operator credentials. Once in control, the malicious NF needs
      to obtain valid access tokens from the Network Repository Function (NRF). This
      step is generally achievable if the NF is recognized as a legitimate entity
      within the system. Token exploitation can occur if the OAuth2.0 implementation
      treats the scope parameter in token issuance as optional. When this parameter
      is not properly restricted, it can lead to over-privileged access. Such a lack
      of granular access control typically arises when NF producers fail to specify
      detailed "additional scope" parameters.
    name: OAuth2.0 scope exploitation
  procedureexamples:
  - description: 'a) Man-in-the-Middle (MitM) Attack: An attacker could intercept
      the token request and response between the client and the authorization server,
      gaining access to the access token.b) Token Leakage: If the access token is
      stored insecurely on the client-side or transmitted over an unsecured channel,
      it could be exposed to attackers.c) Token Replay Attack: An attacker might attempt
      to reuse an intercepted access token to gain unauthorized access to the protected
      resources.'
    name: Eavesdropping the token during transmission
  - description: 'a) Stolen Client Credentials: If the client credentials (client
      ID and client secret) are not properly secured, an attacker could steal them
      through various means, such as through a compromised server, source code leak,
      or other security vulnerabilities.b) Brute Force Attack: An attacker could try
      to guess the client credentials through a brute force attack if the credentials
      are not strong enough.c) Eavesdropping the client credential during transmission:
      An attacker could eavesdrop on the transmission of client credentials between
      the client and server during the client registration process.'
    name: Disclosure of client credentials
  - description: Getting hold of the token through various injection attacks can be
      executed through an application or instance that doesn't fall directly under
      the control of the operators. One of the example would be API calls from 3rd
      party AF and MEC applications call via NEF. These are vulnerable to different
      types of inject attacks, i.e., JSONi, SQLinJSON, CI in JSON.
    name: Stealing tokens through injection attacks
  references:
  - '<a name="1"> \[1\] </a> [I. Saleem: "OAuth2.0 Security and Protocol Exploit Analysis
    in 5G Ecosystem", June 2023.](https://www.researchgate.net/publication/371401470_OAuth20_Security_and_Protocol_Exploit_Analysis_in_5G_Ecosystems)'
  software: []
  status: Theoretical
  subtechnique-of: FGT5043
  tactics:
  - TA0006
  - TA0008
  typecode: fight_subtechnique
- access-required: Expanded Privilege
  architecture-segment: RAN, Roaming
  bluf: An adversary may attempt to subvert the roaming authentication process by
    forcing the home network to derive and send keys for a victim UE.
  campaigns: []
  criticalassets:
  - description: User plane data sent /received by the UE is revealed to the adversary.
    name: User data (calls/data/SMS)
  description: "An adversary may attempt to subvert the roaming authentication process\
    \ by forcing the home network to derive and send keys for a victim UE.\r\n\r\n\
    The adversary, having obtained the permanent identifier of the UE (SUPI/IMSI)\
    \ via some means, uses access to the IPX roaming network, or a compromised or\
    \ colluding cellular operator (PLMN) to send a fraudulent request for keys (subscriber\
    \ authentication vectors) to the home network of the victim UE. This technique\
    \ then enables an adversary to successfully decrypt the user data that passes\
    \ through a fake or compromised base station that the adversary is using. \r\n\
    \r\nThe false base station deployed in locations close to the subscriber of interest\
    \ lures the UE to connect to it and start a registration procedure. The false\
    \ base station may advertise a spoofed PLMN ID and cell ID in order to trigger\
    \ a new registration. \r\n\r\nFor 4G, this request for keys is carried over the\
    \ Diameter protocol (e.g., the AIR- Authentication-Information-Request), and it\
    \ has as origin a spoofed PLMN ID (e.g., the PLMN ID of the home network of the\
    \ UE (as in [1]), or another PLMN ID (of a legitimate roaming partner) that is\
    \ accepted by the Diameter firewall of the home network of the victim UE) (see\
    \ FGT1036.501). Then, the home network returns the authentication vectors and\
    \ the false base station completes the registration procedure and the user data\
    \ session is started, encrypted with the radio interface keys that the false base\
    \ station has obtained. Thus, the adversary can decrypt all traffic from the UE,\
    \ all the while providing data service (in order to remain undetected by the user).\
    \ \r\n\r\nFor 5G, the attack is more complex because it requires the cooperation\
    \ of a colluding cellular operator. The UE must first be tricked to connect to\
    \ the false base station advertising the PLMN ID of the colluding roaming partner.\
    \ After this, the adversary sends a fraudulent HTTP/2 message carrying an authentication\
    \ request. The 5G authentication procedure takes place between the UE, the colluding\
    \ PLMN, and the home PLMN of the UE. After this, the false base station is finally\
    \ in possession of the keys for radio interface and is able to decrypt user traffic.\
    \ Thus, the adversary can decrypt all traffic from the UE, all the while providing\
    \ data service. The UE may or may not show to the user the PLMN that the UE is\
    \ attaching to, thus this attack may remain undetected at the subscriber side.\
    \ In addition to user traffic decryption, an adversary can send user plane data\
    \ to the UE and possibly achieve remote code execution (RCE). "
  detections:
  - component: System Notifications
    detects: Configure UE / SIM to display current PLMN name, or to detect suspicious
      broadcast PLMN names.
    fgdsid: FGDS0042.002
    name: User Interface
  - component: Firewall metadata
    detects: Check Diameter or SEPP firewall logs for unexpected signaling sources
    fgdsid: FGDS0018.003
    name: Firewall
  groups: []
  id: FGT5044
  mitigations:
  - fgmid: FGM5542
    mitigates: Employ strict rules in the Diameter firewall to filter out incoming
      messages from suspicious origins or with unexpected content (including UE -
      plausibility of location and velocity checks)
    name: Application Layer Firewall
  name: Force Generation Of Subscriber Keys
  object-type: technique
  platforms: 5G RAN platform, Interconnect
  postconditions:
  - description: Decrypt all user data sent by the UE to the base station encrypted
    name: Reveal user data
  preconditions:
  - description: Adversary obtains a false base station and places it in the vicinity
      of the victim UE, setting it to broadcast a spoofed PLMN ID and cell ID
    name: Obtain and deploy false base station
  - description: The adversary buys access or fraudulently obtains access to the IPX
      network in order to send Diameter or HTTP/2 messages
    name: Obtain access to roaming network (IPX)
  - description: Adversaries uses a technique to obtain subscriber identifier (See
      FGT5019).
    name: Obtain UE IMSI/SUPI (for FORCE)
  procedureexamples:
  - description: An adversary sends from the IPX or a compromised PLMN a Diameter
      or HTTP/2 message to the home PLMN of a victim UE, having as a source (visited
      PLMN) a spoofed PLMN ID, in order to the force the home PLMN to derive air interface
      keys for that UE, and send them to the adversary in response to this request.
    name: Send fraudulent Diameter or HTTP/2 message to obtain UE keys
  references:
  - <a name="1"> \[1\] </a> [P1 security (2021). All authentication vectors are not
    made equal.](https://labs.p1sec.com/2021/09/30/all-authentication-vectors-are-not-made-equal/)
  - "<a name=\"2\"> \\[2\\] </a> [Lange, S., Gringoli, F., Hollick, M., Classen, J.\
    \ (2024). Wherever I May Roam: Stealthy Interception and\_Injection Attacks Through\
    \ Roaming Agreements. In: ESORICS 2024. Lecture Notes in Computer Science, vol\
    \ 14985.](https://doi.org/10.1007/978-3-031-70903-6_11)"
  software: []
  status: Theoretical
  tactics:
  - TA0006
  typecode: fight_technique
- access-required: Admin Or User
  architecture-segment: User Plane, Control Plane
  bluf: Adversaries may hide their data within a legitimate telecom protocol payload
    in order to evade defenses such as firewall measures.
  campaigns: []
  criticalassets:
  - description: Short description of the assets that adversary wants to target or
      that are at risk such as data (system/user, access token, crypto key etc.),
      capability, service.
    name: User data
  description: "Adversaries may hide their data within a legitimate telecom protocol\
    \ payload in order to evade defenses such as firewall measures.\r\n\r\nIn order\
    \ to evade defenses and detection, an adversary may send their data (command and\
    \ control, exfiltrated/stolen data) to an external adversary-controlled server\
    \ by hiding it inside the payload of legitimate telecommunications protocols.\
    \ The adversary may encrypt the data to ensure further obfuscation. The telecom\
    \ firewalls and gateways that may do deep packet inspection in 5G networks usually\
    \ allow this type of telecom protocols. In one case, these protocols were actually\
    \ rarely used any more (example: SS7), but the firewalls had not been updated\
    \ to mark such traffic as suspicious."
  detections:
  - component: Process Access
    detects: Employ EDR (Extended Detection and Response) for process execution.
    fgdsid: FGDS0009.002
    name: Process
  - component: File Modification
    detects: Employ File Integrity Monitoring (FIM) for recording file changes of
      key configuration files, including firewall configurations.
    fgdsid: FGDS0022.005
    name: File
  - component: Firewall enumeration
    detects: Application layer firewall enumerate- extract configuration info and
      results of applying the filtering of unexpected telecom protocol traffic.
    fgdsid: FGDS0018.002
    name: Firewall
  groups:
  - description: Liminal Panda placed C2 data, encrypted (with a fixed string) into
      SIGTRAN protocols - which even though rare in 4G/5G core and data network, but
      the firewalls allow this type of traffic [1],[2].
    fggid: FGG5001
    name: Liminal Panda
  id: FGT5045
  mitigations:
  - fgmid: FGM1018
    mitigates: Ensure proper user permissions are in place to prevent adversaries
      from disabling or modifying firewall settings.
    name: User Account Management
  - fgmid: FGM1022
    mitigates: Ensure proper process and file permissions are in place to prevent
      adversaries from disabling or modifying firewall settings.
    name: Restrict File And Directory Permissions
  name: Telecom Protocol Payload
  object-type: technique
  platforms: 5G Core, Roaming, Transport
  postconditions: []
  preconditions:
  - description: It is assumed that the malware was downloaded onto the UPF or the
      NF (for 3G/4G) that handles GTP-U.
    name: Malware running on UPF
  procedureexamples: []
  references:
  - '<a name="1"> \[1\] </a> [CrowdStrike blog: "LIMINAL PANDA: A Roaming Threat to
    Telecommunications Companies", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)'
  - '<a name="2"> \[2\] </a> [CrowdStrike blog: "Unveiling LIMINAL PANDA: A Closer
    Look at China''s Cyber Threats to the Telecom Sector", updated November 19, 2024.](https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats)'
  - '<a name="3"> \[3\] </a> [Hackernews article: "GTPDOOR Linux Malware Targets Telecoms,
    Exploiting GPRS Roaming Networks".](https://thehackernews.com/2024/02/gtpdoor-linux-malware-targets-telecoms.html)'
  software:
  - description: GTPDOOR is used to bypass telecom signaling firewall [3].
    fgsid: FGS5012
    name: GTPDOOR
  status: Observed
  tactics:
  - TA0005
  - TA0011
  typecode: fight_technique
- access-required: Privileged Access (Root)
  architecture-segment: RAN, MEC, OA&M
  bluf: Adversaries may create or modify system-level processes to retain access,
    prevent detection, and open communication paths with C2 servers and new targets.
  campaigns: []
  criticalassets:
  - description: Any system configuration manipulation can cause unwanted behavior.  In
      IP table example, integrity of firewall rules is critical to prevent unauthorized
      remote access. Control of eDNS nodes may impact telecom roaming and interconnectivity.
    name: System Configuration
  description: "Adversaries may create or modify system-level processes to retain\
    \ access, prevent detection, and open communication paths with C2 servers and\
    \ new targets.\r\n\r\nOne observed tactic is replacing legitimate binaries with\
    \ malicious \"wrapper\" programs that continue to perform expected functions while\
    \ introducing stealthy behaviors. These wrappers are often indistinguishable from\
    \ the original tools without in-depth forensic analysis.\r\n\r\nIn a confirmed\
    \ 2024 case, the threat group LIMINAL PANDA replaced the legitimate iptables binary\
    \ on compromised Linux-based eDNS servers with a wrapper binary. This wrapper\
    \ preserved core functionality, returning legitimate firewall rules when queried,\
    \ while secretly filtering out malicious SSH access rules used by the attackers\
    \ to maintain persistent connectivity across other compromised telecom environments.\
    \ The malicious binary allowed adversaries to bypass traditional auditing mechanisms\
    \ by presenting sanitized output to system administrators and analysts. This illustrates\
    \ how legitimate system tools can be subverted to create hidden backdoors, complicate\
    \ detection, and secure long-term access within critical telecom infrastructure."
  detections:
  - component: OS API Execution
    detects: Instances of computer programs that are being executed by at least one
      thread. Processes have memory space for process executables, loaded modules
      (DLLs or shared libraries), and allocated memory regions containing everything
      from user input to application-specific data structures
    fgdsid: FGDS0009.001
    name: Process
  - component: File Access
    detects: File Access
    fgdsid: FGDS0022.001
    name: File
  - component: File Creation
    detects: 'Initial construction of a new file (ex: Sysmon EID 11)'
    fgdsid: FGDS0022.002
    name: File
  - component: File Deletion
    detects: 'Removal of a file (ex: Sysmon EID 23, macOS ESF EID ES_EVENT_TYPE_AUTH_UNLINK,
      or Linux commands auditd unlink, rename, rmdir, unlinked, or renameat rules)'
    fgdsid: FGDS0022.003
    name: File
  - component: File Metadata
    detects: 'ontextual data about a file, which may include information such as name,
      the content (ex: signature, headers, or data/media), user/owner, permissions,
      etc.'
    fgdsid: FGDS0022.004
    name: File
  - component: File Modification
    detects: File contents are changed by adversary.
    fgdsid: FGDS0022.005
    name: File
  groups:
  - description: 'Liminal Panda replaced the standard iptables binary with a modified
      version (SHA256: 97d4c9b5750d614face73d11ba8532e53594332af53f4c07c1543195225b76eb)
      that selectively filters output, hiding unauthorized rules while maintaining
      SSH connections.'
    fggid: FGG5001
    name: Liminal Panda
  id: FGT5046
  mitigations:
  - fgmid: FGM1017
    mitigates: User Training helps employees and contractors recognize and prevent
      threats like phishing and social engineering, making them an active line of
      defense.
    name: User Training
  - fgmid: FGM1028
    mitigates: Operating System Configuration secures systems by hardening default
      settings to reduce vulnerabilities and limit attack surfaces
    name: Operating System Configuration
  - fgmid: FGM1045
    mitigates: Code Signing verifies the integrity and authenticity of software by
      using digital signatures to prevent execution of tampered or untrusted code.
    name: Code Signing
  name: Program Wrapper
  object-type: technique
  platforms: 'OS: Linux'
  postconditions:
  - description: Adversary achieves stealthy, long-term foothold and network pivoting
      within telecom environments.
    name: Persistence in the network
  preconditions:
  - description: Adversary must have administrative control to overwrite core system
      binaries like iptables.
    name: Privileged Access
  procedureexamples: []
  references:
  - <a name="1"> \[1\] </a> [CrowdStrike - Analysis of LightBasin Attacks](https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/)
  software:
  - description: PingPong - Custom ICMP-triggered backdoor used alongside binary wrapper
      for persistence.
    fgsid: FGS5001
    name: PingPong
  status: Observed
  tactics:
  - TA0003
  - TA0005
  typecode: fight_technique
